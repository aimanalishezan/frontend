import{r as v,a as Dr,R as ve,t as Nl,u as Di,L as lr,c as at,g as i1,b as s1,d as a1,N as o1,e as l1,f as ia,B as c1}from"./vendor-fb29d5a5.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function r(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(i){if(i.ep)return;i.ep=!0;const s=r(i);fetch(i.href,s)}})();var L0={exports:{}},uo={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var u1=v,f1=Symbol.for("react.element"),h1=Symbol.for("react.fragment"),d1=Object.prototype.hasOwnProperty,p1=u1.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,m1={key:!0,ref:!0,__self:!0,__source:!0};function M0(t,e,r){var n,i={},s=null,a=null;r!==void 0&&(s=""+r),e.key!==void 0&&(s=""+e.key),e.ref!==void 0&&(a=e.ref);for(n in e)d1.call(e,n)&&!m1.hasOwnProperty(n)&&(i[n]=e[n]);if(t&&t.defaultProps)for(n in e=t.defaultProps,e)i[n]===void 0&&(i[n]=e[n]);return{$$typeof:f1,type:t,key:s,ref:a,props:i,_owner:p1.current}}uo.Fragment=h1;uo.jsx=M0;uo.jsxs=M0;L0.exports=uo;var x=L0.exports,Dl={},Zu=Dr;Dl.createRoot=Zu.createRoot,Dl.hydrateRoot=Zu.hydrateRoot;class Fs{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(e){const r={listener:e};return this.listeners.add(r),this.onSubscribe(),()=>{this.listeners.delete(r),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}}const ws=typeof window>"u"||"Deno"in window;function Ut(){}function g1(t,e){return typeof t=="function"?t(e):t}function Ll(t){return typeof t=="number"&&t>=0&&t!==1/0}function j0(t,e){return Math.max(t+(e||0)-Date.now(),0)}function es(t,e,r){return fo(t)?typeof e=="function"?{...r,queryKey:t,queryFn:e}:{...e,queryKey:t}:t}function Yr(t,e,r){return fo(t)?[{...e,queryKey:t},r]:[t||{},e]}function ef(t,e){const{type:r="all",exact:n,fetchStatus:i,predicate:s,queryKey:a,stale:o}=t;if(fo(a)){if(n){if(e.queryHash!==Ac(a,e.options))return!1}else if(!Oa(e.queryKey,a))return!1}if(r!=="all"){const l=e.isActive();if(r==="active"&&!l||r==="inactive"&&l)return!1}return!(typeof o=="boolean"&&e.isStale()!==o||typeof i<"u"&&i!==e.state.fetchStatus||s&&!s(e))}function tf(t,e){const{exact:r,fetching:n,predicate:i,mutationKey:s}=t;if(fo(s)){if(!e.options.mutationKey)return!1;if(r){if(Fn(e.options.mutationKey)!==Fn(s))return!1}else if(!Oa(e.options.mutationKey,s))return!1}return!(typeof n=="boolean"&&e.state.status==="loading"!==n||i&&!i(e))}function Ac(t,e){return((e==null?void 0:e.queryKeyHashFn)||Fn)(t)}function Fn(t){return JSON.stringify(t,(e,r)=>jl(r)?Object.keys(r).sort().reduce((n,i)=>(n[i]=r[i],n),{}):r)}function Oa(t,e){return $0(t,e)}function $0(t,e){return t===e?!0:typeof t!=typeof e?!1:t&&e&&typeof t=="object"&&typeof e=="object"?!Object.keys(e).some(r=>!$0(t[r],e[r])):!1}function B0(t,e){if(t===e)return t;const r=rf(t)&&rf(e);if(r||jl(t)&&jl(e)){const n=r?t.length:Object.keys(t).length,i=r?e:Object.keys(e),s=i.length,a=r?[]:{};let o=0;for(let l=0;l<s;l++){const c=r?l:i[l];a[c]=B0(t[c],e[c]),a[c]===t[c]&&o++}return n===s&&o===n?t:a}return e}function Ml(t,e){if(t&&!e||e&&!t)return!1;for(const r in t)if(t[r]!==e[r])return!1;return!0}function rf(t){return Array.isArray(t)&&t.length===Object.keys(t).length}function jl(t){if(!nf(t))return!1;const e=t.constructor;if(typeof e>"u")return!0;const r=e.prototype;return!(!nf(r)||!r.hasOwnProperty("isPrototypeOf"))}function nf(t){return Object.prototype.toString.call(t)==="[object Object]"}function fo(t){return Array.isArray(t)}function U0(t){return new Promise(e=>{setTimeout(e,t)})}function sf(t){U0(0).then(t)}function v1(){if(typeof AbortController=="function")return new AbortController}function $l(t,e,r){return r.isDataEqual!=null&&r.isDataEqual(t,e)?t:typeof r.structuralSharing=="function"?r.structuralSharing(t,e):r.structuralSharing!==!1?B0(t,e):e}class x1 extends Fs{constructor(){super(),this.setup=e=>{if(!ws&&window.addEventListener){const r=()=>e();return window.addEventListener("visibilitychange",r,!1),window.addEventListener("focus",r,!1),()=>{window.removeEventListener("visibilitychange",r),window.removeEventListener("focus",r)}}}}onSubscribe(){this.cleanup||this.setEventListener(this.setup)}onUnsubscribe(){if(!this.hasListeners()){var e;(e=this.cleanup)==null||e.call(this),this.cleanup=void 0}}setEventListener(e){var r;this.setup=e,(r=this.cleanup)==null||r.call(this),this.cleanup=e(n=>{typeof n=="boolean"?this.setFocused(n):this.onFocus()})}setFocused(e){this.focused!==e&&(this.focused=e,this.onFocus())}onFocus(){this.listeners.forEach(({listener:e})=>{e()})}isFocused(){return typeof this.focused=="boolean"?this.focused:typeof document>"u"?!0:[void 0,"visible","prerender"].includes(document.visibilityState)}}const Ra=new x1,af=["online","offline"];class y1 extends Fs{constructor(){super(),this.setup=e=>{if(!ws&&window.addEventListener){const r=()=>e();return af.forEach(n=>{window.addEventListener(n,r,!1)}),()=>{af.forEach(n=>{window.removeEventListener(n,r)})}}}}onSubscribe(){this.cleanup||this.setEventListener(this.setup)}onUnsubscribe(){if(!this.hasListeners()){var e;(e=this.cleanup)==null||e.call(this),this.cleanup=void 0}}setEventListener(e){var r;this.setup=e,(r=this.cleanup)==null||r.call(this),this.cleanup=e(n=>{typeof n=="boolean"?this.setOnline(n):this.onOnline()})}setOnline(e){this.online!==e&&(this.online=e,this.onOnline())}onOnline(){this.listeners.forEach(({listener:e})=>{e()})}isOnline(){return typeof this.online=="boolean"?this.online:typeof navigator>"u"||typeof navigator.onLine>"u"?!0:navigator.onLine}}const Pa=new y1;function w1(t){return Math.min(1e3*2**t,3e4)}function ho(t){return(t??"online")==="online"?Pa.isOnline():!0}class H0{constructor(e){this.revert=e==null?void 0:e.revert,this.silent=e==null?void 0:e.silent}}function ba(t){return t instanceof H0}function W0(t){let e=!1,r=0,n=!1,i,s,a;const o=new Promise((g,w)=>{s=g,a=w}),l=g=>{n||(h(new H0(g)),t.abort==null||t.abort())},c=()=>{e=!0},u=()=>{e=!1},f=()=>!Ra.isFocused()||t.networkMode!=="always"&&!Pa.isOnline(),d=g=>{n||(n=!0,t.onSuccess==null||t.onSuccess(g),i==null||i(),s(g))},h=g=>{n||(n=!0,t.onError==null||t.onError(g),i==null||i(),a(g))},m=()=>new Promise(g=>{i=w=>{const b=n||!f();return b&&g(w),b},t.onPause==null||t.onPause()}).then(()=>{i=void 0,n||t.onContinue==null||t.onContinue()}),p=()=>{if(n)return;let g;try{g=t.fn()}catch(w){g=Promise.reject(w)}Promise.resolve(g).then(d).catch(w=>{var b,_;if(n)return;const k=(b=t.retry)!=null?b:3,L=(_=t.retryDelay)!=null?_:w1,M=typeof L=="function"?L(r,w):L,I=k===!0||typeof k=="number"&&r<k||typeof k=="function"&&k(r,w);if(e||!I){h(w);return}r++,t.onFail==null||t.onFail(r,w),U0(M).then(()=>{if(f())return m()}).then(()=>{e?h(w):p()})})};return ho(t.networkMode)?p():m().then(p),{promise:o,cancel:l,continue:()=>(i==null?void 0:i())?o:Promise.resolve(),cancelRetry:c,continueRetry:u}}const Cc=console;function _1(){let t=[],e=0,r=u=>{u()},n=u=>{u()};const i=u=>{let f;e++;try{f=u()}finally{e--,e||o()}return f},s=u=>{e?t.push(u):sf(()=>{r(u)})},a=u=>(...f)=>{s(()=>{u(...f)})},o=()=>{const u=t;t=[],u.length&&sf(()=>{n(()=>{u.forEach(f=>{r(f)})})})};return{batch:i,batchCalls:a,schedule:s,setNotifyFunction:u=>{r=u},setBatchNotifyFunction:u=>{n=u}}}const qe=_1();class V0{destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),Ll(this.cacheTime)&&(this.gcTimeout=setTimeout(()=>{this.optionalRemove()},this.cacheTime))}updateCacheTime(e){this.cacheTime=Math.max(this.cacheTime||0,e??(ws?1/0:5*60*1e3))}clearGcTimeout(){this.gcTimeout&&(clearTimeout(this.gcTimeout),this.gcTimeout=void 0)}}class E1 extends V0{constructor(e){super(),this.abortSignalConsumed=!1,this.defaultOptions=e.defaultOptions,this.setOptions(e.options),this.observers=[],this.cache=e.cache,this.logger=e.logger||Cc,this.queryKey=e.queryKey,this.queryHash=e.queryHash,this.initialState=e.state||b1(this.options),this.state=this.initialState,this.scheduleGc()}get meta(){return this.options.meta}setOptions(e){this.options={...this.defaultOptions,...e},this.updateCacheTime(this.options.cacheTime)}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&this.cache.remove(this)}setData(e,r){const n=$l(this.state.data,e,this.options);return this.dispatch({data:n,type:"success",dataUpdatedAt:r==null?void 0:r.updatedAt,manual:r==null?void 0:r.manual}),n}setState(e,r){this.dispatch({type:"setState",state:e,setStateOptions:r})}cancel(e){var r;const n=this.promise;return(r=this.retryer)==null||r.cancel(e),n?n.then(Ut).catch(Ut):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(this.initialState)}isActive(){return this.observers.some(e=>e.options.enabled!==!1)}isDisabled(){return this.getObserversCount()>0&&!this.isActive()}isStale(){return this.state.isInvalidated||!this.state.dataUpdatedAt||this.observers.some(e=>e.getCurrentResult().isStale)}isStaleByTime(e=0){return this.state.isInvalidated||!this.state.dataUpdatedAt||!j0(this.state.dataUpdatedAt,e)}onFocus(){var e;const r=this.observers.find(n=>n.shouldFetchOnWindowFocus());r&&r.refetch({cancelRefetch:!1}),(e=this.retryer)==null||e.continue()}onOnline(){var e;const r=this.observers.find(n=>n.shouldFetchOnReconnect());r&&r.refetch({cancelRefetch:!1}),(e=this.retryer)==null||e.continue()}addObserver(e){this.observers.includes(e)||(this.observers.push(e),this.clearGcTimeout(),this.cache.notify({type:"observerAdded",query:this,observer:e}))}removeObserver(e){this.observers.includes(e)&&(this.observers=this.observers.filter(r=>r!==e),this.observers.length||(this.retryer&&(this.abortSignalConsumed?this.retryer.cancel({revert:!0}):this.retryer.cancelRetry()),this.scheduleGc()),this.cache.notify({type:"observerRemoved",query:this,observer:e}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||this.dispatch({type:"invalidate"})}fetch(e,r){var n,i;if(this.state.fetchStatus!=="idle"){if(this.state.dataUpdatedAt&&r!=null&&r.cancelRefetch)this.cancel({silent:!0});else if(this.promise){var s;return(s=this.retryer)==null||s.continueRetry(),this.promise}}if(e&&this.setOptions(e),!this.options.queryFn){const h=this.observers.find(m=>m.options.queryFn);h&&this.setOptions(h.options)}const a=v1(),o={queryKey:this.queryKey,pageParam:void 0,meta:this.meta},l=h=>{Object.defineProperty(h,"signal",{enumerable:!0,get:()=>{if(a)return this.abortSignalConsumed=!0,a.signal}})};l(o);const c=()=>this.options.queryFn?(this.abortSignalConsumed=!1,this.options.queryFn(o)):Promise.reject("Missing queryFn for queryKey '"+this.options.queryHash+"'"),u={fetchOptions:r,options:this.options,queryKey:this.queryKey,state:this.state,fetchFn:c};if(l(u),(n=this.options.behavior)==null||n.onFetch(u),this.revertState=this.state,this.state.fetchStatus==="idle"||this.state.fetchMeta!==((i=u.fetchOptions)==null?void 0:i.meta)){var f;this.dispatch({type:"fetch",meta:(f=u.fetchOptions)==null?void 0:f.meta})}const d=h=>{if(ba(h)&&h.silent||this.dispatch({type:"error",error:h}),!ba(h)){var m,p,g,w;(m=(p=this.cache.config).onError)==null||m.call(p,h,this),(g=(w=this.cache.config).onSettled)==null||g.call(w,this.state.data,h,this)}this.isFetchingOptimistic||this.scheduleGc(),this.isFetchingOptimistic=!1};return this.retryer=W0({fn:u.fetchFn,abort:a==null?void 0:a.abort.bind(a),onSuccess:h=>{var m,p,g,w;if(typeof h>"u"){d(new Error(this.queryHash+" data is undefined"));return}this.setData(h),(m=(p=this.cache.config).onSuccess)==null||m.call(p,h,this),(g=(w=this.cache.config).onSettled)==null||g.call(w,h,this.state.error,this),this.isFetchingOptimistic||this.scheduleGc(),this.isFetchingOptimistic=!1},onError:d,onFail:(h,m)=>{this.dispatch({type:"failed",failureCount:h,error:m})},onPause:()=>{this.dispatch({type:"pause"})},onContinue:()=>{this.dispatch({type:"continue"})},retry:u.options.retry,retryDelay:u.options.retryDelay,networkMode:u.options.networkMode}),this.promise=this.retryer.promise,this.promise}dispatch(e){const r=n=>{var i,s;switch(e.type){case"failed":return{...n,fetchFailureCount:e.failureCount,fetchFailureReason:e.error};case"pause":return{...n,fetchStatus:"paused"};case"continue":return{...n,fetchStatus:"fetching"};case"fetch":return{...n,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:(i=e.meta)!=null?i:null,fetchStatus:ho(this.options.networkMode)?"fetching":"paused",...!n.dataUpdatedAt&&{error:null,status:"loading"}};case"success":return{...n,data:e.data,dataUpdateCount:n.dataUpdateCount+1,dataUpdatedAt:(s=e.dataUpdatedAt)!=null?s:Date.now(),error:null,isInvalidated:!1,status:"success",...!e.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};case"error":const a=e.error;return ba(a)&&a.revert&&this.revertState?{...this.revertState,fetchStatus:"idle"}:{...n,error:a,errorUpdateCount:n.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:n.fetchFailureCount+1,fetchFailureReason:a,fetchStatus:"idle",status:"error"};case"invalidate":return{...n,isInvalidated:!0};case"setState":return{...n,...e.state}}};this.state=r(this.state),qe.batch(()=>{this.observers.forEach(n=>{n.onQueryUpdate(e)}),this.cache.notify({query:this,type:"updated",action:e})})}}function b1(t){const e=typeof t.initialData=="function"?t.initialData():t.initialData,r=typeof e<"u",n=r?typeof t.initialDataUpdatedAt=="function"?t.initialDataUpdatedAt():t.initialDataUpdatedAt:0;return{data:e,dataUpdateCount:0,dataUpdatedAt:r?n??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:r?"success":"loading",fetchStatus:"idle"}}class T1 extends Fs{constructor(e){super(),this.config=e||{},this.queries=[],this.queriesMap={}}build(e,r,n){var i;const s=r.queryKey,a=(i=r.queryHash)!=null?i:Ac(s,r);let o=this.get(a);return o||(o=new E1({cache:this,logger:e.getLogger(),queryKey:s,queryHash:a,options:e.defaultQueryOptions(r),state:n,defaultOptions:e.getQueryDefaults(s)}),this.add(o)),o}add(e){this.queriesMap[e.queryHash]||(this.queriesMap[e.queryHash]=e,this.queries.push(e),this.notify({type:"added",query:e}))}remove(e){const r=this.queriesMap[e.queryHash];r&&(e.destroy(),this.queries=this.queries.filter(n=>n!==e),r===e&&delete this.queriesMap[e.queryHash],this.notify({type:"removed",query:e}))}clear(){qe.batch(()=>{this.queries.forEach(e=>{this.remove(e)})})}get(e){return this.queriesMap[e]}getAll(){return this.queries}find(e,r){const[n]=Yr(e,r);return typeof n.exact>"u"&&(n.exact=!0),this.queries.find(i=>ef(n,i))}findAll(e,r){const[n]=Yr(e,r);return Object.keys(n).length>0?this.queries.filter(i=>ef(n,i)):this.queries}notify(e){qe.batch(()=>{this.listeners.forEach(({listener:r})=>{r(e)})})}onFocus(){qe.batch(()=>{this.queries.forEach(e=>{e.onFocus()})})}onOnline(){qe.batch(()=>{this.queries.forEach(e=>{e.onOnline()})})}}class S1 extends V0{constructor(e){super(),this.defaultOptions=e.defaultOptions,this.mutationId=e.mutationId,this.mutationCache=e.mutationCache,this.logger=e.logger||Cc,this.observers=[],this.state=e.state||A1(),this.setOptions(e.options),this.scheduleGc()}setOptions(e){this.options={...this.defaultOptions,...e},this.updateCacheTime(this.options.cacheTime)}get meta(){return this.options.meta}setState(e){this.dispatch({type:"setState",state:e})}addObserver(e){this.observers.includes(e)||(this.observers.push(e),this.clearGcTimeout(),this.mutationCache.notify({type:"observerAdded",mutation:this,observer:e}))}removeObserver(e){this.observers=this.observers.filter(r=>r!==e),this.scheduleGc(),this.mutationCache.notify({type:"observerRemoved",mutation:this,observer:e})}optionalRemove(){this.observers.length||(this.state.status==="loading"?this.scheduleGc():this.mutationCache.remove(this))}continue(){var e,r;return(e=(r=this.retryer)==null?void 0:r.continue())!=null?e:this.execute()}async execute(){const e=()=>{var I;return this.retryer=W0({fn:()=>this.options.mutationFn?this.options.mutationFn(this.state.variables):Promise.reject("No mutationFn found"),onFail:(F,R)=>{this.dispatch({type:"failed",failureCount:F,error:R})},onPause:()=>{this.dispatch({type:"pause"})},onContinue:()=>{this.dispatch({type:"continue"})},retry:(I=this.options.retry)!=null?I:0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode}),this.retryer.promise},r=this.state.status==="loading";try{var n,i,s,a,o,l,c,u;if(!r){var f,d,h,m;this.dispatch({type:"loading",variables:this.options.variables}),await((f=(d=this.mutationCache.config).onMutate)==null?void 0:f.call(d,this.state.variables,this));const F=await((h=(m=this.options).onMutate)==null?void 0:h.call(m,this.state.variables));F!==this.state.context&&this.dispatch({type:"loading",context:F,variables:this.state.variables})}const I=await e();return await((n=(i=this.mutationCache.config).onSuccess)==null?void 0:n.call(i,I,this.state.variables,this.state.context,this)),await((s=(a=this.options).onSuccess)==null?void 0:s.call(a,I,this.state.variables,this.state.context)),await((o=(l=this.mutationCache.config).onSettled)==null?void 0:o.call(l,I,null,this.state.variables,this.state.context,this)),await((c=(u=this.options).onSettled)==null?void 0:c.call(u,I,null,this.state.variables,this.state.context)),this.dispatch({type:"success",data:I}),I}catch(I){try{var p,g,w,b,_,k,L,M;throw await((p=(g=this.mutationCache.config).onError)==null?void 0:p.call(g,I,this.state.variables,this.state.context,this)),await((w=(b=this.options).onError)==null?void 0:w.call(b,I,this.state.variables,this.state.context)),await((_=(k=this.mutationCache.config).onSettled)==null?void 0:_.call(k,void 0,I,this.state.variables,this.state.context,this)),await((L=(M=this.options).onSettled)==null?void 0:L.call(M,void 0,I,this.state.variables,this.state.context)),I}finally{this.dispatch({type:"error",error:I})}}}dispatch(e){const r=n=>{switch(e.type){case"failed":return{...n,failureCount:e.failureCount,failureReason:e.error};case"pause":return{...n,isPaused:!0};case"continue":return{...n,isPaused:!1};case"loading":return{...n,context:e.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:!ho(this.options.networkMode),status:"loading",variables:e.variables};case"success":return{...n,data:e.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...n,data:void 0,error:e.error,failureCount:n.failureCount+1,failureReason:e.error,isPaused:!1,status:"error"};case"setState":return{...n,...e.state}}};this.state=r(this.state),qe.batch(()=>{this.observers.forEach(n=>{n.onMutationUpdate(e)}),this.mutationCache.notify({mutation:this,type:"updated",action:e})})}}function A1(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0}}class C1 extends Fs{constructor(e){super(),this.config=e||{},this.mutations=[],this.mutationId=0}build(e,r,n){const i=new S1({mutationCache:this,logger:e.getLogger(),mutationId:++this.mutationId,options:e.defaultMutationOptions(r),state:n,defaultOptions:r.mutationKey?e.getMutationDefaults(r.mutationKey):void 0});return this.add(i),i}add(e){this.mutations.push(e),this.notify({type:"added",mutation:e})}remove(e){this.mutations=this.mutations.filter(r=>r!==e),this.notify({type:"removed",mutation:e})}clear(){qe.batch(()=>{this.mutations.forEach(e=>{this.remove(e)})})}getAll(){return this.mutations}find(e){return typeof e.exact>"u"&&(e.exact=!0),this.mutations.find(r=>tf(e,r))}findAll(e){return this.mutations.filter(r=>tf(e,r))}notify(e){qe.batch(()=>{this.listeners.forEach(({listener:r})=>{r(e)})})}resumePausedMutations(){var e;return this.resuming=((e=this.resuming)!=null?e:Promise.resolve()).then(()=>{const r=this.mutations.filter(n=>n.state.isPaused);return qe.batch(()=>r.reduce((n,i)=>n.then(()=>i.continue().catch(Ut)),Promise.resolve()))}).then(()=>{this.resuming=void 0}),this.resuming}}function I1(){return{onFetch:t=>{t.fetchFn=()=>{var e,r,n,i,s,a;const o=(e=t.fetchOptions)==null||(r=e.meta)==null?void 0:r.refetchPage,l=(n=t.fetchOptions)==null||(i=n.meta)==null?void 0:i.fetchMore,c=l==null?void 0:l.pageParam,u=(l==null?void 0:l.direction)==="forward",f=(l==null?void 0:l.direction)==="backward",d=((s=t.state.data)==null?void 0:s.pages)||[],h=((a=t.state.data)==null?void 0:a.pageParams)||[];let m=h,p=!1;const g=M=>{Object.defineProperty(M,"signal",{enumerable:!0,get:()=>{var I;if((I=t.signal)!=null&&I.aborted)p=!0;else{var F;(F=t.signal)==null||F.addEventListener("abort",()=>{p=!0})}return t.signal}})},w=t.options.queryFn||(()=>Promise.reject("Missing queryFn for queryKey '"+t.options.queryHash+"'")),b=(M,I,F,R)=>(m=R?[I,...m]:[...m,I],R?[F,...M]:[...M,F]),_=(M,I,F,R)=>{if(p)return Promise.reject("Cancelled");if(typeof F>"u"&&!I&&M.length)return Promise.resolve(M);const N={queryKey:t.queryKey,pageParam:F,meta:t.options.meta};g(N);const H=w(N);return Promise.resolve(H).then(Y=>b(M,F,Y,R))};let k;if(!d.length)k=_([]);else if(u){const M=typeof c<"u",I=M?c:of(t.options,d);k=_(d,M,I)}else if(f){const M=typeof c<"u",I=M?c:k1(t.options,d);k=_(d,M,I,!0)}else{m=[];const M=typeof t.options.getNextPageParam>"u";k=(o&&d[0]?o(d[0],0,d):!0)?_([],M,h[0]):Promise.resolve(b([],h[0],d[0]));for(let F=1;F<d.length;F++)k=k.then(R=>{if(o&&d[F]?o(d[F],F,d):!0){const H=M?h[F]:of(t.options,R);return _(R,M,H)}return Promise.resolve(b(R,h[F],d[F]))})}return k.then(M=>({pages:M,pageParams:m}))}}}}function of(t,e){return t.getNextPageParam==null?void 0:t.getNextPageParam(e[e.length-1],e)}function k1(t,e){return t.getPreviousPageParam==null?void 0:t.getPreviousPageParam(e[0],e)}class O1{constructor(e={}){this.queryCache=e.queryCache||new T1,this.mutationCache=e.mutationCache||new C1,this.logger=e.logger||Cc,this.defaultOptions=e.defaultOptions||{},this.queryDefaults=[],this.mutationDefaults=[],this.mountCount=0}mount(){this.mountCount++,this.mountCount===1&&(this.unsubscribeFocus=Ra.subscribe(()=>{Ra.isFocused()&&(this.resumePausedMutations(),this.queryCache.onFocus())}),this.unsubscribeOnline=Pa.subscribe(()=>{Pa.isOnline()&&(this.resumePausedMutations(),this.queryCache.onOnline())}))}unmount(){var e,r;this.mountCount--,this.mountCount===0&&((e=this.unsubscribeFocus)==null||e.call(this),this.unsubscribeFocus=void 0,(r=this.unsubscribeOnline)==null||r.call(this),this.unsubscribeOnline=void 0)}isFetching(e,r){const[n]=Yr(e,r);return n.fetchStatus="fetching",this.queryCache.findAll(n).length}isMutating(e){return this.mutationCache.findAll({...e,fetching:!0}).length}getQueryData(e,r){var n;return(n=this.queryCache.find(e,r))==null?void 0:n.state.data}ensureQueryData(e,r,n){const i=es(e,r,n),s=this.getQueryData(i.queryKey);return s?Promise.resolve(s):this.fetchQuery(i)}getQueriesData(e){return this.getQueryCache().findAll(e).map(({queryKey:r,state:n})=>{const i=n.data;return[r,i]})}setQueryData(e,r,n){const i=this.queryCache.find(e),s=i==null?void 0:i.state.data,a=g1(r,s);if(typeof a>"u")return;const o=es(e),l=this.defaultQueryOptions(o);return this.queryCache.build(this,l).setData(a,{...n,manual:!0})}setQueriesData(e,r,n){return qe.batch(()=>this.getQueryCache().findAll(e).map(({queryKey:i})=>[i,this.setQueryData(i,r,n)]))}getQueryState(e,r){var n;return(n=this.queryCache.find(e,r))==null?void 0:n.state}removeQueries(e,r){const[n]=Yr(e,r),i=this.queryCache;qe.batch(()=>{i.findAll(n).forEach(s=>{i.remove(s)})})}resetQueries(e,r,n){const[i,s]=Yr(e,r,n),a=this.queryCache,o={type:"active",...i};return qe.batch(()=>(a.findAll(i).forEach(l=>{l.reset()}),this.refetchQueries(o,s)))}cancelQueries(e,r,n){const[i,s={}]=Yr(e,r,n);typeof s.revert>"u"&&(s.revert=!0);const a=qe.batch(()=>this.queryCache.findAll(i).map(o=>o.cancel(s)));return Promise.all(a).then(Ut).catch(Ut)}invalidateQueries(e,r,n){const[i,s]=Yr(e,r,n);return qe.batch(()=>{var a,o;if(this.queryCache.findAll(i).forEach(c=>{c.invalidate()}),i.refetchType==="none")return Promise.resolve();const l={...i,type:(a=(o=i.refetchType)!=null?o:i.type)!=null?a:"active"};return this.refetchQueries(l,s)})}refetchQueries(e,r,n){const[i,s]=Yr(e,r,n),a=qe.batch(()=>this.queryCache.findAll(i).filter(l=>!l.isDisabled()).map(l=>{var c;return l.fetch(void 0,{...s,cancelRefetch:(c=s==null?void 0:s.cancelRefetch)!=null?c:!0,meta:{refetchPage:i.refetchPage}})}));let o=Promise.all(a).then(Ut);return s!=null&&s.throwOnError||(o=o.catch(Ut)),o}fetchQuery(e,r,n){const i=es(e,r,n),s=this.defaultQueryOptions(i);typeof s.retry>"u"&&(s.retry=!1);const a=this.queryCache.build(this,s);return a.isStaleByTime(s.staleTime)?a.fetch(s):Promise.resolve(a.state.data)}prefetchQuery(e,r,n){return this.fetchQuery(e,r,n).then(Ut).catch(Ut)}fetchInfiniteQuery(e,r,n){const i=es(e,r,n);return i.behavior=I1(),this.fetchQuery(i)}prefetchInfiniteQuery(e,r,n){return this.fetchInfiniteQuery(e,r,n).then(Ut).catch(Ut)}resumePausedMutations(){return this.mutationCache.resumePausedMutations()}getQueryCache(){return this.queryCache}getMutationCache(){return this.mutationCache}getLogger(){return this.logger}getDefaultOptions(){return this.defaultOptions}setDefaultOptions(e){this.defaultOptions=e}setQueryDefaults(e,r){const n=this.queryDefaults.find(i=>Fn(e)===Fn(i.queryKey));n?n.defaultOptions=r:this.queryDefaults.push({queryKey:e,defaultOptions:r})}getQueryDefaults(e){if(!e)return;const r=this.queryDefaults.find(n=>Oa(e,n.queryKey));return r==null?void 0:r.defaultOptions}setMutationDefaults(e,r){const n=this.mutationDefaults.find(i=>Fn(e)===Fn(i.mutationKey));n?n.defaultOptions=r:this.mutationDefaults.push({mutationKey:e,defaultOptions:r})}getMutationDefaults(e){if(!e)return;const r=this.mutationDefaults.find(n=>Oa(e,n.mutationKey));return r==null?void 0:r.defaultOptions}defaultQueryOptions(e){if(e!=null&&e._defaulted)return e;const r={...this.defaultOptions.queries,...this.getQueryDefaults(e==null?void 0:e.queryKey),...e,_defaulted:!0};return!r.queryHash&&r.queryKey&&(r.queryHash=Ac(r.queryKey,r)),typeof r.refetchOnReconnect>"u"&&(r.refetchOnReconnect=r.networkMode!=="always"),typeof r.useErrorBoundary>"u"&&(r.useErrorBoundary=!!r.suspense),r}defaultMutationOptions(e){return e!=null&&e._defaulted?e:{...this.defaultOptions.mutations,...this.getMutationDefaults(e==null?void 0:e.mutationKey),...e,_defaulted:!0}}clear(){this.queryCache.clear(),this.mutationCache.clear()}}class R1 extends Fs{constructor(e,r){super(),this.client=e,this.options=r,this.trackedProps=new Set,this.selectError=null,this.bindMethods(),this.setOptions(r)}bindMethods(){this.remove=this.remove.bind(this),this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.size===1&&(this.currentQuery.addObserver(this),lf(this.currentQuery,this.options)&&this.executeFetch(),this.updateTimers())}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return Bl(this.currentQuery,this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return Bl(this.currentQuery,this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,this.clearStaleTimeout(),this.clearRefetchInterval(),this.currentQuery.removeObserver(this)}setOptions(e,r){const n=this.options,i=this.currentQuery;if(this.options=this.client.defaultQueryOptions(e),Ml(n,this.options)||this.client.getQueryCache().notify({type:"observerOptionsUpdated",query:this.currentQuery,observer:this}),typeof this.options.enabled<"u"&&typeof this.options.enabled!="boolean")throw new Error("Expected enabled to be a boolean");this.options.queryKey||(this.options.queryKey=n.queryKey),this.updateQuery();const s=this.hasListeners();s&&cf(this.currentQuery,i,this.options,n)&&this.executeFetch(),this.updateResult(r),s&&(this.currentQuery!==i||this.options.enabled!==n.enabled||this.options.staleTime!==n.staleTime)&&this.updateStaleTimeout();const a=this.computeRefetchInterval();s&&(this.currentQuery!==i||this.options.enabled!==n.enabled||a!==this.currentRefetchInterval)&&this.updateRefetchInterval(a)}getOptimisticResult(e){const r=this.client.getQueryCache().build(this.client,e),n=this.createResult(r,e);return F1(this,n,e)&&(this.currentResult=n,this.currentResultOptions=this.options,this.currentResultState=this.currentQuery.state),n}getCurrentResult(){return this.currentResult}trackResult(e){const r={};return Object.keys(e).forEach(n=>{Object.defineProperty(r,n,{configurable:!1,enumerable:!0,get:()=>(this.trackedProps.add(n),e[n])})}),r}getCurrentQuery(){return this.currentQuery}remove(){this.client.getQueryCache().remove(this.currentQuery)}refetch({refetchPage:e,...r}={}){return this.fetch({...r,meta:{refetchPage:e}})}fetchOptimistic(e){const r=this.client.defaultQueryOptions(e),n=this.client.getQueryCache().build(this.client,r);return n.isFetchingOptimistic=!0,n.fetch().then(()=>this.createResult(n,r))}fetch(e){var r;return this.executeFetch({...e,cancelRefetch:(r=e.cancelRefetch)!=null?r:!0}).then(()=>(this.updateResult(),this.currentResult))}executeFetch(e){this.updateQuery();let r=this.currentQuery.fetch(this.options,e);return e!=null&&e.throwOnError||(r=r.catch(Ut)),r}updateStaleTimeout(){if(this.clearStaleTimeout(),ws||this.currentResult.isStale||!Ll(this.options.staleTime))return;const r=j0(this.currentResult.dataUpdatedAt,this.options.staleTime)+1;this.staleTimeoutId=setTimeout(()=>{this.currentResult.isStale||this.updateResult()},r)}computeRefetchInterval(){var e;return typeof this.options.refetchInterval=="function"?this.options.refetchInterval(this.currentResult.data,this.currentQuery):(e=this.options.refetchInterval)!=null?e:!1}updateRefetchInterval(e){this.clearRefetchInterval(),this.currentRefetchInterval=e,!(ws||this.options.enabled===!1||!Ll(this.currentRefetchInterval)||this.currentRefetchInterval===0)&&(this.refetchIntervalId=setInterval(()=>{(this.options.refetchIntervalInBackground||Ra.isFocused())&&this.executeFetch()},this.currentRefetchInterval))}updateTimers(){this.updateStaleTimeout(),this.updateRefetchInterval(this.computeRefetchInterval())}clearStaleTimeout(){this.staleTimeoutId&&(clearTimeout(this.staleTimeoutId),this.staleTimeoutId=void 0)}clearRefetchInterval(){this.refetchIntervalId&&(clearInterval(this.refetchIntervalId),this.refetchIntervalId=void 0)}createResult(e,r){const n=this.currentQuery,i=this.options,s=this.currentResult,a=this.currentResultState,o=this.currentResultOptions,l=e!==n,c=l?e.state:this.currentQueryInitialState,u=l?this.currentResult:this.previousQueryResult,{state:f}=e;let{dataUpdatedAt:d,error:h,errorUpdatedAt:m,fetchStatus:p,status:g}=f,w=!1,b=!1,_;if(r._optimisticResults){const F=this.hasListeners(),R=!F&&lf(e,r),N=F&&cf(e,n,r,i);(R||N)&&(p=ho(e.options.networkMode)?"fetching":"paused",d||(g="loading")),r._optimisticResults==="isRestoring"&&(p="idle")}if(r.keepPreviousData&&!f.dataUpdatedAt&&u!=null&&u.isSuccess&&g!=="error")_=u.data,d=u.dataUpdatedAt,g=u.status,w=!0;else if(r.select&&typeof f.data<"u")if(s&&f.data===(a==null?void 0:a.data)&&r.select===this.selectFn)_=this.selectResult;else try{this.selectFn=r.select,_=r.select(f.data),_=$l(s==null?void 0:s.data,_,r),this.selectResult=_,this.selectError=null}catch(F){this.selectError=F}else _=f.data;if(typeof r.placeholderData<"u"&&typeof _>"u"&&g==="loading"){let F;if(s!=null&&s.isPlaceholderData&&r.placeholderData===(o==null?void 0:o.placeholderData))F=s.data;else if(F=typeof r.placeholderData=="function"?r.placeholderData():r.placeholderData,r.select&&typeof F<"u")try{F=r.select(F),this.selectError=null}catch(R){this.selectError=R}typeof F<"u"&&(g="success",_=$l(s==null?void 0:s.data,F,r),b=!0)}this.selectError&&(h=this.selectError,_=this.selectResult,m=Date.now(),g="error");const k=p==="fetching",L=g==="loading",M=g==="error";return{status:g,fetchStatus:p,isLoading:L,isSuccess:g==="success",isError:M,isInitialLoading:L&&k,data:_,dataUpdatedAt:d,error:h,errorUpdatedAt:m,failureCount:f.fetchFailureCount,failureReason:f.fetchFailureReason,errorUpdateCount:f.errorUpdateCount,isFetched:f.dataUpdateCount>0||f.errorUpdateCount>0,isFetchedAfterMount:f.dataUpdateCount>c.dataUpdateCount||f.errorUpdateCount>c.errorUpdateCount,isFetching:k,isRefetching:k&&!L,isLoadingError:M&&f.dataUpdatedAt===0,isPaused:p==="paused",isPlaceholderData:b,isPreviousData:w,isRefetchError:M&&f.dataUpdatedAt!==0,isStale:Ic(e,r),refetch:this.refetch,remove:this.remove}}updateResult(e){const r=this.currentResult,n=this.createResult(this.currentQuery,this.options);if(this.currentResultState=this.currentQuery.state,this.currentResultOptions=this.options,Ml(n,r))return;this.currentResult=n;const i={cache:!0},s=()=>{if(!r)return!0;const{notifyOnChangeProps:a}=this.options,o=typeof a=="function"?a():a;if(o==="all"||!o&&!this.trackedProps.size)return!0;const l=new Set(o??this.trackedProps);return this.options.useErrorBoundary&&l.add("error"),Object.keys(this.currentResult).some(c=>{const u=c;return this.currentResult[u]!==r[u]&&l.has(u)})};(e==null?void 0:e.listeners)!==!1&&s()&&(i.listeners=!0),this.notify({...i,...e})}updateQuery(){const e=this.client.getQueryCache().build(this.client,this.options);if(e===this.currentQuery)return;const r=this.currentQuery;this.currentQuery=e,this.currentQueryInitialState=e.state,this.previousQueryResult=this.currentResult,this.hasListeners()&&(r==null||r.removeObserver(this),e.addObserver(this))}onQueryUpdate(e){const r={};e.type==="success"?r.onSuccess=!e.manual:e.type==="error"&&!ba(e.error)&&(r.onError=!0),this.updateResult(r),this.hasListeners()&&this.updateTimers()}notify(e){qe.batch(()=>{if(e.onSuccess){var r,n,i,s;(r=(n=this.options).onSuccess)==null||r.call(n,this.currentResult.data),(i=(s=this.options).onSettled)==null||i.call(s,this.currentResult.data,null)}else if(e.onError){var a,o,l,c;(a=(o=this.options).onError)==null||a.call(o,this.currentResult.error),(l=(c=this.options).onSettled)==null||l.call(c,void 0,this.currentResult.error)}e.listeners&&this.listeners.forEach(({listener:u})=>{u(this.currentResult)}),e.cache&&this.client.getQueryCache().notify({query:this.currentQuery,type:"observerResultsUpdated"})})}}function P1(t,e){return e.enabled!==!1&&!t.state.dataUpdatedAt&&!(t.state.status==="error"&&e.retryOnMount===!1)}function lf(t,e){return P1(t,e)||t.state.dataUpdatedAt>0&&Bl(t,e,e.refetchOnMount)}function Bl(t,e,r){if(e.enabled!==!1){const n=typeof r=="function"?r(t):r;return n==="always"||n!==!1&&Ic(t,e)}return!1}function cf(t,e,r,n){return r.enabled!==!1&&(t!==e||n.enabled===!1)&&(!r.suspense||t.state.status!=="error")&&Ic(t,r)}function Ic(t,e){return t.isStaleByTime(e.staleTime)}function F1(t,e,r){return r.keepPreviousData?!1:r.placeholderData!==void 0?e.isPlaceholderData:!Ml(t.getCurrentResult(),e)}var G0={exports:{}},z0={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ki=v;function N1(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var D1=typeof Object.is=="function"?Object.is:N1,L1=ki.useState,M1=ki.useEffect,j1=ki.useLayoutEffect,$1=ki.useDebugValue;function B1(t,e){var r=e(),n=L1({inst:{value:r,getSnapshot:e}}),i=n[0].inst,s=n[1];return j1(function(){i.value=r,i.getSnapshot=e,Jo(i)&&s({inst:i})},[t,r,e]),M1(function(){return Jo(i)&&s({inst:i}),t(function(){Jo(i)&&s({inst:i})})},[t]),$1(r),r}function Jo(t){var e=t.getSnapshot;t=t.value;try{var r=e();return!D1(t,r)}catch{return!0}}function U1(t,e){return e()}var H1=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?U1:B1;z0.useSyncExternalStore=ki.useSyncExternalStore!==void 0?ki.useSyncExternalStore:H1;G0.exports=z0;var W1=G0.exports;const V1=W1.useSyncExternalStore,uf=v.createContext(void 0),q0=v.createContext(!1);function K0(t,e){return t||(e&&typeof window<"u"?(window.ReactQueryClientContext||(window.ReactQueryClientContext=uf),window.ReactQueryClientContext):uf)}const G1=({context:t}={})=>{const e=v.useContext(K0(t,v.useContext(q0)));if(!e)throw new Error("No QueryClient set, use QueryClientProvider to set one");return e},z1=({client:t,children:e,context:r,contextSharing:n=!1})=>{v.useEffect(()=>(t.mount(),()=>{t.unmount()}),[t]);const i=K0(r,n);return v.createElement(q0.Provider,{value:!r&&n},v.createElement(i.Provider,{value:t},e))},X0=v.createContext(!1),q1=()=>v.useContext(X0);X0.Provider;function K1(){let t=!1;return{clearReset:()=>{t=!1},reset:()=>{t=!0},isReset:()=>t}}const X1=v.createContext(K1()),Y1=()=>v.useContext(X1);function J1(t,e){return typeof t=="function"?t(...e):!!t}const Q1=(t,e)=>{(t.suspense||t.useErrorBoundary)&&(e.isReset()||(t.retryOnMount=!1))},Z1=t=>{v.useEffect(()=>{t.clearReset()},[t])},ex=({result:t,errorResetBoundary:e,useErrorBoundary:r,query:n})=>t.isError&&!e.isReset()&&!t.isFetching&&J1(r,[t.error,n]),tx=t=>{t.suspense&&typeof t.staleTime!="number"&&(t.staleTime=1e3)},rx=(t,e)=>t.isLoading&&t.isFetching&&!e,nx=(t,e,r)=>(t==null?void 0:t.suspense)&&rx(e,r),ix=(t,e,r)=>e.fetchOptimistic(t).then(({data:n})=>{t.onSuccess==null||t.onSuccess(n),t.onSettled==null||t.onSettled(n,null)}).catch(n=>{r.clearReset(),t.onError==null||t.onError(n),t.onSettled==null||t.onSettled(void 0,n)});function sx(t,e){const r=G1({context:t.context}),n=q1(),i=Y1(),s=r.defaultQueryOptions(t);s._optimisticResults=n?"isRestoring":"optimistic",s.onError&&(s.onError=qe.batchCalls(s.onError)),s.onSuccess&&(s.onSuccess=qe.batchCalls(s.onSuccess)),s.onSettled&&(s.onSettled=qe.batchCalls(s.onSettled)),tx(s),Q1(s,i),Z1(i);const[a]=v.useState(()=>new e(r,s)),o=a.getOptimisticResult(s);if(V1(v.useCallback(l=>{const c=n?()=>{}:a.subscribe(qe.batchCalls(l));return a.updateResult(),c},[a,n]),()=>a.getCurrentResult(),()=>a.getCurrentResult()),v.useEffect(()=>{a.setOptions(s,{listeners:!1})},[s,a]),nx(s,o,n))throw ix(s,a,i);if(ex({result:o,errorResetBoundary:i,useErrorBoundary:s.useErrorBoundary,query:a.getCurrentQuery()}))throw o.error;return s.notifyOnChangeProps?o:a.trackResult(o)}function Y0(t,e,r){const n=es(t,e,r);return sx(n,R1)}let ax={data:""},ox=t=>typeof window=="object"?((t?t.querySelector("#_goober"):window._goober)||Object.assign((t||document.head).appendChild(document.createElement("style")),{innerHTML:" ",id:"_goober"})).firstChild:t||ax,lx=/(?:([\u0080-\uFFFF\w-%@]+) *:? *([^{;]+?);|([^;}{]*?) *{)|(}\s*)/g,cx=/\/\*[^]*?\*\/|  +/g,ff=/\n+/g,Qr=(t,e)=>{let r="",n="",i="";for(let s in t){let a=t[s];s[0]=="@"?s[1]=="i"?r=s+" "+a+";":n+=s[1]=="f"?Qr(a,s):s+"{"+Qr(a,s[1]=="k"?"":e)+"}":typeof a=="object"?n+=Qr(a,e?e.replace(/([^,])+/g,o=>s.replace(/([^,]*:\S+\([^)]*\))|([^,])+/g,l=>/&/.test(l)?l.replace(/&/g,o):o?o+" "+l:l)):s):a!=null&&(s=/^--/.test(s)?s:s.replace(/[A-Z]/g,"-$&").toLowerCase(),i+=Qr.p?Qr.p(s,a):s+":"+a+";")}return r+(e&&i?e+"{"+i+"}":i)+n},_r={},J0=t=>{if(typeof t=="object"){let e="";for(let r in t)e+=r+J0(t[r]);return e}return t},ux=(t,e,r,n,i)=>{let s=J0(t),a=_r[s]||(_r[s]=(l=>{let c=0,u=11;for(;c<l.length;)u=101*u+l.charCodeAt(c++)>>>0;return"go"+u})(s));if(!_r[a]){let l=s!==t?t:(c=>{let u,f,d=[{}];for(;u=lx.exec(c.replace(cx,""));)u[4]?d.shift():u[3]?(f=u[3].replace(ff," ").trim(),d.unshift(d[0][f]=d[0][f]||{})):d[0][u[1]]=u[2].replace(ff," ").trim();return d[0]})(t);_r[a]=Qr(i?{["@keyframes "+a]:l}:l,r?"":"."+a)}let o=r&&_r.g?_r.g:null;return r&&(_r.g=_r[a]),((l,c,u,f)=>{f?c.data=c.data.replace(f,l):c.data.indexOf(l)===-1&&(c.data=u?l+c.data:c.data+l)})(_r[a],e,n,o),a},fx=(t,e,r)=>t.reduce((n,i,s)=>{let a=e[s];if(a&&a.call){let o=a(r),l=o&&o.props&&o.props.className||/^go/.test(o)&&o;a=l?"."+l:o&&typeof o=="object"?o.props?"":Qr(o,""):o===!1?"":o}return n+i+(a??"")},"");function po(t){let e=this||{},r=t.call?t(e.p):t;return ux(r.unshift?r.raw?fx(r,[].slice.call(arguments,1),e.p):r.reduce((n,i)=>Object.assign(n,i&&i.call?i(e.p):i),{}):r,ox(e.target),e.g,e.o,e.k)}let Q0,Ul,Hl;po.bind({g:1});let Lr=po.bind({k:1});function hx(t,e,r,n){Qr.p=e,Q0=t,Ul=r,Hl=n}function mn(t,e){let r=this||{};return function(){let n=arguments;function i(s,a){let o=Object.assign({},s),l=o.className||i.className;r.p=Object.assign({theme:Ul&&Ul()},o),r.o=/ *go\d+/.test(l),o.className=po.apply(r,n)+(l?" "+l:""),e&&(o.ref=a);let c=t;return t[0]&&(c=o.as||t,delete o.as),Hl&&c[0]&&Hl(o),Q0(c,o)}return e?e(i):i}}var dx=t=>typeof t=="function",Fa=(t,e)=>dx(t)?t(e):t,px=(()=>{let t=0;return()=>(++t).toString()})(),Z0=(()=>{let t;return()=>{if(t===void 0&&typeof window<"u"){let e=matchMedia("(prefers-reduced-motion: reduce)");t=!e||e.matches}return t}})(),mx=20,ed=(t,e)=>{switch(e.type){case 0:return{...t,toasts:[e.toast,...t.toasts].slice(0,mx)};case 1:return{...t,toasts:t.toasts.map(s=>s.id===e.toast.id?{...s,...e.toast}:s)};case 2:let{toast:r}=e;return ed(t,{type:t.toasts.find(s=>s.id===r.id)?1:0,toast:r});case 3:let{toastId:n}=e;return{...t,toasts:t.toasts.map(s=>s.id===n||n===void 0?{...s,dismissed:!0,visible:!1}:s)};case 4:return e.toastId===void 0?{...t,toasts:[]}:{...t,toasts:t.toasts.filter(s=>s.id!==e.toastId)};case 5:return{...t,pausedAt:e.time};case 6:let i=e.time-(t.pausedAt||0);return{...t,pausedAt:void 0,toasts:t.toasts.map(s=>({...s,pauseDuration:s.pauseDuration+i}))}}},Ta=[],Nn={toasts:[],pausedAt:void 0},Jn=t=>{Nn=ed(Nn,t),Ta.forEach(e=>{e(Nn)})},gx={blank:4e3,error:4e3,success:2e3,loading:1/0,custom:4e3},vx=(t={})=>{let[e,r]=v.useState(Nn),n=v.useRef(Nn);v.useEffect(()=>(n.current!==Nn&&r(Nn),Ta.push(r),()=>{let s=Ta.indexOf(r);s>-1&&Ta.splice(s,1)}),[]);let i=e.toasts.map(s=>{var a,o,l;return{...t,...t[s.type],...s,removeDelay:s.removeDelay||((a=t[s.type])==null?void 0:a.removeDelay)||(t==null?void 0:t.removeDelay),duration:s.duration||((o=t[s.type])==null?void 0:o.duration)||(t==null?void 0:t.duration)||gx[s.type],style:{...t.style,...(l=t[s.type])==null?void 0:l.style,...s.style}}});return{...e,toasts:i}},xx=(t,e="blank",r)=>({createdAt:Date.now(),visible:!0,dismissed:!1,type:e,ariaProps:{role:"status","aria-live":"polite"},message:t,pauseDuration:0,...r,id:(r==null?void 0:r.id)||px()}),Ns=t=>(e,r)=>{let n=xx(e,t,r);return Jn({type:2,toast:n}),n.id},Qe=(t,e)=>Ns("blank")(t,e);Qe.error=Ns("error");Qe.success=Ns("success");Qe.loading=Ns("loading");Qe.custom=Ns("custom");Qe.dismiss=t=>{Jn({type:3,toastId:t})};Qe.remove=t=>Jn({type:4,toastId:t});Qe.promise=(t,e,r)=>{let n=Qe.loading(e.loading,{...r,...r==null?void 0:r.loading});return typeof t=="function"&&(t=t()),t.then(i=>{let s=e.success?Fa(e.success,i):void 0;return s?Qe.success(s,{id:n,...r,...r==null?void 0:r.success}):Qe.dismiss(n),i}).catch(i=>{let s=e.error?Fa(e.error,i):void 0;s?Qe.error(s,{id:n,...r,...r==null?void 0:r.error}):Qe.dismiss(n)}),t};var yx=(t,e)=>{Jn({type:1,toast:{id:t,height:e}})},wx=()=>{Jn({type:5,time:Date.now()})},os=new Map,_x=1e3,Ex=(t,e=_x)=>{if(os.has(t))return;let r=setTimeout(()=>{os.delete(t),Jn({type:4,toastId:t})},e);os.set(t,r)},bx=t=>{let{toasts:e,pausedAt:r}=vx(t);v.useEffect(()=>{if(r)return;let s=Date.now(),a=e.map(o=>{if(o.duration===1/0)return;let l=(o.duration||0)+o.pauseDuration-(s-o.createdAt);if(l<0){o.visible&&Qe.dismiss(o.id);return}return setTimeout(()=>Qe.dismiss(o.id),l)});return()=>{a.forEach(o=>o&&clearTimeout(o))}},[e,r]);let n=v.useCallback(()=>{r&&Jn({type:6,time:Date.now()})},[r]),i=v.useCallback((s,a)=>{let{reverseOrder:o=!1,gutter:l=8,defaultPosition:c}=a||{},u=e.filter(h=>(h.position||c)===(s.position||c)&&h.height),f=u.findIndex(h=>h.id===s.id),d=u.filter((h,m)=>m<f&&h.visible).length;return u.filter(h=>h.visible).slice(...o?[d+1]:[0,d]).reduce((h,m)=>h+(m.height||0)+l,0)},[e]);return v.useEffect(()=>{e.forEach(s=>{if(s.dismissed)Ex(s.id,s.removeDelay);else{let a=os.get(s.id);a&&(clearTimeout(a),os.delete(s.id))}})},[e]),{toasts:e,handlers:{updateHeight:yx,startPause:wx,endPause:n,calculateOffset:i}}},Tx=Lr`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
 transform: scale(1) rotate(45deg);
  opacity: 1;
}`,Sx=Lr`
from {
  transform: scale(0);
  opacity: 0;
}
to {
  transform: scale(1);
  opacity: 1;
}`,Ax=Lr`
from {
  transform: scale(0) rotate(90deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(90deg);
	opacity: 1;
}`,Cx=mn("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${t=>t.primary||"#ff4b4b"};
  position: relative;
  transform: rotate(45deg);

  animation: ${Tx} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;

  &:after,
  &:before {
    content: '';
    animation: ${Sx} 0.15s ease-out forwards;
    animation-delay: 150ms;
    position: absolute;
    border-radius: 3px;
    opacity: 0;
    background: ${t=>t.secondary||"#fff"};
    bottom: 9px;
    left: 4px;
    height: 2px;
    width: 12px;
  }

  &:before {
    animation: ${Ax} 0.15s ease-out forwards;
    animation-delay: 180ms;
    transform: rotate(90deg);
  }
`,Ix=Lr`
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
`,kx=mn("div")`
  width: 12px;
  height: 12px;
  box-sizing: border-box;
  border: 2px solid;
  border-radius: 100%;
  border-color: ${t=>t.secondary||"#e0e0e0"};
  border-right-color: ${t=>t.primary||"#616161"};
  animation: ${Ix} 1s linear infinite;
`,Ox=Lr`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(45deg);
	opacity: 1;
}`,Rx=Lr`
0% {
	height: 0;
	width: 0;
	opacity: 0;
}
40% {
  height: 0;
	width: 6px;
	opacity: 1;
}
100% {
  opacity: 1;
  height: 10px;
}`,Px=mn("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${t=>t.primary||"#61d345"};
  position: relative;
  transform: rotate(45deg);

  animation: ${Ox} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;
  &:after {
    content: '';
    box-sizing: border-box;
    animation: ${Rx} 0.2s ease-out forwards;
    opacity: 0;
    animation-delay: 200ms;
    position: absolute;
    border-right: 2px solid;
    border-bottom: 2px solid;
    border-color: ${t=>t.secondary||"#fff"};
    bottom: 6px;
    left: 6px;
    height: 10px;
    width: 6px;
  }
`,Fx=mn("div")`
  position: absolute;
`,Nx=mn("div")`
  position: relative;
  display: flex;
  justify-content: center;
  align-items: center;
  min-width: 20px;
  min-height: 20px;
`,Dx=Lr`
from {
  transform: scale(0.6);
  opacity: 0.4;
}
to {
  transform: scale(1);
  opacity: 1;
}`,Lx=mn("div")`
  position: relative;
  transform: scale(0.6);
  opacity: 0.4;
  min-width: 20px;
  animation: ${Dx} 0.3s 0.12s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
`,Mx=({toast:t})=>{let{icon:e,type:r,iconTheme:n}=t;return e!==void 0?typeof e=="string"?v.createElement(Lx,null,e):e:r==="blank"?null:v.createElement(Nx,null,v.createElement(kx,{...n}),r!=="loading"&&v.createElement(Fx,null,r==="error"?v.createElement(Cx,{...n}):v.createElement(Px,{...n})))},jx=t=>`
0% {transform: translate3d(0,${t*-200}%,0) scale(.6); opacity:.5;}
100% {transform: translate3d(0,0,0) scale(1); opacity:1;}
`,$x=t=>`
0% {transform: translate3d(0,0,-1px) scale(1); opacity:1;}
100% {transform: translate3d(0,${t*-150}%,-1px) scale(.6); opacity:0;}
`,Bx="0%{opacity:0;} 100%{opacity:1;}",Ux="0%{opacity:1;} 100%{opacity:0;}",Hx=mn("div")`
  display: flex;
  align-items: center;
  background: #fff;
  color: #363636;
  line-height: 1.3;
  will-change: transform;
  box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1), 0 3px 3px rgba(0, 0, 0, 0.05);
  max-width: 350px;
  pointer-events: auto;
  padding: 8px 10px;
  border-radius: 8px;
`,Wx=mn("div")`
  display: flex;
  justify-content: center;
  margin: 4px 10px;
  color: inherit;
  flex: 1 1 auto;
  white-space: pre-line;
`,Vx=(t,e)=>{let r=t.includes("top")?1:-1,[n,i]=Z0()?[Bx,Ux]:[jx(r),$x(r)];return{animation:e?`${Lr(n)} 0.35s cubic-bezier(.21,1.02,.73,1) forwards`:`${Lr(i)} 0.4s forwards cubic-bezier(.06,.71,.55,1)`}},Gx=v.memo(({toast:t,position:e,style:r,children:n})=>{let i=t.height?Vx(t.position||e||"top-center",t.visible):{opacity:0},s=v.createElement(Mx,{toast:t}),a=v.createElement(Wx,{...t.ariaProps},Fa(t.message,t));return v.createElement(Hx,{className:t.className,style:{...i,...r,...t.style}},typeof n=="function"?n({icon:s,message:a}):v.createElement(v.Fragment,null,s,a))});hx(v.createElement);var zx=({id:t,className:e,style:r,onHeightUpdate:n,children:i})=>{let s=v.useCallback(a=>{if(a){let o=()=>{let l=a.getBoundingClientRect().height;n(t,l)};o(),new MutationObserver(o).observe(a,{subtree:!0,childList:!0,characterData:!0})}},[t,n]);return v.createElement("div",{ref:s,className:e,style:r},i)},qx=(t,e)=>{let r=t.includes("top"),n=r?{top:0}:{bottom:0},i=t.includes("center")?{justifyContent:"center"}:t.includes("right")?{justifyContent:"flex-end"}:{};return{left:0,right:0,display:"flex",position:"absolute",transition:Z0()?void 0:"all 230ms cubic-bezier(.21,1.02,.73,1)",transform:`translateY(${e*(r?1:-1)}px)`,...n,...i}},Kx=po`
  z-index: 9999;
  > * {
    pointer-events: auto;
  }
`,sa=16,Xx=({reverseOrder:t,position:e="top-center",toastOptions:r,gutter:n,children:i,containerStyle:s,containerClassName:a})=>{let{toasts:o,handlers:l}=bx(r);return v.createElement("div",{id:"_rht_toaster",style:{position:"fixed",zIndex:9999,top:sa,left:sa,right:sa,bottom:sa,pointerEvents:"none",...s},className:a,onMouseEnter:l.startPause,onMouseLeave:l.endPause},o.map(c=>{let u=c.position||e,f=l.calculateOffset(c,{reverseOrder:t,gutter:n,defaultPosition:e}),d=qx(u,f);return v.createElement(zx,{id:c.id,key:c.id,onHeightUpdate:l.updateHeight,className:c.visible?Kx:"",style:d},c.type==="custom"?Fa(c.message,c):i?i(c):v.createElement(Gx,{toast:c,position:u}))}))},Gr=Qe;const td=typeof document<"u"?ve.useLayoutEffect:()=>{};function Yx(t){const e=v.useRef(null);return td(()=>{e.current=t},[t]),v.useCallback((...r)=>{const n=e.current;return n==null?void 0:n(...r)},[])}const gn=t=>{var e;return(e=t==null?void 0:t.ownerDocument)!==null&&e!==void 0?e:document},Dn=t=>t&&"window"in t&&t.window===t?t:gn(t).defaultView||window;function Jx(t){return t!==null&&typeof t=="object"&&"nodeType"in t&&typeof t.nodeType=="number"}function Qx(t){return Jx(t)&&t.nodeType===Node.DOCUMENT_FRAGMENT_NODE&&"host"in t}let Zx=!1;function kc(){return Zx}function rd(t,e){if(!kc())return e&&t?t.contains(e):!1;if(!t||!e)return!1;let r=e;for(;r!==null;){if(r===t)return!0;r.tagName==="SLOT"&&r.assignedSlot?r=r.assignedSlot.parentNode:Qx(r)?r=r.host:r=r.parentNode}return!1}const Wl=(t=document)=>{var e;if(!kc())return t.activeElement;let r=t.activeElement;for(;r&&"shadowRoot"in r&&(!((e=r.shadowRoot)===null||e===void 0)&&e.activeElement);)r=r.shadowRoot.activeElement;return r};function nd(t){return kc()&&t.target.shadowRoot&&t.composedPath?t.composedPath()[0]:t.target}function ey(t){var e;return typeof window>"u"||window.navigator==null?!1:((e=window.navigator.userAgentData)===null||e===void 0?void 0:e.brands.some(r=>t.test(r.brand)))||t.test(window.navigator.userAgent)}function ty(t){var e;return typeof window<"u"&&window.navigator!=null?t.test(((e=window.navigator.userAgentData)===null||e===void 0?void 0:e.platform)||window.navigator.platform):!1}function id(t){let e=null;return()=>(e==null&&(e=t()),e)}const ry=id(function(){return ty(/^Mac/i)}),ny=id(function(){return ey(/Android/i)});function sd(){let t=v.useRef(new Map),e=v.useCallback((i,s,a,o)=>{let l=o!=null&&o.once?(...c)=>{t.current.delete(a),a(...c)}:a;t.current.set(a,{type:s,eventTarget:i,fn:l,options:o}),i.addEventListener(s,l,o)},[]),r=v.useCallback((i,s,a,o)=>{var l;let c=((l=t.current.get(a))===null||l===void 0?void 0:l.fn)||a;i.removeEventListener(s,c,o),t.current.delete(a)},[]),n=v.useCallback(()=>{t.current.forEach((i,s)=>{r(i.eventTarget,i.type,s,i.options)})},[r]);return v.useEffect(()=>n,[n]),{addGlobalListener:e,removeGlobalListener:r,removeAllGlobalListeners:n}}function iy(t){return t.mozInputSource===0&&t.isTrusted?!0:ny()&&t.pointerType?t.type==="click"&&t.buttons===1:t.detail===0&&!t.pointerType}function ad(t){let e=t;return e.nativeEvent=t,e.isDefaultPrevented=()=>e.defaultPrevented,e.isPropagationStopped=()=>e.cancelBubble,e.persist=()=>{},e}function sy(t,e){Object.defineProperty(t,"target",{value:e}),Object.defineProperty(t,"currentTarget",{value:e})}function od(t){let e=v.useRef({isFocused:!1,observer:null});td(()=>{const n=e.current;return()=>{n.observer&&(n.observer.disconnect(),n.observer=null)}},[]);let r=Yx(n=>{t==null||t(n)});return v.useCallback(n=>{if(n.target instanceof HTMLButtonElement||n.target instanceof HTMLInputElement||n.target instanceof HTMLTextAreaElement||n.target instanceof HTMLSelectElement){e.current.isFocused=!0;let i=n.target,s=a=>{if(e.current.isFocused=!1,i.disabled){let o=ad(a);r(o)}e.current.observer&&(e.current.observer.disconnect(),e.current.observer=null)};i.addEventListener("focusout",s,{once:!0}),e.current.observer=new MutationObserver(()=>{if(e.current.isFocused&&i.disabled){var a;(a=e.current.observer)===null||a===void 0||a.disconnect();let o=i===document.activeElement?null:document.activeElement;i.dispatchEvent(new FocusEvent("blur",{relatedTarget:o})),i.dispatchEvent(new FocusEvent("focusout",{bubbles:!0,relatedTarget:o}))}}),e.current.observer.observe(i,{attributes:!0,attributeFilter:["disabled"]})}},[r])}let ay=!1,Ds=null,Vl=new Set,ls=new Map,Un=!1,Gl=!1;const oy={Tab:!0,Escape:!0};function Oc(t,e){for(let r of Vl)r(t,e)}function ly(t){return!(t.metaKey||!ry()&&t.altKey||t.ctrlKey||t.key==="Control"||t.key==="Shift"||t.key==="Meta")}function Na(t){Un=!0,ly(t)&&(Ds="keyboard",Oc("keyboard",t))}function wi(t){Ds="pointer",(t.type==="mousedown"||t.type==="pointerdown")&&(Un=!0,Oc("pointer",t))}function ld(t){iy(t)&&(Un=!0,Ds="virtual")}function cd(t){t.target===window||t.target===document||ay||!t.isTrusted||(!Un&&!Gl&&(Ds="virtual",Oc("virtual",t)),Un=!1,Gl=!1)}function ud(){Un=!1,Gl=!0}function zl(t){if(typeof window>"u"||typeof document>"u"||ls.get(Dn(t)))return;const e=Dn(t),r=gn(t);let n=e.HTMLElement.prototype.focus;e.HTMLElement.prototype.focus=function(){Un=!0,n.apply(this,arguments)},r.addEventListener("keydown",Na,!0),r.addEventListener("keyup",Na,!0),r.addEventListener("click",ld,!0),e.addEventListener("focus",cd,!0),e.addEventListener("blur",ud,!1),typeof PointerEvent<"u"&&(r.addEventListener("pointerdown",wi,!0),r.addEventListener("pointermove",wi,!0),r.addEventListener("pointerup",wi,!0)),e.addEventListener("beforeunload",()=>{fd(t)},{once:!0}),ls.set(e,{focus:n})}const fd=(t,e)=>{const r=Dn(t),n=gn(t);e&&n.removeEventListener("DOMContentLoaded",e),ls.has(r)&&(r.HTMLElement.prototype.focus=ls.get(r).focus,n.removeEventListener("keydown",Na,!0),n.removeEventListener("keyup",Na,!0),n.removeEventListener("click",ld,!0),r.removeEventListener("focus",cd,!0),r.removeEventListener("blur",ud,!1),typeof PointerEvent<"u"&&(n.removeEventListener("pointerdown",wi,!0),n.removeEventListener("pointermove",wi,!0),n.removeEventListener("pointerup",wi,!0)),ls.delete(r))};function cy(t){const e=gn(t);let r;return e.readyState!=="loading"?zl(t):(r=()=>{zl(t)},e.addEventListener("DOMContentLoaded",r)),()=>fd(t,r)}typeof document<"u"&&cy();function hd(){return Ds!=="pointer"}const uy=new Set(["checkbox","radio","range","color","file","image","button","submit","reset"]);function fy(t,e,r){let n=gn(r==null?void 0:r.target);const i=typeof window<"u"?Dn(r==null?void 0:r.target).HTMLInputElement:HTMLInputElement,s=typeof window<"u"?Dn(r==null?void 0:r.target).HTMLTextAreaElement:HTMLTextAreaElement,a=typeof window<"u"?Dn(r==null?void 0:r.target).HTMLElement:HTMLElement,o=typeof window<"u"?Dn(r==null?void 0:r.target).KeyboardEvent:KeyboardEvent;return t=t||n.activeElement instanceof i&&!uy.has(n.activeElement.type)||n.activeElement instanceof s||n.activeElement instanceof a&&n.activeElement.isContentEditable,!(t&&e==="keyboard"&&r instanceof o&&!oy[r.key])}function hy(t,e,r){zl(),v.useEffect(()=>{let n=(i,s)=>{fy(!!(r!=null&&r.isTextInput),i,s)&&t(hd())};return Vl.add(n),()=>{Vl.delete(n)}},e)}function dy(t){let{isDisabled:e,onFocus:r,onBlur:n,onFocusChange:i}=t;const s=v.useCallback(l=>{if(l.target===l.currentTarget)return n&&n(l),i&&i(!1),!0},[n,i]),a=od(s),o=v.useCallback(l=>{const c=gn(l.target),u=c?Wl(c):Wl();l.target===l.currentTarget&&u===nd(l.nativeEvent)&&(r&&r(l),i&&i(!0),a(l))},[i,r,a]);return{focusProps:{onFocus:!e&&(r||i||n)?o:void 0,onBlur:!e&&(n||i)?s:void 0}}}function py(t){let{isDisabled:e,onBlurWithin:r,onFocusWithin:n,onFocusWithinChange:i}=t,s=v.useRef({isFocusWithin:!1}),{addGlobalListener:a,removeAllGlobalListeners:o}=sd(),l=v.useCallback(f=>{f.currentTarget.contains(f.target)&&s.current.isFocusWithin&&!f.currentTarget.contains(f.relatedTarget)&&(s.current.isFocusWithin=!1,o(),r&&r(f),i&&i(!1))},[r,i,s,o]),c=od(l),u=v.useCallback(f=>{if(!f.currentTarget.contains(f.target))return;const d=gn(f.target),h=Wl(d);if(!s.current.isFocusWithin&&h===nd(f.nativeEvent)){n&&n(f),i&&i(!0),s.current.isFocusWithin=!0,c(f);let m=f.currentTarget;a(d,"focus",p=>{if(s.current.isFocusWithin&&!rd(m,p.target)){let g=new d.defaultView.FocusEvent("blur",{relatedTarget:p.target});sy(g,m);let w=ad(g);l(w)}},{capture:!0})}},[n,i,c,a,l]);return e?{focusWithinProps:{onFocus:void 0,onBlur:void 0}}:{focusWithinProps:{onFocus:u,onBlur:l}}}let ql=!1,Qo=0;function my(){ql=!0,setTimeout(()=>{ql=!1},50)}function hf(t){t.pointerType==="touch"&&my()}function gy(){if(!(typeof document>"u"))return typeof PointerEvent<"u"&&document.addEventListener("pointerup",hf),Qo++,()=>{Qo--,!(Qo>0)&&typeof PointerEvent<"u"&&document.removeEventListener("pointerup",hf)}}function dd(t){let{onHoverStart:e,onHoverChange:r,onHoverEnd:n,isDisabled:i}=t,[s,a]=v.useState(!1),o=v.useRef({isHovered:!1,ignoreEmulatedMouseEvents:!1,pointerType:"",target:null}).current;v.useEffect(gy,[]);let{addGlobalListener:l,removeAllGlobalListeners:c}=sd(),{hoverProps:u,triggerHoverEnd:f}=v.useMemo(()=>{let d=(p,g)=>{if(o.pointerType=g,i||g==="touch"||o.isHovered||!p.currentTarget.contains(p.target))return;o.isHovered=!0;let w=p.currentTarget;o.target=w,l(gn(p.target),"pointerover",b=>{o.isHovered&&o.target&&!rd(o.target,b.target)&&h(b,b.pointerType)},{capture:!0}),e&&e({type:"hoverstart",target:w,pointerType:g}),r&&r(!0),a(!0)},h=(p,g)=>{let w=o.target;o.pointerType="",o.target=null,!(g==="touch"||!o.isHovered||!w)&&(o.isHovered=!1,c(),n&&n({type:"hoverend",target:w,pointerType:g}),r&&r(!1),a(!1))},m={};return typeof PointerEvent<"u"&&(m.onPointerEnter=p=>{ql&&p.pointerType==="mouse"||d(p,p.pointerType)},m.onPointerLeave=p=>{!i&&p.currentTarget.contains(p.target)&&h(p,p.pointerType)}),{hoverProps:m,triggerHoverEnd:h}},[e,r,n,i,o,l,c]);return v.useEffect(()=>{i&&f({currentTarget:o.target},o.pointerType)},[i]),{hoverProps:u,isHovered:s}}function pd(t={}){let{autoFocus:e=!1,isTextInput:r,within:n}=t,i=v.useRef({isFocused:!1,isFocusVisible:e||hd()}),[s,a]=v.useState(!1),[o,l]=v.useState(()=>i.current.isFocused&&i.current.isFocusVisible),c=v.useCallback(()=>l(i.current.isFocused&&i.current.isFocusVisible),[]),u=v.useCallback(h=>{i.current.isFocused=h,a(h),c()},[c]);hy(h=>{i.current.isFocusVisible=h,c()},[],{isTextInput:r});let{focusProps:f}=dy({isDisabled:n,onFocusChange:u}),{focusWithinProps:d}=py({isDisabled:!n,onFocusWithinChange:u});return{isFocused:s,isFocusVisible:o,focusProps:n?d:f}}var vy=Object.defineProperty,xy=(t,e,r)=>e in t?vy(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Zo=(t,e,r)=>(xy(t,typeof e!="symbol"?e+"":e,r),r);let yy=class{constructor(){Zo(this,"current",this.detect()),Zo(this,"handoffState","pending"),Zo(this,"currentId",0)}set(e){this.current!==e&&(this.handoffState="pending",this.currentId=0,this.current=e)}reset(){this.set(this.detect())}nextId(){return++this.currentId}get isServer(){return this.current==="server"}get isClient(){return this.current==="client"}detect(){return typeof window>"u"||typeof document>"u"?"server":"client"}handoff(){this.handoffState==="pending"&&(this.handoffState="complete")}get isHandoffComplete(){return this.handoffState==="complete"}},$n=new yy;function Qn(t){var e,r;return $n.isServer?null:t?"ownerDocument"in t?t.ownerDocument:"current"in t?(r=(e=t.current)==null?void 0:e.ownerDocument)!=null?r:document:null:document}function md(t){typeof queueMicrotask=="function"?queueMicrotask(t):Promise.resolve().then(t).catch(e=>setTimeout(()=>{throw e}))}function Vt(){let t=[],e={addEventListener(r,n,i,s){return r.addEventListener(n,i,s),e.add(()=>r.removeEventListener(n,i,s))},requestAnimationFrame(...r){let n=requestAnimationFrame(...r);return e.add(()=>cancelAnimationFrame(n))},nextFrame(...r){return e.requestAnimationFrame(()=>e.requestAnimationFrame(...r))},setTimeout(...r){let n=setTimeout(...r);return e.add(()=>clearTimeout(n))},microTask(...r){let n={current:!0};return md(()=>{n.current&&r[0]()}),e.add(()=>{n.current=!1})},style(r,n,i){let s=r.style.getPropertyValue(n);return Object.assign(r.style,{[n]:i}),this.add(()=>{Object.assign(r.style,{[n]:s})})},group(r){let n=Vt();return r(n),this.add(()=>n.dispose())},add(r){return t.includes(r)||t.push(r),()=>{let n=t.indexOf(r);if(n>=0)for(let i of t.splice(n,1))i()}},dispose(){for(let r of t.splice(0))r()}};return e}function Ls(){let[t]=v.useState(Vt);return v.useEffect(()=>()=>t.dispose(),[t]),t}let Le=(t,e)=>{$n.isServer?v.useEffect(t,e):v.useLayoutEffect(t,e)};function Li(t){let e=v.useRef(t);return Le(()=>{e.current=t},[t]),e}let ge=function(t){let e=Li(t);return ve.useCallback((...r)=>e.current(...r),[e])};function wy(t){let e=t.width/2,r=t.height/2;return{top:t.clientY-r,right:t.clientX+e,bottom:t.clientY+r,left:t.clientX-e}}function _y(t,e){return!(!t||!e||t.right<e.left||t.left>e.right||t.bottom<e.top||t.top>e.bottom)}function gd({disabled:t=!1}={}){let e=v.useRef(null),[r,n]=v.useState(!1),i=Ls(),s=ge(()=>{e.current=null,n(!1),i.dispose()}),a=ge(o=>{if(i.dispose(),e.current===null){e.current=o.currentTarget,n(!0);{let l=Qn(o.currentTarget);i.addEventListener(l,"pointerup",s,!1),i.addEventListener(l,"pointermove",c=>{if(e.current){let u=wy(c);n(_y(u,e.current.getBoundingClientRect()))}},!1),i.addEventListener(l,"pointercancel",s,!1)}}});return{pressed:r,pressProps:t?{}:{onPointerDown:a,onPointerUp:s,onClick:s}}}let Ey=v.createContext(void 0);function vd(){return v.useContext(Ey)}function Kl(...t){return Array.from(new Set(t.flatMap(e=>typeof e=="string"?e.split(" "):[]))).filter(Boolean).join(" ")}function nr(t,e,...r){if(t in e){let i=e[t];return typeof i=="function"?i(...r):i}let n=new Error(`Tried to handle "${t}" but there is no handler defined. Only defined handlers are: ${Object.keys(e).map(i=>`"${i}"`).join(", ")}.`);throw Error.captureStackTrace&&Error.captureStackTrace(n,nr),n}var Oi=(t=>(t[t.None=0]="None",t[t.RenderStrategy=1]="RenderStrategy",t[t.Static=2]="Static",t))(Oi||{}),nn=(t=>(t[t.Unmount=0]="Unmount",t[t.Hidden=1]="Hidden",t))(nn||{});function ft(){let t=Ty();return v.useCallback(e=>by({mergeRefs:t,...e}),[t])}function by({ourProps:t,theirProps:e,slot:r,defaultTag:n,features:i,visible:s=!0,name:a,mergeRefs:o}){o=o??Sy;let l=xd(e,t);if(s)return aa(l,r,n,a,o);let c=i??0;if(c&2){let{static:u=!1,...f}=l;if(u)return aa(f,r,n,a,o)}if(c&1){let{unmount:u=!0,...f}=l;return nr(u?0:1,{0(){return null},1(){return aa({...f,hidden:!0,style:{display:"none"}},r,n,a,o)}})}return aa(l,r,n,a,o)}function aa(t,e={},r,n,i){let{as:s=r,children:a,refName:o="ref",...l}=el(t,["unmount","static"]),c=t.ref!==void 0?{[o]:t.ref}:{},u=typeof a=="function"?a(e):a;"className"in l&&l.className&&typeof l.className=="function"&&(l.className=l.className(e)),l["aria-labelledby"]&&l["aria-labelledby"]===l.id&&(l["aria-labelledby"]=void 0);let f={};if(e){let d=!1,h=[];for(let[m,p]of Object.entries(e))typeof p=="boolean"&&(d=!0),p===!0&&h.push(m.replace(/([A-Z])/g,g=>`-${g.toLowerCase()}`));if(d){f["data-headlessui-state"]=h.join(" ");for(let m of h)f[`data-${m}`]=""}}if(s===v.Fragment&&(Object.keys(Cn(l)).length>0||Object.keys(Cn(f)).length>0))if(!v.isValidElement(u)||Array.isArray(u)&&u.length>1){if(Object.keys(Cn(l)).length>0)throw new Error(['Passing props on "Fragment"!',"",`The current component <${n} /> is rendering a "Fragment".`,"However we need to passthrough the following props:",Object.keys(Cn(l)).concat(Object.keys(Cn(f))).map(d=>`  - ${d}`).join(`
`),"","You can apply a few solutions:",['Add an `as="..."` prop, to ensure that we render an actual element instead of a "Fragment".',"Render a single element as the child so that we can forward the props onto that element."].map(d=>`  - ${d}`).join(`
`)].join(`
`))}else{let d=u.props,h=d==null?void 0:d.className,m=typeof h=="function"?(...w)=>Kl(h(...w),l.className):Kl(h,l.className),p=m?{className:m}:{},g=xd(u.props,Cn(el(l,["ref"])));for(let w in f)w in g&&delete f[w];return v.cloneElement(u,Object.assign({},g,f,c,{ref:i(Ay(u),c.ref)},p))}return v.createElement(s,Object.assign({},el(l,["ref"]),s!==v.Fragment&&c,s!==v.Fragment&&f),u)}function Ty(){let t=v.useRef([]),e=v.useCallback(r=>{for(let n of t.current)n!=null&&(typeof n=="function"?n(r):n.current=r)},[]);return(...r)=>{if(!r.every(n=>n==null))return t.current=r,e}}function Sy(...t){return t.every(e=>e==null)?void 0:e=>{for(let r of t)r!=null&&(typeof r=="function"?r(e):r.current=e)}}function xd(...t){if(t.length===0)return{};if(t.length===1)return t[0];let e={},r={};for(let n of t)for(let i in n)i.startsWith("on")&&typeof n[i]=="function"?(r[i]!=null||(r[i]=[]),r[i].push(n[i])):e[i]=n[i];if(e.disabled||e["aria-disabled"])for(let n in r)/^(on(?:Click|Pointer|Mouse|Key)(?:Down|Up|Press)?)$/.test(n)&&(r[n]=[i=>{var s;return(s=i==null?void 0:i.preventDefault)==null?void 0:s.call(i)}]);for(let n in r)Object.assign(e,{[n](i,...s){let a=r[n];for(let o of a){if((i instanceof Event||(i==null?void 0:i.nativeEvent)instanceof Event)&&i.defaultPrevented)return;o(i,...s)}}});return e}function Da(...t){if(t.length===0)return{};if(t.length===1)return t[0];let e={},r={};for(let n of t)for(let i in n)i.startsWith("on")&&typeof n[i]=="function"?(r[i]!=null||(r[i]=[]),r[i].push(n[i])):e[i]=n[i];for(let n in r)Object.assign(e,{[n](...i){let s=r[n];for(let a of s)a==null||a(...i)}});return e}function rt(t){var e;return Object.assign(v.forwardRef(t),{displayName:(e=t.displayName)!=null?e:t.name})}function Cn(t){let e=Object.assign({},t);for(let r in e)e[r]===void 0&&delete e[r];return e}function el(t,e=[]){let r=Object.assign({},t);for(let n of e)n in r&&delete r[n];return r}function Ay(t){return ve.version.split(".")[0]>="19"?t.props.ref:t.ref}let Cy=v.createContext(void 0);function Iy(){return v.useContext(Cy)}function Rc(t){return typeof t!="object"||t===null?!1:"nodeType"in t}function mo(t){return Rc(t)&&"tagName"in t}function Hr(t){return mo(t)&&"accessKey"in t}function Sr(t){return mo(t)&&"tabIndex"in t}function ky(t){return mo(t)&&"style"in t}function Oy(t){return Hr(t)&&t.nodeName==="IFRAME"}function yd(t){return Hr(t)&&t.nodeName==="INPUT"}function df(t){return Hr(t)&&t.nodeName==="LABEL"}function Ry(t){return Hr(t)&&t.nodeName==="FIELDSET"}function wd(t){return Hr(t)&&t.nodeName==="LEGEND"}function Py(t){return mo(t)?t.matches('a[href],audio[controls],button,details,embed,iframe,img[usemap],input:not([type="hidden"]),label,select,textarea,video[controls]'):!1}function _d(t){let e=t.parentElement,r=null;for(;e&&!Ry(e);)wd(e)&&(r=e),e=e.parentElement;let n=(e==null?void 0:e.getAttribute("disabled"))==="";return n&&Fy(r)?!1:n}function Fy(t){if(!t)return!1;let e=t.previousElementSibling;for(;e!==null;){if(wd(e))return!1;e=e.previousElementSibling}return!0}let Ed=Symbol();function bd(t,e=!0){return Object.assign(t,{[Ed]:e})}function Ot(...t){let e=v.useRef(t);v.useEffect(()=>{e.current=t},[t]);let r=ge(n=>{for(let i of e.current)i!=null&&(typeof i=="function"?i(n):i.current=n)});return t.every(n=>n==null||(n==null?void 0:n[Ed]))?void 0:r}let Pc=v.createContext(null);Pc.displayName="DescriptionContext";function Td(){let t=v.useContext(Pc);if(t===null){let e=new Error("You used a <Description /> component, but it is not inside a relevant parent.");throw Error.captureStackTrace&&Error.captureStackTrace(e,Td),e}return t}function Ny(){let[t,e]=v.useState([]);return[t.length>0?t.join(" "):void 0,v.useMemo(()=>function(r){let n=ge(s=>(e(a=>[...a,s]),()=>e(a=>{let o=a.slice(),l=o.indexOf(s);return l!==-1&&o.splice(l,1),o}))),i=v.useMemo(()=>({register:n,slot:r.slot,name:r.name,props:r.props,value:r.value}),[n,r.slot,r.name,r.props,r.value]);return ve.createElement(Pc.Provider,{value:i},r.children)},[e])]}let Dy="p";function Ly(t,e){let r=v.useId(),n=vd(),{id:i=`headlessui-description-${r}`,...s}=t,a=Td(),o=Ot(e);Le(()=>a.register(i),[i,a.register]);let l=n||!1,c=v.useMemo(()=>({...a.slot,disabled:l}),[a.slot,l]),u={ref:o,...a.props,id:i};return ft()({ourProps:u,theirProps:s,slot:c,defaultTag:Dy,name:a.name||"Description"})}let My=rt(Ly);Object.assign(My,{});var He=(t=>(t.Space=" ",t.Enter="Enter",t.Escape="Escape",t.Backspace="Backspace",t.Delete="Delete",t.ArrowLeft="ArrowLeft",t.ArrowUp="ArrowUp",t.ArrowRight="ArrowRight",t.ArrowDown="ArrowDown",t.Home="Home",t.End="End",t.PageUp="PageUp",t.PageDown="PageDown",t.Tab="Tab",t))(He||{});let go=v.createContext(null);go.displayName="LabelContext";function Fc(){let t=v.useContext(go);if(t===null){let e=new Error("You used a <Label /> component, but it is not inside a relevant parent.");throw Error.captureStackTrace&&Error.captureStackTrace(e,Fc),e}return t}function jy(t){var e,r,n;let i=(r=(e=v.useContext(go))==null?void 0:e.value)!=null?r:void 0;return((n=t==null?void 0:t.length)!=null?n:0)>0?[i,...t].filter(Boolean).join(" "):i}function Sd({inherit:t=!1}={}){let e=jy(),[r,n]=v.useState([]),i=t?[e,...r].filter(Boolean):r;return[i.length>0?i.join(" "):void 0,v.useMemo(()=>function(s){let a=ge(l=>(n(c=>[...c,l]),()=>n(c=>{let u=c.slice(),f=u.indexOf(l);return f!==-1&&u.splice(f,1),u}))),o=v.useMemo(()=>({register:a,slot:s.slot,name:s.name,props:s.props,value:s.value}),[a,s.slot,s.name,s.props,s.value]);return ve.createElement(go.Provider,{value:o},s.children)},[n])]}let $y="label";function By(t,e){var r;let n=v.useId(),i=Fc(),s=Iy(),a=vd(),{id:o=`headlessui-label-${n}`,htmlFor:l=s??((r=i.props)==null?void 0:r.htmlFor),passive:c=!1,...u}=t,f=Ot(e);Le(()=>i.register(o),[o,i.register]);let d=ge(g=>{let w=g.currentTarget;if(!(g.target!==g.currentTarget&&Py(g.target))&&(df(w)&&g.preventDefault(),i.props&&"onClick"in i.props&&typeof i.props.onClick=="function"&&i.props.onClick(g),df(w))){let b=document.getElementById(w.htmlFor);if(b){let _=b.getAttribute("disabled");if(_==="true"||_==="")return;let k=b.getAttribute("aria-disabled");if(k==="true"||k==="")return;(yd(b)&&(b.type==="file"||b.type==="radio"||b.type==="checkbox")||b.role==="radio"||b.role==="checkbox"||b.role==="switch")&&b.click(),b.focus({preventScroll:!0})}}}),h=a||!1,m=v.useMemo(()=>({...i.slot,disabled:h}),[i.slot,h]),p={ref:f,...i.props,id:o,htmlFor:l,onClick:d};return c&&("onClick"in p&&(delete p.htmlFor,delete p.onClick),"onClick"in u&&delete u.onClick),ft()({ourProps:p,theirProps:u,slot:m,defaultTag:l?$y:"div",name:i.name||"Label"})}let Uy=rt(By);Object.assign(Uy,{});let Hy=v.createContext(()=>{});function Wy({value:t,children:e}){return ve.createElement(Hy.Provider,{value:t},e)}function Vy(t){if(t===null)return{width:0,height:0};let{width:e,height:r}=t.getBoundingClientRect();return{width:e,height:r}}function Gy(t,e=!1){let[r,n]=v.useReducer(()=>({}),{}),i=v.useMemo(()=>Vy(t),[t,r]);return Le(()=>{if(!t)return;let s=new ResizeObserver(n);return s.observe(t),()=>{s.disconnect()}},[t]),e?{width:`${i.width}px`,height:`${i.height}px`}:i}let Ad=class extends Map{constructor(e){super(),this.factory=e}get(e){let r=super.get(e);return r===void 0&&(r=this.factory(e),this.set(e,r)),r}};var zy=Object.defineProperty,qy=(t,e,r)=>e in t?zy(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Ky=(t,e,r)=>(qy(t,typeof e!="symbol"?e+"":e,r),r),Cd=(t,e,r)=>{if(!e.has(t))throw TypeError("Cannot "+r)},$t=(t,e,r)=>(Cd(t,e,"read from private field"),r?r.call(t):e.get(t)),tl=(t,e,r)=>{if(e.has(t))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(t):e.set(t,r)},pf=(t,e,r,n)=>(Cd(t,e,"write to private field"),n?n.call(t,r):e.set(t,r),r),sr,ts,rs;let Id=class{constructor(e){tl(this,sr,{}),tl(this,ts,new Ad(()=>new Set)),tl(this,rs,new Set),Ky(this,"disposables",Vt()),pf(this,sr,e)}dispose(){this.disposables.dispose()}get state(){return $t(this,sr)}subscribe(e,r){let n={selector:e,callback:r,current:e($t(this,sr))};return $t(this,rs).add(n),this.disposables.add(()=>{$t(this,rs).delete(n)})}on(e,r){return $t(this,ts).get(e).add(r),this.disposables.add(()=>{$t(this,ts).get(e).delete(r)})}send(e){let r=this.reduce($t(this,sr),e);if(r!==$t(this,sr)){pf(this,sr,r);for(let n of $t(this,rs)){let i=n.selector($t(this,sr));kd(n.current,i)||(n.current=i,n.callback(i))}for(let n of $t(this,ts).get(e.type))n($t(this,sr),e)}}};sr=new WeakMap,ts=new WeakMap,rs=new WeakMap;function kd(t,e){return Object.is(t,e)?!0:typeof t!="object"||t===null||typeof e!="object"||e===null?!1:Array.isArray(t)&&Array.isArray(e)?t.length!==e.length?!1:rl(t[Symbol.iterator](),e[Symbol.iterator]()):t instanceof Map&&e instanceof Map||t instanceof Set&&e instanceof Set?t.size!==e.size?!1:rl(t.entries(),e.entries()):mf(t)&&mf(e)?rl(Object.entries(t)[Symbol.iterator](),Object.entries(e)[Symbol.iterator]()):!1}function rl(t,e){do{let r=t.next(),n=e.next();if(r.done&&n.done)return!0;if(r.done||n.done||!Object.is(r.value,n.value))return!1}while(!0)}function mf(t){if(Object.prototype.toString.call(t)!=="[object Object]")return!1;let e=Object.getPrototypeOf(t);return e===null||Object.getPrototypeOf(e)===null}function gf(t){let[e,r]=t(),n=Vt();return(...i)=>{e(...i),n.dispose(),n.microTask(r)}}var Xy=Object.defineProperty,Yy=(t,e,r)=>e in t?Xy(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,vf=(t,e,r)=>(Yy(t,typeof e!="symbol"?e+"":e,r),r),Od=(t=>(t[t.Push=0]="Push",t[t.Pop=1]="Pop",t))(Od||{});let Jy={0(t,e){let r=e.id,n=t.stack,i=t.stack.indexOf(r);if(i!==-1){let s=t.stack.slice();return s.splice(i,1),s.push(r),n=s,{...t,stack:n}}return{...t,stack:[...t.stack,r]}},1(t,e){let r=e.id,n=t.stack.indexOf(r);if(n===-1)return t;let i=t.stack.slice();return i.splice(n,1),{...t,stack:i}}},Qy=class Rd extends Id{constructor(){super(...arguments),vf(this,"actions",{push:e=>this.send({type:0,id:e}),pop:e=>this.send({type:1,id:e})}),vf(this,"selectors",{isTop:(e,r)=>e.stack[e.stack.length-1]===r,inStack:(e,r)=>e.stack.includes(r)})}static new(){return new Rd({stack:[]})}reduce(e,r){return nr(r.type,Jy,e,r)}};const Nc=new Ad(()=>Qy.new());var Pd={exports:{}},Fd={};/**
 * @license React
 * use-sync-external-store-with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ms=v;function Zy(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var ew=typeof Object.is=="function"?Object.is:Zy,tw=Ms.useSyncExternalStore,rw=Ms.useRef,nw=Ms.useEffect,iw=Ms.useMemo,sw=Ms.useDebugValue;Fd.useSyncExternalStoreWithSelector=function(t,e,r,n,i){var s=rw(null);if(s.current===null){var a={hasValue:!1,value:null};s.current=a}else a=s.current;s=iw(function(){function l(h){if(!c){if(c=!0,u=h,h=n(h),i!==void 0&&a.hasValue){var m=a.value;if(i(m,h))return f=m}return f=h}if(m=f,ew(u,h))return m;var p=n(h);return i!==void 0&&i(m,p)?(u=h,m):(u=h,f=p)}var c=!1,u,f,d=r===void 0?null:r;return[function(){return l(e())},d===null?void 0:function(){return l(d())}]},[e,r,n,i]);var o=tw(t,s[0],s[1]);return nw(function(){a.hasValue=!0,a.value=o},[o]),sw(o),o};Pd.exports=Fd;var aw=Pd.exports;function cr(t,e,r=kd){return aw.useSyncExternalStoreWithSelector(ge(n=>t.subscribe(ow,n)),ge(()=>t.state),ge(()=>t.state),ge(e),r)}function ow(t){return t}function Nd(t,e){let r=v.useId(),n=Nc.get(e),[i,s]=cr(n,v.useCallback(a=>[n.selectors.isTop(a,r),n.selectors.inStack(a,r)],[n,r]));return Le(()=>{if(t)return n.actions.push(r),()=>n.actions.pop(r)},[n,t,r]),t?s?i:!0:!1}let Xl=new Map,cs=new Map;function xf(t){var e;let r=(e=cs.get(t))!=null?e:0;return cs.set(t,r+1),r!==0?()=>yf(t):(Xl.set(t,{"aria-hidden":t.getAttribute("aria-hidden"),inert:t.inert}),t.setAttribute("aria-hidden","true"),t.inert=!0,()=>yf(t))}function yf(t){var e;let r=(e=cs.get(t))!=null?e:1;if(r===1?cs.delete(t):cs.set(t,r-1),r!==1)return;let n=Xl.get(t);n&&(n["aria-hidden"]===null?t.removeAttribute("aria-hidden"):t.setAttribute("aria-hidden",n["aria-hidden"]),t.inert=n.inert,Xl.delete(t))}function lw(t,{allowed:e,disallowed:r}={}){let n=Nd(t,"inert-others");Le(()=>{var i,s;if(!n)return;let a=Vt();for(let l of(i=r==null?void 0:r())!=null?i:[])l&&a.add(xf(l));let o=(s=e==null?void 0:e())!=null?s:[];for(let l of o){if(!l)continue;let c=Qn(l);if(!c)continue;let u=l.parentElement;for(;u&&u!==c.body;){for(let f of u.children)o.some(d=>f.contains(d))||a.add(xf(f));u=u.parentElement}}return a.dispose},[n,e,r])}function cw(t,e,r){let n=Li(i=>{let s=i.getBoundingClientRect();s.x===0&&s.y===0&&s.width===0&&s.height===0&&r()});v.useEffect(()=>{if(!t)return;let i=e===null?null:Hr(e)?e:e.current;if(!i)return;let s=Vt();if(typeof ResizeObserver<"u"){let a=new ResizeObserver(()=>n.current(i));a.observe(i),s.add(()=>a.disconnect())}if(typeof IntersectionObserver<"u"){let a=new IntersectionObserver(()=>n.current(i));a.observe(i),s.add(()=>a.disconnect())}return()=>s.dispose()},[e,n,t])}let Yl=["[contentEditable=true]","[tabindex]","a[href]","area[href]","button:not([disabled])","iframe","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].map(t=>`${t}:not([tabindex='-1'])`).join(","),uw=["[data-autofocus]"].map(t=>`${t}:not([tabindex='-1'])`).join(",");var Jl=(t=>(t[t.First=1]="First",t[t.Previous=2]="Previous",t[t.Next=4]="Next",t[t.Last=8]="Last",t[t.WrapAround=16]="WrapAround",t[t.NoScroll=32]="NoScroll",t[t.AutoFocus=64]="AutoFocus",t))(Jl||{}),fw=(t=>(t[t.Error=0]="Error",t[t.Overflow=1]="Overflow",t[t.Success=2]="Success",t[t.Underflow=3]="Underflow",t))(fw||{}),hw=(t=>(t[t.Previous=-1]="Previous",t[t.Next=1]="Next",t))(hw||{});function Dd(t=document.body){return t==null?[]:Array.from(t.querySelectorAll(Yl)).sort((e,r)=>Math.sign((e.tabIndex||Number.MAX_SAFE_INTEGER)-(r.tabIndex||Number.MAX_SAFE_INTEGER)))}function dw(t=document.body){return t==null?[]:Array.from(t.querySelectorAll(uw)).sort((e,r)=>Math.sign((e.tabIndex||Number.MAX_SAFE_INTEGER)-(r.tabIndex||Number.MAX_SAFE_INTEGER)))}var Dc=(t=>(t[t.Strict=0]="Strict",t[t.Loose=1]="Loose",t))(Dc||{});function Lc(t,e=0){var r;return t===((r=Qn(t))==null?void 0:r.body)?!1:nr(e,{0(){return t.matches(Yl)},1(){let n=t;for(;n!==null;){if(n.matches(Yl))return!0;n=n.parentElement}return!1}})}function Ld(t){let e=Qn(t);Vt().nextFrame(()=>{e&&Sr(e.activeElement)&&!Lc(e.activeElement,0)&&mw(t)})}var pw=(t=>(t[t.Keyboard=0]="Keyboard",t[t.Mouse=1]="Mouse",t))(pw||{});typeof window<"u"&&typeof document<"u"&&(document.addEventListener("keydown",t=>{t.metaKey||t.altKey||t.ctrlKey||(document.documentElement.dataset.headlessuiFocusVisible="")},!0),document.addEventListener("click",t=>{t.detail===1?delete document.documentElement.dataset.headlessuiFocusVisible:t.detail===0&&(document.documentElement.dataset.headlessuiFocusVisible="")},!0));function mw(t){t==null||t.focus({preventScroll:!0})}let gw=["textarea","input"].join(",");function vw(t){var e,r;return(r=(e=t==null?void 0:t.matches)==null?void 0:e.call(t,gw))!=null?r:!1}function Md(t,e=r=>r){return t.slice().sort((r,n)=>{let i=e(r),s=e(n);if(i===null||s===null)return 0;let a=i.compareDocumentPosition(s);return a&Node.DOCUMENT_POSITION_FOLLOWING?-1:a&Node.DOCUMENT_POSITION_PRECEDING?1:0})}function xw(t,e){return yw(Dd(),e,{relativeTo:t})}function yw(t,e,{sorted:r=!0,relativeTo:n=null,skipElements:i=[]}={}){let s=Array.isArray(t)?t.length>0?t[0].ownerDocument:document:t.ownerDocument,a=Array.isArray(t)?r?Md(t):t:e&64?dw(t):Dd(t);i.length>0&&a.length>1&&(a=a.filter(h=>!i.some(m=>m!=null&&"current"in m?(m==null?void 0:m.current)===h:m===h))),n=n??s.activeElement;let o=(()=>{if(e&5)return 1;if(e&10)return-1;throw new Error("Missing Focus.First, Focus.Previous, Focus.Next or Focus.Last")})(),l=(()=>{if(e&1)return 0;if(e&2)return Math.max(0,a.indexOf(n))-1;if(e&4)return Math.max(0,a.indexOf(n))+1;if(e&8)return a.length-1;throw new Error("Missing Focus.First, Focus.Previous, Focus.Next or Focus.Last")})(),c=e&32?{preventScroll:!0}:{},u=0,f=a.length,d;do{if(u>=f||u+f<=0)return 0;let h=l+u;if(e&16)h=(h+f)%f;else{if(h<0)return 3;if(h>=f)return 1}d=a[h],d==null||d.focus(c),u+=o}while(d!==s.activeElement);return e&6&&vw(d)&&d.select(),2}function jd(){return/iPhone/gi.test(window.navigator.platform)||/Mac/gi.test(window.navigator.platform)&&window.navigator.maxTouchPoints>0}function ww(){return/Android/gi.test(window.navigator.userAgent)}function wf(){return jd()||ww()}function xi(t,e,r,n){let i=Li(r);v.useEffect(()=>{if(!t)return;function s(a){i.current(a)}return document.addEventListener(e,s,n),()=>document.removeEventListener(e,s,n)},[t,e,n])}function _w(t,e,r,n){let i=Li(r);v.useEffect(()=>{if(!t)return;function s(a){i.current(a)}return window.addEventListener(e,s,n),()=>window.removeEventListener(e,s,n)},[t,e,n])}const _f=30;function Ew(t,e,r){let n=Li(r),i=v.useCallback(function(o,l){if(o.defaultPrevented)return;let c=l(o);if(c===null||!c.getRootNode().contains(c)||!c.isConnected)return;let u=function f(d){return typeof d=="function"?f(d()):Array.isArray(d)||d instanceof Set?d:[d]}(e);for(let f of u)if(f!==null&&(f.contains(c)||o.composed&&o.composedPath().includes(f)))return;return!Lc(c,Dc.Loose)&&c.tabIndex!==-1&&o.preventDefault(),n.current(o,c)},[n,e]),s=v.useRef(null);xi(t,"pointerdown",o=>{var l,c;wf()||(s.current=((c=(l=o.composedPath)==null?void 0:l.call(o))==null?void 0:c[0])||o.target)},!0),xi(t,"pointerup",o=>{if(wf()||!s.current)return;let l=s.current;return s.current=null,i(o,()=>l)},!0);let a=v.useRef({x:0,y:0});xi(t,"touchstart",o=>{a.current.x=o.touches[0].clientX,a.current.y=o.touches[0].clientY},!0),xi(t,"touchend",o=>{let l={x:o.changedTouches[0].clientX,y:o.changedTouches[0].clientY};if(!(Math.abs(l.x-a.current.x)>=_f||Math.abs(l.y-a.current.y)>=_f))return i(o,()=>Sr(o.target)?o.target:null)},!0),_w(t,"blur",o=>i(o,()=>Oy(window.document.activeElement)?window.document.activeElement:null),!0)}function Ql(...t){return v.useMemo(()=>Qn(...t),[...t])}var bw=(t=>(t[t.Ignore=0]="Ignore",t[t.Select=1]="Select",t[t.Close=2]="Close",t))(bw||{});const oa={Ignore:{kind:0},Select:t=>({kind:1,target:t}),Close:{kind:2}},Tw=200;function Sw(t,{trigger:e,action:r,close:n,select:i}){let s=v.useRef(null);xi(t&&e!==null,"pointerdown",a=>{Rc(a==null?void 0:a.target)&&e!=null&&e.contains(a.target)&&(s.current=new Date)}),xi(t&&e!==null,"pointerup",a=>{if(s.current===null||!Sr(a.target))return;let o=r(a),l=new Date().getTime()-s.current.getTime();switch(s.current=null,o.kind){case 0:return;case 1:{l>Tw&&(i(o.target),n());break}case 2:{n();break}}},{capture:!0})}function $d(t,e){return v.useMemo(()=>{var r;if(t.type)return t.type;let n=(r=t.as)!=null?r:"button";if(typeof n=="string"&&n.toLowerCase()==="button"||(e==null?void 0:e.tagName)==="BUTTON"&&!e.hasAttribute("type"))return"button"},[t.type,t.as,e])}function Aw(t){return v.useSyncExternalStore(t.subscribe,t.getSnapshot,t.getSnapshot)}function Cw(t,e){let r=t(),n=new Set;return{getSnapshot(){return r},subscribe(i){return n.add(i),()=>n.delete(i)},dispatch(i,...s){let a=e[i].call(r,...s);a&&(r=a,n.forEach(o=>o()))}}}function Iw(){let t;return{before({doc:e}){var r;let n=e.documentElement,i=(r=e.defaultView)!=null?r:window;t=Math.max(0,i.innerWidth-n.clientWidth)},after({doc:e,d:r}){let n=e.documentElement,i=Math.max(0,n.clientWidth-n.offsetWidth),s=Math.max(0,t-i);r.style(n,"paddingRight",`${s}px`)}}}function kw(){return jd()?{before({doc:t,d:e,meta:r}){function n(i){return r.containers.flatMap(s=>s()).some(s=>s.contains(i))}e.microTask(()=>{var i;if(window.getComputedStyle(t.documentElement).scrollBehavior!=="auto"){let o=Vt();o.style(t.documentElement,"scrollBehavior","auto"),e.add(()=>e.microTask(()=>o.dispose()))}let s=(i=window.scrollY)!=null?i:window.pageYOffset,a=null;e.addEventListener(t,"click",o=>{if(Sr(o.target))try{let l=o.target.closest("a");if(!l)return;let{hash:c}=new URL(l.href),u=t.querySelector(c);Sr(u)&&!n(u)&&(a=u)}catch{}},!0),e.addEventListener(t,"touchstart",o=>{if(Sr(o.target)&&ky(o.target))if(n(o.target)){let l=o.target;for(;l.parentElement&&n(l.parentElement);)l=l.parentElement;e.style(l,"overscrollBehavior","contain")}else e.style(o.target,"touchAction","none")}),e.addEventListener(t,"touchmove",o=>{if(Sr(o.target)){if(yd(o.target))return;if(n(o.target)){let l=o.target;for(;l.parentElement&&l.dataset.headlessuiPortal!==""&&!(l.scrollHeight>l.clientHeight||l.scrollWidth>l.clientWidth);)l=l.parentElement;l.dataset.headlessuiPortal===""&&o.preventDefault()}else o.preventDefault()}},{passive:!1}),e.add(()=>{var o;let l=(o=window.scrollY)!=null?o:window.pageYOffset;s!==l&&window.scrollTo(0,s),a&&a.isConnected&&(a.scrollIntoView({block:"nearest"}),a=null)})})}}:{}}function Ow(){return{before({doc:t,d:e}){e.style(t.documentElement,"overflow","hidden")}}}function Rw(t){let e={};for(let r of t)Object.assign(e,r(e));return e}let Ln=Cw(()=>new Map,{PUSH(t,e){var r;let n=(r=this.get(t))!=null?r:{doc:t,count:0,d:Vt(),meta:new Set};return n.count++,n.meta.add(e),this.set(t,n),this},POP(t,e){let r=this.get(t);return r&&(r.count--,r.meta.delete(e)),this},SCROLL_PREVENT({doc:t,d:e,meta:r}){let n={doc:t,d:e,meta:Rw(r)},i=[kw(),Iw(),Ow()];i.forEach(({before:s})=>s==null?void 0:s(n)),i.forEach(({after:s})=>s==null?void 0:s(n))},SCROLL_ALLOW({d:t}){t.dispose()},TEARDOWN({doc:t}){this.delete(t)}});Ln.subscribe(()=>{let t=Ln.getSnapshot(),e=new Map;for(let[r]of t)e.set(r,r.documentElement.style.overflow);for(let r of t.values()){let n=e.get(r.doc)==="hidden",i=r.count!==0;(i&&!n||!i&&n)&&Ln.dispatch(r.count>0?"SCROLL_PREVENT":"SCROLL_ALLOW",r),r.count===0&&Ln.dispatch("TEARDOWN",r)}});function Pw(t,e,r=()=>({containers:[]})){let n=Aw(Ln),i=e?n.get(e):void 0,s=i?i.count>0:!1;return Le(()=>{if(!(!e||!t))return Ln.dispatch("PUSH",e,r),()=>Ln.dispatch("POP",e,r)},[t,e]),s}function Fw(t,e,r=()=>[document.body]){let n=Nd(t,"scroll-lock");Pw(n,e,i=>{var s;return{containers:[...(s=i.containers)!=null?s:[],r]}})}function Ef(t){return[t.screenX,t.screenY]}function Nw(){let t=v.useRef([-1,-1]);return{wasMoved(e){let r=Ef(e);return t.current[0]===r[0]&&t.current[1]===r[1]?!1:(t.current=r,!0)},update(e){t.current=Ef(e)}}}function Dw(t=0){let[e,r]=v.useState(t),n=v.useCallback(l=>r(l),[e]),i=v.useCallback(l=>r(c=>c|l),[e]),s=v.useCallback(l=>(e&l)===l,[e]),a=v.useCallback(l=>r(c=>c&~l),[r]),o=v.useCallback(l=>r(c=>c^l),[r]);return{flags:e,setFlag:n,addFlag:i,hasFlag:s,removeFlag:a,toggleFlag:o}}var bf,Tf;typeof process<"u"&&typeof globalThis<"u"&&typeof Element<"u"&&((bf=process==null?void 0:process.env)==null?void 0:bf.NODE_ENV)==="test"&&typeof((Tf=Element==null?void 0:Element.prototype)==null?void 0:Tf.getAnimations)>"u"&&(Element.prototype.getAnimations=function(){return console.warn(["Headless UI has polyfilled `Element.prototype.getAnimations` for your tests.","Please install a proper polyfill e.g. `jsdom-testing-mocks`, to silence these warnings.","","Example usage:","```js","import { mockAnimationsApi } from 'jsdom-testing-mocks'","mockAnimationsApi()","```"].join(`
`)),[]});var Lw=(t=>(t[t.None=0]="None",t[t.Closed=1]="Closed",t[t.Enter=2]="Enter",t[t.Leave=4]="Leave",t))(Lw||{});function Mc(t){let e={};for(let r in t)t[r]===!0&&(e[`data-${r}`]="");return e}function jc(t,e,r,n){let[i,s]=v.useState(r),{hasFlag:a,addFlag:o,removeFlag:l}=Dw(t&&i?3:0),c=v.useRef(!1),u=v.useRef(!1),f=Ls();return Le(()=>{var d;if(t){if(r&&s(!0),!e){r&&o(3);return}return(d=n==null?void 0:n.start)==null||d.call(n,r),Mw(e,{inFlight:c,prepare(){u.current?u.current=!1:u.current=c.current,c.current=!0,!u.current&&(r?(o(3),l(4)):(o(4),l(2)))},run(){u.current?r?(l(3),o(4)):(l(4),o(3)):r?l(1):o(1)},done(){var h;u.current&&typeof e.getAnimations=="function"&&e.getAnimations().length>0||(c.current=!1,l(7),r||s(!1),(h=n==null?void 0:n.end)==null||h.call(n,r))}})}},[t,r,e,f]),t?[i,{closed:a(1),enter:a(2),leave:a(4),transition:a(2)||a(4)}]:[r,{closed:void 0,enter:void 0,leave:void 0,transition:void 0}]}function Mw(t,{prepare:e,run:r,done:n,inFlight:i}){let s=Vt();return $w(t,{prepare:e,inFlight:i}),s.nextFrame(()=>{r(),s.requestAnimationFrame(()=>{s.add(jw(t,n))})}),s.dispose}function jw(t,e){var r,n;let i=Vt();if(!t)return i.dispose;let s=!1;i.add(()=>{s=!0});let a=(n=(r=t.getAnimations)==null?void 0:r.call(t).filter(o=>o instanceof CSSTransition))!=null?n:[];return a.length===0?(e(),i.dispose):(Promise.allSettled(a.map(o=>o.finished)).then(()=>{s||e()}),i.dispose)}function $w(t,{inFlight:e,prepare:r}){if(e!=null&&e.current){r();return}let n=t.style.transition;t.style.transition="none",r(),t.offsetHeight,t.style.transition=n}function Bw(t,{container:e,accept:r,walk:n}){let i=v.useRef(r),s=v.useRef(n);v.useEffect(()=>{i.current=r,s.current=n},[r,n]),Le(()=>{if(!e||!t)return;let a=Qn(e);if(!a)return;let o=i.current,l=s.current,c=Object.assign(f=>o(f),{acceptNode:o}),u=a.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,c,!1);for(;u.nextNode();)l(u.currentNode)},[e,t,i,s])}function vo(){return typeof window<"u"}function Mi(t){return Bd(t)?(t.nodeName||"").toLowerCase():"#document"}function Dt(t){var e;return(t==null||(e=t.ownerDocument)==null?void 0:e.defaultView)||window}function gr(t){var e;return(e=(Bd(t)?t.ownerDocument:t.document)||window.document)==null?void 0:e.documentElement}function Bd(t){return vo()?t instanceof Node||t instanceof Dt(t).Node:!1}function wt(t){return vo()?t instanceof Element||t instanceof Dt(t).Element:!1}function dr(t){return vo()?t instanceof HTMLElement||t instanceof Dt(t).HTMLElement:!1}function Sf(t){return!vo()||typeof ShadowRoot>"u"?!1:t instanceof ShadowRoot||t instanceof Dt(t).ShadowRoot}const Uw=new Set(["inline","contents"]);function js(t){const{overflow:e,overflowX:r,overflowY:n,display:i}=rr(t);return/auto|scroll|overlay|hidden|clip/.test(e+n+r)&&!Uw.has(i)}const Hw=new Set(["table","td","th"]);function Ww(t){return Hw.has(Mi(t))}const Vw=[":popover-open",":modal"];function xo(t){return Vw.some(e=>{try{return t.matches(e)}catch{return!1}})}const Gw=["transform","translate","scale","rotate","perspective"],zw=["transform","translate","scale","rotate","perspective","filter"],qw=["paint","layout","strict","content"];function $c(t){const e=Bc(),r=wt(t)?rr(t):t;return Gw.some(n=>r[n]?r[n]!=="none":!1)||(r.containerType?r.containerType!=="normal":!1)||!e&&(r.backdropFilter?r.backdropFilter!=="none":!1)||!e&&(r.filter?r.filter!=="none":!1)||zw.some(n=>(r.willChange||"").includes(n))||qw.some(n=>(r.contain||"").includes(n))}function Kw(t){let e=un(t);for(;dr(e)&&!Ri(e);){if($c(e))return e;if(xo(e))return null;e=un(e)}return null}function Bc(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}const Xw=new Set(["html","body","#document"]);function Ri(t){return Xw.has(Mi(t))}function rr(t){return Dt(t).getComputedStyle(t)}function yo(t){return wt(t)?{scrollLeft:t.scrollLeft,scrollTop:t.scrollTop}:{scrollLeft:t.scrollX,scrollTop:t.scrollY}}function un(t){if(Mi(t)==="html")return t;const e=t.assignedSlot||t.parentNode||Sf(t)&&t.host||gr(t);return Sf(e)?e.host:e}function Ud(t){const e=un(t);return Ri(e)?t.ownerDocument?t.ownerDocument.body:t.body:dr(e)&&js(e)?e:Ud(e)}function _s(t,e,r){var n;e===void 0&&(e=[]),r===void 0&&(r=!0);const i=Ud(t),s=i===((n=t.ownerDocument)==null?void 0:n.body),a=Dt(i);if(s){const o=Zl(a);return e.concat(a,a.visualViewport||[],js(i)?i:[],o&&r?_s(o):[])}return e.concat(i,_s(i,[],r))}function Zl(t){return t.parent&&Object.getPrototypeOf(t.parent)?t.frameElement:null}function Yw(){const t=navigator.userAgentData;return t&&Array.isArray(t.brands)?t.brands.map(e=>{let{brand:r,version:n}=e;return r+"/"+n}).join(" "):navigator.userAgent}const Hn=Math.min,pt=Math.max,Es=Math.round,la=Math.floor,ur=t=>({x:t,y:t}),Jw={left:"right",right:"left",bottom:"top",top:"bottom"},Qw={start:"end",end:"start"};function Af(t,e,r){return pt(t,Hn(e,r))}function ji(t,e){return typeof t=="function"?t(e):t}function fn(t){return t.split("-")[0]}function $s(t){return t.split("-")[1]}function Hd(t){return t==="x"?"y":"x"}function Wd(t){return t==="y"?"height":"width"}const Zw=new Set(["top","bottom"]);function Ar(t){return Zw.has(fn(t))?"y":"x"}function Vd(t){return Hd(Ar(t))}function e_(t,e,r){r===void 0&&(r=!1);const n=$s(t),i=Vd(t),s=Wd(i);let a=i==="x"?n===(r?"end":"start")?"right":"left":n==="start"?"bottom":"top";return e.reference[s]>e.floating[s]&&(a=La(a)),[a,La(a)]}function t_(t){const e=La(t);return[ec(t),e,ec(e)]}function ec(t){return t.replace(/start|end/g,e=>Qw[e])}const Cf=["left","right"],If=["right","left"],r_=["top","bottom"],n_=["bottom","top"];function i_(t,e,r){switch(t){case"top":case"bottom":return r?e?If:Cf:e?Cf:If;case"left":case"right":return e?r_:n_;default:return[]}}function s_(t,e,r,n){const i=$s(t);let s=i_(fn(t),r==="start",n);return i&&(s=s.map(a=>a+"-"+i),e&&(s=s.concat(s.map(ec)))),s}function La(t){return t.replace(/left|right|bottom|top/g,e=>Jw[e])}function a_(t){return{top:0,right:0,bottom:0,left:0,...t}}function o_(t){return typeof t!="number"?a_(t):{top:t,right:t,bottom:t,left:t}}function Ma(t){const{x:e,y:r,width:n,height:i}=t;return{width:n,height:i,top:r,left:e,right:e+n,bottom:r+i,x:e,y:r}}function kf(t,e,r){let{reference:n,floating:i}=t;const s=Ar(e),a=Vd(e),o=Wd(a),l=fn(e),c=s==="y",u=n.x+n.width/2-i.width/2,f=n.y+n.height/2-i.height/2,d=n[o]/2-i[o]/2;let h;switch(l){case"top":h={x:u,y:n.y-i.height};break;case"bottom":h={x:u,y:n.y+n.height};break;case"right":h={x:n.x+n.width,y:f};break;case"left":h={x:n.x-i.width,y:f};break;default:h={x:n.x,y:n.y}}switch($s(e)){case"start":h[a]-=d*(r&&c?-1:1);break;case"end":h[a]+=d*(r&&c?-1:1);break}return h}const l_=async(t,e,r)=>{const{placement:n="bottom",strategy:i="absolute",middleware:s=[],platform:a}=r,o=s.filter(Boolean),l=await(a.isRTL==null?void 0:a.isRTL(e));let c=await a.getElementRects({reference:t,floating:e,strategy:i}),{x:u,y:f}=kf(c,n,l),d=n,h={},m=0;for(let p=0;p<o.length;p++){const{name:g,fn:w}=o[p],{x:b,y:_,data:k,reset:L}=await w({x:u,y:f,initialPlacement:n,placement:d,strategy:i,middlewareData:h,rects:c,platform:a,elements:{reference:t,floating:e}});u=b??u,f=_??f,h={...h,[g]:{...h[g],...k}},L&&m<=50&&(m++,typeof L=="object"&&(L.placement&&(d=L.placement),L.rects&&(c=L.rects===!0?await a.getElementRects({reference:t,floating:e,strategy:i}):L.rects),{x:u,y:f}=kf(c,d,l)),p=-1)}return{x:u,y:f,placement:d,strategy:i,middlewareData:h}};async function wo(t,e){var r;e===void 0&&(e={});const{x:n,y:i,platform:s,rects:a,elements:o,strategy:l}=t,{boundary:c="clippingAncestors",rootBoundary:u="viewport",elementContext:f="floating",altBoundary:d=!1,padding:h=0}=ji(e,t),m=o_(h),g=o[d?f==="floating"?"reference":"floating":f],w=Ma(await s.getClippingRect({element:(r=await(s.isElement==null?void 0:s.isElement(g)))==null||r?g:g.contextElement||await(s.getDocumentElement==null?void 0:s.getDocumentElement(o.floating)),boundary:c,rootBoundary:u,strategy:l})),b=f==="floating"?{x:n,y:i,width:a.floating.width,height:a.floating.height}:a.reference,_=await(s.getOffsetParent==null?void 0:s.getOffsetParent(o.floating)),k=await(s.isElement==null?void 0:s.isElement(_))?await(s.getScale==null?void 0:s.getScale(_))||{x:1,y:1}:{x:1,y:1},L=Ma(s.convertOffsetParentRelativeRectToViewportRelativeRect?await s.convertOffsetParentRelativeRectToViewportRelativeRect({elements:o,rect:b,offsetParent:_,strategy:l}):b);return{top:(w.top-L.top+m.top)/k.y,bottom:(L.bottom-w.bottom+m.bottom)/k.y,left:(w.left-L.left+m.left)/k.x,right:(L.right-w.right+m.right)/k.x}}const c_=function(t){return t===void 0&&(t={}),{name:"flip",options:t,async fn(e){var r,n;const{placement:i,middlewareData:s,rects:a,initialPlacement:o,platform:l,elements:c}=e,{mainAxis:u=!0,crossAxis:f=!0,fallbackPlacements:d,fallbackStrategy:h="bestFit",fallbackAxisSideDirection:m="none",flipAlignment:p=!0,...g}=ji(t,e);if((r=s.arrow)!=null&&r.alignmentOffset)return{};const w=fn(i),b=Ar(o),_=fn(o)===o,k=await(l.isRTL==null?void 0:l.isRTL(c.floating)),L=d||(_||!p?[La(o)]:t_(o)),M=m!=="none";!d&&M&&L.push(...s_(o,p,m,k));const I=[o,...L],F=await wo(e,g),R=[];let N=((n=s.flip)==null?void 0:n.overflows)||[];if(u&&R.push(F[w]),f){const fe=e_(i,a,k);R.push(F[fe[0]],F[fe[1]])}if(N=[...N,{placement:i,overflows:R}],!R.every(fe=>fe<=0)){var H,q;const fe=(((H=s.flip)==null?void 0:H.index)||0)+1,ue=I[fe];if(ue&&(!(f==="alignment"?b!==Ar(ue):!1)||N.every(he=>he.overflows[0]>0&&Ar(he.placement)===b)))return{data:{index:fe,overflows:N},reset:{placement:ue}};let we=(q=N.filter(xe=>xe.overflows[0]<=0).sort((xe,he)=>xe.overflows[1]-he.overflows[1])[0])==null?void 0:q.placement;if(!we)switch(h){case"bestFit":{var Y;const xe=(Y=N.filter(he=>{if(M){const Q=Ar(he.placement);return Q===b||Q==="y"}return!0}).map(he=>[he.placement,he.overflows.filter(Q=>Q>0).reduce((Q,_e)=>Q+_e,0)]).sort((he,Q)=>he[1]-Q[1])[0])==null?void 0:Y[0];xe&&(we=xe);break}case"initialPlacement":we=o;break}if(i!==we)return{reset:{placement:we}}}return{}}}},u_=new Set(["left","top"]);async function f_(t,e){const{placement:r,platform:n,elements:i}=t,s=await(n.isRTL==null?void 0:n.isRTL(i.floating)),a=fn(r),o=$s(r),l=Ar(r)==="y",c=u_.has(a)?-1:1,u=s&&l?-1:1,f=ji(e,t);let{mainAxis:d,crossAxis:h,alignmentAxis:m}=typeof f=="number"?{mainAxis:f,crossAxis:0,alignmentAxis:null}:{mainAxis:f.mainAxis||0,crossAxis:f.crossAxis||0,alignmentAxis:f.alignmentAxis};return o&&typeof m=="number"&&(h=o==="end"?m*-1:m),l?{x:h*u,y:d*c}:{x:d*c,y:h*u}}const h_=function(t){return t===void 0&&(t=0),{name:"offset",options:t,async fn(e){var r,n;const{x:i,y:s,placement:a,middlewareData:o}=e,l=await f_(e,t);return a===((r=o.offset)==null?void 0:r.placement)&&(n=o.arrow)!=null&&n.alignmentOffset?{}:{x:i+l.x,y:s+l.y,data:{...l,placement:a}}}}},d_=function(t){return t===void 0&&(t={}),{name:"shift",options:t,async fn(e){const{x:r,y:n,placement:i}=e,{mainAxis:s=!0,crossAxis:a=!1,limiter:o={fn:g=>{let{x:w,y:b}=g;return{x:w,y:b}}},...l}=ji(t,e),c={x:r,y:n},u=await wo(e,l),f=Ar(fn(i)),d=Hd(f);let h=c[d],m=c[f];if(s){const g=d==="y"?"top":"left",w=d==="y"?"bottom":"right",b=h+u[g],_=h-u[w];h=Af(b,h,_)}if(a){const g=f==="y"?"top":"left",w=f==="y"?"bottom":"right",b=m+u[g],_=m-u[w];m=Af(b,m,_)}const p=o.fn({...e,[d]:h,[f]:m});return{...p,data:{x:p.x-r,y:p.y-n,enabled:{[d]:s,[f]:a}}}}}},p_=function(t){return t===void 0&&(t={}),{name:"size",options:t,async fn(e){var r,n;const{placement:i,rects:s,platform:a,elements:o}=e,{apply:l=()=>{},...c}=ji(t,e),u=await wo(e,c),f=fn(i),d=$s(i),h=Ar(i)==="y",{width:m,height:p}=s.floating;let g,w;f==="top"||f==="bottom"?(g=f,w=d===(await(a.isRTL==null?void 0:a.isRTL(o.floating))?"start":"end")?"left":"right"):(w=f,g=d==="end"?"top":"bottom");const b=p-u.top-u.bottom,_=m-u.left-u.right,k=Hn(p-u[g],b),L=Hn(m-u[w],_),M=!e.middlewareData.shift;let I=k,F=L;if((r=e.middlewareData.shift)!=null&&r.enabled.x&&(F=_),(n=e.middlewareData.shift)!=null&&n.enabled.y&&(I=b),M&&!d){const N=pt(u.left,0),H=pt(u.right,0),q=pt(u.top,0),Y=pt(u.bottom,0);h?F=m-2*(N!==0||H!==0?N+H:pt(u.left,u.right)):I=p-2*(q!==0||Y!==0?q+Y:pt(u.top,u.bottom))}await l({...e,availableWidth:F,availableHeight:I});const R=await a.getDimensions(o.floating);return m!==R.width||p!==R.height?{reset:{rects:!0}}:{}}}};function Gd(t){const e=rr(t);let r=parseFloat(e.width)||0,n=parseFloat(e.height)||0;const i=dr(t),s=i?t.offsetWidth:r,a=i?t.offsetHeight:n,o=Es(r)!==s||Es(n)!==a;return o&&(r=s,n=a),{width:r,height:n,$:o}}function Uc(t){return wt(t)?t:t.contextElement}function _i(t){const e=Uc(t);if(!dr(e))return ur(1);const r=e.getBoundingClientRect(),{width:n,height:i,$:s}=Gd(e);let a=(s?Es(r.width):r.width)/n,o=(s?Es(r.height):r.height)/i;return(!a||!Number.isFinite(a))&&(a=1),(!o||!Number.isFinite(o))&&(o=1),{x:a,y:o}}const m_=ur(0);function zd(t){const e=Dt(t);return!Bc()||!e.visualViewport?m_:{x:e.visualViewport.offsetLeft,y:e.visualViewport.offsetTop}}function g_(t,e,r){return e===void 0&&(e=!1),!r||e&&r!==Dt(t)?!1:e}function Wn(t,e,r,n){e===void 0&&(e=!1),r===void 0&&(r=!1);const i=t.getBoundingClientRect(),s=Uc(t);let a=ur(1);e&&(n?wt(n)&&(a=_i(n)):a=_i(t));const o=g_(s,r,n)?zd(s):ur(0);let l=(i.left+o.x)/a.x,c=(i.top+o.y)/a.y,u=i.width/a.x,f=i.height/a.y;if(s){const d=Dt(s),h=n&&wt(n)?Dt(n):n;let m=d,p=Zl(m);for(;p&&n&&h!==m;){const g=_i(p),w=p.getBoundingClientRect(),b=rr(p),_=w.left+(p.clientLeft+parseFloat(b.paddingLeft))*g.x,k=w.top+(p.clientTop+parseFloat(b.paddingTop))*g.y;l*=g.x,c*=g.y,u*=g.x,f*=g.y,l+=_,c+=k,m=Dt(p),p=Zl(m)}}return Ma({width:u,height:f,x:l,y:c})}function Hc(t,e){const r=yo(t).scrollLeft;return e?e.left+r:Wn(gr(t)).left+r}function qd(t,e,r){r===void 0&&(r=!1);const n=t.getBoundingClientRect(),i=n.left+e.scrollLeft-(r?0:Hc(t,n)),s=n.top+e.scrollTop;return{x:i,y:s}}function v_(t){let{elements:e,rect:r,offsetParent:n,strategy:i}=t;const s=i==="fixed",a=gr(n),o=e?xo(e.floating):!1;if(n===a||o&&s)return r;let l={scrollLeft:0,scrollTop:0},c=ur(1);const u=ur(0),f=dr(n);if((f||!f&&!s)&&((Mi(n)!=="body"||js(a))&&(l=yo(n)),dr(n))){const h=Wn(n);c=_i(n),u.x=h.x+n.clientLeft,u.y=h.y+n.clientTop}const d=a&&!f&&!s?qd(a,l,!0):ur(0);return{width:r.width*c.x,height:r.height*c.y,x:r.x*c.x-l.scrollLeft*c.x+u.x+d.x,y:r.y*c.y-l.scrollTop*c.y+u.y+d.y}}function x_(t){return Array.from(t.getClientRects())}function y_(t){const e=gr(t),r=yo(t),n=t.ownerDocument.body,i=pt(e.scrollWidth,e.clientWidth,n.scrollWidth,n.clientWidth),s=pt(e.scrollHeight,e.clientHeight,n.scrollHeight,n.clientHeight);let a=-r.scrollLeft+Hc(t);const o=-r.scrollTop;return rr(n).direction==="rtl"&&(a+=pt(e.clientWidth,n.clientWidth)-i),{width:i,height:s,x:a,y:o}}function w_(t,e){const r=Dt(t),n=gr(t),i=r.visualViewport;let s=n.clientWidth,a=n.clientHeight,o=0,l=0;if(i){s=i.width,a=i.height;const c=Bc();(!c||c&&e==="fixed")&&(o=i.offsetLeft,l=i.offsetTop)}return{width:s,height:a,x:o,y:l}}const __=new Set(["absolute","fixed"]);function E_(t,e){const r=Wn(t,!0,e==="fixed"),n=r.top+t.clientTop,i=r.left+t.clientLeft,s=dr(t)?_i(t):ur(1),a=t.clientWidth*s.x,o=t.clientHeight*s.y,l=i*s.x,c=n*s.y;return{width:a,height:o,x:l,y:c}}function Of(t,e,r){let n;if(e==="viewport")n=w_(t,r);else if(e==="document")n=y_(gr(t));else if(wt(e))n=E_(e,r);else{const i=zd(t);n={x:e.x-i.x,y:e.y-i.y,width:e.width,height:e.height}}return Ma(n)}function Kd(t,e){const r=un(t);return r===e||!wt(r)||Ri(r)?!1:rr(r).position==="fixed"||Kd(r,e)}function b_(t,e){const r=e.get(t);if(r)return r;let n=_s(t,[],!1).filter(o=>wt(o)&&Mi(o)!=="body"),i=null;const s=rr(t).position==="fixed";let a=s?un(t):t;for(;wt(a)&&!Ri(a);){const o=rr(a),l=$c(a);!l&&o.position==="fixed"&&(i=null),(s?!l&&!i:!l&&o.position==="static"&&!!i&&__.has(i.position)||js(a)&&!l&&Kd(t,a))?n=n.filter(u=>u!==a):i=o,a=un(a)}return e.set(t,n),n}function T_(t){let{element:e,boundary:r,rootBoundary:n,strategy:i}=t;const a=[...r==="clippingAncestors"?xo(e)?[]:b_(e,this._c):[].concat(r),n],o=a[0],l=a.reduce((c,u)=>{const f=Of(e,u,i);return c.top=pt(f.top,c.top),c.right=Hn(f.right,c.right),c.bottom=Hn(f.bottom,c.bottom),c.left=pt(f.left,c.left),c},Of(e,o,i));return{width:l.right-l.left,height:l.bottom-l.top,x:l.left,y:l.top}}function S_(t){const{width:e,height:r}=Gd(t);return{width:e,height:r}}function A_(t,e,r){const n=dr(e),i=gr(e),s=r==="fixed",a=Wn(t,!0,s,e);let o={scrollLeft:0,scrollTop:0};const l=ur(0);function c(){l.x=Hc(i)}if(n||!n&&!s)if((Mi(e)!=="body"||js(i))&&(o=yo(e)),n){const h=Wn(e,!0,s,e);l.x=h.x+e.clientLeft,l.y=h.y+e.clientTop}else i&&c();s&&!n&&i&&c();const u=i&&!n&&!s?qd(i,o):ur(0),f=a.left+o.scrollLeft-l.x-u.x,d=a.top+o.scrollTop-l.y-u.y;return{x:f,y:d,width:a.width,height:a.height}}function nl(t){return rr(t).position==="static"}function Rf(t,e){if(!dr(t)||rr(t).position==="fixed")return null;if(e)return e(t);let r=t.offsetParent;return gr(t)===r&&(r=r.ownerDocument.body),r}function Xd(t,e){const r=Dt(t);if(xo(t))return r;if(!dr(t)){let i=un(t);for(;i&&!Ri(i);){if(wt(i)&&!nl(i))return i;i=un(i)}return r}let n=Rf(t,e);for(;n&&Ww(n)&&nl(n);)n=Rf(n,e);return n&&Ri(n)&&nl(n)&&!$c(n)?r:n||Kw(t)||r}const C_=async function(t){const e=this.getOffsetParent||Xd,r=this.getDimensions,n=await r(t.floating);return{reference:A_(t.reference,await e(t.floating),t.strategy),floating:{x:0,y:0,width:n.width,height:n.height}}};function I_(t){return rr(t).direction==="rtl"}const k_={convertOffsetParentRelativeRectToViewportRelativeRect:v_,getDocumentElement:gr,getClippingRect:T_,getOffsetParent:Xd,getElementRects:C_,getClientRects:x_,getDimensions:S_,getScale:_i,isElement:wt,isRTL:I_};function Yd(t,e){return t.x===e.x&&t.y===e.y&&t.width===e.width&&t.height===e.height}function O_(t,e){let r=null,n;const i=gr(t);function s(){var o;clearTimeout(n),(o=r)==null||o.disconnect(),r=null}function a(o,l){o===void 0&&(o=!1),l===void 0&&(l=1),s();const c=t.getBoundingClientRect(),{left:u,top:f,width:d,height:h}=c;if(o||e(),!d||!h)return;const m=la(f),p=la(i.clientWidth-(u+d)),g=la(i.clientHeight-(f+h)),w=la(u),_={rootMargin:-m+"px "+-p+"px "+-g+"px "+-w+"px",threshold:pt(0,Hn(1,l))||1};let k=!0;function L(M){const I=M[0].intersectionRatio;if(I!==l){if(!k)return a();I?a(!1,I):n=setTimeout(()=>{a(!1,1e-7)},1e3)}I===1&&!Yd(c,t.getBoundingClientRect())&&a(),k=!1}try{r=new IntersectionObserver(L,{..._,root:i.ownerDocument})}catch{r=new IntersectionObserver(L,_)}r.observe(t)}return a(!0),s}function R_(t,e,r,n){n===void 0&&(n={});const{ancestorScroll:i=!0,ancestorResize:s=!0,elementResize:a=typeof ResizeObserver=="function",layoutShift:o=typeof IntersectionObserver=="function",animationFrame:l=!1}=n,c=Uc(t),u=i||s?[...c?_s(c):[],..._s(e)]:[];u.forEach(w=>{i&&w.addEventListener("scroll",r,{passive:!0}),s&&w.addEventListener("resize",r)});const f=c&&o?O_(c,r):null;let d=-1,h=null;a&&(h=new ResizeObserver(w=>{let[b]=w;b&&b.target===c&&h&&(h.unobserve(e),cancelAnimationFrame(d),d=requestAnimationFrame(()=>{var _;(_=h)==null||_.observe(e)})),r()}),c&&!l&&h.observe(c),h.observe(e));let m,p=l?Wn(t):null;l&&g();function g(){const w=Wn(t);p&&!Yd(p,w)&&r(),p=w,m=requestAnimationFrame(g)}return r(),()=>{var w;u.forEach(b=>{i&&b.removeEventListener("scroll",r),s&&b.removeEventListener("resize",r)}),f==null||f(),(w=h)==null||w.disconnect(),h=null,l&&cancelAnimationFrame(m)}}const il=wo,P_=h_,F_=d_,N_=c_,D_=p_,L_=(t,e,r)=>{const n=new Map,i={platform:k_,...r},s={...i.platform,_c:n};return l_(t,e,{...i,platform:s})};var M_=typeof document<"u",j_=function(){},Sa=M_?v.useLayoutEffect:j_;function ja(t,e){if(t===e)return!0;if(typeof t!=typeof e)return!1;if(typeof t=="function"&&t.toString()===e.toString())return!0;let r,n,i;if(t&&e&&typeof t=="object"){if(Array.isArray(t)){if(r=t.length,r!==e.length)return!1;for(n=r;n--!==0;)if(!ja(t[n],e[n]))return!1;return!0}if(i=Object.keys(t),r=i.length,r!==Object.keys(e).length)return!1;for(n=r;n--!==0;)if(!{}.hasOwnProperty.call(e,i[n]))return!1;for(n=r;n--!==0;){const s=i[n];if(!(s==="_owner"&&t.$$typeof)&&!ja(t[s],e[s]))return!1}return!0}return t!==t&&e!==e}function Jd(t){return typeof window>"u"?1:(t.ownerDocument.defaultView||window).devicePixelRatio||1}function Pf(t,e){const r=Jd(t);return Math.round(e*r)/r}function sl(t){const e=v.useRef(t);return Sa(()=>{e.current=t}),e}function $_(t){t===void 0&&(t={});const{placement:e="bottom",strategy:r="absolute",middleware:n=[],platform:i,elements:{reference:s,floating:a}={},transform:o=!0,whileElementsMounted:l,open:c}=t,[u,f]=v.useState({x:0,y:0,strategy:r,placement:e,middlewareData:{},isPositioned:!1}),[d,h]=v.useState(n);ja(d,n)||h(n);const[m,p]=v.useState(null),[g,w]=v.useState(null),b=v.useCallback(he=>{he!==M.current&&(M.current=he,p(he))},[]),_=v.useCallback(he=>{he!==I.current&&(I.current=he,w(he))},[]),k=s||m,L=a||g,M=v.useRef(null),I=v.useRef(null),F=v.useRef(u),R=l!=null,N=sl(l),H=sl(i),q=sl(c),Y=v.useCallback(()=>{if(!M.current||!I.current)return;const he={placement:e,strategy:r,middleware:d};H.current&&(he.platform=H.current),L_(M.current,I.current,he).then(Q=>{const _e={...Q,isPositioned:q.current!==!1};fe.current&&!ja(F.current,_e)&&(F.current=_e,Dr.flushSync(()=>{f(_e)}))})},[d,e,r,H,q]);Sa(()=>{c===!1&&F.current.isPositioned&&(F.current.isPositioned=!1,f(he=>({...he,isPositioned:!1})))},[c]);const fe=v.useRef(!1);Sa(()=>(fe.current=!0,()=>{fe.current=!1}),[]),Sa(()=>{if(k&&(M.current=k),L&&(I.current=L),k&&L){if(N.current)return N.current(k,L,Y);Y()}},[k,L,Y,N,R]);const ue=v.useMemo(()=>({reference:M,floating:I,setReference:b,setFloating:_}),[b,_]),we=v.useMemo(()=>({reference:k,floating:L}),[k,L]),xe=v.useMemo(()=>{const he={position:r,left:0,top:0};if(!we.floating)return he;const Q=Pf(we.floating,u.x),_e=Pf(we.floating,u.y);return o?{...he,transform:"translate("+Q+"px, "+_e+"px)",...Jd(we.floating)>=1.5&&{willChange:"transform"}}:{position:r,left:Q,top:_e}},[r,o,we.floating,u.x,u.y]);return v.useMemo(()=>({...u,update:Y,refs:ue,elements:we,floatingStyles:xe}),[u,Y,ue,we,xe])}const Qd=(t,e)=>({...P_(t),options:[t,e]}),B_=(t,e)=>({...F_(t),options:[t,e]}),U_=(t,e)=>({...N_(t),options:[t,e]}),H_=(t,e)=>({...D_(t),options:[t,e]}),Zd={...Nl},W_=Zd.useInsertionEffect,V_=W_||(t=>t());function ep(t){const e=v.useRef(()=>{});return V_(()=>{e.current=t}),v.useCallback(function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return e.current==null?void 0:e.current(...n)},[])}var tc=typeof document<"u"?v.useLayoutEffect:v.useEffect;let Ff=!1,G_=0;const Nf=()=>"floating-ui-"+Math.random().toString(36).slice(2,6)+G_++;function z_(){const[t,e]=v.useState(()=>Ff?Nf():void 0);return tc(()=>{t==null&&e(Nf())},[]),v.useEffect(()=>{Ff=!0},[]),t}const q_=Zd.useId,K_=q_||z_;function X_(){const t=new Map;return{emit(e,r){var n;(n=t.get(e))==null||n.forEach(i=>i(r))},on(e,r){t.set(e,[...t.get(e)||[],r])},off(e,r){var n;t.set(e,((n=t.get(e))==null?void 0:n.filter(i=>i!==r))||[])}}}const Y_=v.createContext(null),J_=v.createContext(null),Q_=()=>{var t;return((t=v.useContext(Y_))==null?void 0:t.id)||null},Z_=()=>v.useContext(J_),eE="data-floating-ui-focusable";function tE(t){const{open:e=!1,onOpenChange:r,elements:n}=t,i=K_(),s=v.useRef({}),[a]=v.useState(()=>X_()),o=Q_()!=null,[l,c]=v.useState(n.reference),u=ep((h,m,p)=>{s.current.openEvent=h?m:void 0,a.emit("openchange",{open:h,event:m,reason:p,nested:o}),r==null||r(h,m,p)}),f=v.useMemo(()=>({setPositionReference:c}),[]),d=v.useMemo(()=>({reference:l||n.reference||null,floating:n.floating||null,domReference:n.reference}),[l,n.reference,n.floating]);return v.useMemo(()=>({dataRef:s,open:e,onOpenChange:u,elements:d,events:a,floatingId:i,refs:f}),[e,u,d,a,i,f])}function rE(t){t===void 0&&(t={});const{nodeId:e}=t,r=tE({...t,elements:{reference:null,floating:null,...t.elements}}),n=t.rootContext||r,i=n.elements,[s,a]=v.useState(null),[o,l]=v.useState(null),u=(i==null?void 0:i.domReference)||s,f=v.useRef(null),d=Z_();tc(()=>{u&&(f.current=u)},[u]);const h=$_({...t,elements:{...i,...o&&{reference:o}}}),m=v.useCallback(_=>{const k=wt(_)?{getBoundingClientRect:()=>_.getBoundingClientRect(),contextElement:_}:_;l(k),h.refs.setReference(k)},[h.refs]),p=v.useCallback(_=>{(wt(_)||_===null)&&(f.current=_,a(_)),(wt(h.refs.reference.current)||h.refs.reference.current===null||_!==null&&!wt(_))&&h.refs.setReference(_)},[h.refs]),g=v.useMemo(()=>({...h.refs,setReference:p,setPositionReference:m,domReference:f}),[h.refs,p,m]),w=v.useMemo(()=>({...h.elements,domReference:u}),[h.elements,u]),b=v.useMemo(()=>({...h,...n,refs:g,elements:w,nodeId:e}),[h,g,w,e,n]);return tc(()=>{n.dataRef.current.floatingContext=b;const _=d==null?void 0:d.nodesRef.current.find(k=>k.id===e);_&&(_.context=b)}),v.useMemo(()=>({...h,context:b,refs:g,elements:w}),[h,g,w,b])}const Df="active",Lf="selected";function al(t,e,r){const n=new Map,i=r==="item";let s=t;if(i&&t){const{[Df]:a,[Lf]:o,...l}=t;s=l}return{...r==="floating"&&{tabIndex:-1,[eE]:""},...s,...e.map(a=>{const o=a?a[r]:null;return typeof o=="function"?t?o(t):null:o}).concat(t).reduce((a,o)=>(o&&Object.entries(o).forEach(l=>{let[c,u]=l;if(!(i&&[Df,Lf].includes(c)))if(c.indexOf("on")===0){if(n.has(c)||n.set(c,[]),typeof u=="function"){var f;(f=n.get(c))==null||f.push(u),a[c]=function(){for(var d,h=arguments.length,m=new Array(h),p=0;p<h;p++)m[p]=arguments[p];return(d=n.get(c))==null?void 0:d.map(g=>g(...m)).find(g=>g!==void 0)}}}else a[c]=u}),a),{})}}function nE(t){t===void 0&&(t=[]);const e=t.map(o=>o==null?void 0:o.reference),r=t.map(o=>o==null?void 0:o.floating),n=t.map(o=>o==null?void 0:o.item),i=v.useCallback(o=>al(o,t,"reference"),e),s=v.useCallback(o=>al(o,t,"floating"),r),a=v.useCallback(o=>al(o,t,"item"),n);return v.useMemo(()=>({getReferenceProps:i,getFloatingProps:s,getItemProps:a}),[i,s,a])}function Mf(t,e){return{...t,rects:{...t.rects,floating:{...t.rects.floating,height:e}}}}const iE=t=>({name:"inner",options:t,async fn(e){const{listRef:r,overflowRef:n,onFallbackChange:i,offset:s=0,index:a=0,minItemsVisible:o=4,referenceOverflowThreshold:l=0,scrollRef:c,...u}=ji(t,e),{rects:f,elements:{floating:d}}=e,h=r.current[a],m=(c==null?void 0:c.current)||d,p=d.clientTop||m.clientTop,g=d.clientTop!==0,w=m.clientTop!==0,b=d===m;if(!h)return{};const _={...e,...await Qd(-h.offsetTop-d.clientTop-f.reference.height/2-h.offsetHeight/2-s).fn(e)},k=await il(Mf(_,m.scrollHeight+p+d.clientTop),u),L=await il(_,{...u,elementContext:"reference"}),M=pt(0,k.top),I=_.y+M,N=(m.scrollHeight>m.clientHeight?H=>H:Es)(pt(0,m.scrollHeight+(g&&b||w?p*2:0)-M-pt(0,k.bottom)));if(m.style.maxHeight=N+"px",m.scrollTop=M,i){const H=m.offsetHeight<h.offsetHeight*Hn(o,r.current.length)-1||L.top>=-l||L.bottom>=-l;Dr.flushSync(()=>i(H))}return n&&(n.current=await il(Mf({..._,y:I},m.offsetHeight+p+d.clientTop),u)),{y:I}}});function sE(t,e){const{open:r,elements:n}=t,{enabled:i=!0,overflowRef:s,scrollRef:a,onChange:o}=e,l=ep(o),c=v.useRef(!1),u=v.useRef(null),f=v.useRef(null);v.useEffect(()=>{if(!i)return;function h(p){if(p.ctrlKey||!m||s.current==null)return;const g=p.deltaY,w=s.current.top>=-.5,b=s.current.bottom>=-.5,_=m.scrollHeight-m.clientHeight,k=g<0?-1:1,L=g<0?"max":"min";m.scrollHeight<=m.clientHeight||(!w&&g>0||!b&&g<0?(p.preventDefault(),Dr.flushSync(()=>{l(M=>M+Math[L](g,_*k))})):/firefox/i.test(Yw())&&(m.scrollTop+=g))}const m=(a==null?void 0:a.current)||n.floating;if(r&&m)return m.addEventListener("wheel",h),requestAnimationFrame(()=>{u.current=m.scrollTop,s.current!=null&&(f.current={...s.current})}),()=>{u.current=null,f.current=null,m.removeEventListener("wheel",h)}},[i,r,n.floating,s,a,l]);const d=v.useMemo(()=>({onKeyDown(){c.current=!0},onWheel(){c.current=!1},onPointerMove(){c.current=!1},onScroll(){const h=(a==null?void 0:a.current)||n.floating;if(!(!s.current||!h||!c.current)){if(u.current!==null){const m=h.scrollTop-u.current;(s.current.bottom<-.5&&m<-1||s.current.top<-.5&&m>1)&&Dr.flushSync(()=>l(p=>p+m))}requestAnimationFrame(()=>{u.current=h.scrollTop})}}}),[n.floating,l,s,a]);return v.useMemo(()=>i?{floating:d}:{},[i,d])}let $i=v.createContext({styles:void 0,setReference:()=>{},setFloating:()=>{},getReferenceProps:()=>({}),getFloatingProps:()=>({}),slot:{}});$i.displayName="FloatingContext";let Wc=v.createContext(null);Wc.displayName="PlacementContext";function aE(t){return v.useMemo(()=>t?typeof t=="string"?{to:t}:t:null,[t])}function oE(){return v.useContext($i).setReference}function lE(){return v.useContext($i).getReferenceProps}function cE(){let{getFloatingProps:t,slot:e}=v.useContext($i);return v.useCallback((...r)=>Object.assign({},t(...r),{"data-anchor":e.anchor}),[t,e])}function uE(t=null){t===!1&&(t=null),typeof t=="string"&&(t={to:t});let e=v.useContext(Wc),r=v.useMemo(()=>t,[JSON.stringify(t,(i,s)=>{var a;return(a=s==null?void 0:s.outerHTML)!=null?a:s})]);Le(()=>{e==null||e(r??null)},[e,r]);let n=v.useContext($i);return v.useMemo(()=>[n.setFloating,t?n.styles:{}],[n.setFloating,t,n.styles])}let jf=4;function fE({children:t,enabled:e=!0}){let[r,n]=v.useState(null),[i,s]=v.useState(0),a=v.useRef(null),[o,l]=v.useState(null);hE(o);let c=e&&r!==null&&o!==null,{to:u="bottom",gap:f=0,offset:d=0,padding:h=0,inner:m}=dE(r,o),[p,g="center"]=u.split(" ");Le(()=>{c&&s(0)},[c]);let{refs:w,floatingStyles:b,context:_}=rE({open:c,placement:p==="selection"?g==="center"?"bottom":`bottom-${g}`:g==="center"?`${p}`:`${p}-${g}`,strategy:"absolute",transform:!1,middleware:[Qd({mainAxis:p==="selection"?0:f,crossAxis:d}),B_({padding:h}),p!=="selection"&&U_({padding:h}),p==="selection"&&m?iE({...m,padding:h,overflowRef:a,offset:i,minItemsVisible:jf,referenceOverflowThreshold:h,onFallbackChange(H){var q,Y;if(!H)return;let fe=_.elements.floating;if(!fe)return;let ue=parseFloat(getComputedStyle(fe).scrollPaddingBottom)||0,we=Math.min(jf,fe.childElementCount),xe=0,he=0;for(let Q of(Y=(q=_.elements.floating)==null?void 0:q.childNodes)!=null?Y:[])if(Hr(Q)){let _e=Q.offsetTop,Be=_e+Q.clientHeight+ue,O=fe.scrollTop,j=O+fe.clientHeight;if(_e>=O&&Be<=j)we--;else{he=Math.max(0,Math.min(Be,j)-Math.max(_e,O)),xe=Q.clientHeight;break}}we>=1&&s(Q=>{let _e=xe*we-he+ue;return Q>=_e?Q:_e})}}):null,H_({padding:h,apply({availableWidth:H,availableHeight:q,elements:Y}){Object.assign(Y.floating.style,{overflow:"auto",maxWidth:`${H}px`,maxHeight:`min(var(--anchor-max-height, 100vh), ${q}px)`})}})].filter(Boolean),whileElementsMounted:R_}),[k=p,L=g]=_.placement.split("-");p==="selection"&&(k="selection");let M=v.useMemo(()=>({anchor:[k,L].filter(Boolean).join(" ")}),[k,L]),I=sE(_,{overflowRef:a,onChange:s}),{getReferenceProps:F,getFloatingProps:R}=nE([I]),N=ge(H=>{l(H),w.setFloating(H)});return v.createElement(Wc.Provider,{value:n},v.createElement($i.Provider,{value:{setFloating:N,setReference:w.setReference,styles:b,getReferenceProps:F,getFloatingProps:R,slot:M}},t))}function hE(t){Le(()=>{if(!t)return;let e=new MutationObserver(()=>{let r=window.getComputedStyle(t).maxHeight,n=parseFloat(r);if(isNaN(n))return;let i=parseInt(r);isNaN(i)||n!==i&&(t.style.maxHeight=`${Math.ceil(n)}px`)});return e.observe(t,{attributes:!0,attributeFilter:["style"]}),()=>{e.disconnect()}},[t])}function dE(t,e){var r,n,i;let s=ol((r=t==null?void 0:t.gap)!=null?r:"var(--anchor-gap, 0)",e),a=ol((n=t==null?void 0:t.offset)!=null?n:"var(--anchor-offset, 0)",e),o=ol((i=t==null?void 0:t.padding)!=null?i:"var(--anchor-padding, 0)",e);return{...t,gap:s,offset:a,padding:o}}function ol(t,e,r=void 0){let n=Ls(),i=ge((l,c)=>{if(l==null)return[r,null];if(typeof l=="number")return[l,null];if(typeof l=="string"){if(!c)return[r,null];let u=$f(l,c);return[u,f=>{let d=tp(l);{let h=d.map(m=>window.getComputedStyle(c).getPropertyValue(m));n.requestAnimationFrame(function m(){n.nextFrame(m);let p=!1;for(let[w,b]of d.entries()){let _=window.getComputedStyle(c).getPropertyValue(b);if(h[w]!==_){h[w]=_,p=!0;break}}if(!p)return;let g=$f(l,c);u!==g&&(f(g),u=g)})}return n.dispose}]}return[r,null]}),s=v.useMemo(()=>i(t,e)[0],[t,e]),[a=s,o]=v.useState();return Le(()=>{let[l,c]=i(t,e);if(o(l),!!c)return c(o)},[t,e]),a}function tp(t){let e=/var\((.*)\)/.exec(t);if(e){let r=e[1].indexOf(",");if(r===-1)return[e[1]];let n=e[1].slice(0,r).trim(),i=e[1].slice(r+1).trim();return i?[n,...tp(i)]:[n]}return[]}function $f(t,e){let r=document.createElement("div");e.appendChild(r),r.style.setProperty("margin-top","0px","important"),r.style.setProperty("margin-top",t,"important");let n=parseFloat(window.getComputedStyle(r).marginTop)||0;return e.removeChild(r),n}let _o=v.createContext(null);_o.displayName="OpenClosedContext";var _t=(t=>(t[t.Open=1]="Open",t[t.Closed=2]="Closed",t[t.Closing=4]="Closing",t[t.Opening=8]="Opening",t))(_t||{});function Eo(){return v.useContext(_o)}function Vc({value:t,children:e}){return ve.createElement(_o.Provider,{value:t},e)}function pE({children:t}){return ve.createElement(_o.Provider,{value:null},t)}function mE(t){throw new Error("Unexpected object: "+t)}var Ge=(t=>(t[t.First=0]="First",t[t.Previous=1]="Previous",t[t.Next=2]="Next",t[t.Last=3]="Last",t[t.Specific=4]="Specific",t[t.Nothing=5]="Nothing",t))(Ge||{});function ca(t,e){let r=e.resolveItems();if(r.length<=0)return null;let n=e.resolveActiveIndex(),i=n??-1;switch(t.focus){case 0:{for(let s=0;s<r.length;++s)if(!e.resolveDisabled(r[s],s,r))return s;return n}case 1:{i===-1&&(i=r.length);for(let s=i-1;s>=0;--s)if(!e.resolveDisabled(r[s],s,r))return s;return n}case 2:{for(let s=i+1;s<r.length;++s)if(!e.resolveDisabled(r[s],s,r))return s;return n}case 3:{for(let s=r.length-1;s>=0;--s)if(!e.resolveDisabled(r[s],s,r))return s;return n}case 4:{for(let s=0;s<r.length;++s)if(e.resolveId(r[s],s,r)===t.id)return s;return n}case 5:return null;default:mE(t)}}function rp(t){let e=ge(t),r=v.useRef(!1);v.useEffect(()=>(r.current=!1,()=>{r.current=!0,md(()=>{r.current&&e()})}),[e])}function gE(){let t=typeof document>"u";return"useSyncExternalStore"in Nl?(e=>e.useSyncExternalStore)(Nl)(()=>()=>{},()=>!1,()=>!t):!1}function Gc(){let t=gE(),[e,r]=v.useState($n.isHandoffComplete);return e&&$n.isHandoffComplete===!1&&r(!1),v.useEffect(()=>{e!==!0&&r(!0)},[e]),v.useEffect(()=>$n.handoff(),[]),t?!1:e}let vE=v.createContext(!1);function xE(){return v.useContext(vE)}function yE(t){let e=xE(),r=v.useContext(ip),[n,i]=v.useState(()=>{var s;if(!e&&r!==null)return(s=r.current)!=null?s:null;if($n.isServer)return null;let a=t==null?void 0:t.getElementById("headlessui-portal-root");if(a)return a;if(t===null)return null;let o=t.createElement("div");return o.setAttribute("id","headlessui-portal-root"),t.body.appendChild(o)});return v.useEffect(()=>{n!==null&&(t!=null&&t.body.contains(n)||t==null||t.body.appendChild(n))},[n,t]),v.useEffect(()=>{e||r!==null&&i(r.current)},[r,i,e]),n}let np=v.Fragment,wE=rt(function(t,e){let{ownerDocument:r=null,...n}=t,i=v.useRef(null),s=Ot(bd(h=>{i.current=h}),e),a=Ql(i),o=r??a,l=yE(o),[c]=v.useState(()=>{var h;return $n.isServer?null:(h=o==null?void 0:o.createElement("div"))!=null?h:null}),u=v.useContext(TE),f=Gc();Le(()=>{!l||!c||l.contains(c)||(c.setAttribute("data-headlessui-portal",""),l.appendChild(c))},[l,c]),Le(()=>{if(c&&u)return u.register(c)},[u,c]),rp(()=>{var h;!l||!c||(Rc(c)&&l.contains(c)&&l.removeChild(c),l.childNodes.length<=0&&((h=l.parentElement)==null||h.removeChild(l)))});let d=ft();return f?!l||!c?null:Dr.createPortal(d({ourProps:{ref:s},theirProps:n,slot:{},defaultTag:np,name:"Portal"}),c):null});function _E(t,e){let r=Ot(e),{enabled:n=!0,ownerDocument:i,...s}=t,a=ft();return n?ve.createElement(wE,{...s,ownerDocument:i,ref:r}):a({ourProps:{ref:r},theirProps:s,slot:{},defaultTag:np,name:"Portal"})}let EE=v.Fragment,ip=v.createContext(null);function bE(t,e){let{target:r,...n}=t,i={ref:Ot(e)},s=ft();return ve.createElement(ip.Provider,{value:r},s({ourProps:i,theirProps:n,defaultTag:EE,name:"Popover.Group"}))}let TE=v.createContext(null),SE=rt(_E),AE=rt(bE),CE=Object.assign(SE,{Group:AE});function IE(){let t=v.useRef(!1);return Le(()=>(t.current=!0,()=>{t.current=!1}),[]),t}function sp(t){var e;return!!(t.enter||t.enterFrom||t.enterTo||t.leave||t.leaveFrom||t.leaveTo)||((e=t.as)!=null?e:op)!==v.Fragment||ve.Children.count(t.children)===1}let bo=v.createContext(null);bo.displayName="TransitionContext";var kE=(t=>(t.Visible="visible",t.Hidden="hidden",t))(kE||{});function OE(){let t=v.useContext(bo);if(t===null)throw new Error("A <Transition.Child /> is used but it is missing a parent <Transition /> or <Transition.Root />.");return t}function RE(){let t=v.useContext(To);if(t===null)throw new Error("A <Transition.Child /> is used but it is missing a parent <Transition /> or <Transition.Root />.");return t}let To=v.createContext(null);To.displayName="NestingContext";function So(t){return"children"in t?So(t.children):t.current.filter(({el:e})=>e.current!==null).filter(({state:e})=>e==="visible").length>0}function ap(t,e){let r=Li(t),n=v.useRef([]),i=IE(),s=Ls(),a=ge((h,m=nn.Hidden)=>{let p=n.current.findIndex(({el:g})=>g===h);p!==-1&&(nr(m,{[nn.Unmount](){n.current.splice(p,1)},[nn.Hidden](){n.current[p].state="hidden"}}),s.microTask(()=>{var g;!So(n)&&i.current&&((g=r.current)==null||g.call(r))}))}),o=ge(h=>{let m=n.current.find(({el:p})=>p===h);return m?m.state!=="visible"&&(m.state="visible"):n.current.push({el:h,state:"visible"}),()=>a(h,nn.Unmount)}),l=v.useRef([]),c=v.useRef(Promise.resolve()),u=v.useRef({enter:[],leave:[]}),f=ge((h,m,p)=>{l.current.splice(0),e&&(e.chains.current[m]=e.chains.current[m].filter(([g])=>g!==h)),e==null||e.chains.current[m].push([h,new Promise(g=>{l.current.push(g)})]),e==null||e.chains.current[m].push([h,new Promise(g=>{Promise.all(u.current[m].map(([w,b])=>b)).then(()=>g())})]),m==="enter"?c.current=c.current.then(()=>e==null?void 0:e.wait.current).then(()=>p(m)):p(m)}),d=ge((h,m,p)=>{Promise.all(u.current[m].splice(0).map(([g,w])=>w)).then(()=>{var g;(g=l.current.shift())==null||g()}).then(()=>p(m))});return v.useMemo(()=>({children:n,register:o,unregister:a,onStart:f,onStop:d,wait:c,chains:u}),[o,a,n,f,d,u,c])}let op=v.Fragment,lp=Oi.RenderStrategy;function PE(t,e){var r,n;let{transition:i=!0,beforeEnter:s,afterEnter:a,beforeLeave:o,afterLeave:l,enter:c,enterFrom:u,enterTo:f,entered:d,leave:h,leaveFrom:m,leaveTo:p,...g}=t,[w,b]=v.useState(null),_=v.useRef(null),k=sp(t),L=Ot(...k?[_,e,b]:e===null?[]:[e]),M=(r=g.unmount)==null||r?nn.Unmount:nn.Hidden,{show:I,appear:F,initial:R}=OE(),[N,H]=v.useState(I?"visible":"hidden"),q=RE(),{register:Y,unregister:fe}=q;Le(()=>Y(_),[Y,_]),Le(()=>{if(M===nn.Hidden&&_.current){if(I&&N!=="visible"){H("visible");return}return nr(N,{hidden:()=>fe(_),visible:()=>Y(_)})}},[N,_,Y,fe,I,M]);let ue=Gc();Le(()=>{if(k&&ue&&N==="visible"&&_.current===null)throw new Error("Did you forget to passthrough the `ref` to the actual DOM node?")},[_,N,ue,k]);let we=R&&!F,xe=F&&I&&R,he=v.useRef(!1),Q=ap(()=>{he.current||(H("hidden"),fe(_))},q),_e=ge(oe=>{he.current=!0;let ce=oe?"enter":"leave";Q.onStart(_,ce,se=>{se==="enter"?s==null||s():se==="leave"&&(o==null||o())})}),Be=ge(oe=>{let ce=oe?"enter":"leave";he.current=!1,Q.onStop(_,ce,se=>{se==="enter"?a==null||a():se==="leave"&&(l==null||l())}),ce==="leave"&&!So(Q)&&(H("hidden"),fe(_))});v.useEffect(()=>{k&&i||(_e(I),Be(I))},[I,k,i]);let O=(()=>!(!i||!k||!ue||we))(),[,j]=jc(O,w,I,{start:_e,end:Be}),D=Cn({ref:L,className:((n=Kl(g.className,xe&&c,xe&&u,j.enter&&c,j.enter&&j.closed&&u,j.enter&&!j.closed&&f,j.leave&&h,j.leave&&!j.closed&&m,j.leave&&j.closed&&p,!j.transition&&I&&d))==null?void 0:n.trim())||void 0,...Mc(j)}),P=0;N==="visible"&&(P|=_t.Open),N==="hidden"&&(P|=_t.Closed),I&&N==="hidden"&&(P|=_t.Opening),!I&&N==="visible"&&(P|=_t.Closing);let X=ft();return ve.createElement(To.Provider,{value:Q},ve.createElement(Vc,{value:P},X({ourProps:D,theirProps:g,defaultTag:op,features:lp,visible:N==="visible",name:"Transition.Child"})))}function FE(t,e){let{show:r,appear:n=!1,unmount:i=!0,...s}=t,a=v.useRef(null),o=sp(t),l=Ot(...o?[a,e]:e===null?[]:[e]);Gc();let c=Eo();if(r===void 0&&c!==null&&(r=(c&_t.Open)===_t.Open),r===void 0)throw new Error("A <Transition /> is used but it is missing a `show={true | false}` prop.");let[u,f]=v.useState(r?"visible":"hidden"),d=ap(()=>{r||f("hidden")}),[h,m]=v.useState(!0),p=v.useRef([r]);Le(()=>{h!==!1&&p.current[p.current.length-1]!==r&&(p.current.push(r),m(!1))},[p,r]);let g=v.useMemo(()=>({show:r,appear:n,initial:h}),[r,n,h]);Le(()=>{r?f("visible"):!So(d)&&a.current!==null&&f("hidden")},[r,d]);let w={unmount:i},b=ge(()=>{var L;h&&m(!1),(L=t.beforeEnter)==null||L.call(t)}),_=ge(()=>{var L;h&&m(!1),(L=t.beforeLeave)==null||L.call(t)}),k=ft();return ve.createElement(To.Provider,{value:d},ve.createElement(bo.Provider,{value:g},k({ourProps:{...w,as:v.Fragment,children:ve.createElement(cp,{ref:l,...w,...s,beforeEnter:b,beforeLeave:_})},theirProps:{},defaultTag:v.Fragment,features:lp,visible:u==="visible",name:"Transition"})))}function NE(t,e){let r=v.useContext(bo)!==null,n=Eo()!==null;return ve.createElement(ve.Fragment,null,!r&&n?ve.createElement(rc,{ref:e,...t}):ve.createElement(cp,{ref:e,...t}))}let rc=rt(FE),cp=rt(PE),DE=rt(NE),LE=Object.assign(rc,{Child:DE,Root:rc});var Bf;let ME=(Bf=ve.startTransition)!=null?Bf:function(t){t()};var jE=(t=>(t[t.Open=0]="Open",t[t.Closed=1]="Closed",t))(jE||{}),$E=(t=>(t[t.ToggleDisclosure=0]="ToggleDisclosure",t[t.CloseDisclosure=1]="CloseDisclosure",t[t.SetButtonId=2]="SetButtonId",t[t.SetPanelId=3]="SetPanelId",t[t.SetButtonElement=4]="SetButtonElement",t[t.SetPanelElement=5]="SetPanelElement",t))($E||{});let BE={0:t=>({...t,disclosureState:nr(t.disclosureState,{0:1,1:0})}),1:t=>t.disclosureState===1?t:{...t,disclosureState:1},2(t,e){return t.buttonId===e.buttonId?t:{...t,buttonId:e.buttonId}},3(t,e){return t.panelId===e.panelId?t:{...t,panelId:e.panelId}},4(t,e){return t.buttonElement===e.element?t:{...t,buttonElement:e.element}},5(t,e){return t.panelElement===e.element?t:{...t,panelElement:e.element}}},zc=v.createContext(null);zc.displayName="DisclosureContext";function qc(t){let e=v.useContext(zc);if(e===null){let r=new Error(`<${t} /> is missing a parent <Disclosure /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(r,qc),r}return e}let Kc=v.createContext(null);Kc.displayName="DisclosureAPIContext";function up(t){let e=v.useContext(Kc);if(e===null){let r=new Error(`<${t} /> is missing a parent <Disclosure /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(r,up),r}return e}let Xc=v.createContext(null);Xc.displayName="DisclosurePanelContext";function UE(){return v.useContext(Xc)}function HE(t,e){return nr(e.type,BE,t,e)}let WE=v.Fragment;function VE(t,e){let{defaultOpen:r=!1,...n}=t,i=v.useRef(null),s=Ot(e,bd(p=>{i.current=p},t.as===void 0||t.as===v.Fragment)),a=v.useReducer(HE,{disclosureState:r?0:1,buttonElement:null,panelElement:null,buttonId:null,panelId:null}),[{disclosureState:o,buttonId:l},c]=a,u=ge(p=>{c({type:1});let g=Qn(i);if(!g||!l)return;let w=(()=>p?Sr(p)?p:"current"in p&&Sr(p.current)?p.current:g.getElementById(l):g.getElementById(l))();w==null||w.focus()}),f=v.useMemo(()=>({close:u}),[u]),d=v.useMemo(()=>({open:o===0,close:u}),[o,u]),h={ref:s},m=ft();return ve.createElement(zc.Provider,{value:a},ve.createElement(Kc.Provider,{value:f},ve.createElement(Wy,{value:u},ve.createElement(Vc,{value:nr(o,{0:_t.Open,1:_t.Closed})},m({ourProps:h,theirProps:n,slot:d,defaultTag:WE,name:"Disclosure"})))))}let GE="button";function zE(t,e){let r=v.useId(),{id:n=`headlessui-disclosure-button-${r}`,disabled:i=!1,autoFocus:s=!1,...a}=t,[o,l]=qc("Disclosure.Button"),c=UE(),u=c===null?!1:c===o.panelId,f=v.useRef(null),d=Ot(f,e,ge(R=>{if(!u)return l({type:4,element:R})}));v.useEffect(()=>{if(!u)return l({type:2,buttonId:n}),()=>{l({type:2,buttonId:null})}},[n,l,u]);let h=ge(R=>{var N;if(u){if(o.disclosureState===1)return;switch(R.key){case He.Space:case He.Enter:R.preventDefault(),R.stopPropagation(),l({type:0}),(N=o.buttonElement)==null||N.focus();break}}else switch(R.key){case He.Space:case He.Enter:R.preventDefault(),R.stopPropagation(),l({type:0});break}}),m=ge(R=>{switch(R.key){case He.Space:R.preventDefault();break}}),p=ge(R=>{var N;_d(R.currentTarget)||i||(u?(l({type:0}),(N=o.buttonElement)==null||N.focus()):l({type:0}))}),{isFocusVisible:g,focusProps:w}=pd({autoFocus:s}),{isHovered:b,hoverProps:_}=dd({isDisabled:i}),{pressed:k,pressProps:L}=gd({disabled:i}),M=v.useMemo(()=>({open:o.disclosureState===0,hover:b,active:k,disabled:i,focus:g,autofocus:s}),[o,b,k,g,i,s]),I=$d(t,o.buttonElement),F=Da(u?{ref:d,type:I,disabled:i||void 0,autoFocus:s,onKeyDown:h,onClick:p}:{ref:d,id:n,type:I,"aria-expanded":o.disclosureState===0,"aria-controls":o.panelElement?o.panelId:void 0,disabled:i||void 0,autoFocus:s,onKeyDown:h,onKeyUp:m,onClick:p},w,_,L);return ft()({ourProps:F,theirProps:a,slot:M,defaultTag:GE,name:"Disclosure.Button"})}let qE="div",KE=Oi.RenderStrategy|Oi.Static;function XE(t,e){let r=v.useId(),{id:n=`headlessui-disclosure-panel-${r}`,transition:i=!1,...s}=t,[a,o]=qc("Disclosure.Panel"),{close:l}=up("Disclosure.Panel"),[c,u]=v.useState(null),f=Ot(e,ge(b=>{ME(()=>o({type:5,element:b}))}),u);v.useEffect(()=>(o({type:3,panelId:n}),()=>{o({type:3,panelId:null})}),[n,o]);let d=Eo(),[h,m]=jc(i,c,d!==null?(d&_t.Open)===_t.Open:a.disclosureState===0),p=v.useMemo(()=>({open:a.disclosureState===0,close:l}),[a.disclosureState,l]),g={ref:f,id:n,...Mc(m)},w=ft();return ve.createElement(pE,null,ve.createElement(Xc.Provider,{value:a.panelId},w({ourProps:g,theirProps:s,slot:p,defaultTag:qE,features:KE,visible:h,name:"Disclosure.Panel"})))}let YE=rt(VE),JE=rt(zE),QE=rt(XE),Tn=Object.assign(YE,{Button:JE,Panel:QE});function ZE(t,e){let r=v.useRef({left:0,top:0});if(Le(()=>{if(!e)return;let i=e.getBoundingClientRect();i&&(r.current=i)},[t,e]),e==null||!t||e===document.activeElement)return!1;let n=e.getBoundingClientRect();return n.top!==r.current.top||n.left!==r.current.left}let Uf=/([\u2700-\u27BF]|[\uE000-\uF8FF]|\uD83C[\uDC00-\uDFFF]|\uD83D[\uDC00-\uDFFF]|[\u2011-\u26FF]|\uD83E[\uDD10-\uDDFF])/g;function Hf(t){var e,r;let n=(e=t.innerText)!=null?e:"",i=t.cloneNode(!0);if(!Hr(i))return n;let s=!1;for(let o of i.querySelectorAll('[hidden],[aria-hidden],[role="img"]'))o.remove(),s=!0;let a=s?(r=i.innerText)!=null?r:"":n;return Uf.test(a)&&(a=a.replace(Uf,"")),a}function e2(t){let e=t.getAttribute("aria-label");if(typeof e=="string")return e.trim();let r=t.getAttribute("aria-labelledby");if(r){let n=r.split(" ").map(i=>{let s=document.getElementById(i);if(s){let a=s.getAttribute("aria-label");return typeof a=="string"?a.trim():Hf(s).trim()}return null}).filter(Boolean);if(n.length>0)return n.join(", ")}return Hf(t).trim()}function t2(t){let e=v.useRef(""),r=v.useRef("");return ge(()=>{let n=t.current;if(!n)return"";let i=n.innerText;if(e.current===i)return r.current;let s=e2(n).trim().toLowerCase();return e.current=i,r.current=s,s})}var r2=Object.defineProperty,n2=(t,e,r)=>e in t?r2(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Wf=(t,e,r)=>(n2(t,typeof e!="symbol"?e+"":e,r),r),st=(t=>(t[t.Open=0]="Open",t[t.Closed=1]="Closed",t))(st||{}),$a=(t=>(t[t.Pointer=0]="Pointer",t[t.Other=1]="Other",t))($a||{}),Re=(t=>(t[t.OpenMenu=0]="OpenMenu",t[t.CloseMenu=1]="CloseMenu",t[t.GoToItem=2]="GoToItem",t[t.Search=3]="Search",t[t.ClearSearch=4]="ClearSearch",t[t.RegisterItems=5]="RegisterItems",t[t.UnregisterItems=6]="UnregisterItems",t[t.SetButtonElement=7]="SetButtonElement",t[t.SetItemsElement=8]="SetItemsElement",t[t.SortItems=9]="SortItems",t))(Re||{});function Vf(t,e=r=>r){let r=t.activeItemIndex!==null?t.items[t.activeItemIndex]:null,n=Md(e(t.items.slice()),s=>s.dataRef.current.domRef.current),i=r?n.indexOf(r):null;return i===-1&&(i=null),{items:n,activeItemIndex:i}}let i2={1(t){return t.menuState===1?t:{...t,activeItemIndex:null,pendingFocus:{focus:Ge.Nothing},menuState:1}},0(t,e){return t.menuState===0?t:{...t,__demoMode:!1,pendingFocus:e.focus,menuState:0}},2:(t,e)=>{var r,n,i,s,a;if(t.menuState===1)return t;let o={...t,searchQuery:"",activationTrigger:(r=e.trigger)!=null?r:1,__demoMode:!1};if(e.focus===Ge.Nothing)return{...o,activeItemIndex:null};if(e.focus===Ge.Specific)return{...o,activeItemIndex:t.items.findIndex(u=>u.id===e.id)};if(e.focus===Ge.Previous){let u=t.activeItemIndex;if(u!==null){let f=t.items[u].dataRef.current.domRef,d=ca(e,{resolveItems:()=>t.items,resolveActiveIndex:()=>t.activeItemIndex,resolveId:h=>h.id,resolveDisabled:h=>h.dataRef.current.disabled});if(d!==null){let h=t.items[d].dataRef.current.domRef;if(((n=f.current)==null?void 0:n.previousElementSibling)===h.current||((i=h.current)==null?void 0:i.previousElementSibling)===null)return{...o,activeItemIndex:d}}}}else if(e.focus===Ge.Next){let u=t.activeItemIndex;if(u!==null){let f=t.items[u].dataRef.current.domRef,d=ca(e,{resolveItems:()=>t.items,resolveActiveIndex:()=>t.activeItemIndex,resolveId:h=>h.id,resolveDisabled:h=>h.dataRef.current.disabled});if(d!==null){let h=t.items[d].dataRef.current.domRef;if(((s=f.current)==null?void 0:s.nextElementSibling)===h.current||((a=h.current)==null?void 0:a.nextElementSibling)===null)return{...o,activeItemIndex:d}}}}let l=Vf(t),c=ca(e,{resolveItems:()=>l.items,resolveActiveIndex:()=>l.activeItemIndex,resolveId:u=>u.id,resolveDisabled:u=>u.dataRef.current.disabled});return{...o,...l,activeItemIndex:c}},3:(t,e)=>{let r=t.searchQuery!==""?0:1,n=t.searchQuery+e.value.toLowerCase(),i=(t.activeItemIndex!==null?t.items.slice(t.activeItemIndex+r).concat(t.items.slice(0,t.activeItemIndex+r)):t.items).find(a=>{var o;return((o=a.dataRef.current.textValue)==null?void 0:o.startsWith(n))&&!a.dataRef.current.disabled}),s=i?t.items.indexOf(i):-1;return s===-1||s===t.activeItemIndex?{...t,searchQuery:n}:{...t,searchQuery:n,activeItemIndex:s,activationTrigger:1}},4(t){return t.searchQuery===""?t:{...t,searchQuery:"",searchActiveItemIndex:null}},5:(t,e)=>{let r=t.items.concat(e.items.map(i=>i)),n=t.activeItemIndex;return t.pendingFocus.focus!==Ge.Nothing&&(n=ca(t.pendingFocus,{resolveItems:()=>r,resolveActiveIndex:()=>t.activeItemIndex,resolveId:i=>i.id,resolveDisabled:i=>i.dataRef.current.disabled})),{...t,items:r,activeItemIndex:n,pendingFocus:{focus:Ge.Nothing},pendingShouldSort:!0}},6:(t,e)=>{let r=t.items,n=[],i=new Set(e.items);for(let[s,a]of r.entries())if(i.has(a.id)&&(n.push(s),i.delete(a.id),i.size===0))break;if(n.length>0){r=r.slice();for(let s of n.reverse())r.splice(s,1)}return{...t,items:r,activationTrigger:1}},7:(t,e)=>t.buttonElement===e.element?t:{...t,buttonElement:e.element},8:(t,e)=>t.itemsElement===e.element?t:{...t,itemsElement:e.element},9:t=>t.pendingShouldSort?{...t,...Vf(t),pendingShouldSort:!1}:t};class Yc extends Id{constructor(e){super(e),Wf(this,"actions",{registerItem:gf(()=>{let r=[],n=new Set;return[(i,s)=>{n.has(s)||(n.add(s),r.push({id:i,dataRef:s}))},()=>(n.clear(),this.send({type:5,items:r.splice(0)}))]}),unregisterItem:gf(()=>{let r=[];return[n=>r.push(n),()=>this.send({type:6,items:r.splice(0)})]})}),Wf(this,"selectors",{activeDescendantId(r){var n;let i=r.activeItemIndex,s=r.items;return i===null||(n=s[i])==null?void 0:n.id},isActive(r,n){var i;let s=r.activeItemIndex,a=r.items;return s!==null?((i=a[s])==null?void 0:i.id)===n:!1},shouldScrollIntoView(r,n){return r.__demoMode||r.menuState!==0||r.activationTrigger===0?!1:this.isActive(r,n)}}),this.on(5,()=>{this.disposables.requestAnimationFrame(()=>{this.send({type:9})})});{let r=this.state.id,n=Nc.get(null);this.disposables.add(n.on(Od.Push,i=>{!n.selectors.isTop(i,r)&&this.state.menuState===0&&this.send({type:1})})),this.on(0,()=>n.actions.push(r)),this.on(1,()=>n.actions.pop(r))}}static new({id:e,__demoMode:r=!1}){return new Yc({id:e,__demoMode:r,menuState:r?0:1,buttonElement:null,itemsElement:null,items:[],searchQuery:"",activeItemIndex:null,activationTrigger:1,pendingShouldSort:!1,pendingFocus:{focus:Ge.Nothing}})}reduce(e,r){return nr(r.type,i2,e,r)}}const fp=v.createContext(null);function Jc(t){let e=v.useContext(fp);if(e===null){let r=new Error(`<${t} /> is missing a parent <Menu /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(r,hp),r}return e}function hp({id:t,__demoMode:e=!1}){let r=v.useMemo(()=>Yc.new({id:t,__demoMode:e}),[]);return rp(()=>r.dispose()),r}let s2=v.Fragment;function a2(t,e){let r=v.useId(),{__demoMode:n=!1,...i}=t,s=hp({id:r,__demoMode:n}),[a,o,l]=cr(s,g=>[g.menuState,g.itemsElement,g.buttonElement]),c=Ot(e),u=Nc.get(null),f=cr(u,v.useCallback(g=>u.selectors.isTop(g,r),[u,r]));Ew(f,[l,o],(g,w)=>{var b;s.send({type:Re.CloseMenu}),Lc(w,Dc.Loose)||(g.preventDefault(),(b=s.state.buttonElement)==null||b.focus())});let d=ge(()=>{s.send({type:Re.CloseMenu})}),h=v.useMemo(()=>({open:a===st.Open,close:d}),[a,d]),m={ref:c},p=ft();return ve.createElement(fE,null,ve.createElement(fp.Provider,{value:s},ve.createElement(Vc,{value:nr(a,{[st.Open]:_t.Open,[st.Closed]:_t.Closed})},p({ourProps:m,theirProps:i,slot:h,defaultTag:s2,name:"Menu"}))))}let o2="button";function l2(t,e){let r=Jc("Menu.Button"),n=v.useId(),{id:i=`headlessui-menu-button-${n}`,disabled:s=!1,autoFocus:a=!1,...o}=t,l=v.useRef(null),c=lE(),u=Ot(e,l,oE(),ge(N=>r.send({type:Re.SetButtonElement,element:N}))),f=ge(N=>{switch(N.key){case He.Space:case He.Enter:case He.ArrowDown:N.preventDefault(),N.stopPropagation(),r.send({type:Re.OpenMenu,focus:{focus:Ge.First}});break;case He.ArrowUp:N.preventDefault(),N.stopPropagation(),r.send({type:Re.OpenMenu,focus:{focus:Ge.Last}});break}}),d=ge(N=>{switch(N.key){case He.Space:N.preventDefault();break}}),[h,m,p]=cr(r,N=>[N.menuState,N.buttonElement,N.itemsElement]),g=h===st.Open;Sw(g,{trigger:m,action:v.useCallback(N=>{if(m!=null&&m.contains(N.target))return oa.Ignore;let H=N.target.closest('[role="menuitem"]:not([data-disabled])');return Hr(H)?oa.Select(H):p!=null&&p.contains(N.target)?oa.Ignore:oa.Close},[m,p]),close:v.useCallback(()=>r.send({type:Re.CloseMenu}),[]),select:v.useCallback(N=>N.click(),[])});let w=ge(N=>{var H;if(N.button===0){if(_d(N.currentTarget))return N.preventDefault();s||(h===st.Open?(Dr.flushSync(()=>r.send({type:Re.CloseMenu})),(H=l.current)==null||H.focus({preventScroll:!0})):(N.preventDefault(),r.send({type:Re.OpenMenu,focus:{focus:Ge.Nothing},trigger:$a.Pointer})))}}),{isFocusVisible:b,focusProps:_}=pd({autoFocus:a}),{isHovered:k,hoverProps:L}=dd({isDisabled:s}),{pressed:M,pressProps:I}=gd({disabled:s}),F=v.useMemo(()=>({open:h===st.Open,active:M||h===st.Open,disabled:s,hover:k,focus:b,autofocus:a}),[h,k,b,M,s,a]),R=Da(c(),{ref:u,id:i,type:$d(t,l.current),"aria-haspopup":"menu","aria-controls":p==null?void 0:p.id,"aria-expanded":h===st.Open,disabled:s||void 0,autoFocus:a,onKeyDown:f,onKeyUp:d,onPointerDown:w},_,L,I);return ft()({ourProps:R,theirProps:o,slot:F,defaultTag:o2,name:"Menu.Button"})}let c2="div",u2=Oi.RenderStrategy|Oi.Static;function f2(t,e){let r=v.useId(),{id:n=`headlessui-menu-items-${r}`,anchor:i,portal:s=!1,modal:a=!0,transition:o=!1,...l}=t,c=aE(i),u=Jc("Menu.Items"),[f,d]=uE(c),h=cE(),[m,p]=v.useState(null),g=Ot(e,c?f:null,ge(Q=>u.send({type:Re.SetItemsElement,element:Q})),p),[w,b]=cr(u,Q=>[Q.menuState,Q.buttonElement]),_=Ql(b),k=Ql(m);c&&(s=!0);let L=Eo(),[M,I]=jc(o,m,L!==null?(L&_t.Open)===_t.Open:w===st.Open);cw(M,b,()=>{u.send({type:Re.CloseMenu})});let F=cr(u,Q=>Q.__demoMode),R=F?!1:a&&w===st.Open;Fw(R,k);let N=F?!1:a&&w===st.Open;lw(N,{allowed:v.useCallback(()=>[b,m],[b,m])});let H=w!==st.Open,q=ZE(H,b)?!1:M;v.useEffect(()=>{let Q=m;Q&&w===st.Open&&Q!==(k==null?void 0:k.activeElement)&&Q.focus({preventScroll:!0})},[w,m,k]),Bw(w===st.Open,{container:m,accept(Q){return Q.getAttribute("role")==="menuitem"?NodeFilter.FILTER_REJECT:Q.hasAttribute("role")?NodeFilter.FILTER_SKIP:NodeFilter.FILTER_ACCEPT},walk(Q){Q.setAttribute("role","none")}});let Y=Ls(),fe=ge(Q=>{var _e,Be,O;switch(Y.dispose(),Q.key){case He.Space:if(u.state.searchQuery!=="")return Q.preventDefault(),Q.stopPropagation(),u.send({type:Re.Search,value:Q.key});case He.Enter:if(Q.preventDefault(),Q.stopPropagation(),u.state.activeItemIndex!==null){let{dataRef:j}=u.state.items[u.state.activeItemIndex];(Be=(_e=j.current)==null?void 0:_e.domRef.current)==null||Be.click()}u.send({type:Re.CloseMenu}),Ld(u.state.buttonElement);break;case He.ArrowDown:return Q.preventDefault(),Q.stopPropagation(),u.send({type:Re.GoToItem,focus:Ge.Next});case He.ArrowUp:return Q.preventDefault(),Q.stopPropagation(),u.send({type:Re.GoToItem,focus:Ge.Previous});case He.Home:case He.PageUp:return Q.preventDefault(),Q.stopPropagation(),u.send({type:Re.GoToItem,focus:Ge.First});case He.End:case He.PageDown:return Q.preventDefault(),Q.stopPropagation(),u.send({type:Re.GoToItem,focus:Ge.Last});case He.Escape:Q.preventDefault(),Q.stopPropagation(),Dr.flushSync(()=>u.send({type:Re.CloseMenu})),(O=u.state.buttonElement)==null||O.focus({preventScroll:!0});break;case He.Tab:Q.preventDefault(),Q.stopPropagation(),Dr.flushSync(()=>u.send({type:Re.CloseMenu})),xw(u.state.buttonElement,Q.shiftKey?Jl.Previous:Jl.Next);break;default:Q.key.length===1&&(u.send({type:Re.Search,value:Q.key}),Y.setTimeout(()=>u.send({type:Re.ClearSearch}),350));break}}),ue=ge(Q=>{switch(Q.key){case He.Space:Q.preventDefault();break}}),we=v.useMemo(()=>({open:w===st.Open}),[w]),xe=Da(c?h():{},{"aria-activedescendant":cr(u,u.selectors.activeDescendantId),"aria-labelledby":cr(u,Q=>{var _e;return(_e=Q.buttonElement)==null?void 0:_e.id}),id:n,onKeyDown:fe,onKeyUp:ue,role:"menu",tabIndex:w===st.Open?0:void 0,ref:g,style:{...l.style,...d,"--button-width":Gy(b,!0).width},...Mc(I)}),he=ft();return ve.createElement(CE,{enabled:s?t.static||M:!1,ownerDocument:_},he({ourProps:xe,theirProps:l,slot:we,defaultTag:c2,features:u2,visible:q,name:"Menu.Items"}))}let h2=v.Fragment;function d2(t,e){let r=v.useId(),{id:n=`headlessui-menu-item-${r}`,disabled:i=!1,...s}=t,a=Jc("Menu.Item"),o=cr(a,H=>a.selectors.isActive(H,n)),l=v.useRef(null),c=Ot(e,l),u=cr(a,H=>a.selectors.shouldScrollIntoView(H,n));Le(()=>{if(u)return Vt().requestAnimationFrame(()=>{var H,q;(q=(H=l.current)==null?void 0:H.scrollIntoView)==null||q.call(H,{block:"nearest"})})},[u,l]);let f=t2(l),d=v.useRef({disabled:i,domRef:l,get textValue(){return f()}});Le(()=>{d.current.disabled=i},[d,i]),Le(()=>(a.actions.registerItem(n,d),()=>a.actions.unregisterItem(n)),[d,n]);let h=ge(()=>{a.send({type:Re.CloseMenu})}),m=ge(H=>{if(i)return H.preventDefault();a.send({type:Re.CloseMenu}),Ld(a.state.buttonElement)}),p=ge(()=>{if(i)return a.send({type:Re.GoToItem,focus:Ge.Nothing});a.send({type:Re.GoToItem,focus:Ge.Specific,id:n})}),g=Nw(),w=ge(H=>{g.update(H),!i&&(o||a.send({type:Re.GoToItem,focus:Ge.Specific,id:n,trigger:$a.Pointer}))}),b=ge(H=>{g.wasMoved(H)&&(i||o||a.send({type:Re.GoToItem,focus:Ge.Specific,id:n,trigger:$a.Pointer}))}),_=ge(H=>{g.wasMoved(H)&&(i||o&&a.send({type:Re.GoToItem,focus:Ge.Nothing}))}),[k,L]=Sd(),[M,I]=Ny(),F=v.useMemo(()=>({active:o,focus:o,disabled:i,close:h}),[o,i,h]),R={id:n,ref:c,role:"menuitem",tabIndex:i===!0?void 0:-1,"aria-disabled":i===!0?!0:void 0,"aria-labelledby":k,"aria-describedby":M,disabled:void 0,onClick:m,onFocus:p,onPointerEnter:w,onMouseEnter:w,onPointerMove:b,onMouseMove:b,onPointerLeave:_,onMouseLeave:_},N=ft();return ve.createElement(L,null,ve.createElement(I,null,N({ourProps:R,theirProps:s,slot:F,defaultTag:h2,name:"Menu.Item"})))}let p2="div";function m2(t,e){let[r,n]=Sd(),i=t,s={ref:e,"aria-labelledby":r,role:"group"},a=ft();return ve.createElement(n,null,a({ourProps:s,theirProps:i,slot:{},defaultTag:p2,name:"Menu.Section"}))}let g2="header";function v2(t,e){let r=v.useId(),{id:n=`headlessui-menu-heading-${r}`,...i}=t,s=Fc();Le(()=>s.register(n),[n,s.register]);let a={id:n,ref:e,role:"presentation",...s.props};return ft()({ourProps:a,theirProps:i,slot:{},defaultTag:g2,name:"Menu.Heading"})}let x2="div";function y2(t,e){let r=t,n={ref:e,role:"separator"};return ft()({ourProps:n,theirProps:r,slot:{},defaultTag:x2,name:"Menu.Separator"})}let w2=rt(a2),_2=rt(l2),E2=rt(f2),b2=rt(d2),T2=rt(m2),S2=rt(v2),A2=rt(y2),ua=Object.assign(w2,{Button:_2,Items:E2,Item:b2,Section:T2,Heading:S2,Separator:A2});function C2({title:t,titleId:e,...r},n){return v.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":e},r),t?v.createElement("title",{id:e},t):null,v.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M10.5 19.5 3 12m0 0 7.5-7.5M3 12h18"}))}const I2=v.forwardRef(C2),Gf=I2;function k2({title:t,titleId:e,...r},n){return v.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":e},r),t?v.createElement("title",{id:e},t):null,v.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.75 6.75h16.5M3.75 12h16.5m-16.5 5.25h16.5"}))}const O2=v.forwardRef(k2),R2=O2;function P2({title:t,titleId:e,...r},n){return v.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":e},r),t?v.createElement("title",{id:e},t):null,v.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.75 21h16.5M4.5 3h15M5.25 3v18m13.5-18v18M9 6.75h1.5m-1.5 3h1.5m-1.5 3h1.5m3-6H15m-1.5 3H15m-1.5 3H15M9 21v-3.375c0-.621.504-1.125 1.125-1.125h3.75c.621 0 1.125.504 1.125 1.125V21"}))}const F2=v.forwardRef(P2),N2=F2;function D2({title:t,titleId:e,...r},n){return v.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":e},r),t?v.createElement("title",{id:e},t):null,v.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6.75 3v2.25M17.25 3v2.25M3 18.75V7.5a2.25 2.25 0 0 1 2.25-2.25h13.5A2.25 2.25 0 0 1 21 7.5v11.25m-18 0A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75m-18 0v-7.5A2.25 2.25 0 0 1 5.25 9h13.5A2.25 2.25 0 0 1 21 11.25v7.5"}))}const L2=v.forwardRef(D2),M2=L2;function j2({title:t,titleId:e,...r},n){return v.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":e},r),t?v.createElement("title",{id:e},t):null,v.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.5 14.25v-2.625a3.375 3.375 0 0 0-3.375-3.375h-1.5A1.125 1.125 0 0 1 13.5 7.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H8.25m.75 12 3 3m0 0 3-3m-3 3v-6m-1.5-9H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 0 0-9-9Z"}))}const $2=v.forwardRef(j2),B2=$2;function U2({title:t,titleId:e,...r},n){return v.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":e},r),t?v.createElement("title",{id:e},t):null,v.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 3c2.755 0 5.455.232 8.083.678.533.09.917.556.917 1.096v1.044a2.25 2.25 0 0 1-.659 1.591l-5.432 5.432a2.25 2.25 0 0 0-.659 1.591v2.927a2.25 2.25 0 0 1-1.244 2.013L9.75 21v-6.568a2.25 2.25 0 0 0-.659-1.591L3.659 7.409A2.25 2.25 0 0 1 3 5.818V4.774c0-.54.384-1.006.917-1.096A48.32 48.32 0 0 1 12 3Z"}))}const H2=v.forwardRef(U2),W2=H2;function V2({title:t,titleId:e,...r},n){return v.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":e},r),t?v.createElement("title",{id:e},t):null,v.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 21a9.004 9.004 0 0 0 8.716-6.747M12 21a9.004 9.004 0 0 1-8.716-6.747M12 21c2.485 0 4.5-4.03 4.5-9S14.485 3 12 3m0 18c-2.485 0-4.5-4.03-4.5-9S9.515 3 12 3m0 0a8.997 8.997 0 0 1 7.843 4.582M12 3a8.997 8.997 0 0 0-7.843 4.582m15.686 0A11.953 11.953 0 0 1 12 10.5c-2.998 0-5.74-1.1-7.843-2.918m15.686 0A8.959 8.959 0 0 1 21 12c0 .778-.099 1.533-.284 2.253m0 0A17.919 17.919 0 0 1 12 16.5c-3.162 0-6.133-.815-8.716-2.247m0 0A9.015 9.015 0 0 1 3 12c0-1.605.42-3.113 1.157-4.418"}))}const G2=v.forwardRef(V2),z2=G2;function q2({title:t,titleId:e,...r},n){return v.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":e},r),t?v.createElement("title",{id:e},t):null,v.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m21 21-5.197-5.197m0 0A7.5 7.5 0 1 0 5.196 5.196a7.5 7.5 0 0 0 10.607 10.607Z"}))}const K2=v.forwardRef(q2),X2=K2;function Y2({title:t,titleId:e,...r},n){return v.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":e},r),t?v.createElement("title",{id:e},t):null,v.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 10.5a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z"}),v.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.5 10.5c0 7.142-7.5 11.25-7.5 11.25S4.5 17.642 4.5 10.5a7.5 7.5 0 1 1 15 0Z"}))}const J2=v.forwardRef(Y2),Q2=J2;function Z2({title:t,titleId:e,...r},n){return v.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":e},r),t?v.createElement("title",{id:e},t):null,v.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18 18 6M6 6l12 12"}))}const eb=v.forwardRef(Z2),tb=eb;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dp=function(t){const e=[];let r=0;for(let n=0;n<t.length;n++){let i=t.charCodeAt(n);i<128?e[r++]=i:i<2048?(e[r++]=i>>6|192,e[r++]=i&63|128):(i&64512)===55296&&n+1<t.length&&(t.charCodeAt(n+1)&64512)===56320?(i=65536+((i&1023)<<10)+(t.charCodeAt(++n)&1023),e[r++]=i>>18|240,e[r++]=i>>12&63|128,e[r++]=i>>6&63|128,e[r++]=i&63|128):(e[r++]=i>>12|224,e[r++]=i>>6&63|128,e[r++]=i&63|128)}return e},rb=function(t){const e=[];let r=0,n=0;for(;r<t.length;){const i=t[r++];if(i<128)e[n++]=String.fromCharCode(i);else if(i>191&&i<224){const s=t[r++];e[n++]=String.fromCharCode((i&31)<<6|s&63)}else if(i>239&&i<365){const s=t[r++],a=t[r++],o=t[r++],l=((i&7)<<18|(s&63)<<12|(a&63)<<6|o&63)-65536;e[n++]=String.fromCharCode(55296+(l>>10)),e[n++]=String.fromCharCode(56320+(l&1023))}else{const s=t[r++],a=t[r++];e[n++]=String.fromCharCode((i&15)<<12|(s&63)<<6|a&63)}}return e.join("")},pp={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const r=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,n=[];for(let i=0;i<t.length;i+=3){const s=t[i],a=i+1<t.length,o=a?t[i+1]:0,l=i+2<t.length,c=l?t[i+2]:0,u=s>>2,f=(s&3)<<4|o>>4;let d=(o&15)<<2|c>>6,h=c&63;l||(h=64,a||(d=64)),n.push(r[u],r[f],r[d],r[h])}return n.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(dp(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):rb(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const r=e?this.charToByteMapWebSafe_:this.charToByteMap_,n=[];for(let i=0;i<t.length;){const s=r[t.charAt(i++)],o=i<t.length?r[t.charAt(i)]:0;++i;const c=i<t.length?r[t.charAt(i)]:64;++i;const f=i<t.length?r[t.charAt(i)]:64;if(++i,s==null||o==null||c==null||f==null)throw new nb;const d=s<<2|o>>4;if(n.push(d),c!==64){const h=o<<4&240|c>>2;if(n.push(h),f!==64){const m=c<<6&192|f;n.push(m)}}}return n},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class nb extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const ib=function(t){const e=dp(t);return pp.encodeByteArray(e,!0)},mp=function(t){return ib(t).replace(/\./g,"")},gp=function(t){try{return pp.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sb(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ab=()=>sb().__FIREBASE_DEFAULTS__,ob=()=>{if(typeof process>"u"||typeof process.env>"u")return;const t={}.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},lb=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&gp(t[1]);return e&&JSON.parse(e)},Qc=()=>{try{return ab()||ob()||lb()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},cb=t=>{var e,r;return(r=(e=Qc())===null||e===void 0?void 0:e.emulatorHosts)===null||r===void 0?void 0:r[t]},vp=()=>{var t;return(t=Qc())===null||t===void 0?void 0:t.config},xp=t=>{var e;return(e=Qc())===null||e===void 0?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ub=class{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}wrapCallback(e){return(r,n)=>{r?this.reject(r):this.resolve(n),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(r):e(r,n))}}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bt(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function fb(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(bt())}function hb(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function yp(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function db(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function pb(){const t=bt();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function wp(){try{return typeof indexedDB=="object"}catch{return!1}}function _p(){return new Promise((t,e)=>{try{let r=!0;const n="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(n);i.onsuccess=()=>{i.result.close(),r||self.indexedDB.deleteDatabase(n),t(!0)},i.onupgradeneeded=()=>{r=!1},i.onerror=()=>{var s;e(((s=i.error)===null||s===void 0?void 0:s.message)||"")}}catch(r){e(r)}})}function mb(){return!(typeof navigator>"u"||!navigator.cookieEnabled)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gb="FirebaseError";class vr extends Error{constructor(e,r,n){super(r),this.code=e,this.customData=n,this.name=gb,Object.setPrototypeOf(this,vr.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Zn.prototype.create)}}class Zn{constructor(e,r,n){this.service=e,this.serviceName=r,this.errors=n}create(e,...r){const n=r[0]||{},i=`${this.service}/${e}`,s=this.errors[e],a=s?vb(s,n):"Error",o=`${this.serviceName}: ${a} (${i}).`;return new vr(i,o,n)}}function vb(t,e){return t.replace(xb,(r,n)=>{const i=e[n];return i!=null?String(i):`<${n}?>`})}const xb=/\{\$([^}]+)}/g;function yb(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function bs(t,e){if(t===e)return!0;const r=Object.keys(t),n=Object.keys(e);for(const i of r){if(!n.includes(i))return!1;const s=t[i],a=e[i];if(zf(s)&&zf(a)){if(!bs(s,a))return!1}else if(s!==a)return!1}for(const i of n)if(!r.includes(i))return!1;return!0}function zf(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Bs(t){const e=[];for(const[r,n]of Object.entries(t))Array.isArray(n)?n.forEach(i=>{e.push(encodeURIComponent(r)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(r)+"="+encodeURIComponent(n));return e.length?"&"+e.join("&"):""}function ns(t){const e={};return t.replace(/^\?/,"").split("&").forEach(n=>{if(n){const[i,s]=n.split("=");e[decodeURIComponent(i)]=decodeURIComponent(s)}}),e}function is(t){const e=t.indexOf("?");if(!e)return"";const r=t.indexOf("#",e);return t.substring(e,r>0?r:void 0)}function wb(t,e){const r=new _b(t,e);return r.subscribe.bind(r)}class _b{constructor(e,r){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=r,this.task.then(()=>{e(this)}).catch(n=>{this.error(n)})}next(e){this.forEachObserver(r=>{r.next(e)})}error(e){this.forEachObserver(r=>{r.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,r,n){let i;if(e===void 0&&r===void 0&&n===void 0)throw new Error("Missing Observer.");Eb(e,["next","error","complete"])?i=e:i={next:e,error:r,complete:n},i.next===void 0&&(i.next=ll),i.error===void 0&&(i.error=ll),i.complete===void 0&&(i.complete=ll);const s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let r=0;r<this.observers.length;r++)this.sendOne(r,e)}sendOne(e,r){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{r(this.observers[e])}catch(n){typeof console<"u"&&console.error&&console.error(n)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function Eb(t,e){if(typeof t!="object"||t===null)return!1;for(const r of e)if(r in t&&typeof t[r]=="function")return!0;return!1}function ll(){}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bb=1e3,Tb=2,Sb=4*60*60*1e3,Ab=.5;function qf(t,e=bb,r=Tb){const n=e*Math.pow(r,t),i=Math.round(Ab*n*(Math.random()-.5)*2);return Math.min(Sb,n+i)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gt(t){return t&&t._delegate?t._delegate:t}class pr{constructor(e,r,n){this.name=e,this.instanceFactory=r,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const In="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cb{constructor(e,r){this.name=e,this.container=r,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const r=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(r)){const n=new ub;if(this.instancesDeferred.set(r,n),this.isInitialized(r)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:r});i&&n.resolve(i)}catch{}}return this.instancesDeferred.get(r).promise}getImmediate(e){var r;const n=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),i=(r=e==null?void 0:e.optional)!==null&&r!==void 0?r:!1;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(s){if(i)return null;throw s}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(kb(e))try{this.getOrInitializeService({instanceIdentifier:In})}catch{}for(const[r,n]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(r);try{const s=this.getOrInitializeService({instanceIdentifier:i});n.resolve(s)}catch{}}}}clearInstance(e=In){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(r=>"INTERNAL"in r).map(r=>r.INTERNAL.delete()),...e.filter(r=>"_delete"in r).map(r=>r._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=In){return this.instances.has(e)}getOptions(e=In){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:r={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:n,options:r});for(const[s,a]of this.instancesDeferred.entries()){const o=this.normalizeInstanceIdentifier(s);n===o&&a.resolve(i)}return i}onInit(e,r){var n;const i=this.normalizeInstanceIdentifier(r),s=(n=this.onInitCallbacks.get(i))!==null&&n!==void 0?n:new Set;s.add(e),this.onInitCallbacks.set(i,s);const a=this.instances.get(i);return a&&e(a,i),()=>{s.delete(e)}}invokeOnInitCallbacks(e,r){const n=this.onInitCallbacks.get(r);if(n)for(const i of n)try{i(e,r)}catch{}}getOrInitializeService({instanceIdentifier:e,options:r={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:Ib(e),options:r}),this.instances.set(e,n),this.instancesOptions.set(e,r),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch{}return n||null}normalizeInstanceIdentifier(e=In){return this.component?this.component.multipleInstances?e:In:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function Ib(t){return t===In?void 0:t}function kb(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ob{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const r=this.getProvider(e.name);if(r.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);r.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const r=new Cb(e,this);return this.providers.set(e,r),r}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ne;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(Ne||(Ne={}));const Rb={debug:Ne.DEBUG,verbose:Ne.VERBOSE,info:Ne.INFO,warn:Ne.WARN,error:Ne.ERROR,silent:Ne.SILENT},Pb=Ne.INFO,Fb={[Ne.DEBUG]:"log",[Ne.VERBOSE]:"log",[Ne.INFO]:"info",[Ne.WARN]:"warn",[Ne.ERROR]:"error"},Nb=(t,e,...r)=>{if(e<t.logLevel)return;const n=new Date().toISOString(),i=Fb[e];if(i)console[i](`[${n}]  ${t.name}:`,...r);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Zc{constructor(e){this.name=e,this._logLevel=Pb,this._logHandler=Nb,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Ne))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?Rb[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Ne.DEBUG,...e),this._logHandler(this,Ne.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Ne.VERBOSE,...e),this._logHandler(this,Ne.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Ne.INFO,...e),this._logHandler(this,Ne.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Ne.WARN,...e),this._logHandler(this,Ne.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Ne.ERROR,...e),this._logHandler(this,Ne.ERROR,...e)}}const Db=(t,e)=>e.some(r=>t instanceof r);let Kf,Xf;function Lb(){return Kf||(Kf=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function Mb(){return Xf||(Xf=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const Ep=new WeakMap,nc=new WeakMap,bp=new WeakMap,cl=new WeakMap,eu=new WeakMap;function jb(t){const e=new Promise((r,n)=>{const i=()=>{t.removeEventListener("success",s),t.removeEventListener("error",a)},s=()=>{r(on(t.result)),i()},a=()=>{n(t.error),i()};t.addEventListener("success",s),t.addEventListener("error",a)});return e.then(r=>{r instanceof IDBCursor&&Ep.set(r,t)}).catch(()=>{}),eu.set(e,t),e}function $b(t){if(nc.has(t))return;const e=new Promise((r,n)=>{const i=()=>{t.removeEventListener("complete",s),t.removeEventListener("error",a),t.removeEventListener("abort",a)},s=()=>{r(),i()},a=()=>{n(t.error||new DOMException("AbortError","AbortError")),i()};t.addEventListener("complete",s),t.addEventListener("error",a),t.addEventListener("abort",a)});nc.set(t,e)}let ic={get(t,e,r){if(t instanceof IDBTransaction){if(e==="done")return nc.get(t);if(e==="objectStoreNames")return t.objectStoreNames||bp.get(t);if(e==="store")return r.objectStoreNames[1]?void 0:r.objectStore(r.objectStoreNames[0])}return on(t[e])},set(t,e,r){return t[e]=r,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function Bb(t){ic=t(ic)}function Ub(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...r){const n=t.call(ul(this),e,...r);return bp.set(n,e.sort?e.sort():[e]),on(n)}:Mb().includes(t)?function(...e){return t.apply(ul(this),e),on(Ep.get(this))}:function(...e){return on(t.apply(ul(this),e))}}function Hb(t){return typeof t=="function"?Ub(t):(t instanceof IDBTransaction&&$b(t),Db(t,Lb())?new Proxy(t,ic):t)}function on(t){if(t instanceof IDBRequest)return jb(t);if(cl.has(t))return cl.get(t);const e=Hb(t);return e!==t&&(cl.set(t,e),eu.set(e,t)),e}const ul=t=>eu.get(t);function Tp(t,e,{blocked:r,upgrade:n,blocking:i,terminated:s}={}){const a=indexedDB.open(t,e),o=on(a);return n&&a.addEventListener("upgradeneeded",l=>{n(on(a.result),l.oldVersion,l.newVersion,on(a.transaction),l)}),r&&a.addEventListener("blocked",l=>r(l.oldVersion,l.newVersion,l)),o.then(l=>{s&&l.addEventListener("close",()=>s()),i&&l.addEventListener("versionchange",c=>i(c.oldVersion,c.newVersion,c))}).catch(()=>{}),o}const Wb=["get","getKey","getAll","getAllKeys","count"],Vb=["put","add","delete","clear"],fl=new Map;function Yf(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(fl.get(e))return fl.get(e);const r=e.replace(/FromIndex$/,""),n=e!==r,i=Vb.includes(r);if(!(r in(n?IDBIndex:IDBObjectStore).prototype)||!(i||Wb.includes(r)))return;const s=async function(a,...o){const l=this.transaction(a,i?"readwrite":"readonly");let c=l.store;return n&&(c=c.index(o.shift())),(await Promise.all([c[r](...o),i&&l.done]))[0]};return fl.set(e,s),s}Bb(t=>({...t,get:(e,r,n)=>Yf(e,r)||t.get(e,r,n),has:(e,r)=>!!Yf(e,r)||t.has(e,r)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gb{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(r=>{if(zb(r)){const n=r.getImmediate();return`${n.library}/${n.version}`}else return null}).filter(r=>r).join(" ")}}function zb(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const sc="@firebase/app",Jf="0.10.13";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mr=new Zc("@firebase/app"),qb="@firebase/app-compat",Kb="@firebase/analytics-compat",Xb="@firebase/analytics",Yb="@firebase/app-check-compat",Jb="@firebase/app-check",Qb="@firebase/auth",Zb="@firebase/auth-compat",eT="@firebase/database",tT="@firebase/data-connect",rT="@firebase/database-compat",nT="@firebase/functions",iT="@firebase/functions-compat",sT="@firebase/installations",aT="@firebase/installations-compat",oT="@firebase/messaging",lT="@firebase/messaging-compat",cT="@firebase/performance",uT="@firebase/performance-compat",fT="@firebase/remote-config",hT="@firebase/remote-config-compat",dT="@firebase/storage",pT="@firebase/storage-compat",mT="@firebase/firestore",gT="@firebase/vertexai-preview",vT="@firebase/firestore-compat",xT="firebase",yT="10.14.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ac="[DEFAULT]",wT={[sc]:"fire-core",[qb]:"fire-core-compat",[Xb]:"fire-analytics",[Kb]:"fire-analytics-compat",[Jb]:"fire-app-check",[Yb]:"fire-app-check-compat",[Qb]:"fire-auth",[Zb]:"fire-auth-compat",[eT]:"fire-rtdb",[tT]:"fire-data-connect",[rT]:"fire-rtdb-compat",[nT]:"fire-fn",[iT]:"fire-fn-compat",[sT]:"fire-iid",[aT]:"fire-iid-compat",[oT]:"fire-fcm",[lT]:"fire-fcm-compat",[cT]:"fire-perf",[uT]:"fire-perf-compat",[fT]:"fire-rc",[hT]:"fire-rc-compat",[dT]:"fire-gcs",[pT]:"fire-gcs-compat",[mT]:"fire-fst",[vT]:"fire-fst-compat",[gT]:"fire-vertex","fire-js":"fire-js",[xT]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ba=new Map,_T=new Map,oc=new Map;function Qf(t,e){try{t.container.addComponent(e)}catch(r){Mr.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,r)}}function jr(t){const e=t.name;if(oc.has(e))return Mr.debug(`There were multiple attempts to register component ${e}.`),!1;oc.set(e,t);for(const r of Ba.values())Qf(r,t);for(const r of _T.values())Qf(r,t);return!0}function Bi(t,e){const r=t.container.getProvider("heartbeat").getImmediate({optional:!0});return r&&r.triggerHeartbeat(),t.container.getProvider(e)}function Qt(t){return t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ET={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},ln=new Zn("app","Firebase",ET);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bT{constructor(e,r,n){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},r),this._name=r.name,this._automaticDataCollectionEnabled=r.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new pr("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw ln.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Us=yT;function Sp(t,e={}){let r=t;typeof e!="object"&&(e={name:e});const n=Object.assign({name:ac,automaticDataCollectionEnabled:!1},e),i=n.name;if(typeof i!="string"||!i)throw ln.create("bad-app-name",{appName:String(i)});if(r||(r=vp()),!r)throw ln.create("no-options");const s=Ba.get(i);if(s){if(bs(r,s.options)&&bs(n,s.config))return s;throw ln.create("duplicate-app",{appName:i})}const a=new Ob(i);for(const l of oc.values())a.addComponent(l);const o=new bT(r,n,a);return Ba.set(i,o),o}function Ap(t=ac){const e=Ba.get(t);if(!e&&t===ac&&vp())return Sp();if(!e)throw ln.create("no-app",{appName:t});return e}function fr(t,e,r){var n;let i=(n=wT[t])!==null&&n!==void 0?n:t;r&&(i+=`-${r}`);const s=i.match(/\s|\//),a=e.match(/\s|\//);if(s||a){const o=[`Unable to register library "${i}" with version "${e}":`];s&&o.push(`library name "${i}" contains illegal characters (whitespace or "/")`),s&&a&&o.push("and"),a&&o.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Mr.warn(o.join(" "));return}jr(new pr(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TT="firebase-heartbeat-database",ST=1,Ts="firebase-heartbeat-store";let hl=null;function Cp(){return hl||(hl=Tp(TT,ST,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(Ts)}catch(r){console.warn(r)}}}}).catch(t=>{throw ln.create("idb-open",{originalErrorMessage:t.message})})),hl}async function AT(t){try{const r=(await Cp()).transaction(Ts),n=await r.objectStore(Ts).get(Ip(t));return await r.done,n}catch(e){if(e instanceof vr)Mr.warn(e.message);else{const r=ln.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});Mr.warn(r.message)}}}async function Zf(t,e){try{const n=(await Cp()).transaction(Ts,"readwrite");await n.objectStore(Ts).put(e,Ip(t)),await n.done}catch(r){if(r instanceof vr)Mr.warn(r.message);else{const n=ln.create("idb-set",{originalErrorMessage:r==null?void 0:r.message});Mr.warn(n.message)}}}function Ip(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const CT=1024,IT=30*24*60*60*1e3;class kT{constructor(e){this.container=e,this._heartbeatsCache=null;const r=this.container.getProvider("app").getImmediate();this._storage=new RT(r),this._heartbeatsCachePromise=this._storage.read().then(n=>(this._heartbeatsCache=n,n))}async triggerHeartbeat(){var e,r;try{const i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=eh();return((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((r=this._heartbeatsCache)===null||r===void 0?void 0:r.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(a=>a.date===s)?void 0:(this._heartbeatsCache.heartbeats.push({date:s,agent:i}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(a=>{const o=new Date(a.date).valueOf();return Date.now()-o<=IT}),this._storage.overwrite(this._heartbeatsCache))}catch(n){Mr.warn(n)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const r=eh(),{heartbeatsToSend:n,unsentEntries:i}=OT(this._heartbeatsCache.heartbeats),s=mp(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=r,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}catch(r){return Mr.warn(r),""}}}function eh(){return new Date().toISOString().substring(0,10)}function OT(t,e=CT){const r=[];let n=t.slice();for(const i of t){const s=r.find(a=>a.agent===i.agent);if(s){if(s.dates.push(i.date),th(r)>e){s.dates.pop();break}}else if(r.push({agent:i.agent,dates:[i.date]}),th(r)>e){r.pop();break}n=n.slice(1)}return{heartbeatsToSend:r,unsentEntries:n}}class RT{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return wp()?_p().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const r=await AT(this.app);return r!=null&&r.heartbeats?r:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var r;if(await this._canUseIndexedDBPromise){const i=await this.read();return Zf(this.app,{lastSentHeartbeatDate:(r=e.lastSentHeartbeatDate)!==null&&r!==void 0?r:i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var r;if(await this._canUseIndexedDBPromise){const i=await this.read();return Zf(this.app,{lastSentHeartbeatDate:(r=e.lastSentHeartbeatDate)!==null&&r!==void 0?r:i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}}function th(t){return mp(JSON.stringify({version:2,heartbeats:t})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function PT(t){jr(new pr("platform-logger",e=>new Gb(e),"PRIVATE")),jr(new pr("heartbeat",e=>new kT(e),"PRIVATE")),fr(sc,Jf,t),fr(sc,Jf,"esm2017"),fr("fire-js","")}PT("");function tu(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(t);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]]);return r}function kp(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const FT=kp,Op=new Zn("auth","Firebase",kp());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ua=new Zc("@firebase/auth");function NT(t,...e){Ua.logLevel<=Ne.WARN&&Ua.warn(`Auth (${Us}): ${t}`,...e)}function Aa(t,...e){Ua.logLevel<=Ne.ERROR&&Ua.error(`Auth (${Us}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Wt(t,...e){throw nu(t,...e)}function er(t,...e){return nu(t,...e)}function ru(t,e,r){const n=Object.assign(Object.assign({},FT()),{[e]:r});return new Zn("auth","Firebase",n).create(e,{appName:t.name})}function Rr(t){return ru(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function DT(t,e,r){const n=r;if(!(e instanceof n))throw n.name!==e.constructor.name&&Wt(t,"argument-error"),ru(t,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function nu(t,...e){if(typeof t!="string"){const r=e[0],n=[...e.slice(1)];return n[0]&&(n[0].appName=t.name),t._errorFactory.create(r,...n)}return Op.create(t,...e)}function de(t,e,...r){if(!t)throw nu(e,...r)}function Cr(t){const e="INTERNAL ASSERTION FAILED: "+t;throw Aa(e),new Error(e)}function $r(t,e){t||Cr(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lc(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.href)||""}function LT(){return rh()==="http:"||rh()==="https:"}function rh(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function MT(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(LT()||yp()||"connection"in navigator)?navigator.onLine:!0}function jT(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hs{constructor(e,r){this.shortDelay=e,this.longDelay=r,$r(r>e,"Short delay should be less than long delay!"),this.isMobile=fb()||db()}get(){return MT()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function iu(t,e){$r(t.emulator,"Emulator should always be set here");const{url:r}=t.emulator;return e?`${r}${e.startsWith("/")?e.slice(1):e}`:r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rp{static initialize(e,r,n){this.fetchImpl=e,r&&(this.headersImpl=r),n&&(this.responseImpl=n)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Cr("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Cr("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Cr("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $T={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const BT=new Hs(3e4,6e4);function vn(t,e){return t.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:t.tenantId}):e}async function Wr(t,e,r,n,i={}){return Pp(t,i,async()=>{let s={},a={};n&&(e==="GET"?a=n:s={body:JSON.stringify(n)});const o=Bs(Object.assign({key:t.config.apiKey},a)).slice(1),l=await t._getAdditionalHeaders();l["Content-Type"]="application/json",t.languageCode&&(l["X-Firebase-Locale"]=t.languageCode);const c=Object.assign({method:e,headers:l},s);return hb()||(c.referrerPolicy="no-referrer"),Rp.fetch()(Fp(t,t.config.apiHost,r,o),c)})}async function Pp(t,e,r){t._canInitEmulator=!1;const n=Object.assign(Object.assign({},$T),e);try{const i=new HT(t),s=await Promise.race([r(),i.promise]);i.clearNetworkTimeout();const a=await s.json();if("needConfirmation"in a)throw fa(t,"account-exists-with-different-credential",a);if(s.ok&&!("errorMessage"in a))return a;{const o=s.ok?a.errorMessage:a.error.message,[l,c]=o.split(" : ");if(l==="FEDERATED_USER_ID_ALREADY_LINKED")throw fa(t,"credential-already-in-use",a);if(l==="EMAIL_EXISTS")throw fa(t,"email-already-in-use",a);if(l==="USER_DISABLED")throw fa(t,"user-disabled",a);const u=n[l]||l.toLowerCase().replace(/[_\s]+/g,"-");if(c)throw ru(t,u,c);Wt(t,u)}}catch(i){if(i instanceof vr)throw i;Wt(t,"network-request-failed",{message:String(i)})}}async function Ws(t,e,r,n,i={}){const s=await Wr(t,e,r,n,i);return"mfaPendingCredential"in s&&Wt(t,"multi-factor-auth-required",{_serverResponse:s}),s}function Fp(t,e,r,n){const i=`${e}${r}?${n}`;return t.config.emulator?iu(t.config,i):`${t.config.apiScheme}://${i}`}function UT(t){switch(t){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class HT{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((r,n)=>{this.timer=setTimeout(()=>n(er(this.auth,"network-request-failed")),BT.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function fa(t,e,r){const n={appName:t.name};r.email&&(n.email=r.email),r.phoneNumber&&(n.phoneNumber=r.phoneNumber);const i=er(t,e,n);return i.customData._tokenResponse=r,i}function nh(t){return t!==void 0&&t.enterprise!==void 0}class WT{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const r of this.recaptchaEnforcementState)if(r.provider&&r.provider===e)return UT(r.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}}async function VT(t,e){return Wr(t,"GET","/v2/recaptchaConfig",vn(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function GT(t,e){return Wr(t,"POST","/v1/accounts:delete",e)}async function Np(t,e){return Wr(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function us(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function zT(t,e=!1){const r=Gt(t),n=await r.getIdToken(e),i=su(n);de(i&&i.exp&&i.auth_time&&i.iat,r.auth,"internal-error");const s=typeof i.firebase=="object"?i.firebase:void 0,a=s==null?void 0:s.sign_in_provider;return{claims:i,token:n,authTime:us(dl(i.auth_time)),issuedAtTime:us(dl(i.iat)),expirationTime:us(dl(i.exp)),signInProvider:a||null,signInSecondFactor:(s==null?void 0:s.sign_in_second_factor)||null}}function dl(t){return Number(t)*1e3}function su(t){const[e,r,n]=t.split(".");if(e===void 0||r===void 0||n===void 0)return Aa("JWT malformed, contained fewer than 3 sections"),null;try{const i=gp(r);return i?JSON.parse(i):(Aa("Failed to decode base64 JWT payload"),null)}catch(i){return Aa("Caught error parsing JWT payload as JSON",i==null?void 0:i.toString()),null}}function ih(t){const e=su(t);return de(e,"internal-error"),de(typeof e.exp<"u","internal-error"),de(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Pi(t,e,r=!1){if(r)return e;try{return await e}catch(n){throw n instanceof vr&&qT(n)&&t.auth.currentUser===t&&await t.auth.signOut(),n}}function qT({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KT{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var r;if(e){const n=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),n}else{this.errorBackoff=3e4;const i=((r=this.user.stsTokenManager.expirationTime)!==null&&r!==void 0?r:0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;const r=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},r)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cc{constructor(e,r){this.createdAt=e,this.lastLoginAt=r,this._initializeTime()}_initializeTime(){this.lastSignInTime=us(this.lastLoginAt),this.creationTime=us(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ha(t){var e;const r=t.auth,n=await t.getIdToken(),i=await Pi(t,Np(r,{idToken:n}));de(i==null?void 0:i.users.length,r,"internal-error");const s=i.users[0];t._notifyReloadListener(s);const a=!((e=s.providerUserInfo)===null||e===void 0)&&e.length?Dp(s.providerUserInfo):[],o=YT(t.providerData,a),l=t.isAnonymous,c=!(t.email&&s.passwordHash)&&!(o!=null&&o.length),u=l?c:!1,f={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:o,metadata:new cc(s.createdAt,s.lastLoginAt),isAnonymous:u};Object.assign(t,f)}async function XT(t){const e=Gt(t);await Ha(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function YT(t,e){return[...t.filter(n=>!e.some(i=>i.providerId===n.providerId)),...e]}function Dp(t){return t.map(e=>{var{providerId:r}=e,n=tu(e,["providerId"]);return{providerId:r,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function JT(t,e){const r=await Pp(t,{},async()=>{const n=Bs({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:s}=t.config,a=Fp(t,i,"/v1/token",`key=${s}`),o=await t._getAdditionalHeaders();return o["Content-Type"]="application/x-www-form-urlencoded",Rp.fetch()(a,{method:"POST",headers:o,body:n})});return{accessToken:r.access_token,expiresIn:r.expires_in,refreshToken:r.refresh_token}}async function QT(t,e){return Wr(t,"POST","/v2/accounts:revokeToken",vn(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ei{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){de(e.idToken,"internal-error"),de(typeof e.idToken<"u","internal-error"),de(typeof e.refreshToken<"u","internal-error");const r="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):ih(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,r)}updateFromIdToken(e){de(e.length!==0,"internal-error");const r=ih(e);this.updateTokensAndExpiration(e,null,r)}async getToken(e,r=!1){return!r&&this.accessToken&&!this.isExpired?this.accessToken:(de(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,r){const{accessToken:n,refreshToken:i,expiresIn:s}=await JT(e,r);this.updateTokensAndExpiration(n,i,Number(s))}updateTokensAndExpiration(e,r,n){this.refreshToken=r||null,this.accessToken=e||null,this.expirationTime=Date.now()+n*1e3}static fromJSON(e,r){const{refreshToken:n,accessToken:i,expirationTime:s}=r,a=new Ei;return n&&(de(typeof n=="string","internal-error",{appName:e}),a.refreshToken=n),i&&(de(typeof i=="string","internal-error",{appName:e}),a.accessToken=i),s&&(de(typeof s=="number","internal-error",{appName:e}),a.expirationTime=s),a}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Ei,this.toJSON())}_performRefresh(){return Cr("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zr(t,e){de(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class Ir{constructor(e){var{uid:r,auth:n,stsTokenManager:i}=e,s=tu(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new KT(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=r,this.auth=n,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new cc(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(e){const r=await Pi(this,this.stsTokenManager.getToken(this.auth,e));return de(r,this.auth,"internal-error"),this.accessToken!==r&&(this.accessToken=r,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),r}getIdTokenResult(e){return zT(this,e)}reload(){return XT(this)}_assign(e){this!==e&&(de(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(r=>Object.assign({},r)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const r=new Ir(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return r.metadata._copy(this.metadata),r}_onReload(e){de(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,r=!1){let n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),r&&await Ha(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Qt(this.auth.app))return Promise.reject(Rr(this.auth));const e=await this.getIdToken();return await Pi(this,GT(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,r){var n,i,s,a,o,l,c,u;const f=(n=r.displayName)!==null&&n!==void 0?n:void 0,d=(i=r.email)!==null&&i!==void 0?i:void 0,h=(s=r.phoneNumber)!==null&&s!==void 0?s:void 0,m=(a=r.photoURL)!==null&&a!==void 0?a:void 0,p=(o=r.tenantId)!==null&&o!==void 0?o:void 0,g=(l=r._redirectEventId)!==null&&l!==void 0?l:void 0,w=(c=r.createdAt)!==null&&c!==void 0?c:void 0,b=(u=r.lastLoginAt)!==null&&u!==void 0?u:void 0,{uid:_,emailVerified:k,isAnonymous:L,providerData:M,stsTokenManager:I}=r;de(_&&I,e,"internal-error");const F=Ei.fromJSON(this.name,I);de(typeof _=="string",e,"internal-error"),zr(f,e.name),zr(d,e.name),de(typeof k=="boolean",e,"internal-error"),de(typeof L=="boolean",e,"internal-error"),zr(h,e.name),zr(m,e.name),zr(p,e.name),zr(g,e.name),zr(w,e.name),zr(b,e.name);const R=new Ir({uid:_,auth:e,email:d,emailVerified:k,displayName:f,isAnonymous:L,photoURL:m,phoneNumber:h,tenantId:p,stsTokenManager:F,createdAt:w,lastLoginAt:b});return M&&Array.isArray(M)&&(R.providerData=M.map(N=>Object.assign({},N))),g&&(R._redirectEventId=g),R}static async _fromIdTokenResponse(e,r,n=!1){const i=new Ei;i.updateFromServerResponse(r);const s=new Ir({uid:r.localId,auth:e,stsTokenManager:i,isAnonymous:n});return await Ha(s),s}static async _fromGetAccountInfoResponse(e,r,n){const i=r.users[0];de(i.localId!==void 0,"internal-error");const s=i.providerUserInfo!==void 0?Dp(i.providerUserInfo):[],a=!(i.email&&i.passwordHash)&&!(s!=null&&s.length),o=new Ei;o.updateFromIdToken(n);const l=new Ir({uid:i.localId,auth:e,stsTokenManager:o,isAnonymous:a}),c={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:s,metadata:new cc(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!(s!=null&&s.length)};return Object.assign(l,c),l}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sh=new Map;function kr(t){$r(t instanceof Function,"Expected a class definition");let e=sh.get(t);return e?($r(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,sh.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lp{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,r){this.storage[e]=r}async _get(e){const r=this.storage[e];return r===void 0?null:r}async _remove(e){delete this.storage[e]}_addListener(e,r){}_removeListener(e,r){}}Lp.type="NONE";const ah=Lp;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ca(t,e,r){return`firebase:${t}:${e}:${r}`}class bi{constructor(e,r,n){this.persistence=e,this.auth=r,this.userKey=n;const{config:i,name:s}=this.auth;this.fullUserKey=Ca(this.userKey,i.apiKey,s),this.fullPersistenceKey=Ca("persistence",i.apiKey,s),this.boundEventHandler=r._onStorageEvent.bind(r),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?Ir._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const r=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,r)return this.setCurrentUser(r)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,r,n="authUser"){if(!r.length)return new bi(kr(ah),e,n);const i=(await Promise.all(r.map(async c=>{if(await c._isAvailable())return c}))).filter(c=>c);let s=i[0]||kr(ah);const a=Ca(n,e.config.apiKey,e.name);let o=null;for(const c of r)try{const u=await c._get(a);if(u){const f=Ir._fromJSON(e,u);c!==s&&(o=f),s=c;break}}catch{}const l=i.filter(c=>c._shouldAllowMigration);return!s._shouldAllowMigration||!l.length?new bi(s,e,n):(s=l[0],o&&await s._set(a,o.toJSON()),await Promise.all(r.map(async c=>{if(c!==s)try{await c._remove(a)}catch{}})),new bi(s,e,n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oh(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(Bp(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(Mp(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(Hp(e))return"Blackberry";if(Wp(e))return"Webos";if(jp(e))return"Safari";if((e.includes("chrome/")||$p(e))&&!e.includes("edge/"))return"Chrome";if(Up(e))return"Android";{const r=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=t.match(r);if((n==null?void 0:n.length)===2)return n[1]}return"Other"}function Mp(t=bt()){return/firefox\//i.test(t)}function jp(t=bt()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function $p(t=bt()){return/crios\//i.test(t)}function Bp(t=bt()){return/iemobile/i.test(t)}function Up(t=bt()){return/android/i.test(t)}function Hp(t=bt()){return/blackberry/i.test(t)}function Wp(t=bt()){return/webos/i.test(t)}function au(t=bt()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function ZT(t=bt()){var e;return au(t)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function eS(){return pb()&&document.documentMode===10}function Vp(t=bt()){return au(t)||Up(t)||Wp(t)||Hp(t)||/windows phone/i.test(t)||Bp(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gp(t,e=[]){let r;switch(t){case"Browser":r=oh(bt());break;case"Worker":r=`${oh(bt())}-${t}`;break;default:r=t}const n=e.length?e.join(","):"FirebaseCore-web";return`${r}/JsCore/${Us}/${n}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tS{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,r){const n=s=>new Promise((a,o)=>{try{const l=e(s);a(l)}catch(l){o(l)}});n.onAbort=r,this.queue.push(n);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const r=[];try{for(const n of this.queue)await n(e),n.onAbort&&r.push(n.onAbort)}catch(n){r.reverse();for(const i of r)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:n==null?void 0:n.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function rS(t,e={}){return Wr(t,"GET","/v2/passwordPolicy",vn(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nS=6;class iS{constructor(e){var r,n,i,s;const a=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(r=a.minPasswordLength)!==null&&r!==void 0?r:nS,a.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=a.maxPasswordLength),a.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=a.containsLowercaseCharacter),a.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=a.containsUppercaseCharacter),a.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=a.containsNumericCharacter),a.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=a.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(i=(n=e.allowedNonAlphanumericCharacters)===null||n===void 0?void 0:n.join(""))!==null&&i!==void 0?i:"",this.forceUpgradeOnSignin=(s=e.forceUpgradeOnSignin)!==null&&s!==void 0?s:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var r,n,i,s,a,o;const l={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,l),this.validatePasswordCharacterOptions(e,l),l.isValid&&(l.isValid=(r=l.meetsMinPasswordLength)!==null&&r!==void 0?r:!0),l.isValid&&(l.isValid=(n=l.meetsMaxPasswordLength)!==null&&n!==void 0?n:!0),l.isValid&&(l.isValid=(i=l.containsLowercaseLetter)!==null&&i!==void 0?i:!0),l.isValid&&(l.isValid=(s=l.containsUppercaseLetter)!==null&&s!==void 0?s:!0),l.isValid&&(l.isValid=(a=l.containsNumericCharacter)!==null&&a!==void 0?a:!0),l.isValid&&(l.isValid=(o=l.containsNonAlphanumericCharacter)!==null&&o!==void 0?o:!0),l}validatePasswordLengthOptions(e,r){const n=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;n&&(r.meetsMinPasswordLength=e.length>=n),i&&(r.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,r){this.updatePasswordCharacterOptionsStatuses(r,!1,!1,!1,!1);let n;for(let i=0;i<e.length;i++)n=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(r,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(e,r,n,i,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=r)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sS{constructor(e,r,n,i){this.app=e,this.heartbeatServiceProvider=r,this.appCheckServiceProvider=n,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new lh(this),this.idTokenSubscription=new lh(this),this.beforeStateQueue=new tS(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=Op,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion}_initializeWithPersistence(e,r){return r&&(this._popupRedirectResolver=kr(r)),this._initializationPromise=this.queue(async()=>{var n,i;if(!this._deleted&&(this.persistenceManager=await bi.create(this,e),!this._deleted)){if(!((n=this._popupRedirectResolver)===null||n===void 0)&&n._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(r),this.lastNotifiedUid=((i=this.currentUser)===null||i===void 0?void 0:i.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const r=await Np(this,{idToken:e}),n=await Ir._fromGetAccountInfoResponse(this,r,e);await this.directlySetCurrentUser(n)}catch(r){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",r),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var r;if(Qt(this.app)){const a=this.app.settings.authIdToken;return a?new Promise(o=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(a).then(o,o))}):this.directlySetCurrentUser(null)}const n=await this.assertedPersistence.getCurrentUser();let i=n,s=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const a=(r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId,o=i==null?void 0:i._redirectEventId,l=await this.tryRedirectSignIn(e);(!a||a===o)&&(l!=null&&l.user)&&(i=l.user,s=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(i)}catch(a){i=n,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(a))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return de(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(e){let r=null;try{r=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return r}async reloadAndSetCurrentUserOrClear(e){try{await Ha(e)}catch(r){if((r==null?void 0:r.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=jT()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Qt(this.app))return Promise.reject(Rr(this));const r=e?Gt(e):null;return r&&de(r.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(r&&r._clone(this))}async _updateCurrentUser(e,r=!1){if(!this._deleted)return e&&de(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),r||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Qt(this.app)?Promise.reject(Rr(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Qt(this.app)?Promise.reject(Rr(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(kr(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const r=this._getPasswordPolicyInternal();return r.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):r.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await rS(this),r=new iS(e);this.tenantId===null?this._projectPasswordPolicy=r:this._tenantPasswordPolicies[this.tenantId]=r}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new Zn("auth","Firebase",e())}onAuthStateChanged(e,r,n){return this.registerStateListener(this.authStateSubscription,e,r,n)}beforeAuthStateChanged(e,r){return this.beforeStateQueue.pushCallback(e,r)}onIdTokenChanged(e,r,n){return this.registerStateListener(this.idTokenSubscription,e,r,n)}authStateReady(){return new Promise((e,r)=>{if(this.currentUser)e();else{const n=this.onAuthStateChanged(()=>{n(),e()},r)}})}async revokeAccessToken(e){if(this.currentUser){const r=await this.currentUser.getIdToken(),n={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:r};this.tenantId!=null&&(n.tenantId=this.tenantId),await QT(this,n)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,r){const n=await this.getOrInitRedirectPersistenceManager(r);return e===null?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const r=e&&kr(e)||this._popupRedirectResolver;de(r,this,"argument-error"),this.redirectPersistenceManager=await bi.create(this,[kr(r._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var r,n;return this._isInitialized&&await this.queue(async()=>{}),((r=this._currentUser)===null||r===void 0?void 0:r._redirectEventId)===e?this._currentUser:((n=this.redirectUser)===null||n===void 0?void 0:n._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,r;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const n=(r=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&r!==void 0?r:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,r,n,i){if(this._deleted)return()=>{};const s=typeof r=="function"?r:r.next.bind(r);let a=!1;const o=this._isInitialized?Promise.resolve():this._initializationPromise;if(de(o,this,"internal-error"),o.then(()=>{a||s(this.currentUser)}),typeof r=="function"){const l=e.addObserver(r,n,i);return()=>{a=!0,l()}}else{const l=e.addObserver(r);return()=>{a=!0,l()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return de(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=Gp(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const r={"X-Client-Version":this.clientVersion};this.app.options.appId&&(r["X-Firebase-gmpid"]=this.app.options.appId);const n=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());n&&(r["X-Firebase-Client"]=n);const i=await this._getAppCheckToken();return i&&(r["X-Firebase-AppCheck"]=i),r}async _getAppCheckToken(){var e;const r=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return r!=null&&r.error&&NT(`Error while retrieving App Check token: ${r.error}`),r==null?void 0:r.token}}function xn(t){return Gt(t)}class lh{constructor(e){this.auth=e,this.observer=null,this.addObserver=wb(r=>this.observer=r)}get next(){return de(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ao={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function aS(t){Ao=t}function zp(t){return Ao.loadJS(t)}function oS(){return Ao.recaptchaEnterpriseScript}function lS(){return Ao.gapiScript}function cS(t){return`__${t}${Math.floor(Math.random()*1e6)}`}const uS="recaptcha-enterprise",fS="NO_RECAPTCHA";class hS{constructor(e){this.type=uS,this.auth=xn(e)}async verify(e="verify",r=!1){async function n(s){if(!r){if(s.tenantId==null&&s._agentRecaptchaConfig!=null)return s._agentRecaptchaConfig.siteKey;if(s.tenantId!=null&&s._tenantRecaptchaConfigs[s.tenantId]!==void 0)return s._tenantRecaptchaConfigs[s.tenantId].siteKey}return new Promise(async(a,o)=>{VT(s,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(l=>{if(l.recaptchaKey===void 0)o(new Error("recaptcha Enterprise site key undefined"));else{const c=new WT(l);return s.tenantId==null?s._agentRecaptchaConfig=c:s._tenantRecaptchaConfigs[s.tenantId]=c,a(c.siteKey)}}).catch(l=>{o(l)})})}function i(s,a,o){const l=window.grecaptcha;nh(l)?l.enterprise.ready(()=>{l.enterprise.execute(s,{action:e}).then(c=>{a(c)}).catch(()=>{a(fS)})}):o(Error("No reCAPTCHA enterprise script loaded."))}return new Promise((s,a)=>{n(this.auth).then(o=>{if(!r&&nh(window.grecaptcha))i(o,s,a);else{if(typeof window>"u"){a(new Error("RecaptchaVerifier is only supported in browser"));return}let l=oS();l.length!==0&&(l+=o),zp(l).then(()=>{i(o,s,a)}).catch(c=>{a(c)})}}).catch(o=>{a(o)})})}}async function ch(t,e,r,n=!1){const i=new hS(t);let s;try{s=await i.verify(r)}catch{s=await i.verify(r,!0)}const a=Object.assign({},e);return n?Object.assign(a,{captchaResp:s}):Object.assign(a,{captchaResponse:s}),Object.assign(a,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(a,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),a}async function uc(t,e,r,n){var i;if(!((i=t._getRecaptchaConfig())===null||i===void 0)&&i.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const s=await ch(t,e,r,r==="getOobCode");return n(t,s)}else return n(t,e).catch(async s=>{if(s.code==="auth/missing-recaptcha-token"){console.log(`${r} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const a=await ch(t,e,r,r==="getOobCode");return n(t,a)}else return Promise.reject(s)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dS(t,e){const r=Bi(t,"auth");if(r.isInitialized()){const i=r.getImmediate(),s=r.getOptions();if(bs(s,e??{}))return i;Wt(i,"already-initialized")}return r.initialize({options:e})}function pS(t,e){const r=(e==null?void 0:e.persistence)||[],n=(Array.isArray(r)?r:[r]).map(kr);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(n,e==null?void 0:e.popupRedirectResolver)}function mS(t,e,r){const n=xn(t);de(n._canInitEmulator,n,"emulator-config-failed"),de(/^https?:\/\//.test(e),n,"invalid-emulator-scheme");const i=!!(r!=null&&r.disableWarnings),s=qp(e),{host:a,port:o}=gS(e),l=o===null?"":`:${o}`;n.config.emulator={url:`${s}//${a}${l}/`},n.settings.appVerificationDisabledForTesting=!0,n.emulatorConfig=Object.freeze({host:a,port:o,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:i})}),i||vS()}function qp(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function gS(t){const e=qp(t),r=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!r)return{host:"",port:null};const n=r[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(n);if(i){const s=i[1];return{host:s,port:uh(n.substr(s.length+1))}}else{const[s,a]=n.split(":");return{host:s,port:uh(a)}}}function uh(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function vS(){function t(){const e=document.createElement("p"),r=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",r.position="fixed",r.width="100%",r.backgroundColor="#ffffff",r.border=".1em solid #000000",r.color="#b50000",r.bottom="0px",r.left="0px",r.margin="0px",r.zIndex="10000",r.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ou{constructor(e,r){this.providerId=e,this.signInMethod=r}toJSON(){return Cr("not implemented")}_getIdTokenResponse(e){return Cr("not implemented")}_linkToIdToken(e,r){return Cr("not implemented")}_getReauthenticationResolver(e){return Cr("not implemented")}}async function xS(t,e){return Wr(t,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function yS(t,e){return Ws(t,"POST","/v1/accounts:signInWithPassword",vn(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function wS(t,e){return Ws(t,"POST","/v1/accounts:signInWithEmailLink",vn(t,e))}async function _S(t,e){return Ws(t,"POST","/v1/accounts:signInWithEmailLink",vn(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ss extends ou{constructor(e,r,n,i=null){super("password",n),this._email=e,this._password=r,this._tenantId=i}static _fromEmailAndPassword(e,r){return new Ss(e,r,"password")}static _fromEmailAndCode(e,r,n=null){return new Ss(e,r,"emailLink",n)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const r=typeof e=="string"?JSON.parse(e):e;if(r!=null&&r.email&&(r!=null&&r.password)){if(r.signInMethod==="password")return this._fromEmailAndPassword(r.email,r.password);if(r.signInMethod==="emailLink")return this._fromEmailAndCode(r.email,r.password,r.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const r={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return uc(e,r,"signInWithPassword",yS);case"emailLink":return wS(e,{email:this._email,oobCode:this._password});default:Wt(e,"internal-error")}}async _linkToIdToken(e,r){switch(this.signInMethod){case"password":const n={idToken:r,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return uc(e,n,"signUpPassword",xS);case"emailLink":return _S(e,{idToken:r,email:this._email,oobCode:this._password});default:Wt(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ti(t,e){return Ws(t,"POST","/v1/accounts:signInWithIdp",vn(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ES="http://localhost";class Vn extends ou{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const r=new Vn(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(r.idToken=e.idToken),e.accessToken&&(r.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(r.nonce=e.nonce),e.pendingToken&&(r.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(r.accessToken=e.oauthToken,r.secret=e.oauthTokenSecret):Wt("argument-error"),r}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const r=typeof e=="string"?JSON.parse(e):e,{providerId:n,signInMethod:i}=r,s=tu(r,["providerId","signInMethod"]);if(!n||!i)return null;const a=new Vn(n,i);return a.idToken=s.idToken||void 0,a.accessToken=s.accessToken||void 0,a.secret=s.secret,a.nonce=s.nonce,a.pendingToken=s.pendingToken||null,a}_getIdTokenResponse(e){const r=this.buildRequest();return Ti(e,r)}_linkToIdToken(e,r){const n=this.buildRequest();return n.idToken=r,Ti(e,n)}_getReauthenticationResolver(e){const r=this.buildRequest();return r.autoCreate=!1,Ti(e,r)}buildRequest(){const e={requestUri:ES,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const r={};this.idToken&&(r.id_token=this.idToken),this.accessToken&&(r.access_token=this.accessToken),this.secret&&(r.oauth_token_secret=this.secret),r.providerId=this.providerId,this.nonce&&!this.pendingToken&&(r.nonce=this.nonce),e.postBody=Bs(r)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bS(t){switch(t){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function TS(t){const e=ns(is(t)).link,r=e?ns(is(e)).deep_link_id:null,n=ns(is(t)).deep_link_id;return(n?ns(is(n)).link:null)||n||r||e||t}class lu{constructor(e){var r,n,i,s,a,o;const l=ns(is(e)),c=(r=l.apiKey)!==null&&r!==void 0?r:null,u=(n=l.oobCode)!==null&&n!==void 0?n:null,f=bS((i=l.mode)!==null&&i!==void 0?i:null);de(c&&u&&f,"argument-error"),this.apiKey=c,this.operation=f,this.code=u,this.continueUrl=(s=l.continueUrl)!==null&&s!==void 0?s:null,this.languageCode=(a=l.languageCode)!==null&&a!==void 0?a:null,this.tenantId=(o=l.tenantId)!==null&&o!==void 0?o:null}static parseLink(e){const r=TS(e);try{return new lu(r)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ui{constructor(){this.providerId=Ui.PROVIDER_ID}static credential(e,r){return Ss._fromEmailAndPassword(e,r)}static credentialWithLink(e,r){const n=lu.parseLink(r);return de(n,"argument-error"),Ss._fromEmailAndCode(e,n.code,n.tenantId)}}Ui.PROVIDER_ID="password";Ui.EMAIL_PASSWORD_SIGN_IN_METHOD="password";Ui.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cu{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vs extends cu{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zr extends Vs{constructor(){super("facebook.com")}static credential(e){return Vn._fromParams({providerId:Zr.PROVIDER_ID,signInMethod:Zr.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Zr.credentialFromTaggedObject(e)}static credentialFromError(e){return Zr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Zr.credential(e.oauthAccessToken)}catch{return null}}}Zr.FACEBOOK_SIGN_IN_METHOD="facebook.com";Zr.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tr extends Vs{constructor(){super("google.com"),this.addScope("profile")}static credential(e,r){return Vn._fromParams({providerId:Tr.PROVIDER_ID,signInMethod:Tr.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:r})}static credentialFromResult(e){return Tr.credentialFromTaggedObject(e)}static credentialFromError(e){return Tr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:r,oauthAccessToken:n}=e;if(!r&&!n)return null;try{return Tr.credential(r,n)}catch{return null}}}Tr.GOOGLE_SIGN_IN_METHOD="google.com";Tr.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class en extends Vs{constructor(){super("github.com")}static credential(e){return Vn._fromParams({providerId:en.PROVIDER_ID,signInMethod:en.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return en.credentialFromTaggedObject(e)}static credentialFromError(e){return en.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return en.credential(e.oauthAccessToken)}catch{return null}}}en.GITHUB_SIGN_IN_METHOD="github.com";en.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tn extends Vs{constructor(){super("twitter.com")}static credential(e,r){return Vn._fromParams({providerId:tn.PROVIDER_ID,signInMethod:tn.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:r})}static credentialFromResult(e){return tn.credentialFromTaggedObject(e)}static credentialFromError(e){return tn.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:r,oauthTokenSecret:n}=e;if(!r||!n)return null;try{return tn.credential(r,n)}catch{return null}}}tn.TWITTER_SIGN_IN_METHOD="twitter.com";tn.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function SS(t,e){return Ws(t,"POST","/v1/accounts:signUp",vn(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gn{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,r,n,i=!1){const s=await Ir._fromIdTokenResponse(e,n,i),a=fh(n);return new Gn({user:s,providerId:a,_tokenResponse:n,operationType:r})}static async _forOperation(e,r,n){await e._updateTokensIfNecessary(n,!0);const i=fh(n);return new Gn({user:e,providerId:i,_tokenResponse:n,operationType:r})}}function fh(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wa extends vr{constructor(e,r,n,i){var s;super(r.code,r.message),this.operationType=n,this.user=i,Object.setPrototypeOf(this,Wa.prototype),this.customData={appName:e.name,tenantId:(s=e.tenantId)!==null&&s!==void 0?s:void 0,_serverResponse:r.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,r,n,i){return new Wa(e,r,n,i)}}function Kp(t,e,r,n){return(e==="reauthenticate"?r._getReauthenticationResolver(t):r._getIdTokenResponse(t)).catch(s=>{throw s.code==="auth/multi-factor-auth-required"?Wa._fromErrorAndOperation(t,s,e,n):s})}async function AS(t,e,r=!1){const n=await Pi(t,e._linkToIdToken(t.auth,await t.getIdToken()),r);return Gn._forOperation(t,"link",n)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function CS(t,e,r=!1){const{auth:n}=t;if(Qt(n.app))return Promise.reject(Rr(n));const i="reauthenticate";try{const s=await Pi(t,Kp(n,i,e,t),r);de(s.idToken,n,"internal-error");const a=su(s.idToken);de(a,n,"internal-error");const{sub:o}=a;return de(t.uid===o,n,"user-mismatch"),Gn._forOperation(t,i,s)}catch(s){throw(s==null?void 0:s.code)==="auth/user-not-found"&&Wt(n,"user-mismatch"),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Xp(t,e,r=!1){if(Qt(t.app))return Promise.reject(Rr(t));const n="signIn",i=await Kp(t,n,e),s=await Gn._fromIdTokenResponse(t,n,i);return r||await t._updateCurrentUser(s.user),s}async function IS(t,e){return Xp(xn(t),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Yp(t){const e=xn(t);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function kS(t,e,r){if(Qt(t.app))return Promise.reject(Rr(t));const n=xn(t),a=await uc(n,{returnSecureToken:!0,email:e,password:r,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",SS).catch(l=>{throw l.code==="auth/password-does-not-meet-requirements"&&Yp(t),l}),o=await Gn._fromIdTokenResponse(n,"signIn",a);return await n._updateCurrentUser(o.user),o}function OS(t,e,r){return Qt(t.app)?Promise.reject(Rr(t)):IS(Gt(t),Ui.credential(e,r)).catch(async n=>{throw n.code==="auth/password-does-not-meet-requirements"&&Yp(t),n})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function RS(t,e){return Wr(t,"POST","/v1/accounts:update",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function PS(t,{displayName:e,photoURL:r}){if(e===void 0&&r===void 0)return;const n=Gt(t),s={idToken:await n.getIdToken(),displayName:e,photoUrl:r,returnSecureToken:!0},a=await Pi(n,RS(n.auth,s));n.displayName=a.displayName||null,n.photoURL=a.photoUrl||null;const o=n.providerData.find(({providerId:l})=>l==="password");o&&(o.displayName=n.displayName,o.photoURL=n.photoURL),await n._updateTokensIfNecessary(a)}function FS(t,e,r,n){return Gt(t).onIdTokenChanged(e,r,n)}function NS(t,e,r){return Gt(t).beforeAuthStateChanged(e,r)}function DS(t,e,r,n){return Gt(t).onAuthStateChanged(e,r,n)}function LS(t){return Gt(t).signOut()}const Va="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jp{constructor(e,r){this.storageRetriever=e,this.type=r}_isAvailable(){try{return this.storage?(this.storage.setItem(Va,"1"),this.storage.removeItem(Va),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,r){return this.storage.setItem(e,JSON.stringify(r)),Promise.resolve()}_get(e){const r=this.storage.getItem(e);return Promise.resolve(r?JSON.parse(r):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const MS=1e3,jS=10;class Qp extends Jp{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,r)=>this.onStorageEvent(e,r),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=Vp(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const r of Object.keys(this.listeners)){const n=this.storage.getItem(r),i=this.localCache[r];n!==i&&e(r,i,n)}}onStorageEvent(e,r=!1){if(!e.key){this.forAllChangedKeys((a,o,l)=>{this.notifyListeners(a,l)});return}const n=e.key;r?this.detachListener():this.stopPolling();const i=()=>{const a=this.storage.getItem(n);!r&&this.localCache[n]===a||this.notifyListeners(n,a)},s=this.storage.getItem(n);eS()&&s!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,jS):i()}notifyListeners(e,r){this.localCache[e]=r;const n=this.listeners[e];if(n)for(const i of Array.from(n))i(r&&JSON.parse(r))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,r,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:r,newValue:n}),!0)})},MS)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,r){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,r){await super._set(e,r),this.localCache[e]=JSON.stringify(r)}async _get(e){const r=await super._get(e);return this.localCache[e]=JSON.stringify(r),r}async _remove(e){await super._remove(e),delete this.localCache[e]}}Qp.type="LOCAL";const $S=Qp;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zp extends Jp{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,r){}_removeListener(e,r){}}Zp.type="SESSION";const em=Zp;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function BS(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(r){return{fulfilled:!1,reason:r}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Co{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const r=this.receivers.find(i=>i.isListeningto(e));if(r)return r;const n=new Co(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const r=e,{eventId:n,eventType:i,data:s}=r.data,a=this.handlersMap[i];if(!(a!=null&&a.size))return;r.ports[0].postMessage({status:"ack",eventId:n,eventType:i});const o=Array.from(a).map(async c=>c(r.origin,s)),l=await BS(o);r.ports[0].postMessage({status:"done",eventId:n,eventType:i,response:l})}_subscribe(e,r){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(r)}_unsubscribe(e,r){this.handlersMap[e]&&r&&this.handlersMap[e].delete(r),(!r||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Co.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uu(t="",e=10){let r="";for(let n=0;n<e;n++)r+=Math.floor(Math.random()*10);return t+r}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class US{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,r,n=50){const i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let s,a;return new Promise((o,l)=>{const c=uu("",20);i.port1.start();const u=setTimeout(()=>{l(new Error("unsupported_event"))},n);a={messageChannel:i,onMessage(f){const d=f;if(d.data.eventId===c)switch(d.data.status){case"ack":clearTimeout(u),s=setTimeout(()=>{l(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),o(d.data.response);break;default:clearTimeout(u),clearTimeout(s),l(new Error("invalid_response"));break}}},this.handlers.add(a),i.port1.addEventListener("message",a.onMessage),this.target.postMessage({eventType:e,eventId:c,data:r},[i.port2])}).finally(()=>{a&&this.removeMessageHandler(a)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hr(){return window}function HS(t){hr().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tm(){return typeof hr().WorkerGlobalScope<"u"&&typeof hr().importScripts=="function"}async function WS(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function VS(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)===null||t===void 0?void 0:t.controller)||null}function GS(){return tm()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rm="firebaseLocalStorageDb",zS=1,Ga="firebaseLocalStorage",nm="fbase_key";class Gs{constructor(e){this.request=e}toPromise(){return new Promise((e,r)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{r(this.request.error)})})}}function Io(t,e){return t.transaction([Ga],e?"readwrite":"readonly").objectStore(Ga)}function qS(){const t=indexedDB.deleteDatabase(rm);return new Gs(t).toPromise()}function fc(){const t=indexedDB.open(rm,zS);return new Promise((e,r)=>{t.addEventListener("error",()=>{r(t.error)}),t.addEventListener("upgradeneeded",()=>{const n=t.result;try{n.createObjectStore(Ga,{keyPath:nm})}catch(i){r(i)}}),t.addEventListener("success",async()=>{const n=t.result;n.objectStoreNames.contains(Ga)?e(n):(n.close(),await qS(),e(await fc()))})})}async function hh(t,e,r){const n=Io(t,!0).put({[nm]:e,value:r});return new Gs(n).toPromise()}async function KS(t,e){const r=Io(t,!1).get(e),n=await new Gs(r).toPromise();return n===void 0?null:n.value}function dh(t,e){const r=Io(t,!0).delete(e);return new Gs(r).toPromise()}const XS=800,YS=3;class im{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await fc(),this.db)}async _withRetries(e){let r=0;for(;;)try{const n=await this._openDb();return await e(n)}catch(n){if(r++>YS)throw n;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return tm()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Co._getInstance(GS()),this.receiver._subscribe("keyChanged",async(e,r)=>({keyProcessed:(await this._poll()).includes(r.key)})),this.receiver._subscribe("ping",async(e,r)=>["keyChanged"])}async initializeSender(){var e,r;if(this.activeServiceWorker=await WS(),!this.activeServiceWorker)return;this.sender=new US(this.activeServiceWorker);const n=await this.sender._send("ping",{},800);n&&!((e=n[0])===null||e===void 0)&&e.fulfilled&&!((r=n[0])===null||r===void 0)&&r.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||VS()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await fc();return await hh(e,Va,"1"),await dh(e,Va),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,r){return this._withPendingWrite(async()=>(await this._withRetries(n=>hh(n,e,r)),this.localCache[e]=r,this.notifyServiceWorker(e)))}async _get(e){const r=await this._withRetries(n=>KS(n,e));return this.localCache[e]=r,r}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(r=>dh(r,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(i=>{const s=Io(i,!1).getAll();return new Gs(s).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const r=[],n=new Set;if(e.length!==0)for(const{fbase_key:i,value:s}of e)n.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(s)&&(this.notifyListeners(i,s),r.push(i));for(const i of Object.keys(this.localCache))this.localCache[i]&&!n.has(i)&&(this.notifyListeners(i,null),r.push(i));return r}notifyListeners(e,r){this.localCache[e]=r;const n=this.listeners[e];if(n)for(const i of Array.from(n))i(r)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),XS)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,r){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}im.type="LOCAL";const JS=im;new Hs(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sm(t,e){return e?kr(e):(de(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fu extends ou{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Ti(e,this._buildIdpRequest())}_linkToIdToken(e,r){return Ti(e,this._buildIdpRequest(r))}_getReauthenticationResolver(e){return Ti(e,this._buildIdpRequest())}_buildIdpRequest(e){const r={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(r.idToken=e),r}}function QS(t){return Xp(t.auth,new fu(t),t.bypassAuthState)}function ZS(t){const{auth:e,user:r}=t;return de(r,e,"internal-error"),CS(r,new fu(t),t.bypassAuthState)}async function eA(t){const{auth:e,user:r}=t;return de(r,e,"internal-error"),AS(r,new fu(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class am{constructor(e,r,n,i,s=!1){this.auth=e,this.resolver=n,this.user=i,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(r)?r:[r]}execute(){return new Promise(async(e,r)=>{this.pendingPromise={resolve:e,reject:r};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(n){this.reject(n)}})}async onAuthEvent(e){const{urlResponse:r,sessionId:n,postBody:i,tenantId:s,error:a,type:o}=e;if(a){this.reject(a);return}const l={auth:this.auth,requestUri:r,sessionId:n,tenantId:s||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(o)(l))}catch(c){this.reject(c)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return QS;case"linkViaPopup":case"linkViaRedirect":return eA;case"reauthViaPopup":case"reauthViaRedirect":return ZS;default:Wt(this.auth,"internal-error")}}resolve(e){$r(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){$r(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tA=new Hs(2e3,1e4);async function rA(t,e,r){if(Qt(t.app))return Promise.reject(er(t,"operation-not-supported-in-this-environment"));const n=xn(t);DT(t,e,cu);const i=sm(n,r);return new Mn(n,"signInViaPopup",e,i).executeNotNull()}class Mn extends am{constructor(e,r,n,i,s){super(e,r,i,s),this.provider=n,this.authWindow=null,this.pollId=null,Mn.currentPopupAction&&Mn.currentPopupAction.cancel(),Mn.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return de(e,this.auth,"internal-error"),e}async onExecution(){$r(this.filter.length===1,"Popup operations only handle one event");const e=uu();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(r=>{this.reject(r)}),this.resolver._isIframeWebStorageSupported(this.auth,r=>{r||this.reject(er(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(er(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Mn.currentPopupAction=null}pollUserCancellation(){const e=()=>{var r,n;if(!((n=(r=this.authWindow)===null||r===void 0?void 0:r.window)===null||n===void 0)&&n.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(er(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,tA.get())};e()}}Mn.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nA="pendingRedirect",Ia=new Map;class iA extends am{constructor(e,r,n=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],r,void 0,n),this.eventId=null}async execute(){let e=Ia.get(this.auth._key());if(!e){try{const n=await sA(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(n)}catch(r){e=()=>Promise.reject(r)}Ia.set(this.auth._key(),e)}return this.bypassAuthState||Ia.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const r=await this.auth._redirectUserForId(e.eventId);if(r)return this.user=r,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function sA(t,e){const r=lA(e),n=oA(t);if(!await n._isAvailable())return!1;const i=await n._get(r)==="true";return await n._remove(r),i}function aA(t,e){Ia.set(t._key(),e)}function oA(t){return kr(t._redirectPersistence)}function lA(t){return Ca(nA,t.config.apiKey,t.name)}async function cA(t,e,r=!1){if(Qt(t.app))return Promise.reject(Rr(t));const n=xn(t),i=sm(n,e),a=await new iA(n,i,r).execute();return a&&!r&&(delete a.user._redirectEventId,await n._persistUserIfCurrent(a.user),await n._setRedirectUser(null,e)),a}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uA=10*60*1e3;class fA{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let r=!1;return this.consumers.forEach(n=>{this.isEventForConsumer(e,n)&&(r=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!hA(e)||(this.hasHandledPotentialRedirect=!0,r||(this.queuedRedirectEvent=e,r=!0)),r}sendToConsumer(e,r){var n;if(e.error&&!om(e)){const i=((n=e.error.code)===null||n===void 0?void 0:n.split("auth/")[1])||"internal-error";r.onError(er(this.auth,i))}else r.onAuthEvent(e)}isEventForConsumer(e,r){const n=r.eventId===null||!!e.eventId&&e.eventId===r.eventId;return r.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=uA&&this.cachedEventUids.clear(),this.cachedEventUids.has(ph(e))}saveEventToCache(e){this.cachedEventUids.add(ph(e)),this.lastProcessedEventTime=Date.now()}}function ph(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function om({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function hA(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return om(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function dA(t,e={}){return Wr(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pA=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,mA=/^https?/;async function gA(t){if(t.config.emulator)return;const{authorizedDomains:e}=await dA(t);for(const r of e)try{if(vA(r))return}catch{}Wt(t,"unauthorized-domain")}function vA(t){const e=lc(),{protocol:r,hostname:n}=new URL(e);if(t.startsWith("chrome-extension://")){const a=new URL(t);return a.hostname===""&&n===""?r==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):r==="chrome-extension:"&&a.hostname===n}if(!mA.test(r))return!1;if(pA.test(t))return n===t;const i=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(n)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xA=new Hs(3e4,6e4);function mh(){const t=hr().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let r=0;r<t.CP.length;r++)t.CP[r]=null}}function yA(t){return new Promise((e,r)=>{var n,i,s;function a(){mh(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{mh(),r(er(t,"network-request-failed"))},timeout:xA.get()})}if(!((i=(n=hr().gapi)===null||n===void 0?void 0:n.iframes)===null||i===void 0)&&i.Iframe)e(gapi.iframes.getContext());else if(!((s=hr().gapi)===null||s===void 0)&&s.load)a();else{const o=cS("iframefcb");return hr()[o]=()=>{gapi.load?a():r(er(t,"network-request-failed"))},zp(`${lS()}?onload=${o}`).catch(l=>r(l))}}).catch(e=>{throw ka=null,e})}let ka=null;function wA(t){return ka=ka||yA(t),ka}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _A=new Hs(5e3,15e3),EA="__/auth/iframe",bA="emulator/auth/iframe",TA={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},SA=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function AA(t){const e=t.config;de(e.authDomain,t,"auth-domain-config-required");const r=e.emulator?iu(e,bA):`https://${t.config.authDomain}/${EA}`,n={apiKey:e.apiKey,appName:t.name,v:Us},i=SA.get(t.config.apiHost);i&&(n.eid=i);const s=t._getFrameworks();return s.length&&(n.fw=s.join(",")),`${r}?${Bs(n).slice(1)}`}async function CA(t){const e=await wA(t),r=hr().gapi;return de(r,t,"internal-error"),e.open({where:document.body,url:AA(t),messageHandlersFilter:r.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:TA,dontclear:!0},n=>new Promise(async(i,s)=>{await n.restyle({setHideOnLeave:!1});const a=er(t,"network-request-failed"),o=hr().setTimeout(()=>{s(a)},_A.get());function l(){hr().clearTimeout(o),i(n)}n.ping(l).then(l,()=>{s(a)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const IA={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},kA=500,OA=600,RA="_blank",PA="http://localhost";class gh{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function FA(t,e,r,n=kA,i=OA){const s=Math.max((window.screen.availHeight-i)/2,0).toString(),a=Math.max((window.screen.availWidth-n)/2,0).toString();let o="";const l=Object.assign(Object.assign({},IA),{width:n.toString(),height:i.toString(),top:s,left:a}),c=bt().toLowerCase();r&&(o=$p(c)?RA:r),Mp(c)&&(e=e||PA,l.scrollbars="yes");const u=Object.entries(l).reduce((d,[h,m])=>`${d}${h}=${m},`,"");if(ZT(c)&&o!=="_self")return NA(e||"",o),new gh(null);const f=window.open(e||"",o,u);de(f,t,"popup-blocked");try{f.focus()}catch{}return new gh(f)}function NA(t,e){const r=document.createElement("a");r.href=t,r.target=e;const n=document.createEvent("MouseEvent");n.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),r.dispatchEvent(n)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DA="__/auth/handler",LA="emulator/auth/handler",MA=encodeURIComponent("fac");async function vh(t,e,r,n,i,s){de(t.config.authDomain,t,"auth-domain-config-required"),de(t.config.apiKey,t,"invalid-api-key");const a={apiKey:t.config.apiKey,appName:t.name,authType:r,redirectUrl:n,v:Us,eventId:i};if(e instanceof cu){e.setDefaultLanguage(t.languageCode),a.providerId=e.providerId||"",yb(e.getCustomParameters())||(a.customParameters=JSON.stringify(e.getCustomParameters()));for(const[u,f]of Object.entries(s||{}))a[u]=f}if(e instanceof Vs){const u=e.getScopes().filter(f=>f!=="");u.length>0&&(a.scopes=u.join(","))}t.tenantId&&(a.tid=t.tenantId);const o=a;for(const u of Object.keys(o))o[u]===void 0&&delete o[u];const l=await t._getAppCheckToken(),c=l?`#${MA}=${encodeURIComponent(l)}`:"";return`${jA(t)}?${Bs(o).slice(1)}${c}`}function jA({config:t}){return t.emulator?iu(t,LA):`https://${t.authDomain}/${DA}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pl="webStorageSupport";class $A{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=em,this._completeRedirectFn=cA,this._overrideRedirectResult=aA}async _openPopup(e,r,n,i){var s;$r((s=this.eventManagers[e._key()])===null||s===void 0?void 0:s.manager,"_initialize() not called before _openPopup()");const a=await vh(e,r,n,lc(),i);return FA(e,a,uu())}async _openRedirect(e,r,n,i){await this._originValidation(e);const s=await vh(e,r,n,lc(),i);return HS(s),new Promise(()=>{})}_initialize(e){const r=e._key();if(this.eventManagers[r]){const{manager:i,promise:s}=this.eventManagers[r];return i?Promise.resolve(i):($r(s,"If manager is not set, promise should be"),s)}const n=this.initAndGetManager(e);return this.eventManagers[r]={promise:n},n.catch(()=>{delete this.eventManagers[r]}),n}async initAndGetManager(e){const r=await CA(e),n=new fA(e);return r.register("authEvent",i=>(de(i==null?void 0:i.authEvent,e,"invalid-auth-event"),{status:n.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=r,n}_isIframeWebStorageSupported(e,r){this.iframes[e._key()].send(pl,{type:pl},i=>{var s;const a=(s=i==null?void 0:i[0])===null||s===void 0?void 0:s[pl];a!==void 0&&r(!!a),Wt(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const r=e._key();return this.originValidationPromises[r]||(this.originValidationPromises[r]=gA(e)),this.originValidationPromises[r]}get _shouldInitProactively(){return Vp()||jp()||au()}}const BA=$A;var xh="@firebase/auth",yh="1.7.9";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UA{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const r=this.auth.onIdTokenChanged(n=>{e((n==null?void 0:n.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,r),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const r=this.internalListeners.get(e);r&&(this.internalListeners.delete(e),r(),this.updateProactiveRefresh())}assertAuthConfigured(){de(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function HA(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function WA(t){jr(new pr("auth",(e,{options:r})=>{const n=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:a,authDomain:o}=n.options;de(a&&!a.includes(":"),"invalid-api-key",{appName:n.name});const l={apiKey:a,authDomain:o,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Gp(t)},c=new sS(n,i,s,l);return pS(c,r),c},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,r,n)=>{e.getProvider("auth-internal").initialize()})),jr(new pr("auth-internal",e=>{const r=xn(e.getProvider("auth").getImmediate());return(n=>new UA(n))(r)},"PRIVATE").setInstantiationMode("EXPLICIT")),fr(xh,yh,HA(t)),fr(xh,yh,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const VA=5*60,GA=xp("authIdTokenMaxAge")||VA;let wh=null;const zA=t=>async e=>{const r=e&&await e.getIdTokenResult(),n=r&&(new Date().getTime()-Date.parse(r.issuedAtTime))/1e3;if(n&&n>GA)return;const i=r==null?void 0:r.token;wh!==i&&(wh=i,await fetch(t,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))};function qA(t=Ap()){const e=Bi(t,"auth");if(e.isInitialized())return e.getImmediate();const r=dS(t,{popupRedirectResolver:BA,persistence:[JS,$S,em]}),n=xp("authTokenSyncURL");if(n&&typeof isSecureContext=="boolean"&&isSecureContext){const s=new URL(n,location.origin);if(location.origin===s.origin){const a=zA(s.toString());NS(r,a,()=>a(r.currentUser)),FS(r,o=>a(o))}}const i=cb("auth");return i&&mS(r,`http://${i}`),r}function KA(){var t,e;return(e=(t=document.getElementsByTagName("head"))===null||t===void 0?void 0:t[0])!==null&&e!==void 0?e:document}aS({loadJS(t){return new Promise((e,r)=>{const n=document.createElement("script");n.setAttribute("src",t),n.onload=e,n.onerror=i=>{const s=er("internal-error");s.customData=i,r(s)},n.type="text/javascript",n.charset="UTF-8",KA().appendChild(n)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});WA("Browser");var XA="firebase",YA="10.14.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */fr(XA,YA,"app");const lm="@firebase/installations",hu="0.6.9";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cm=1e4,um=`w:${hu}`,fm="FIS_v2",JA="https://firebaseinstallations.googleapis.com/v1",QA=60*60*1e3,ZA="installations",eC="Installations";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tC={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."},zn=new Zn(ZA,eC,tC);function hm(t){return t instanceof vr&&t.code.includes("request-failed")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dm({projectId:t}){return`${JA}/projects/${t}/installations`}function pm(t){return{token:t.token,requestStatus:2,expiresIn:nC(t.expiresIn),creationTime:Date.now()}}async function mm(t,e){const n=(await e.json()).error;return zn.create("request-failed",{requestName:t,serverCode:n.code,serverMessage:n.message,serverStatus:n.status})}function gm({apiKey:t}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":t})}function rC(t,{refreshToken:e}){const r=gm(t);return r.append("Authorization",iC(e)),r}async function vm(t){const e=await t();return e.status>=500&&e.status<600?t():e}function nC(t){return Number(t.replace("s","000"))}function iC(t){return`${fm} ${t}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function sC({appConfig:t,heartbeatServiceProvider:e},{fid:r}){const n=dm(t),i=gm(t),s=e.getImmediate({optional:!0});if(s){const c=await s.getHeartbeatsHeader();c&&i.append("x-firebase-client",c)}const a={fid:r,authVersion:fm,appId:t.appId,sdkVersion:um},o={method:"POST",headers:i,body:JSON.stringify(a)},l=await vm(()=>fetch(n,o));if(l.ok){const c=await l.json();return{fid:c.fid||r,registrationStatus:2,refreshToken:c.refreshToken,authToken:pm(c.authToken)}}else throw await mm("Create Installation",l)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xm(t){return new Promise(e=>{setTimeout(e,t)})}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function aC(t){return btoa(String.fromCharCode(...t)).replace(/\+/g,"-").replace(/\//g,"_")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oC=/^[cdef][\w-]{21}$/,hc="";function lC(){try{const t=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(t),t[0]=112+t[0]%16;const r=cC(t);return oC.test(r)?r:hc}catch{return hc}}function cC(t){return aC(t).substr(0,22)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ko(t){return`${t.appName}!${t.appId}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ym=new Map;function wm(t,e){const r=ko(t);_m(r,e),uC(r,e)}function _m(t,e){const r=ym.get(t);if(r)for(const n of r)n(e)}function uC(t,e){const r=fC();r&&r.postMessage({key:t,fid:e}),hC()}let jn=null;function fC(){return!jn&&"BroadcastChannel"in self&&(jn=new BroadcastChannel("[Firebase] FID Change"),jn.onmessage=t=>{_m(t.data.key,t.data.fid)}),jn}function hC(){ym.size===0&&jn&&(jn.close(),jn=null)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dC="firebase-installations-database",pC=1,qn="firebase-installations-store";let ml=null;function du(){return ml||(ml=Tp(dC,pC,{upgrade:(t,e)=>{switch(e){case 0:t.createObjectStore(qn)}}})),ml}async function za(t,e){const r=ko(t),i=(await du()).transaction(qn,"readwrite"),s=i.objectStore(qn),a=await s.get(r);return await s.put(e,r),await i.done,(!a||a.fid!==e.fid)&&wm(t,e.fid),e}async function Em(t){const e=ko(t),n=(await du()).transaction(qn,"readwrite");await n.objectStore(qn).delete(e),await n.done}async function Oo(t,e){const r=ko(t),i=(await du()).transaction(qn,"readwrite"),s=i.objectStore(qn),a=await s.get(r),o=e(a);return o===void 0?await s.delete(r):await s.put(o,r),await i.done,o&&(!a||a.fid!==o.fid)&&wm(t,o.fid),o}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function pu(t){let e;const r=await Oo(t.appConfig,n=>{const i=mC(n),s=gC(t,i);return e=s.registrationPromise,s.installationEntry});return r.fid===hc?{installationEntry:await e}:{installationEntry:r,registrationPromise:e}}function mC(t){const e=t||{fid:lC(),registrationStatus:0};return bm(e)}function gC(t,e){if(e.registrationStatus===0){if(!navigator.onLine){const i=Promise.reject(zn.create("app-offline"));return{installationEntry:e,registrationPromise:i}}const r={fid:e.fid,registrationStatus:1,registrationTime:Date.now()},n=vC(t,r);return{installationEntry:r,registrationPromise:n}}else return e.registrationStatus===1?{installationEntry:e,registrationPromise:xC(t)}:{installationEntry:e}}async function vC(t,e){try{const r=await sC(t,e);return za(t.appConfig,r)}catch(r){throw hm(r)&&r.customData.serverCode===409?await Em(t.appConfig):await za(t.appConfig,{fid:e.fid,registrationStatus:0}),r}}async function xC(t){let e=await _h(t.appConfig);for(;e.registrationStatus===1;)await xm(100),e=await _h(t.appConfig);if(e.registrationStatus===0){const{installationEntry:r,registrationPromise:n}=await pu(t);return n||r}return e}function _h(t){return Oo(t,e=>{if(!e)throw zn.create("installation-not-found");return bm(e)})}function bm(t){return yC(t)?{fid:t.fid,registrationStatus:0}:t}function yC(t){return t.registrationStatus===1&&t.registrationTime+cm<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function wC({appConfig:t,heartbeatServiceProvider:e},r){const n=_C(t,r),i=rC(t,r),s=e.getImmediate({optional:!0});if(s){const c=await s.getHeartbeatsHeader();c&&i.append("x-firebase-client",c)}const a={installation:{sdkVersion:um,appId:t.appId}},o={method:"POST",headers:i,body:JSON.stringify(a)},l=await vm(()=>fetch(n,o));if(l.ok){const c=await l.json();return pm(c)}else throw await mm("Generate Auth Token",l)}function _C(t,{fid:e}){return`${dm(t)}/${e}/authTokens:generate`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function mu(t,e=!1){let r;const n=await Oo(t.appConfig,s=>{if(!Tm(s))throw zn.create("not-registered");const a=s.authToken;if(!e&&TC(a))return s;if(a.requestStatus===1)return r=EC(t,e),s;{if(!navigator.onLine)throw zn.create("app-offline");const o=AC(s);return r=bC(t,o),o}});return r?await r:n.authToken}async function EC(t,e){let r=await Eh(t.appConfig);for(;r.authToken.requestStatus===1;)await xm(100),r=await Eh(t.appConfig);const n=r.authToken;return n.requestStatus===0?mu(t,e):n}function Eh(t){return Oo(t,e=>{if(!Tm(e))throw zn.create("not-registered");const r=e.authToken;return CC(r)?Object.assign(Object.assign({},e),{authToken:{requestStatus:0}}):e})}async function bC(t,e){try{const r=await wC(t,e),n=Object.assign(Object.assign({},e),{authToken:r});return await za(t.appConfig,n),r}catch(r){if(hm(r)&&(r.customData.serverCode===401||r.customData.serverCode===404))await Em(t.appConfig);else{const n=Object.assign(Object.assign({},e),{authToken:{requestStatus:0}});await za(t.appConfig,n)}throw r}}function Tm(t){return t!==void 0&&t.registrationStatus===2}function TC(t){return t.requestStatus===2&&!SC(t)}function SC(t){const e=Date.now();return e<t.creationTime||t.creationTime+t.expiresIn<e+QA}function AC(t){const e={requestStatus:1,requestTime:Date.now()};return Object.assign(Object.assign({},t),{authToken:e})}function CC(t){return t.requestStatus===1&&t.requestTime+cm<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function IC(t){const e=t,{installationEntry:r,registrationPromise:n}=await pu(e);return n?n.catch(console.error):mu(e).catch(console.error),r.fid}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function kC(t,e=!1){const r=t;return await OC(r),(await mu(r,e)).token}async function OC(t){const{registrationPromise:e}=await pu(t);e&&await e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function RC(t){if(!t||!t.options)throw gl("App Configuration");if(!t.name)throw gl("App Name");const e=["projectId","apiKey","appId"];for(const r of e)if(!t.options[r])throw gl(r);return{appName:t.name,projectId:t.options.projectId,apiKey:t.options.apiKey,appId:t.options.appId}}function gl(t){return zn.create("missing-app-config-values",{valueName:t})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Sm="installations",PC="installations-internal",FC=t=>{const e=t.getProvider("app").getImmediate(),r=RC(e),n=Bi(e,"heartbeat");return{app:e,appConfig:r,heartbeatServiceProvider:n,_delete:()=>Promise.resolve()}},NC=t=>{const e=t.getProvider("app").getImmediate(),r=Bi(e,Sm).getImmediate();return{getId:()=>IC(r),getToken:i=>kC(r,i)}};function DC(){jr(new pr(Sm,FC,"PUBLIC")),jr(new pr(PC,NC,"PRIVATE"))}DC();fr(lm,hu);fr(lm,hu,"esm2017");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qa="analytics",LC="firebase_id",MC="origin",jC=60*1e3,$C="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig",gu="https://www.googletagmanager.com/gtag/js";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const At=new Zc("@firebase/analytics");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const BC={"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-initialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.',"no-client-id":'The "client_id" field is empty.',"invalid-gtag-resource":"Trusted Types detected an invalid gtag resource: {$gtagURL}."},Lt=new Zn("analytics","Analytics",BC);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function UC(t){if(!t.startsWith(gu)){const e=Lt.create("invalid-gtag-resource",{gtagURL:t});return At.warn(e.message),""}return t}function Am(t){return Promise.all(t.map(e=>e.catch(r=>r)))}function HC(t,e){let r;return window.trustedTypes&&(r=window.trustedTypes.createPolicy(t,e)),r}function WC(t,e){const r=HC("firebase-js-sdk-policy",{createScriptURL:UC}),n=document.createElement("script"),i=`${gu}?l=${t}&id=${e}`;n.src=r?r==null?void 0:r.createScriptURL(i):i,n.async=!0,document.head.appendChild(n)}function VC(t){let e=[];return Array.isArray(window[t])?e=window[t]:window[t]=e,e}async function GC(t,e,r,n,i,s){const a=n[i];try{if(a)await e[a];else{const l=(await Am(r)).find(c=>c.measurementId===i);l&&await e[l.appId]}}catch(o){At.error(o)}t("config",i,s)}async function zC(t,e,r,n,i){try{let s=[];if(i&&i.send_to){let a=i.send_to;Array.isArray(a)||(a=[a]);const o=await Am(r);for(const l of a){const c=o.find(f=>f.measurementId===l),u=c&&e[c.appId];if(u)s.push(u);else{s=[];break}}}s.length===0&&(s=Object.values(e)),await Promise.all(s),t("event",n,i||{})}catch(s){At.error(s)}}function qC(t,e,r,n){async function i(s,...a){try{if(s==="event"){const[o,l]=a;await zC(t,e,r,o,l)}else if(s==="config"){const[o,l]=a;await GC(t,e,r,n,o,l)}else if(s==="consent"){const[o,l]=a;t("consent",o,l)}else if(s==="get"){const[o,l,c]=a;t("get",o,l,c)}else if(s==="set"){const[o]=a;t("set",o)}else t(s,...a)}catch(o){At.error(o)}}return i}function KC(t,e,r,n,i){let s=function(...a){window[n].push(arguments)};return window[i]&&typeof window[i]=="function"&&(s=window[i]),window[i]=qC(s,t,e,r),{gtagCore:s,wrappedGtag:window[i]}}function XC(t){const e=window.document.getElementsByTagName("script");for(const r of Object.values(e))if(r.src&&r.src.includes(gu)&&r.src.includes(t))return r;return null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const YC=30,JC=1e3;class QC{constructor(e={},r=JC){this.throttleMetadata=e,this.intervalMillis=r}getThrottleMetadata(e){return this.throttleMetadata[e]}setThrottleMetadata(e,r){this.throttleMetadata[e]=r}deleteThrottleMetadata(e){delete this.throttleMetadata[e]}}const Cm=new QC;function ZC(t){return new Headers({Accept:"application/json","x-goog-api-key":t})}async function eI(t){var e;const{appId:r,apiKey:n}=t,i={method:"GET",headers:ZC(n)},s=$C.replace("{app-id}",r),a=await fetch(s,i);if(a.status!==200&&a.status!==304){let o="";try{const l=await a.json();!((e=l.error)===null||e===void 0)&&e.message&&(o=l.error.message)}catch{}throw Lt.create("config-fetch-failed",{httpStatus:a.status,responseMessage:o})}return a.json()}async function tI(t,e=Cm,r){const{appId:n,apiKey:i,measurementId:s}=t.options;if(!n)throw Lt.create("no-app-id");if(!i){if(s)return{measurementId:s,appId:n};throw Lt.create("no-api-key")}const a=e.getThrottleMetadata(n)||{backoffCount:0,throttleEndTimeMillis:Date.now()},o=new iI;return setTimeout(async()=>{o.abort()},r!==void 0?r:jC),Im({appId:n,apiKey:i,measurementId:s},a,o,e)}async function Im(t,{throttleEndTimeMillis:e,backoffCount:r},n,i=Cm){var s;const{appId:a,measurementId:o}=t;try{await rI(n,e)}catch(l){if(o)return At.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${o} provided in the "measurementId" field in the local Firebase config. [${l==null?void 0:l.message}]`),{appId:a,measurementId:o};throw l}try{const l=await eI(t);return i.deleteThrottleMetadata(a),l}catch(l){const c=l;if(!nI(c)){if(i.deleteThrottleMetadata(a),o)return At.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${o} provided in the "measurementId" field in the local Firebase config. [${c==null?void 0:c.message}]`),{appId:a,measurementId:o};throw l}const u=Number((s=c==null?void 0:c.customData)===null||s===void 0?void 0:s.httpStatus)===503?qf(r,i.intervalMillis,YC):qf(r,i.intervalMillis),f={throttleEndTimeMillis:Date.now()+u,backoffCount:r+1};return i.setThrottleMetadata(a,f),At.debug(`Calling attemptFetch again in ${u} millis`),Im(t,f,n,i)}}function rI(t,e){return new Promise((r,n)=>{const i=Math.max(e-Date.now(),0),s=setTimeout(r,i);t.addEventListener(()=>{clearTimeout(s),n(Lt.create("fetch-throttle",{throttleEndTimeMillis:e}))})})}function nI(t){if(!(t instanceof vr)||!t.customData)return!1;const e=Number(t.customData.httpStatus);return e===429||e===500||e===503||e===504}class iI{constructor(){this.listeners=[]}addEventListener(e){this.listeners.push(e)}abort(){this.listeners.forEach(e=>e())}}async function sI(t,e,r,n,i){if(i&&i.global){t("event",r,n);return}else{const s=await e,a=Object.assign(Object.assign({},n),{send_to:s});t("event",r,a)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function aI(){if(wp())try{await _p()}catch(t){return At.warn(Lt.create("indexeddb-unavailable",{errorInfo:t==null?void 0:t.toString()}).message),!1}else return At.warn(Lt.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;return!0}async function oI(t,e,r,n,i,s,a){var o;const l=tI(t);l.then(h=>{r[h.measurementId]=h.appId,t.options.measurementId&&h.measurementId!==t.options.measurementId&&At.warn(`The measurement ID in the local Firebase config (${t.options.measurementId}) does not match the measurement ID fetched from the server (${h.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)}).catch(h=>At.error(h)),e.push(l);const c=aI().then(h=>{if(h)return n.getId()}),[u,f]=await Promise.all([l,c]);XC(s)||WC(s,u.measurementId),i("js",new Date);const d=(o=a==null?void 0:a.config)!==null&&o!==void 0?o:{};return d[MC]="firebase",d.update=!0,f!=null&&(d[LC]=f),i("config",u.measurementId,d),u.measurementId}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lI{constructor(e){this.app=e}_delete(){return delete fs[this.app.options.appId],Promise.resolve()}}let fs={},bh=[];const Th={};let vl="dataLayer",cI="gtag",Sh,km,Ah=!1;function uI(){const t=[];if(yp()&&t.push("This is a browser extension environment."),mb()||t.push("Cookies are not available."),t.length>0){const e=t.map((n,i)=>`(${i+1}) ${n}`).join(" "),r=Lt.create("invalid-analytics-context",{errorInfo:e});At.warn(r.message)}}function fI(t,e,r){uI();const n=t.options.appId;if(!n)throw Lt.create("no-app-id");if(!t.options.apiKey)if(t.options.measurementId)At.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${t.options.measurementId} provided in the "measurementId" field in the local Firebase config.`);else throw Lt.create("no-api-key");if(fs[n]!=null)throw Lt.create("already-exists",{id:n});if(!Ah){VC(vl);const{wrappedGtag:s,gtagCore:a}=KC(fs,bh,Th,vl,cI);km=s,Sh=a,Ah=!0}return fs[n]=oI(t,bh,Th,e,Sh,vl,r),new lI(t)}function hI(t=Ap()){t=Gt(t);const e=Bi(t,qa);return e.isInitialized()?e.getImmediate():dI(t)}function dI(t,e={}){const r=Bi(t,qa);if(r.isInitialized()){const i=r.getImmediate();if(bs(e,r.getOptions()))return i;throw Lt.create("already-initialized")}return r.initialize({options:e})}function pI(t,e,r,n){t=Gt(t),sI(km,fs[t.app.options.appId],e,r,n).catch(i=>At.error(i))}const Ch="@firebase/analytics",Ih="0.10.8";function mI(){jr(new pr(qa,(e,{options:r})=>{const n=e.getProvider("app").getImmediate(),i=e.getProvider("installations-internal").getImmediate();return fI(n,i,r)},"PUBLIC")),jr(new pr("analytics-internal",t,"PRIVATE")),fr(Ch,Ih),fr(Ch,Ih,"esm2017");function t(e){try{const r=e.getProvider(qa).getImmediate();return{logEvent:(n,i,s)=>pI(r,n,i,s)}}catch(r){throw Lt.create("interop-component-reg-failed",{reason:r})}}}mI();const gI={apiKey:"AIzaSyCyr3YmfnX6AUQ7isuEQ84nSUFMqwYCJhc",authDomain:"companydatafetcher.firebaseapp.com",projectId:"companydatafetcher",storageBucket:"companydatafetcher.firebasestorage.app",messagingSenderId:"954681837320",appId:"1:954681837320:web:ec885b225f649f30168ebd",measurementId:"G-PW4WC3VXFN"},Om=Sp(gI),Ji=qA(Om),vI=new Tr;hI(Om);const Rm=v.createContext(void 0);function xI({children:t}){const[e,r]=v.useState(null),[n,i]=v.useState(!0);v.useEffect(()=>{const u=DS(Ji,f=>{r(f?{uid:f.uid,email:f.email,displayName:f.displayName,photoURL:f.photoURL}:null),i(!1)});return()=>u()},[]);const c={user:e,loading:n,login:async(u,f)=>{try{await OS(Ji,u,f),Gr.success("Successfully logged in!")}catch(d){throw console.error("Login error:",d),Gr.error(d.message||"Failed to log in"),d}},register:async(u,f,d)=>{try{const h=await kS(Ji,u,f);await PS(h.user,{displayName:d}),Gr.success("Account created successfully!")}catch(h){throw console.error("Registration error:",h),Gr.error(h.message||"Failed to create account"),h}},loginWithGoogle:async()=>{try{await rA(Ji,vI),Gr.success("Successfully logged in with Google!")}catch(u){throw console.error("Google login error:",u),Gr.error(u.message||"Failed to log in with Google"),u}},logout:async()=>{try{await LS(Ji),Gr.success("Successfully logged out!")}catch(u){console.error("Logout error:",u),Gr.error("Failed to log out")}},isAuthenticated:!!e};return x.jsx(Rm.Provider,{value:c,children:t})}function zs(){const t=v.useContext(Rm);if(t===void 0)throw new Error("useAuth must be used within an AuthProvider");return t}function yI(...t){return t.filter(Boolean).join(" ")}function wI(){const{user:t,logout:e,isAuthenticated:r}=zs(),n=Di(),i=()=>{e(),n("/login")};return x.jsx(Tn,{as:"nav",className:"bg-white shadow",children:({open:s})=>{var a,o,l,c;return x.jsxs(x.Fragment,{children:[x.jsx("div",{className:"mx-auto max-w-7xl px-4 sm:px-6 lg:px-8",children:x.jsxs("div",{className:"flex h-16 justify-between",children:[x.jsxs("div",{className:"flex",children:[x.jsx("div",{className:"flex flex-shrink-0 items-center",children:x.jsx(lr,{to:"/",className:"text-xl font-bold text-indigo-600",children:"CompanyFinder"})}),r&&x.jsx("div",{className:"hidden sm:ml-6 sm:flex sm:space-x-8",children:x.jsx(lr,{to:"/",className:"inline-flex items-center border-b-2 border-indigo-500 px-1 pt-1 text-sm font-medium text-gray-900",children:"Dashboard"})})]}),x.jsx("div",{className:"hidden sm:ml-6 sm:flex sm:items-center",children:r?x.jsxs(ua,{as:"div",className:"relative ml-3",children:[x.jsx("div",{children:x.jsxs(ua.Button,{className:"flex rounded-full bg-white text-sm focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2",children:[x.jsx("span",{className:"sr-only",children:"Open user menu"}),t!=null&&t.photoURL?x.jsx("img",{className:"h-8 w-8 rounded-full",src:t.photoURL,alt:t.displayName||t.email||"User"}):x.jsx("div",{className:"h-8 w-8 rounded-full bg-indigo-100 flex items-center justify-center text-indigo-600 font-semibold",children:((a=t==null?void 0:t.displayName)==null?void 0:a.charAt(0).toUpperCase())||((o=t==null?void 0:t.email)==null?void 0:o.charAt(0).toUpperCase())||"U"})]})}),x.jsx(LE,{as:v.Fragment,enter:"transition ease-out duration-200",enterFrom:"transform opacity-0 scale-95",enterTo:"transform opacity-100 scale-100",leave:"transition ease-in duration-75",leaveFrom:"transform opacity-100 scale-100",leaveTo:"transform opacity-0 scale-95",children:x.jsx(ua.Items,{className:"absolute right-0 z-10 mt-2 w-48 origin-top-right rounded-md bg-white py-1 shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none",children:x.jsx(ua.Item,{children:({active:u})=>x.jsx("button",{onClick:i,className:yI(u?"bg-gray-100":"","block px-4 py-2 text-sm text-gray-700 w-full text-left"),children:"Sign out"})})})})]}):x.jsxs("div",{className:"flex space-x-4",children:[x.jsx(lr,{to:"/login",className:"inline-flex items-center rounded-md bg-white px-3 py-2 text-sm font-semibold text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 hover:bg-gray-50",children:"Log in"}),x.jsx(lr,{to:"/register",className:"inline-flex items-center rounded-md bg-indigo-600 px-3 py-2 text-sm font-semibold text-white shadow-sm hover:bg-indigo-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-600",children:"Sign up"})]})}),x.jsx("div",{className:"-mr-2 flex items-center sm:hidden",children:x.jsxs(Tn.Button,{className:"inline-flex items-center justify-center rounded-md p-2 text-gray-400 hover:bg-gray-100 hover:text-gray-500 focus:outline-none focus:ring-2 focus:ring-inset focus:ring-indigo-500",children:[x.jsx("span",{className:"sr-only",children:"Open main menu"}),s?x.jsx(tb,{className:"block h-6 w-6","aria-hidden":"true"}):x.jsx(R2,{className:"block h-6 w-6","aria-hidden":"true"})]})})]})}),x.jsxs(Tn.Panel,{className:"sm:hidden",children:[x.jsx("div",{className:"space-y-1 pb-3 pt-2",children:x.jsx(Tn.Button,{as:lr,to:"/",className:"block border-l-4 border-indigo-500 bg-indigo-50 py-2 pl-3 pr-4 text-base font-medium text-indigo-700",children:"Dashboard"})}),x.jsx("div",{className:"border-t border-gray-200 pb-3 pt-4",children:r?x.jsxs(x.Fragment,{children:[x.jsxs("div",{className:"flex items-center px-4",children:[x.jsx("div",{className:"flex-shrink-0",children:t!=null&&t.photoURL?x.jsx("img",{className:"h-10 w-10 rounded-full",src:t.photoURL,alt:t.displayName||t.email||"User"}):x.jsx("div",{className:"h-10 w-10 rounded-full bg-indigo-100 flex items-center justify-center text-indigo-600 font-semibold",children:((l=t==null?void 0:t.displayName)==null?void 0:l.charAt(0).toUpperCase())||((c=t==null?void 0:t.email)==null?void 0:c.charAt(0).toUpperCase())||"U"})}),x.jsxs("div",{className:"ml-3",children:[x.jsx("div",{className:"text-base font-medium text-gray-800",children:(t==null?void 0:t.displayName)||(t==null?void 0:t.email)||"User"}),x.jsx("div",{className:"text-sm font-medium text-gray-500",children:t==null?void 0:t.email})]})]}),x.jsx("div",{className:"mt-3 space-y-1",children:x.jsx(Tn.Button,{as:"button",onClick:i,className:"block w-full px-4 py-2 text-left text-base font-medium text-gray-500 hover:bg-gray-100 hover:text-gray-800",children:"Sign out"})})]}):x.jsxs("div",{className:"space-y-1 px-2",children:[x.jsx(Tn.Button,{as:lr,to:"/login",className:"block rounded-md px-3 py-2 text-base font-medium text-gray-900 hover:bg-gray-50 hover:text-gray-800",children:"Log in"}),x.jsx(Tn.Button,{as:lr,to:"/register",className:"block rounded-md px-3 py-2 text-base font-medium text-gray-900 hover:bg-gray-50 hover:text-gray-800",children:"Sign up"})]})})]})]})}})}function _I({title:t,titleId:e,...r},n){return v.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":e},r),t?v.createElement("title",{id:e},t):null,v.createElement("path",{fillRule:"evenodd",d:"M11.78 5.22a.75.75 0 0 1 0 1.06L8.06 10l3.72 3.72a.75.75 0 1 1-1.06 1.06l-4.25-4.25a.75.75 0 0 1 0-1.06l4.25-4.25a.75.75 0 0 1 1.06 0Z",clipRule:"evenodd"}))}const EI=v.forwardRef(_I),bI=EI;function TI({title:t,titleId:e,...r},n){return v.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":e},r),t?v.createElement("title",{id:e},t):null,v.createElement("path",{fillRule:"evenodd",d:"M8.22 5.22a.75.75 0 0 1 1.06 0l4.25 4.25a.75.75 0 0 1 0 1.06l-4.25 4.25a.75.75 0 0 1-1.06-1.06L11.94 10 8.22 6.28a.75.75 0 0 1 0-1.06Z",clipRule:"evenodd"}))}const SI=v.forwardRef(TI),AI=SI;function CI({title:t,titleId:e,...r},n){return v.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":e},r),t?v.createElement("title",{id:e},t):null,v.createElement("path",{fillRule:"evenodd",d:"M10 1a4.5 4.5 0 0 0-4.5 4.5V9H5a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2v-6a2 2 0 0 0-2-2h-.5V5.5A4.5 4.5 0 0 0 10 1Zm3 8V5.5a3 3 0 1 0-6 0V9h6Z",clipRule:"evenodd"}))}const II=v.forwardRef(CI),kI=II;function OI({title:t,titleId:e,...r},n){return v.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":e},r),t?v.createElement("title",{id:e},t):null,v.createElement("path",{d:"M10 5a3 3 0 1 1-6 0 3 3 0 0 1 6 0ZM1.615 16.428a1.224 1.224 0 0 1-.569-1.175 6.002 6.002 0 0 1 11.908 0c.058.467-.172.92-.57 1.174A9.953 9.953 0 0 1 7 18a9.953 9.953 0 0 1-5.385-1.572ZM16.25 5.75a.75.75 0 0 0-1.5 0v2h-2a.75.75 0 0 0 0 1.5h2v2a.75.75 0 0 0 1.5 0v-2h2a.75.75 0 0 0 0-1.5h-2v-2Z"}))}const RI=v.forwardRef(OI),PI=RI;var Pm={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},kh=ve.createContext&&ve.createContext(Pm),cn=globalThis&&globalThis.__assign||function(){return cn=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++){e=arguments[r];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])}return t},cn.apply(this,arguments)},FI=globalThis&&globalThis.__rest||function(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(t);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]]);return r};function Fm(t){return t&&t.map(function(e,r){return ve.createElement(e.tag,cn({key:r},e.attr),Fm(e.child))})}function NI(t){return function(e){return ve.createElement(DI,cn({attr:cn({},t.attr)},e),Fm(t.child))}}function DI(t){var e=function(r){var n=t.attr,i=t.size,s=t.title,a=FI(t,["attr","size","title"]),o=i||r.size||"1em",l;return r.className&&(l=r.className),t.className&&(l=(l?l+" ":"")+t.className),ve.createElement("svg",cn({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},r.attr,n,a,{className:l,style:cn(cn({color:t.color||r.color},r.style),t.style),height:o,width:o,xmlns:"http://www.w3.org/2000/svg"}),s&&ve.createElement("title",null,s),t.children)};return kh!==void 0?ve.createElement(kh.Consumer,null,function(r){return e(r)}):e(Pm)}function Nm(t){return NI({tag:"svg",attr:{version:"1.1",x:"0px",y:"0px",viewBox:"0 0 48 48",enableBackground:"new 0 0 48 48"},child:[{tag:"path",attr:{fill:"#FFC107",d:`M43.611,20.083H42V20H24v8h11.303c-1.649,4.657-6.08,8-11.303,8c-6.627,0-12-5.373-12-12\r
	c0-6.627,5.373-12,12-12c3.059,0,5.842,1.154,7.961,3.039l5.657-5.657C34.046,6.053,29.268,4,24,4C12.955,4,4,12.955,4,24\r
	c0,11.045,8.955,20,20,20c11.045,0,20-8.955,20-20C44,22.659,43.862,21.35,43.611,20.083z`}},{tag:"path",attr:{fill:"#FF3D00",d:`M6.306,14.691l6.571,4.819C14.655,15.108,18.961,12,24,12c3.059,0,5.842,1.154,7.961,3.039l5.657-5.657\r
	C34.046,6.053,29.268,4,24,4C16.318,4,9.656,8.337,6.306,14.691z`}},{tag:"path",attr:{fill:"#4CAF50",d:`M24,44c5.166,0,9.86-1.977,13.409-5.192l-6.19-5.238C29.211,35.091,26.715,36,24,36\r
	c-5.202,0-9.619-3.317-11.283-7.946l-6.522,5.025C9.505,39.556,16.227,44,24,44z`}},{tag:"path",attr:{fill:"#1976D2",d:`M43.611,20.083H42V20H24v8h11.303c-0.792,2.237-2.231,4.166-4.087,5.571\r
	c0.001-0.001,0.002-0.001,0.003-0.002l6.19,5.238C36.971,39.205,44,34,44,24C44,22.659,43.862,21.35,43.611,20.083z`}}]})(t)}const LI=()=>{const[t,e]=v.useState(""),[r,n]=v.useState(""),[i,s]=v.useState(""),[a,o]=v.useState(!1),[l,c]=v.useState(!1),{login:u,loginWithGoogle:f}=zs(),d=Di(),h=async g=>{if(g.preventDefault(),s(""),!t||!r){s("Please enter both email and password");return}try{c(!0),await u(t,r),d("/")}catch(w){s(w.message||"Login failed. Please check your credentials and try again."),console.error("Login error:",w)}finally{c(!1)}},m=async()=>{try{c(!0),await f(),d("/")}catch(g){s(g.message||"Google sign-in failed. Please try again."),console.error("Google sign-in error:",g)}finally{c(!1)}},p=()=>{e("demo@example.com"),n("demo123")};return x.jsxs("div",{className:"flex min-h-screen flex-col justify-center bg-gray-50 py-12 px-4 sm:px-6 lg:px-8",children:[x.jsx("div",{className:"sm:mx-auto sm:w-full sm:max-w-md",children:x.jsx("h2",{className:"mt-6 text-center text-3xl font-extrabold text-gray-900",children:"Sign in to your account"})}),x.jsx("div",{className:"mt-8 sm:mx-auto sm:w-full sm:max-w-md",children:x.jsxs("div",{className:"bg-white py-8 px-4 shadow sm:rounded-lg sm:px-10",children:[x.jsxs("form",{className:"space-y-6",onSubmit:h,children:[i&&x.jsx("div",{className:"rounded-md bg-red-50 p-4",children:x.jsxs("div",{className:"flex",children:[x.jsx("div",{className:"flex-shrink-0",children:x.jsx("svg",{className:"h-5 w-5 text-red-400",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",children:x.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.28 7.22a.75.75 0 00-1.06 1.06L8.94 10l-1.72 1.72a.75.75 0 101.06 1.06L10 11.06l1.72 1.72a.75.75 0 101.06-1.06L11.06 10l1.72-1.72a.75.75 0 00-1.06-1.06L10 8.94 8.28 7.22z",clipRule:"evenodd"})})}),x.jsx("div",{className:"ml-3",children:x.jsx("h3",{className:"text-sm font-medium text-red-800",children:i})})]})}),x.jsxs("div",{children:[x.jsx("label",{htmlFor:"email",className:"block text-sm font-medium leading-6 text-gray-900",children:"Email address"}),x.jsx("div",{className:"mt-1",children:x.jsx("input",{id:"email",name:"email",type:"email",autoComplete:"email",required:!0,value:t,onChange:g=>e(g.target.value),className:"block w-full rounded-md border-0 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6"})})]}),x.jsxs("div",{children:[x.jsx("label",{htmlFor:"password",className:"block text-sm font-medium leading-6 text-gray-900",children:"Password"}),x.jsx("div",{className:"mt-1",children:x.jsx("input",{id:"password",name:"password",type:"password",autoComplete:"current-password",required:!0,value:r,onChange:g=>n(g.target.value),className:"block w-full rounded-md border-0 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6"})})]}),x.jsxs("div",{className:"flex items-center justify-between",children:[x.jsxs("div",{className:"flex items-center",children:[x.jsx("input",{id:"remember-me",name:"remember-me",type:"checkbox",checked:a,onChange:g=>o(g.target.checked),className:"h-4 w-4 rounded border-gray-300 text-indigo-600 focus:ring-indigo-600"}),x.jsx("label",{htmlFor:"remember-me",className:"ml-2 block text-sm text-gray-900",children:"Remember me"})]}),x.jsx("div",{className:"text-sm",children:x.jsx("a",{href:"#",className:"font-medium text-indigo-600 hover:text-indigo-500",children:"Forgot password?"})})]}),x.jsx("div",{children:x.jsx("button",{type:"submit",disabled:l,className:"flex w-full justify-center rounded-md bg-indigo-600 px-3 py-1.5 text-sm font-semibold leading-6 text-white shadow-sm hover:bg-indigo-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-600 disabled:opacity-50 disabled:cursor-not-allowed",children:l?"Signing in...":x.jsxs("span",{className:"flex items-center justify-center",children:[x.jsx(kI,{className:"mr-2 h-4 w-4"}),"Sign in"]})})})]}),x.jsxs("div",{className:"mt-6",children:[x.jsxs("div",{className:"relative",children:[x.jsx("div",{className:"absolute inset-0 flex items-center",children:x.jsx("div",{className:"w-full border-t border-gray-300"})}),x.jsx("div",{className:"relative flex justify-center text-sm",children:x.jsx("span",{className:"bg-white px-2 text-gray-500",children:"Or continue with"})})]}),x.jsx("div",{className:"mt-6",children:x.jsxs("button",{onClick:m,disabled:l,className:"flex w-full justify-center items-center rounded-md bg-white px-3 py-2 text-sm font-semibold leading-6 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 hover:bg-gray-50 focus-visible:outline-offset-0 disabled:opacity-50 disabled:cursor-not-allowed",children:[x.jsx(Nm,{className:"mr-2 h-5 w-5"}),"Sign in with Google"]})}),x.jsxs("div",{className:"mt-4",children:[x.jsxs("div",{className:"relative",children:[x.jsx("div",{className:"absolute inset-0 flex items-center",children:x.jsx("div",{className:"w-full border-t border-gray-300"})}),x.jsx("div",{className:"relative flex justify-center text-sm",children:x.jsx("span",{className:"bg-white px-2 text-gray-500",children:"Or try demo credentials"})})]}),x.jsx("div",{className:"mt-4",children:x.jsx("button",{onClick:p,disabled:l,className:"flex w-full justify-center rounded-md bg-gray-100 px-3 py-1.5 text-sm font-semibold leading-6 text-gray-700 shadow-sm hover:bg-gray-200 focus-visible:outline-offset-0 disabled:opacity-50 disabled:cursor-not-allowed",children:"Fill demo credentials"})})]})]}),x.jsxs("p",{className:"mt-8 text-center text-sm text-gray-500",children:["Don't have an account?"," ",x.jsx(lr,{to:"/register",className:"font-semibold leading-6 text-indigo-600 hover:text-indigo-500",children:"Sign up"})]})]})})]})},MI=()=>{const[t,e]=v.useState(""),[r,n]=v.useState(""),[i,s]=v.useState(""),[a,o]=v.useState(""),[l,c]=v.useState(""),[u,f]=v.useState(!1),{register:d,loginWithGoogle:h}=zs(),m=Di(),p=async w=>{if(w.preventDefault(),c(""),!t||!r||!i||!a){c("Please fill in all fields");return}if(r!==i){c("Passwords do not match");return}if(r.length<6){c("Password must be at least 6 characters long");return}try{f(!0),await d(t,r,a),m("/")}catch(b){c(b.message||"Registration failed. Please try again."),console.error("Registration error:",b)}finally{f(!1)}},g=async()=>{try{f(!0),await h(),m("/")}catch(w){c(w.message||"Google sign-up failed. Please try again."),console.error("Google sign-up error:",w)}finally{f(!1)}};return x.jsxs("div",{className:"flex min-h-screen flex-col justify-center bg-gray-50 py-12 px-4 sm:px-6 lg:px-8",children:[x.jsxs("div",{className:"sm:mx-auto sm:w-full sm:max-w-md",children:[x.jsx("h2",{className:"mt-6 text-center text-3xl font-extrabold text-gray-900",children:"Create your account"}),x.jsxs("p",{className:"mt-2 text-center text-sm text-gray-600",children:["Or"," ",x.jsx(lr,{to:"/login",className:"font-medium text-indigo-600 hover:text-indigo-500",children:"sign in to your existing account"})]})]}),x.jsx("div",{className:"mt-8 sm:mx-auto sm:w-full sm:max-w-md",children:x.jsxs("div",{className:"bg-white py-8 px-4 shadow sm:rounded-lg sm:px-10",children:[x.jsxs("form",{className:"space-y-6",onSubmit:p,children:[l&&x.jsx("div",{className:"rounded-md bg-red-50 p-4",children:x.jsxs("div",{className:"flex",children:[x.jsx("div",{className:"flex-shrink-0",children:x.jsx("svg",{className:"h-5 w-5 text-red-400",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",children:x.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.28 7.22a.75.75 0 00-1.06 1.06L8.94 10l-1.72 1.72a.75.75 0 101.06 1.06L10 11.06l1.72 1.72a.75.75 0 101.06-1.06L11.06 10l1.72-1.72a.75.75 0 00-1.06-1.06L10 8.94 8.28 7.22z",clipRule:"evenodd"})})}),x.jsx("div",{className:"ml-3",children:x.jsx("h3",{className:"text-sm font-medium text-red-800",children:l})})]})}),x.jsxs("div",{children:[x.jsx("label",{htmlFor:"displayName",className:"block text-sm font-medium leading-6 text-gray-900",children:"Full Name"}),x.jsx("div",{className:"mt-1",children:x.jsx("input",{id:"displayName",name:"displayName",type:"text",autoComplete:"name",required:!0,value:a,onChange:w=>o(w.target.value),className:"block w-full rounded-md border-0 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6"})})]}),x.jsxs("div",{children:[x.jsx("label",{htmlFor:"email",className:"block text-sm font-medium leading-6 text-gray-900",children:"Email address"}),x.jsx("div",{className:"mt-1",children:x.jsx("input",{id:"email",name:"email",type:"email",autoComplete:"email",required:!0,value:t,onChange:w=>e(w.target.value),className:"block w-full rounded-md border-0 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6"})})]}),x.jsxs("div",{children:[x.jsx("label",{htmlFor:"password",className:"block text-sm font-medium leading-6 text-gray-900",children:"Password"}),x.jsx("div",{className:"mt-1",children:x.jsx("input",{id:"password",name:"password",type:"password",autoComplete:"new-password",required:!0,value:r,onChange:w=>n(w.target.value),className:"block w-full rounded-md border-0 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6"})})]}),x.jsxs("div",{children:[x.jsx("label",{htmlFor:"confirmPassword",className:"block text-sm font-medium leading-6 text-gray-900",children:"Confirm Password"}),x.jsx("div",{className:"mt-1",children:x.jsx("input",{id:"confirmPassword",name:"confirmPassword",type:"password",autoComplete:"new-password",required:!0,value:i,onChange:w=>s(w.target.value),className:"block w-full rounded-md border-0 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6"})})]}),x.jsx("div",{children:x.jsx("button",{type:"submit",disabled:u,className:"flex w-full justify-center rounded-md bg-indigo-600 px-3 py-1.5 text-sm font-semibold leading-6 text-white shadow-sm hover:bg-indigo-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-600 disabled:opacity-50 disabled:cursor-not-allowed",children:u?"Creating account...":x.jsxs("span",{className:"flex items-center justify-center",children:[x.jsx(PI,{className:"mr-2 h-4 w-4"}),"Create account"]})})})]}),x.jsxs("div",{className:"mt-6",children:[x.jsxs("div",{className:"relative",children:[x.jsx("div",{className:"absolute inset-0 flex items-center",children:x.jsx("div",{className:"w-full border-t border-gray-300"})}),x.jsx("div",{className:"relative flex justify-center text-sm",children:x.jsx("span",{className:"bg-white px-2 text-gray-500",children:"Or continue with"})})]}),x.jsx("div",{className:"mt-6",children:x.jsxs("button",{onClick:g,disabled:u,className:"flex w-full justify-center items-center rounded-md bg-white px-3 py-2 text-sm font-semibold leading-6 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 hover:bg-gray-50 focus-visible:outline-offset-0 disabled:opacity-50 disabled:cursor-not-allowed",children:[x.jsx(Nm,{className:"mr-2 h-5 w-5"}),"Sign up with Google"]})})]}),x.jsxs("p",{className:"mt-8 text-center text-sm text-gray-500",children:["Already have an account?"," ",x.jsx(lr,{to:"/login",className:"font-semibold leading-6 text-indigo-600 hover:text-indigo-500",children:"Sign in"})]})]})})]})};function jI({companies:t,isLoading:e,error:r}){const[n,i]=v.useState(null),s=Di(),a=u=>{let f="asc";n&&n.key===u&&n.direction==="asc"&&(f="desc"),i({key:u,direction:f})},o=[...t];n!==null&&o.sort((u,f)=>{const d=u[n.key],h=f[n.key];return d==null&&h==null?0:d==null?1:h==null?-1:d<h?n.direction==="asc"?-1:1:d>h?n.direction==="asc"?1:-1:0});const l=u=>!n||n.key!==u?null:n.direction==="asc"?"↑":"↓",c=u=>{s(`/companies/${u}`)};return e?x.jsx("div",{className:"flex justify-center items-center h-64",children:x.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-indigo-500"})}):r?x.jsx("div",{className:"rounded-md bg-red-50 p-4",children:x.jsxs("div",{className:"flex",children:[x.jsx("div",{className:"flex-shrink-0",children:x.jsx("svg",{className:"h-5 w-5 text-red-400",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",children:x.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.28 7.22a.75.75 0 00-1.06 1.06L8.94 10l-1.72 1.72a.75.75 0 101.06 1.06L10 11.06l1.72 1.72a.75.75 0 101.06-1.06L11.06 10l1.72-1.72a.75.75 0 00-1.06-1.06L10 8.94 8.28 7.22z",clipRule:"evenodd"})})}),x.jsxs("div",{className:"ml-3",children:[x.jsx("h3",{className:"text-sm font-medium text-red-800",children:"Error loading companies"}),x.jsx("div",{className:"mt-2 text-sm text-red-700",children:x.jsx("p",{children:r.message})})]})]})}):t.length===0?x.jsxs("div",{className:"text-center py-12",children:[x.jsx("svg",{className:"mx-auto h-12 w-12 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","aria-hidden":"true",children:x.jsx("path",{vectorEffect:"non-scaling-stroke",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9.172 16.172a4 4 0 015.656 0M9 10h.01M15 10h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),x.jsx("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"No companies found"}),x.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Try adjusting your search or filter to find what you're looking for."})]}):x.jsx("div",{className:"overflow-hidden",children:x.jsx("div",{className:"inline-block min-w-full align-middle",children:x.jsxs("table",{className:"min-w-full divide-y divide-gray-300",children:[x.jsx("thead",{className:"bg-gray-50",children:x.jsxs("tr",{children:[x.jsx("th",{scope:"col",className:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900 cursor-pointer",onClick:()=>a("name"),children:x.jsxs("div",{className:"group inline-flex",children:["Name",x.jsx("span",{className:"ml-2 flex-none rounded text-gray-400 group-hover:visible",children:l("name")||"↕"})]})}),x.jsx("th",{scope:"col",className:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900 cursor-pointer",onClick:()=>a("business_id"),children:x.jsxs("div",{className:"group inline-flex",children:["Business ID",x.jsx("span",{className:"ml-2 flex-none rounded text-gray-400 group-hover:visible",children:l("business_id")||"↕"})]})}),x.jsx("th",{scope:"col",className:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900",children:"Industry"}),x.jsx("th",{scope:"col",className:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900",children:"Location"}),x.jsx("th",{scope:"col",className:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900",children:"Type"}),x.jsx("th",{scope:"col",className:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900 cursor-pointer",onClick:()=>a("revenue"),children:x.jsxs("div",{className:"group inline-flex",children:["Revenue (€)",x.jsx("span",{className:"ml-2 flex-none rounded text-gray-400 group-hover:visible",children:l("revenue")||"↕"})]})}),x.jsx("th",{scope:"col",className:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900",children:"Registered"})]})}),x.jsx("tbody",{className:"divide-y divide-gray-200 bg-white",children:o.map(u=>x.jsxs("tr",{className:"hover:bg-gray-50 cursor-pointer",onClick:()=>c(u.id),children:[x.jsx("td",{className:"whitespace-nowrap py-4 pl-4 pr-3 text-sm font-medium text-gray-900 sm:pl-6",children:u.name}),x.jsx("td",{className:"whitespace-nowrap px-3 py-4 text-sm text-gray-500",children:u.business_id}),x.jsx("td",{className:"whitespace-nowrap px-3 py-4 text-sm text-gray-500",children:u.industry||"-"}),x.jsx("td",{className:"whitespace-nowrap px-3 py-4 text-sm text-gray-500",children:u.city||"-"}),x.jsx("td",{className:"whitespace-nowrap px-3 py-4 text-sm text-gray-500",children:u.company_type||"-"}),x.jsx("td",{className:"whitespace-nowrap px-3 py-4 text-sm text-gray-500",children:u.revenue?`€${u.revenue.toLocaleString()}`:"-"}),x.jsx("td",{className:"whitespace-nowrap px-3 py-4 text-sm text-gray-500",children:u.registration_date?new Date(u.registration_date).toLocaleDateString():"-"})]},u.id))})]})})})}function $I({currentPage:t,totalItems:e,itemsPerPage:r,onPageChange:n}){const i=Math.ceil(e/r),s=5;if(i<=1)return null;const o=(()=>{const l=[];let c=Math.max(1,t-Math.floor(s/2)),u=c+s-1;u>i&&(u=i,c=Math.max(1,u-s+1));for(let f=c;f<=u;f++)l.push(f);return l})();return x.jsxs("nav",{className:"isolate inline-flex -space-x-px rounded-md shadow-sm","aria-label":"Pagination",children:[x.jsxs("button",{onClick:()=>n(t-1),disabled:t===1,className:"relative inline-flex items-center rounded-l-md px-2 py-2 text-gray-400 ring-1 ring-inset ring-gray-300 hover:bg-gray-50 focus:z-20 focus:outline-offset-0 disabled:opacity-50",children:[x.jsx("span",{className:"sr-only",children:"Previous"}),x.jsx(bI,{className:"h-5 w-5","aria-hidden":"true"})]}),!o.includes(1)&&x.jsxs(x.Fragment,{children:[x.jsx("button",{onClick:()=>n(1),className:"relative inline-flex items-center px-4 py-2 text-sm font-semibold text-gray-900 ring-1 ring-inset ring-gray-300 hover:bg-gray-50 focus:z-20 focus:outline-offset-0",children:"1"}),!o.includes(2)&&x.jsx("span",{className:"relative inline-flex items-center px-4 py-2 text-sm font-semibold text-gray-700 ring-1 ring-inset ring-gray-300",children:"..."})]}),o.map(l=>x.jsx("button",{onClick:()=>n(l),className:`relative inline-flex items-center px-4 py-2 text-sm font-semibold ${t===l?"z-10 bg-indigo-600 text-white focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-600":"text-gray-900 ring-1 ring-inset ring-gray-300 hover:bg-gray-50 focus:z-20 focus:outline-offset-0"}`,children:l},l)),!o.includes(i)&&x.jsxs(x.Fragment,{children:[!o.includes(i-1)&&x.jsx("span",{className:"relative inline-flex items-center px-4 py-2 text-sm font-semibold text-gray-700 ring-1 ring-inset ring-gray-300",children:"..."}),x.jsx("button",{onClick:()=>n(i),className:"relative inline-flex items-center px-4 py-2 text-sm font-semibold text-gray-900 ring-1 ring-inset ring-gray-300 hover:bg-gray-50 focus:z-20 focus:outline-offset-0",children:i})]}),x.jsxs("button",{onClick:()=>n(t+1),disabled:t===i,className:"relative inline-flex items-center rounded-r-md px-2 py-2 text-gray-400 ring-1 ring-inset ring-gray-300 hover:bg-gray-50 focus:z-20 focus:outline-offset-0 disabled:opacity-50",children:[x.jsx("span",{className:"sr-only",children:"Next"}),x.jsx(AI,{className:"h-5 w-5","aria-hidden":"true"})]})]})}function BI({filters:t,onFilterChange:e,onReset:r}){return x.jsxs("div",{className:"mt-4 rounded-md bg-gray-50 p-4",children:[x.jsxs("div",{className:"flex items-center justify-between",children:[x.jsx("h3",{className:"text-sm font-medium text-gray-900",children:"Filters"}),x.jsx("button",{type:"button",onClick:r,className:"text-sm font-medium text-indigo-600 hover:text-indigo-500",children:"Reset all"})]}),x.jsxs("div",{className:"mt-4 grid grid-cols-1 gap-4 sm:grid-cols-2 lg:grid-cols-3",children:[x.jsxs("div",{children:[x.jsx("label",{htmlFor:"company_name",className:"block text-sm font-medium text-gray-700",children:"Company Name"}),x.jsx("input",{type:"text",name:"company_name",id:"company_name",value:t.company_name,onChange:e,className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm",placeholder:"e.g. Tech Solutions"})]}),x.jsxs("div",{children:[x.jsx("label",{htmlFor:"business_id",className:"block text-sm font-medium text-gray-700",children:"Business ID"}),x.jsx("input",{type:"text",name:"business_id",id:"business_id",value:t.business_id,onChange:e,className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm",placeholder:"e.g. FI12345678"})]}),x.jsxs("div",{children:[x.jsx("label",{htmlFor:"industry",className:"block text-sm font-medium text-gray-700",children:"Industry"}),x.jsx("input",{type:"text",name:"industry",id:"industry",value:t.industry,onChange:e,className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm",placeholder:"e.g. Technology, Healthcare"})]}),x.jsxs("div",{children:[x.jsx("label",{htmlFor:"location",className:"block text-sm font-medium text-gray-700",children:"Location"}),x.jsx("input",{type:"text",name:"location",id:"location",value:t.location,onChange:e,className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm",placeholder:"e.g. Helsinki, Finland"})]}),x.jsxs("div",{children:[x.jsx("label",{htmlFor:"city",className:"block text-sm font-medium text-gray-700",children:"City"}),x.jsx("input",{type:"text",name:"city",id:"city",value:t.city,onChange:e,className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm",placeholder:"e.g. Helsinki"})]}),x.jsxs("div",{children:[x.jsx("label",{htmlFor:"company_type",className:"block text-sm font-medium text-gray-700",children:"Company Type"}),x.jsxs("select",{id:"company_type",name:"company_type",value:t.company_type,onChange:e,className:"mt-1 block w-full rounded-md border-gray-300 py-2 pl-3 pr-10 text-base focus:border-indigo-500 focus:outline-none focus:ring-indigo-500 sm:text-sm",children:[x.jsx("option",{value:"",children:"All Types"}),x.jsx("option",{value:"Corporation",children:"Corporation"}),x.jsx("option",{value:"LLC",children:"LLC"}),x.jsx("option",{value:"Sole Proprietorship",children:"Sole Proprietorship"}),x.jsx("option",{value:"Partnership",children:"Partnership"}),x.jsx("option",{value:"Non-Profit",children:"Non-Profit"})]})]}),x.jsxs("div",{children:[x.jsx("label",{htmlFor:"min_revenue",className:"block text-sm font-medium text-gray-700",children:"Min Revenue (€)"}),x.jsx("input",{type:"number",name:"min_revenue",id:"min_revenue",value:t.min_revenue,onChange:e,className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm",placeholder:"e.g. 100000",min:"0",step:"1000"})]}),x.jsxs("div",{children:[x.jsx("label",{htmlFor:"max_revenue",className:"block text-sm font-medium text-gray-700",children:"Max Revenue (€)"}),x.jsx("input",{type:"number",name:"max_revenue",id:"max_revenue",value:t.max_revenue,onChange:e,className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm",placeholder:"e.g. 5000000",min:"0",step:"1000"})]}),x.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[x.jsxs("div",{children:[x.jsx("label",{htmlFor:"min_date",className:"block text-sm font-medium text-gray-700",children:"From Date"}),x.jsx("input",{type:"date",name:"min_date",id:"min_date",value:t.min_date,onChange:e,className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"})]}),x.jsxs("div",{children:[x.jsx("label",{htmlFor:"max_date",className:"block text-sm font-medium text-gray-700",children:"To Date"}),x.jsx("input",{type:"date",name:"max_date",id:"max_date",value:t.max_date,onChange:e,className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"})]})]})]})]})}/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var Ka={};Ka.version="0.18.5";var Dm=1252,UI=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],Lm=function(t){UI.indexOf(t)!=-1&&(Dm=t)};function HI(){Lm(1252)}var As=function(t){Lm(t)};function WI(){As(1200),HI()}function VI(t){for(var e=[],r=0;r<t.length>>1;++r)e[r]=String.fromCharCode(t.charCodeAt(2*r+1)+(t.charCodeAt(2*r)<<8));return e.join("")}var ha=function(e){return String.fromCharCode(e)},Oh=function(e){return String.fromCharCode(e)},On,sn="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Cs(t){for(var e="",r=0,n=0,i=0,s=0,a=0,o=0,l=0,c=0;c<t.length;)r=t.charCodeAt(c++),s=r>>2,n=t.charCodeAt(c++),a=(r&3)<<4|n>>4,i=t.charCodeAt(c++),o=(n&15)<<2|i>>6,l=i&63,isNaN(n)?o=l=64:isNaN(i)&&(l=64),e+=sn.charAt(s)+sn.charAt(a)+sn.charAt(o)+sn.charAt(l);return e}function Br(t){var e="",r=0,n=0,i=0,s=0,a=0,o=0,l=0;t=t.replace(/[^\w\+\/\=]/g,"");for(var c=0;c<t.length;)s=sn.indexOf(t.charAt(c++)),a=sn.indexOf(t.charAt(c++)),r=s<<2|a>>4,e+=String.fromCharCode(r),o=sn.indexOf(t.charAt(c++)),n=(a&15)<<4|o>>2,o!==64&&(e+=String.fromCharCode(n)),l=sn.indexOf(t.charAt(c++)),i=(o&3)<<6|l,l!==64&&(e+=String.fromCharCode(i));return e}var Se=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),Vr=function(){if(typeof Buffer<"u"){var t=!Buffer.from;if(!t)try{Buffer.from("foo","utf8")}catch{t=!0}return t?function(e,r){return r?new Buffer(e,r):new Buffer(e)}:Buffer.from.bind(Buffer)}return function(){}}();function Kn(t){return Se?Buffer.alloc?Buffer.alloc(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}function Rh(t){return Se?Buffer.allocUnsafe?Buffer.allocUnsafe(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}var Jt=function(e){return Se?Vr(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)&255})};function Ro(t){if(typeof ArrayBuffer>"u")return Jt(t);for(var e=new ArrayBuffer(t.length),r=new Uint8Array(e),n=0;n!=t.length;++n)r[n]=t.charCodeAt(n)&255;return e}function qs(t){if(Array.isArray(t))return t.map(function(n){return String.fromCharCode(n)}).join("");for(var e=[],r=0;r<t.length;++r)e[r]=String.fromCharCode(t[r]);return e.join("")}function GI(t){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(t)}var ot=Se?function(t){return Buffer.concat(t.map(function(e){return Buffer.isBuffer(e)?e:Vr(e)}))}:function(t){if(typeof Uint8Array<"u"){var e=0,r=0;for(e=0;e<t.length;++e)r+=t[e].length;var n=new Uint8Array(r),i=0;for(e=0,r=0;e<t.length;r+=i,++e)if(i=t[e].length,t[e]instanceof Uint8Array)n.set(t[e],r);else{if(typeof t[e]=="string")throw"wtf";n.set(new Uint8Array(t[e]),r)}return n}return[].concat.apply([],t.map(function(s){return Array.isArray(s)?s:[].slice.call(s)}))};function zI(t){for(var e=[],r=0,n=t.length+250,i=Kn(t.length+255),s=0;s<t.length;++s){var a=t.charCodeAt(s);if(a<128)i[r++]=a;else if(a<2048)i[r++]=192|a>>6&31,i[r++]=128|a&63;else if(a>=55296&&a<57344){a=(a&1023)+64;var o=t.charCodeAt(++s)&1023;i[r++]=240|a>>8&7,i[r++]=128|a>>2&63,i[r++]=128|o>>6&15|(a&3)<<4,i[r++]=128|o&63}else i[r++]=224|a>>12&15,i[r++]=128|a>>6&63,i[r++]=128|a&63;r>n&&(e.push(i.slice(0,r)),r=0,i=Kn(65535),n=65530)}return e.push(i.slice(0,r)),ot(e)}var hs=/\u0000/g,da=/[\u0001-\u0006]/g;function Si(t){for(var e="",r=t.length-1;r>=0;)e+=t.charAt(r--);return e}function Zt(t,e){var r=""+t;return r.length>=e?r:We("0",e-r.length)+r}function vu(t,e){var r=""+t;return r.length>=e?r:We(" ",e-r.length)+r}function Xa(t,e){var r=""+t;return r.length>=e?r:r+We(" ",e-r.length)}function qI(t,e){var r=""+Math.round(t);return r.length>=e?r:We("0",e-r.length)+r}function KI(t,e){var r=""+t;return r.length>=e?r:We("0",e-r.length)+r}var Ph=Math.pow(2,32);function oi(t,e){if(t>Ph||t<-Ph)return qI(t,e);var r=Math.round(t);return KI(r,e)}function Ya(t,e){return e=e||0,t.length>=7+e&&(t.charCodeAt(e)|32)===103&&(t.charCodeAt(e+1)|32)===101&&(t.charCodeAt(e+2)|32)===110&&(t.charCodeAt(e+3)|32)===101&&(t.charCodeAt(e+4)|32)===114&&(t.charCodeAt(e+5)|32)===97&&(t.charCodeAt(e+6)|32)===108}var Fh=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],xl=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function XI(t){return t||(t={}),t[0]="General",t[1]="0",t[2]="0.00",t[3]="#,##0",t[4]="#,##0.00",t[9]="0%",t[10]="0.00%",t[11]="0.00E+00",t[12]="# ?/?",t[13]="# ??/??",t[14]="m/d/yy",t[15]="d-mmm-yy",t[16]="d-mmm",t[17]="mmm-yy",t[18]="h:mm AM/PM",t[19]="h:mm:ss AM/PM",t[20]="h:mm",t[21]="h:mm:ss",t[22]="m/d/yy h:mm",t[37]="#,##0 ;(#,##0)",t[38]="#,##0 ;[Red](#,##0)",t[39]="#,##0.00;(#,##0.00)",t[40]="#,##0.00;[Red](#,##0.00)",t[45]="mm:ss",t[46]="[h]:mm:ss",t[47]="mmss.0",t[48]="##0.0E+0",t[49]="@",t[56]='"上午/下午 "hh"時"mm"分"ss"秒 "',t}var Ve={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"上午/下午 "hh"時"mm"分"ss"秒 "'},Nh={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},YI={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function Ja(t,e,r){for(var n=t<0?-1:1,i=t*n,s=0,a=1,o=0,l=1,c=0,u=0,f=Math.floor(i);c<e&&(f=Math.floor(i),o=f*a+s,u=f*c+l,!(i-f<5e-8));)i=1/(i-f),s=a,a=o,l=c,c=u;if(u>e&&(c>e?(u=l,o=s):(u=c,o=a)),!r)return[0,n*o,u];var d=Math.floor(n*o/u);return[d,n*o-d*u,u]}function pa(t,e,r){if(t>2958465||t<0)return null;var n=t|0,i=Math.floor(86400*(t-n)),s=0,a=[],o={D:n,T:i,u:86400*(t-n)-i,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),e&&e.date1904&&(n+=1462),o.u>.9999&&(o.u=0,++i==86400&&(o.T=i=0,++n,++o.D)),n===60)a=r?[1317,10,29]:[1900,2,29],s=3;else if(n===0)a=r?[1317,8,29]:[1900,1,0],s=6;else{n>60&&--n;var l=new Date(1900,0,1);l.setDate(l.getDate()+n-1),a=[l.getFullYear(),l.getMonth()+1,l.getDate()],s=l.getDay(),n<60&&(s=(s+6)%7),r&&(s=nk(l,a))}return o.y=a[0],o.m=a[1],o.d=a[2],o.S=i%60,i=Math.floor(i/60),o.M=i%60,i=Math.floor(i/60),o.H=i,o.q=s,o}var Mm=new Date(1899,11,31,0,0,0),JI=Mm.getTime(),QI=new Date(1900,2,1,0,0,0);function jm(t,e){var r=t.getTime();return e?r-=1461*24*60*60*1e3:t>=QI&&(r+=24*60*60*1e3),(r-(JI+(t.getTimezoneOffset()-Mm.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function xu(t){return t.indexOf(".")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function ZI(t){return t.indexOf("E")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function ek(t){var e=t<0?12:11,r=xu(t.toFixed(12));return r.length<=e||(r=t.toPrecision(10),r.length<=e)?r:t.toExponential(5)}function tk(t){var e=xu(t.toFixed(11));return e.length>(t<0?12:11)||e==="0"||e==="-0"?t.toPrecision(6):e}function rk(t){var e=Math.floor(Math.log(Math.abs(t))*Math.LOG10E),r;return e>=-4&&e<=-1?r=t.toPrecision(10+e):Math.abs(e)<=9?r=ek(t):e===10?r=t.toFixed(10).substr(0,12):r=tk(t),xu(ZI(r.toUpperCase()))}function dc(t,e){switch(typeof t){case"string":return t;case"boolean":return t?"TRUE":"FALSE";case"number":return(t|0)===t?t.toString(10):rk(t);case"undefined":return"";case"object":if(t==null)return"";if(t instanceof Date)return hn(14,jm(t,e&&e.date1904),e)}throw new Error("unsupported value in General format: "+t)}function nk(t,e){e[0]-=581;var r=t.getDay();return t<60&&(r=(r+6)%7),r}function ik(t,e,r,n){var i="",s=0,a=0,o=r.y,l,c=0;switch(t){case 98:o=r.y+543;case 121:switch(e.length){case 1:case 2:l=o%100,c=2;break;default:l=o%1e4,c=4;break}break;case 109:switch(e.length){case 1:case 2:l=r.m,c=e.length;break;case 3:return xl[r.m-1][1];case 5:return xl[r.m-1][0];default:return xl[r.m-1][2]}break;case 100:switch(e.length){case 1:case 2:l=r.d,c=e.length;break;case 3:return Fh[r.q][0];default:return Fh[r.q][1]}break;case 104:switch(e.length){case 1:case 2:l=1+(r.H+11)%12,c=e.length;break;default:throw"bad hour format: "+e}break;case 72:switch(e.length){case 1:case 2:l=r.H,c=e.length;break;default:throw"bad hour format: "+e}break;case 77:switch(e.length){case 1:case 2:l=r.M,c=e.length;break;default:throw"bad minute format: "+e}break;case 115:if(e!="s"&&e!="ss"&&e!=".0"&&e!=".00"&&e!=".000")throw"bad second format: "+e;return r.u===0&&(e=="s"||e=="ss")?Zt(r.S,e.length):(n>=2?a=n===3?1e3:100:a=n===1?10:1,s=Math.round(a*(r.S+r.u)),s>=60*a&&(s=0),e==="s"?s===0?"0":""+s/a:(i=Zt(s,2+n),e==="ss"?i.substr(0,2):"."+i.substr(2,e.length-1)));case 90:switch(e){case"[h]":case"[hh]":l=r.D*24+r.H;break;case"[m]":case"[mm]":l=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":l=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+e}c=e.length===3?1:2;break;case 101:l=o,c=1;break}var u=c>0?Zt(l,c):"";return u}function an(t){var e=3;if(t.length<=e)return t;for(var r=t.length%e,n=t.substr(0,r);r!=t.length;r+=e)n+=(n.length>0?",":"")+t.substr(r,e);return n}var $m=/%/g;function sk(t,e,r){var n=e.replace($m,""),i=e.length-n.length;return Pr(t,n,r*Math.pow(10,2*i))+We("%",i)}function ak(t,e,r){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return Pr(t,e.substr(0,n),r/Math.pow(10,3*(e.length-n)))}function Bm(t,e){var r,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+Bm(t,-e);var i=t.indexOf(".");i===-1&&(i=t.indexOf("E"));var s=Math.floor(Math.log(e)*Math.LOG10E)%i;if(s<0&&(s+=i),r=(e/Math.pow(10,s)).toPrecision(n+1+(i+s)%i),r.indexOf("e")===-1){var a=Math.floor(Math.log(e)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(a-r.length+s):r+="E+"+(a-s);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,i)+"."+r.substr(2+i),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,c,u){return l+c+u.substr(0,(i+s)%i)+"."+u.substr(s)+"E"})}else r=e.toExponential(n);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var Um=/# (\?+)( ?)\/( ?)(\d+)/;function ok(t,e,r){var n=parseInt(t[4],10),i=Math.round(e*n),s=Math.floor(i/n),a=i-s*n,o=n;return r+(s===0?"":""+s)+" "+(a===0?We(" ",t[1].length+1+t[4].length):vu(a,t[1].length)+t[2]+"/"+t[3]+Zt(o,t[4].length))}function lk(t,e,r){return r+(e===0?"":""+e)+We(" ",t[1].length+2+t[4].length)}var Hm=/^#*0*\.([0#]+)/,Wm=/\).*[0#]/,Vm=/\(###\) ###\\?-####/;function xt(t){for(var e="",r,n=0;n!=t.length;++n)switch(r=t.charCodeAt(n)){case 35:break;case 63:e+=" ";break;case 48:e+="0";break;default:e+=String.fromCharCode(r)}return e}function Dh(t,e){var r=Math.pow(10,e);return""+Math.round(t*r)/r}function Lh(t,e){var r=t-Math.floor(t),n=Math.pow(10,e);return e<(""+Math.round(r*n)).length?0:Math.round(r*n)}function ck(t,e){return e<(""+Math.round((t-Math.floor(t))*Math.pow(10,e))).length?1:0}function uk(t){return t<2147483647&&t>-2147483648?""+(t>=0?t|0:t-1|0):""+Math.floor(t)}function Bt(t,e,r){if(t.charCodeAt(0)===40&&!e.match(Wm)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Bt("n",n,r):"("+Bt("n",n,-r)+")"}if(e.charCodeAt(e.length-1)===44)return ak(t,e,r);if(e.indexOf("%")!==-1)return sk(t,e,r);if(e.indexOf("E")!==-1)return Bm(e,r);if(e.charCodeAt(0)===36)return"$"+Bt(t,e.substr(e.charAt(1)==" "?2:1),r);var i,s,a,o,l=Math.abs(r),c=r<0?"-":"";if(e.match(/^00+$/))return c+oi(l,e.length);if(e.match(/^[#?]+$/))return i=oi(r,0),i==="0"&&(i=""),i.length>e.length?i:xt(e.substr(0,e.length-i.length))+i;if(s=e.match(Um))return ok(s,l,c);if(e.match(/^#+0+$/))return c+oi(l,e.length-e.indexOf("0"));if(s=e.match(Hm))return i=Dh(r,s[1].length).replace(/^([^\.]+)$/,"$1."+xt(s[1])).replace(/\.$/,"."+xt(s[1])).replace(/\.(\d*)$/,function(m,p){return"."+p+We("0",xt(s[1]).length-p.length)}),e.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),s=e.match(/^(0*)\.(#*)$/))return c+Dh(l,s[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=e.match(/^#{1,3},##0(\.?)$/))return c+an(oi(l,0));if(s=e.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Bt(t,e,-r):an(""+(Math.floor(r)+ck(r,s[1].length)))+"."+Zt(Lh(r,s[1].length),s[1].length);if(s=e.match(/^#,#*,#0/))return Bt(t,e.replace(/^#,#*,/,""),r);if(s=e.match(/^([0#]+)(\\?-([0#]+))+$/))return i=Si(Bt(t,e.replace(/[\\-]/g,""),r)),a=0,Si(Si(e.replace(/\\/g,"")).replace(/[0#]/g,function(m){return a<i.length?i.charAt(a++):m==="0"?"0":""}));if(e.match(Vm))return i=Bt(t,"##########",r),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var u="";if(s=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(s[4].length,7),o=Ja(l,Math.pow(10,a)-1,!1),i=""+c,u=Pr("n",s[1],o[1]),u.charAt(u.length-1)==" "&&(u=u.substr(0,u.length-1)+"0"),i+=u+s[2]+"/"+s[3],u=Xa(o[2],a),u.length<s[4].length&&(u=xt(s[4].substr(s[4].length-u.length))+u),i+=u,i;if(s=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(Math.max(s[1].length,s[4].length),7),o=Ja(l,Math.pow(10,a)-1,!0),c+(o[0]||(o[1]?"":"0"))+" "+(o[1]?vu(o[1],a)+s[2]+"/"+s[3]+Xa(o[2],a):We(" ",2*a+1+s[2].length+s[3].length));if(s=e.match(/^[#0?]+$/))return i=oi(r,0),e.length<=i.length?i:xt(e.substr(0,e.length-i.length))+i;if(s=e.match(/^([#0?]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),a=i.indexOf(".");var f=e.indexOf(".")-a,d=e.length-i.length-f;return xt(e.substr(0,f)+i+e.substr(e.length-d))}if(s=e.match(/^00,000\.([#0]*0)$/))return a=Lh(r,s[1].length),r<0?"-"+Bt(t,e,-r):an(uk(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(m){return"00,"+(m.length<3?Zt(0,3-m.length):"")+m})+"."+Zt(a,s[1].length);switch(e){case"###,##0.00":return Bt(t,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var h=an(oi(l,0));return h!=="0"?c+h:"";case"###,###.00":return Bt(t,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return Bt(t,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+e+"|")}function fk(t,e,r){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return Pr(t,e.substr(0,n),r/Math.pow(10,3*(e.length-n)))}function hk(t,e,r){var n=e.replace($m,""),i=e.length-n.length;return Pr(t,n,r*Math.pow(10,2*i))+We("%",i)}function Gm(t,e){var r,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+Gm(t,-e);var i=t.indexOf(".");i===-1&&(i=t.indexOf("E"));var s=Math.floor(Math.log(e)*Math.LOG10E)%i;if(s<0&&(s+=i),r=(e/Math.pow(10,s)).toPrecision(n+1+(i+s)%i),!r.match(/[Ee]/)){var a=Math.floor(Math.log(e)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(a-r.length+s):r+="E+"+(a-s),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,c,u){return l+c+u.substr(0,(i+s)%i)+"."+u.substr(s)+"E"})}else r=e.toExponential(n);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function ar(t,e,r){if(t.charCodeAt(0)===40&&!e.match(Wm)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?ar("n",n,r):"("+ar("n",n,-r)+")"}if(e.charCodeAt(e.length-1)===44)return fk(t,e,r);if(e.indexOf("%")!==-1)return hk(t,e,r);if(e.indexOf("E")!==-1)return Gm(e,r);if(e.charCodeAt(0)===36)return"$"+ar(t,e.substr(e.charAt(1)==" "?2:1),r);var i,s,a,o,l=Math.abs(r),c=r<0?"-":"";if(e.match(/^00+$/))return c+Zt(l,e.length);if(e.match(/^[#?]+$/))return i=""+r,r===0&&(i=""),i.length>e.length?i:xt(e.substr(0,e.length-i.length))+i;if(s=e.match(Um))return lk(s,l,c);if(e.match(/^#+0+$/))return c+Zt(l,e.length-e.indexOf("0"));if(s=e.match(Hm))return i=(""+r).replace(/^([^\.]+)$/,"$1."+xt(s[1])).replace(/\.$/,"."+xt(s[1])),i=i.replace(/\.(\d*)$/,function(m,p){return"."+p+We("0",xt(s[1]).length-p.length)}),e.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),s=e.match(/^(0*)\.(#*)$/))return c+(""+l).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=e.match(/^#{1,3},##0(\.?)$/))return c+an(""+l);if(s=e.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+ar(t,e,-r):an(""+r)+"."+We("0",s[1].length);if(s=e.match(/^#,#*,#0/))return ar(t,e.replace(/^#,#*,/,""),r);if(s=e.match(/^([0#]+)(\\?-([0#]+))+$/))return i=Si(ar(t,e.replace(/[\\-]/g,""),r)),a=0,Si(Si(e.replace(/\\/g,"")).replace(/[0#]/g,function(m){return a<i.length?i.charAt(a++):m==="0"?"0":""}));if(e.match(Vm))return i=ar(t,"##########",r),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var u="";if(s=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(s[4].length,7),o=Ja(l,Math.pow(10,a)-1,!1),i=""+c,u=Pr("n",s[1],o[1]),u.charAt(u.length-1)==" "&&(u=u.substr(0,u.length-1)+"0"),i+=u+s[2]+"/"+s[3],u=Xa(o[2],a),u.length<s[4].length&&(u=xt(s[4].substr(s[4].length-u.length))+u),i+=u,i;if(s=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(Math.max(s[1].length,s[4].length),7),o=Ja(l,Math.pow(10,a)-1,!0),c+(o[0]||(o[1]?"":"0"))+" "+(o[1]?vu(o[1],a)+s[2]+"/"+s[3]+Xa(o[2],a):We(" ",2*a+1+s[2].length+s[3].length));if(s=e.match(/^[#0?]+$/))return i=""+r,e.length<=i.length?i:xt(e.substr(0,e.length-i.length))+i;if(s=e.match(/^([#0]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),a=i.indexOf(".");var f=e.indexOf(".")-a,d=e.length-i.length-f;return xt(e.substr(0,f)+i+e.substr(e.length-d))}if(s=e.match(/^00,000\.([#0]*0)$/))return r<0?"-"+ar(t,e,-r):an(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(m){return"00,"+(m.length<3?Zt(0,3-m.length):"")+m})+"."+Zt(0,s[1].length);switch(e){case"###,###":case"##,###":case"#,###":var h=an(""+l);return h!=="0"?c+h:"";default:if(e.match(/\.[0#?]*$/))return ar(t,e.slice(0,e.lastIndexOf(".")),r)+xt(e.slice(e.lastIndexOf(".")))}throw new Error("unsupported format |"+e+"|")}function Pr(t,e,r){return(r|0)===r?ar(t,e,r):Bt(t,e,r)}function dk(t){for(var e=[],r=!1,n=0,i=0;n<t.length;++n)switch(t.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:e[e.length]=t.substr(i,n-i),i=n+1}if(e[e.length]=t.substr(i),r===!0)throw new Error("Format |"+t+"| unterminated string ");return e}var zm=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function qm(t){for(var e=0,r="",n="";e<t.length;)switch(r=t.charAt(e)){case"G":Ya(t,e)&&(e+=6),e++;break;case'"':for(;t.charCodeAt(++e)!==34&&e<t.length;);++e;break;case"\\":e+=2;break;case"_":e+=2;break;case"@":++e;break;case"B":case"b":if(t.charAt(e+1)==="1"||t.charAt(e+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"上":if(t.substr(e,3).toUpperCase()==="A/P"||t.substr(e,5).toUpperCase()==="AM/PM"||t.substr(e,5).toUpperCase()==="上午/下午")return!0;++e;break;case"[":for(n=r;t.charAt(e++)!=="]"&&e<t.length;)n+=t.charAt(e);if(n.match(zm))return!0;break;case".":case"0":case"#":for(;e<t.length&&("0#?.,E+-%".indexOf(r=t.charAt(++e))>-1||r=="\\"&&t.charAt(e+1)=="-"&&"0#".indexOf(t.charAt(e+2))>-1););break;case"?":for(;t.charAt(++e)===r;);break;case"*":++e,(t.charAt(e)==" "||t.charAt(e)=="*")&&++e;break;case"(":case")":++e;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;e<t.length&&"0123456789".indexOf(t.charAt(++e))>-1;);break;case" ":++e;break;default:++e;break}return!1}function pk(t,e,r,n){for(var i=[],s="",a=0,o="",l="t",c,u,f,d="H";a<t.length;)switch(o=t.charAt(a)){case"G":if(!Ya(t,a))throw new Error("unrecognized character "+o+" in "+t);i[i.length]={t:"G",v:"General"},a+=7;break;case'"':for(s="";(f=t.charCodeAt(++a))!==34&&a<t.length;)s+=String.fromCharCode(f);i[i.length]={t:"t",v:s},++a;break;case"\\":var h=t.charAt(++a),m=h==="("||h===")"?h:"t";i[i.length]={t:m,v:h},++a;break;case"_":i[i.length]={t:"t",v:" "},a+=2;break;case"@":i[i.length]={t:"T",v:e},++a;break;case"B":case"b":if(t.charAt(a+1)==="1"||t.charAt(a+1)==="2"){if(c==null&&(c=pa(e,r,t.charAt(a+1)==="2"),c==null))return"";i[i.length]={t:"X",v:t.substr(a,2)},l=o,a+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":o=o.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(e<0||c==null&&(c=pa(e,r),c==null))return"";for(s=o;++a<t.length&&t.charAt(a).toLowerCase()===o;)s+=o;o==="m"&&l.toLowerCase()==="h"&&(o="M"),o==="h"&&(o=d),i[i.length]={t:o,v:s},l=o;break;case"A":case"a":case"上":var p={t:o,v:o};if(c==null&&(c=pa(e,r)),t.substr(a,3).toUpperCase()==="A/P"?(c!=null&&(p.v=c.H>=12?"P":"A"),p.t="T",d="h",a+=3):t.substr(a,5).toUpperCase()==="AM/PM"?(c!=null&&(p.v=c.H>=12?"PM":"AM"),p.t="T",a+=5,d="h"):t.substr(a,5).toUpperCase()==="上午/下午"?(c!=null&&(p.v=c.H>=12?"下午":"上午"),p.t="T",a+=5,d="h"):(p.t="t",++a),c==null&&p.t==="T")return"";i[i.length]=p,l=o;break;case"[":for(s=o;t.charAt(a++)!=="]"&&a<t.length;)s+=t.charAt(a);if(s.slice(-1)!=="]")throw'unterminated "[" block: |'+s+"|";if(s.match(zm)){if(c==null&&(c=pa(e,r),c==null))return"";i[i.length]={t:"Z",v:s.toLowerCase()},l=s.charAt(1)}else s.indexOf("$")>-1&&(s=(s.match(/\$([^-\[\]]*)/)||[])[1]||"$",qm(t)||(i[i.length]={t:"t",v:s}));break;case".":if(c!=null){for(s=o;++a<t.length&&(o=t.charAt(a))==="0";)s+=o;i[i.length]={t:"s",v:s};break}case"0":case"#":for(s=o;++a<t.length&&"0#?.,E+-%".indexOf(o=t.charAt(a))>-1;)s+=o;i[i.length]={t:"n",v:s};break;case"?":for(s=o;t.charAt(++a)===o;)s+=o;i[i.length]={t:o,v:s},l=o;break;case"*":++a,(t.charAt(a)==" "||t.charAt(a)=="*")&&++a;break;case"(":case")":i[i.length]={t:n===1?"t":o,v:o},++a;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(s=o;a<t.length&&"0123456789".indexOf(t.charAt(++a))>-1;)s+=t.charAt(a);i[i.length]={t:"D",v:s};break;case" ":i[i.length]={t:o,v:o},++a;break;case"$":i[i.length]={t:"t",v:"$"},++a;break;default:if(",$-+/():!^&'~{}<>=€acfijklopqrtuvwxzP".indexOf(o)===-1)throw new Error("unrecognized character "+o+" in "+t);i[i.length]={t:"t",v:o},++a;break}var g=0,w=0,b;for(a=i.length-1,l="t";a>=0;--a)switch(i[a].t){case"h":case"H":i[a].t=d,l="h",g<1&&(g=1);break;case"s":(b=i[a].v.match(/\.0+$/))&&(w=Math.max(w,b[0].length-1)),g<3&&(g=3);case"d":case"y":case"M":case"e":l=i[a].t;break;case"m":l==="s"&&(i[a].t="M",g<2&&(g=2));break;case"X":break;case"Z":g<1&&i[a].v.match(/[Hh]/)&&(g=1),g<2&&i[a].v.match(/[Mm]/)&&(g=2),g<3&&i[a].v.match(/[Ss]/)&&(g=3)}switch(g){case 0:break;case 1:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M),c.M>=60&&(c.M=0,++c.H);break;case 2:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M);break}var _="",k;for(a=0;a<i.length;++a)switch(i[a].t){case"t":case"T":case" ":case"D":break;case"X":i[a].v="",i[a].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":i[a].v=ik(i[a].t.charCodeAt(0),i[a].v,c,w),i[a].t="t";break;case"n":case"?":for(k=a+1;i[k]!=null&&((o=i[k].t)==="?"||o==="D"||(o===" "||o==="t")&&i[k+1]!=null&&(i[k+1].t==="?"||i[k+1].t==="t"&&i[k+1].v==="/")||i[a].t==="("&&(o===" "||o==="n"||o===")")||o==="t"&&(i[k].v==="/"||i[k].v===" "&&i[k+1]!=null&&i[k+1].t=="?"));)i[a].v+=i[k].v,i[k]={v:"",t:";"},++k;_+=i[a].v,a=k-1;break;case"G":i[a].t="t",i[a].v=dc(e,r);break}var L="",M,I;if(_.length>0){_.charCodeAt(0)==40?(M=e<0&&_.charCodeAt(0)===45?-e:e,I=Pr("n",_,M)):(M=e<0&&n>1?-e:e,I=Pr("n",_,M),M<0&&i[0]&&i[0].t=="t"&&(I=I.substr(1),i[0].v="-"+i[0].v)),k=I.length-1;var F=i.length;for(a=0;a<i.length;++a)if(i[a]!=null&&i[a].t!="t"&&i[a].v.indexOf(".")>-1){F=a;break}var R=i.length;if(F===i.length&&I.indexOf("E")===-1){for(a=i.length-1;a>=0;--a)i[a]==null||"n?".indexOf(i[a].t)===-1||(k>=i[a].v.length-1?(k-=i[a].v.length,i[a].v=I.substr(k+1,i[a].v.length)):k<0?i[a].v="":(i[a].v=I.substr(0,k+1),k=-1),i[a].t="t",R=a);k>=0&&R<i.length&&(i[R].v=I.substr(0,k+1)+i[R].v)}else if(F!==i.length&&I.indexOf("E")===-1){for(k=I.indexOf(".")-1,a=F;a>=0;--a)if(!(i[a]==null||"n?".indexOf(i[a].t)===-1)){for(u=i[a].v.indexOf(".")>-1&&a===F?i[a].v.indexOf(".")-1:i[a].v.length-1,L=i[a].v.substr(u+1);u>=0;--u)k>=0&&(i[a].v.charAt(u)==="0"||i[a].v.charAt(u)==="#")&&(L=I.charAt(k--)+L);i[a].v=L,i[a].t="t",R=a}for(k>=0&&R<i.length&&(i[R].v=I.substr(0,k+1)+i[R].v),k=I.indexOf(".")+1,a=F;a<i.length;++a)if(!(i[a]==null||"n?(".indexOf(i[a].t)===-1&&a!==F)){for(u=i[a].v.indexOf(".")>-1&&a===F?i[a].v.indexOf(".")+1:0,L=i[a].v.substr(0,u);u<i[a].v.length;++u)k<I.length&&(L+=I.charAt(k++));i[a].v=L,i[a].t="t",R=a}}}for(a=0;a<i.length;++a)i[a]!=null&&"n?".indexOf(i[a].t)>-1&&(M=n>1&&e<0&&a>0&&i[a-1].v==="-"?-e:e,i[a].v=Pr(i[a].t,i[a].v,M),i[a].t="t");var N="";for(a=0;a!==i.length;++a)i[a]!=null&&(N+=i[a].v);return N}var Mh=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function jh(t,e){if(e==null)return!1;var r=parseFloat(e[2]);switch(e[1]){case"=":if(t==r)return!0;break;case">":if(t>r)return!0;break;case"<":if(t<r)return!0;break;case"<>":if(t!=r)return!0;break;case">=":if(t>=r)return!0;break;case"<=":if(t<=r)return!0;break}return!1}function mk(t,e){var r=dk(t),n=r.length,i=r[n-1].indexOf("@");if(n<4&&i>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof e!="number")return[4,r.length===4||i>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=i>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=i>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=i>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var s=e>0?r[0]:e<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,s];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var a=r[0].match(Mh),o=r[1].match(Mh);return jh(e,a)?[n,r[0]]:jh(e,o)?[n,r[1]]:[n,r[a!=null&&o!=null?2:1]]}return[n,s]}function hn(t,e,r){r==null&&(r={});var n="";switch(typeof t){case"string":t=="m/d/yy"&&r.dateNF?n=r.dateNF:n=t;break;case"number":t==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:Ve)[t],n==null&&(n=r.table&&r.table[Nh[t]]||Ve[Nh[t]]),n==null&&(n=YI[t]||"General");break}if(Ya(n,0))return dc(e,r);e instanceof Date&&(e=jm(e,r.date1904));var i=mk(n,e);if(Ya(i[1]))return dc(e,r);if(e===!0)e="TRUE";else if(e===!1)e="FALSE";else if(e===""||e==null)return"";return pk(i[1],e,r,i[0])}function Km(t,e){if(typeof e!="number"){e=+e||-1;for(var r=0;r<392;++r){if(Ve[r]==null){e<0&&(e=r);continue}if(Ve[r]==t){e=r;break}}e<0&&(e=391)}return Ve[e]=t,e}function Po(t){for(var e=0;e!=392;++e)t[e]!==void 0&&Km(t[e],e)}function Fo(){Ve=XI()}var Xm=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function gk(t){var e=typeof t=="number"?Ve[t]:t;return e=e.replace(Xm,"(\\d+)"),new RegExp("^"+e+"$")}function vk(t,e,r){var n=-1,i=-1,s=-1,a=-1,o=-1,l=-1;(e.match(Xm)||[]).forEach(function(f,d){var h=parseInt(r[d+1],10);switch(f.toLowerCase().charAt(0)){case"y":n=h;break;case"d":s=h;break;case"h":a=h;break;case"s":l=h;break;case"m":a>=0?o=h:i=h;break}}),l>=0&&o==-1&&i>=0&&(o=i,i=-1);var c=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(i>=1?i:1)).slice(-2)+"-"+("00"+(s>=1?s:1)).slice(-2);c.length==7&&(c="0"+c),c.length==8&&(c="20"+c);var u=("00"+(a>=0?a:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2);return a==-1&&o==-1&&l==-1?c:n==-1&&i==-1&&s==-1?u:c+"T"+u}var xk=function(){var t={};t.version="1.2.0";function e(){for(var I=0,F=new Array(256),R=0;R!=256;++R)I=R,I=I&1?-306674912^I>>>1:I>>>1,I=I&1?-306674912^I>>>1:I>>>1,I=I&1?-306674912^I>>>1:I>>>1,I=I&1?-306674912^I>>>1:I>>>1,I=I&1?-306674912^I>>>1:I>>>1,I=I&1?-306674912^I>>>1:I>>>1,I=I&1?-306674912^I>>>1:I>>>1,I=I&1?-306674912^I>>>1:I>>>1,F[R]=I;return typeof Int32Array<"u"?new Int32Array(F):F}var r=e();function n(I){var F=0,R=0,N=0,H=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(N=0;N!=256;++N)H[N]=I[N];for(N=0;N!=256;++N)for(R=I[N],F=256+N;F<4096;F+=256)R=H[F]=R>>>8^I[R&255];var q=[];for(N=1;N!=16;++N)q[N-1]=typeof Int32Array<"u"?H.subarray(N*256,N*256+256):H.slice(N*256,N*256+256);return q}var i=n(r),s=i[0],a=i[1],o=i[2],l=i[3],c=i[4],u=i[5],f=i[6],d=i[7],h=i[8],m=i[9],p=i[10],g=i[11],w=i[12],b=i[13],_=i[14];function k(I,F){for(var R=F^-1,N=0,H=I.length;N<H;)R=R>>>8^r[(R^I.charCodeAt(N++))&255];return~R}function L(I,F){for(var R=F^-1,N=I.length-15,H=0;H<N;)R=_[I[H++]^R&255]^b[I[H++]^R>>8&255]^w[I[H++]^R>>16&255]^g[I[H++]^R>>>24]^p[I[H++]]^m[I[H++]]^h[I[H++]]^d[I[H++]]^f[I[H++]]^u[I[H++]]^c[I[H++]]^l[I[H++]]^o[I[H++]]^a[I[H++]]^s[I[H++]]^r[I[H++]];for(N+=15;H<N;)R=R>>>8^r[(R^I[H++])&255];return~R}function M(I,F){for(var R=F^-1,N=0,H=I.length,q=0,Y=0;N<H;)q=I.charCodeAt(N++),q<128?R=R>>>8^r[(R^q)&255]:q<2048?(R=R>>>8^r[(R^(192|q>>6&31))&255],R=R>>>8^r[(R^(128|q&63))&255]):q>=55296&&q<57344?(q=(q&1023)+64,Y=I.charCodeAt(N++)&1023,R=R>>>8^r[(R^(240|q>>8&7))&255],R=R>>>8^r[(R^(128|q>>2&63))&255],R=R>>>8^r[(R^(128|Y>>6&15|(q&3)<<4))&255],R=R>>>8^r[(R^(128|Y&63))&255]):(R=R>>>8^r[(R^(224|q>>12&15))&255],R=R>>>8^r[(R^(128|q>>6&63))&255],R=R>>>8^r[(R^(128|q&63))&255]);return~R}return t.table=r,t.bstr=k,t.buf=L,t.str=M,t}(),Pe=function(){var e={};e.version="1.2.1";function r(y,S){for(var E=y.split("/"),T=S.split("/"),A=0,C=0,U=Math.min(E.length,T.length);A<U;++A){if(C=E[A].length-T[A].length)return C;if(E[A]!=T[A])return E[A]<T[A]?-1:1}return E.length-T.length}function n(y){if(y.charAt(y.length-1)=="/")return y.slice(0,-1).indexOf("/")===-1?y:n(y.slice(0,-1));var S=y.lastIndexOf("/");return S===-1?y:y.slice(0,S+1)}function i(y){if(y.charAt(y.length-1)=="/")return i(y.slice(0,-1));var S=y.lastIndexOf("/");return S===-1?y:y.slice(S+1)}function s(y,S){typeof S=="string"&&(S=new Date(S));var E=S.getHours();E=E<<6|S.getMinutes(),E=E<<5|S.getSeconds()>>>1,y.write_shift(2,E);var T=S.getFullYear()-1980;T=T<<4|S.getMonth()+1,T=T<<5|S.getDate(),y.write_shift(2,T)}function a(y){var S=y.read_shift(2)&65535,E=y.read_shift(2)&65535,T=new Date,A=E&31;E>>>=5;var C=E&15;E>>>=4,T.setMilliseconds(0),T.setFullYear(E+1980),T.setMonth(C-1),T.setDate(A);var U=S&31;S>>>=5;var z=S&63;return S>>>=6,T.setHours(S),T.setMinutes(z),T.setSeconds(U<<1),T}function o(y){Pt(y,0);for(var S={},E=0;y.l<=y.length-4;){var T=y.read_shift(2),A=y.read_shift(2),C=y.l+A,U={};switch(T){case 21589:E=y.read_shift(1),E&1&&(U.mtime=y.read_shift(4)),A>5&&(E&2&&(U.atime=y.read_shift(4)),E&4&&(U.ctime=y.read_shift(4))),U.mtime&&(U.mt=new Date(U.mtime*1e3));break}y.l=C,S[T]=U}return S}var l;function c(){return l||(l={})}function u(y,S){if(y[0]==80&&y[1]==75)return Qu(y,S);if((y[0]|32)==109&&(y[1]|32)==105)return Qv(y,S);if(y.length<512)throw new Error("CFB file size "+y.length+" < 512");var E=3,T=512,A=0,C=0,U=0,z=0,B=0,W=[],V=y.slice(0,512);Pt(V,0);var J=f(V);switch(E=J[0],E){case 3:T=512;break;case 4:T=4096;break;case 0:if(J[1]==0)return Qu(y,S);default:throw new Error("Major Version: Expected 3 or 4 saw "+E)}T!==512&&(V=y.slice(0,T),Pt(V,28));var re=y.slice(0,T);d(V,E);var ae=V.read_shift(4,"i");if(E===3&&ae!==0)throw new Error("# Directory Sectors: Expected 0 saw "+ae);V.l+=4,U=V.read_shift(4,"i"),V.l+=4,V.chk("00100000","Mini Stream Cutoff Size: "),z=V.read_shift(4,"i"),A=V.read_shift(4,"i"),B=V.read_shift(4,"i"),C=V.read_shift(4,"i");for(var Z=-1,ie=0;ie<109&&(Z=V.read_shift(4,"i"),!(Z<0));++ie)W[ie]=Z;var pe=h(y,T);g(B,C,pe,T,W);var je=b(pe,U,W,T);je[U].name="!Directory",A>0&&z!==Y&&(je[z].name="!MiniFAT"),je[W[0]].name="!FAT",je.fat_addrs=W,je.ssz=T;var $e={},ht=[],Ki=[],Xi=[];_(U,je,pe,ht,A,$e,Ki,z),m(Ki,Xi,ht),ht.shift();var Yi={FileIndex:Ki,FullPaths:Xi};return S&&S.raw&&(Yi.raw={header:re,sectors:pe}),Yi}function f(y){if(y[y.l]==80&&y[y.l+1]==75)return[0,0];y.chk(fe,"Header Signature: "),y.l+=16;var S=y.read_shift(2,"u");return[y.read_shift(2,"u"),S]}function d(y,S){var E=9;switch(y.l+=2,E=y.read_shift(2)){case 9:if(S!=3)throw new Error("Sector Shift: Expected 9 saw "+E);break;case 12:if(S!=4)throw new Error("Sector Shift: Expected 12 saw "+E);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+E)}y.chk("0600","Mini Sector Shift: "),y.chk("000000000000","Reserved: ")}function h(y,S){for(var E=Math.ceil(y.length/S)-1,T=[],A=1;A<E;++A)T[A-1]=y.slice(A*S,(A+1)*S);return T[E-1]=y.slice(E*S),T}function m(y,S,E){for(var T=0,A=0,C=0,U=0,z=0,B=E.length,W=[],V=[];T<B;++T)W[T]=V[T]=T,S[T]=E[T];for(;z<V.length;++z)T=V[z],A=y[T].L,C=y[T].R,U=y[T].C,W[T]===T&&(A!==-1&&W[A]!==A&&(W[T]=W[A]),C!==-1&&W[C]!==C&&(W[T]=W[C])),U!==-1&&(W[U]=T),A!==-1&&T!=W[T]&&(W[A]=W[T],V.lastIndexOf(A)<z&&V.push(A)),C!==-1&&T!=W[T]&&(W[C]=W[T],V.lastIndexOf(C)<z&&V.push(C));for(T=1;T<B;++T)W[T]===T&&(C!==-1&&W[C]!==C?W[T]=W[C]:A!==-1&&W[A]!==A&&(W[T]=W[A]));for(T=1;T<B;++T)if(y[T].type!==0){if(z=T,z!=W[z])do z=W[z],S[T]=S[z]+"/"+S[T];while(z!==0&&W[z]!==-1&&z!=W[z]);W[T]=-1}for(S[0]+="/",T=1;T<B;++T)y[T].type!==2&&(S[T]+="/")}function p(y,S,E){for(var T=y.start,A=y.size,C=[],U=T;E&&A>0&&U>=0;)C.push(S.slice(U*q,U*q+q)),A-=q,U=Rn(E,U*4);return C.length===0?G(0):ot(C).slice(0,y.size)}function g(y,S,E,T,A){var C=Y;if(y===Y){if(S!==0)throw new Error("DIFAT chain shorter than expected")}else if(y!==-1){var U=E[y],z=(T>>>2)-1;if(!U)return;for(var B=0;B<z&&(C=Rn(U,B*4))!==Y;++B)A.push(C);g(Rn(U,T-4),S-1,E,T,A)}}function w(y,S,E,T,A){var C=[],U=[];A||(A=[]);var z=T-1,B=0,W=0;for(B=S;B>=0;){A[B]=!0,C[C.length]=B,U.push(y[B]);var V=E[Math.floor(B*4/T)];if(W=B*4&z,T<4+W)throw new Error("FAT boundary crossed: "+B+" 4 "+T);if(!y[V])break;B=Rn(y[V],W)}return{nodes:C,data:zh([U])}}function b(y,S,E,T){var A=y.length,C=[],U=[],z=[],B=[],W=T-1,V=0,J=0,re=0,ae=0;for(V=0;V<A;++V)if(z=[],re=V+S,re>=A&&(re-=A),!U[re]){B=[];var Z=[];for(J=re;J>=0;){Z[J]=!0,U[J]=!0,z[z.length]=J,B.push(y[J]);var ie=E[Math.floor(J*4/T)];if(ae=J*4&W,T<4+ae)throw new Error("FAT boundary crossed: "+J+" 4 "+T);if(!y[ie]||(J=Rn(y[ie],ae),Z[J]))break}C[re]={nodes:z,data:zh([B])}}return C}function _(y,S,E,T,A,C,U,z){for(var B=0,W=T.length?2:0,V=S[y].data,J=0,re=0,ae;J<V.length;J+=128){var Z=V.slice(J,J+128);Pt(Z,64),re=Z.read_shift(2),ae=bu(Z,0,re-W),T.push(ae);var ie={name:ae,type:Z.read_shift(1),color:Z.read_shift(1),L:Z.read_shift(4,"i"),R:Z.read_shift(4,"i"),C:Z.read_shift(4,"i"),clsid:Z.read_shift(16),state:Z.read_shift(4,"i"),start:0,size:0},pe=Z.read_shift(2)+Z.read_shift(2)+Z.read_shift(2)+Z.read_shift(2);pe!==0&&(ie.ct=k(Z,Z.l-8));var je=Z.read_shift(2)+Z.read_shift(2)+Z.read_shift(2)+Z.read_shift(2);je!==0&&(ie.mt=k(Z,Z.l-8)),ie.start=Z.read_shift(4,"i"),ie.size=Z.read_shift(4,"i"),ie.size<0&&ie.start<0&&(ie.size=ie.type=0,ie.start=Y,ie.name=""),ie.type===5?(B=ie.start,A>0&&B!==Y&&(S[B].name="!StreamData")):ie.size>=4096?(ie.storage="fat",S[ie.start]===void 0&&(S[ie.start]=w(E,ie.start,S.fat_addrs,S.ssz)),S[ie.start].name=ie.name,ie.content=S[ie.start].data.slice(0,ie.size)):(ie.storage="minifat",ie.size<0?ie.size=0:B!==Y&&ie.start!==Y&&S[B]&&(ie.content=p(ie,S[B].data,(S[z]||{}).data))),ie.content&&Pt(ie.content,0),C[ae]=ie,U.push(ie)}}function k(y,S){return new Date((Nt(y,S+4)/1e7*Math.pow(2,32)+Nt(y,S)/1e7-11644473600)*1e3)}function L(y,S){return c(),u(l.readFileSync(y),S)}function M(y,S){var E=S&&S.type;switch(E||Se&&Buffer.isBuffer(y)&&(E="buffer"),E||"base64"){case"file":return L(y,S);case"base64":return u(Jt(Br(y)),S);case"binary":return u(Jt(y),S)}return u(y,S)}function I(y,S){var E=S||{},T=E.root||"Root Entry";if(y.FullPaths||(y.FullPaths=[]),y.FileIndex||(y.FileIndex=[]),y.FullPaths.length!==y.FileIndex.length)throw new Error("inconsistent CFB structure");y.FullPaths.length===0&&(y.FullPaths[0]=T+"/",y.FileIndex[0]={name:T,type:5}),E.CLSID&&(y.FileIndex[0].clsid=E.CLSID),F(y)}function F(y){var S="Sh33tJ5";if(!Pe.find(y,"/"+S)){var E=G(4);E[0]=55,E[1]=E[3]=50,E[2]=54,y.FileIndex.push({name:S,type:2,content:E,size:4,L:69,R:69,C:69}),y.FullPaths.push(y.FullPaths[0]+S),R(y)}}function R(y,S){I(y);for(var E=!1,T=!1,A=y.FullPaths.length-1;A>=0;--A){var C=y.FileIndex[A];switch(C.type){case 0:T?E=!0:(y.FileIndex.pop(),y.FullPaths.pop());break;case 1:case 2:case 5:T=!0,isNaN(C.R*C.L*C.C)&&(E=!0),C.R>-1&&C.L>-1&&C.R==C.L&&(E=!0);break;default:E=!0;break}}if(!(!E&&!S)){var U=new Date(1987,1,19),z=0,B=Object.create?Object.create(null):{},W=[];for(A=0;A<y.FullPaths.length;++A)B[y.FullPaths[A]]=!0,y.FileIndex[A].type!==0&&W.push([y.FullPaths[A],y.FileIndex[A]]);for(A=0;A<W.length;++A){var V=n(W[A][0]);T=B[V],T||(W.push([V,{name:i(V).replace("/",""),type:1,clsid:we,ct:U,mt:U,content:null}]),B[V]=!0)}for(W.sort(function(ae,Z){return r(ae[0],Z[0])}),y.FullPaths=[],y.FileIndex=[],A=0;A<W.length;++A)y.FullPaths[A]=W[A][0],y.FileIndex[A]=W[A][1];for(A=0;A<W.length;++A){var J=y.FileIndex[A],re=y.FullPaths[A];if(J.name=i(re).replace("/",""),J.L=J.R=J.C=-(J.color=1),J.size=J.content?J.content.length:0,J.start=0,J.clsid=J.clsid||we,A===0)J.C=W.length>1?1:-1,J.size=0,J.type=5;else if(re.slice(-1)=="/"){for(z=A+1;z<W.length&&n(y.FullPaths[z])!=re;++z);for(J.C=z>=W.length?-1:z,z=A+1;z<W.length&&n(y.FullPaths[z])!=n(re);++z);J.R=z>=W.length?-1:z,J.type=1}else n(y.FullPaths[A+1]||"")==n(re)&&(J.R=A+1),J.type=2}}}function N(y,S){var E=S||{};if(E.fileType=="mad")return Zv(y,E);switch(R(y),E.fileType){case"zip":return zv(y,E)}var T=function(ae){for(var Z=0,ie=0,pe=0;pe<ae.FileIndex.length;++pe){var je=ae.FileIndex[pe];if(je.content){var $e=je.content.length;$e>0&&($e<4096?Z+=$e+63>>6:ie+=$e+511>>9)}}for(var ht=ae.FullPaths.length+3>>2,Ki=Z+7>>3,Xi=Z+127>>7,Yi=Ki+ie+ht+Xi,bn=Yi+127>>7,Yo=bn<=109?0:Math.ceil((bn-109)/127);Yi+bn+Yo+127>>7>bn;)Yo=++bn<=109?0:Math.ceil((bn-109)/127);var wr=[1,Yo,bn,Xi,ht,ie,Z,0];return ae.FileIndex[0].size=Z<<6,wr[7]=(ae.FileIndex[0].start=wr[0]+wr[1]+wr[2]+wr[3]+wr[4]+wr[5])+(wr[6]+7>>3),wr}(y),A=G(T[7]<<9),C=0,U=0;{for(C=0;C<8;++C)A.write_shift(1,ue[C]);for(C=0;C<8;++C)A.write_shift(2,0);for(A.write_shift(2,62),A.write_shift(2,3),A.write_shift(2,65534),A.write_shift(2,9),A.write_shift(2,6),C=0;C<3;++C)A.write_shift(2,0);for(A.write_shift(4,0),A.write_shift(4,T[2]),A.write_shift(4,T[0]+T[1]+T[2]+T[3]-1),A.write_shift(4,0),A.write_shift(4,4096),A.write_shift(4,T[3]?T[0]+T[1]+T[2]-1:Y),A.write_shift(4,T[3]),A.write_shift(-4,T[1]?T[0]-1:Y),A.write_shift(4,T[1]),C=0;C<109;++C)A.write_shift(-4,C<T[2]?T[1]+C:-1)}if(T[1])for(U=0;U<T[1];++U){for(;C<236+U*127;++C)A.write_shift(-4,C<T[2]?T[1]+C:-1);A.write_shift(-4,U===T[1]-1?Y:U+1)}var z=function(ae){for(U+=ae;C<U-1;++C)A.write_shift(-4,C+1);ae&&(++C,A.write_shift(-4,Y))};for(U=C=0,U+=T[1];C<U;++C)A.write_shift(-4,xe.DIFSECT);for(U+=T[2];C<U;++C)A.write_shift(-4,xe.FATSECT);z(T[3]),z(T[4]);for(var B=0,W=0,V=y.FileIndex[0];B<y.FileIndex.length;++B)V=y.FileIndex[B],V.content&&(W=V.content.length,!(W<4096)&&(V.start=U,z(W+511>>9)));for(z(T[6]+7>>3);A.l&511;)A.write_shift(-4,xe.ENDOFCHAIN);for(U=C=0,B=0;B<y.FileIndex.length;++B)V=y.FileIndex[B],V.content&&(W=V.content.length,!(!W||W>=4096)&&(V.start=U,z(W+63>>6)));for(;A.l&511;)A.write_shift(-4,xe.ENDOFCHAIN);for(C=0;C<T[4]<<2;++C){var J=y.FullPaths[C];if(!J||J.length===0){for(B=0;B<17;++B)A.write_shift(4,0);for(B=0;B<3;++B)A.write_shift(4,-1);for(B=0;B<12;++B)A.write_shift(4,0);continue}V=y.FileIndex[C],C===0&&(V.start=V.size?V.start-1:Y);var re=C===0&&E.root||V.name;if(W=2*(re.length+1),A.write_shift(64,re,"utf16le"),A.write_shift(2,W),A.write_shift(1,V.type),A.write_shift(1,V.color),A.write_shift(-4,V.L),A.write_shift(-4,V.R),A.write_shift(-4,V.C),V.clsid)A.write_shift(16,V.clsid,"hex");else for(B=0;B<4;++B)A.write_shift(4,0);A.write_shift(4,V.state||0),A.write_shift(4,0),A.write_shift(4,0),A.write_shift(4,0),A.write_shift(4,0),A.write_shift(4,V.start),A.write_shift(4,V.size),A.write_shift(4,0)}for(C=1;C<y.FileIndex.length;++C)if(V=y.FileIndex[C],V.size>=4096)if(A.l=V.start+1<<9,Se&&Buffer.isBuffer(V.content))V.content.copy(A,A.l,0,V.size),A.l+=V.size+511&-512;else{for(B=0;B<V.size;++B)A.write_shift(1,V.content[B]);for(;B&511;++B)A.write_shift(1,0)}for(C=1;C<y.FileIndex.length;++C)if(V=y.FileIndex[C],V.size>0&&V.size<4096)if(Se&&Buffer.isBuffer(V.content))V.content.copy(A,A.l,0,V.size),A.l+=V.size+63&-64;else{for(B=0;B<V.size;++B)A.write_shift(1,V.content[B]);for(;B&63;++B)A.write_shift(1,0)}if(Se)A.l=A.length;else for(;A.l<A.length;)A.write_shift(1,0);return A}function H(y,S){var E=y.FullPaths.map(function(B){return B.toUpperCase()}),T=E.map(function(B){var W=B.split("/");return W[W.length-(B.slice(-1)=="/"?2:1)]}),A=!1;S.charCodeAt(0)===47?(A=!0,S=E[0].slice(0,-1)+S):A=S.indexOf("/")!==-1;var C=S.toUpperCase(),U=A===!0?E.indexOf(C):T.indexOf(C);if(U!==-1)return y.FileIndex[U];var z=!C.match(da);for(C=C.replace(hs,""),z&&(C=C.replace(da,"!")),U=0;U<E.length;++U)if((z?E[U].replace(da,"!"):E[U]).replace(hs,"")==C||(z?T[U].replace(da,"!"):T[U]).replace(hs,"")==C)return y.FileIndex[U];return null}var q=64,Y=-2,fe="d0cf11e0a1b11ae1",ue=[208,207,17,224,161,177,26,225],we="00000000000000000000000000000000",xe={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:Y,FREESECT:-1,HEADER_SIGNATURE:fe,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:we,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function he(y,S,E){c();var T=N(y,E);l.writeFileSync(S,T)}function Q(y){for(var S=new Array(y.length),E=0;E<y.length;++E)S[E]=String.fromCharCode(y[E]);return S.join("")}function _e(y,S){var E=N(y,S);switch(S&&S.type||"buffer"){case"file":return c(),l.writeFileSync(S.filename,E),E;case"binary":return typeof E=="string"?E:Q(E);case"base64":return Cs(typeof E=="string"?E:Q(E));case"buffer":if(Se)return Buffer.isBuffer(E)?E:Vr(E);case"array":return typeof E=="string"?Jt(E):E}return E}var Be;function O(y){try{var S=y.InflateRaw,E=new S;if(E._processChunk(new Uint8Array([3,0]),E._finishFlushFlag),E.bytesRead)Be=y;else throw new Error("zlib does not expose bytesRead")}catch(T){console.error("cannot use native zlib: "+(T.message||T))}}function j(y,S){if(!Be)return Yu(y,S);var E=Be.InflateRaw,T=new E,A=T._processChunk(y.slice(y.l),T._finishFlushFlag);return y.l+=T.bytesRead,A}function D(y){return Be?Be.deflateRawSync(y):Vu(y)}var P=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],X=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],oe=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function ce(y){var S=(y<<1|y<<11)&139536|(y<<5|y<<15)&558144;return(S>>16|S>>8|S)&255}for(var se=typeof Uint8Array<"u",ne=se?new Uint8Array(256):[],Fe=0;Fe<256;++Fe)ne[Fe]=ce(Fe);function be(y,S){var E=ne[y&255];return S<=8?E>>>8-S:(E=E<<8|ne[y>>8&255],S<=16?E>>>16-S:(E=E<<8|ne[y>>16&255],E>>>24-S))}function vt(y,S){var E=S&7,T=S>>>3;return(y[T]|(E<=6?0:y[T+1]<<8))>>>E&3}function Ae(y,S){var E=S&7,T=S>>>3;return(y[T]|(E<=5?0:y[T+1]<<8))>>>E&7}function xr(y,S){var E=S&7,T=S>>>3;return(y[T]|(E<=4?0:y[T+1]<<8))>>>E&15}function Ue(y,S){var E=S&7,T=S>>>3;return(y[T]|(E<=3?0:y[T+1]<<8))>>>E&31}function le(y,S){var E=S&7,T=S>>>3;return(y[T]|(E<=1?0:y[T+1]<<8))>>>E&127}function jt(y,S,E){var T=S&7,A=S>>>3,C=(1<<E)-1,U=y[A]>>>T;return E<8-T||(U|=y[A+1]<<8-T,E<16-T)||(U|=y[A+2]<<16-T,E<24-T)||(U|=y[A+3]<<24-T),U&C}function yr(y,S,E){var T=S&7,A=S>>>3;return T<=5?y[A]|=(E&7)<<T:(y[A]|=E<<T&255,y[A+1]=(E&7)>>8-T),S+3}function _n(y,S,E){var T=S&7,A=S>>>3;return E=(E&1)<<T,y[A]|=E,S+1}function ai(y,S,E){var T=S&7,A=S>>>3;return E<<=T,y[A]|=E&255,E>>>=8,y[A+1]=E,S+8}function Wu(y,S,E){var T=S&7,A=S>>>3;return E<<=T,y[A]|=E&255,E>>>=8,y[A+1]=E&255,y[A+2]=E>>>8,S+16}function zo(y,S){var E=y.length,T=2*E>S?2*E:S+5,A=0;if(E>=S)return y;if(Se){var C=Rh(T);if(y.copy)y.copy(C);else for(;A<y.length;++A)C[A]=y[A];return C}else if(se){var U=new Uint8Array(T);if(U.set)U.set(y);else for(;A<E;++A)U[A]=y[A];return U}return y.length=T,y}function ir(y){for(var S=new Array(y),E=0;E<y;++E)S[E]=0;return S}function ra(y,S,E){var T=1,A=0,C=0,U=0,z=0,B=y.length,W=se?new Uint16Array(32):ir(32);for(C=0;C<32;++C)W[C]=0;for(C=B;C<E;++C)y[C]=0;B=y.length;var V=se?new Uint16Array(B):ir(B);for(C=0;C<B;++C)W[A=y[C]]++,T<A&&(T=A),V[C]=0;for(W[0]=0,C=1;C<=T;++C)W[C+16]=z=z+W[C-1]<<1;for(C=0;C<B;++C)z=y[C],z!=0&&(V[C]=W[z+16]++);var J=0;for(C=0;C<B;++C)if(J=y[C],J!=0)for(z=be(V[C],T)>>T-J,U=(1<<T+4-J)-1;U>=0;--U)S[z|U<<J]=J&15|C<<4;return T}var qo=se?new Uint16Array(512):ir(512),Ko=se?new Uint16Array(32):ir(32);if(!se){for(var En=0;En<512;++En)qo[En]=0;for(En=0;En<32;++En)Ko[En]=0}(function(){for(var y=[],S=0;S<32;S++)y.push(5);ra(y,Ko,32);var E=[];for(S=0;S<=143;S++)E.push(8);for(;S<=255;S++)E.push(9);for(;S<=279;S++)E.push(7);for(;S<=287;S++)E.push(8);ra(E,qo,288)})();var Hv=function(){for(var S=se?new Uint8Array(32768):[],E=0,T=0;E<oe.length-1;++E)for(;T<oe[E+1];++T)S[T]=E;for(;T<32768;++T)S[T]=29;var A=se?new Uint8Array(259):[];for(E=0,T=0;E<X.length-1;++E)for(;T<X[E+1];++T)A[T]=E;function C(z,B){for(var W=0;W<z.length;){var V=Math.min(65535,z.length-W),J=W+V==z.length;for(B.write_shift(1,+J),B.write_shift(2,V),B.write_shift(2,~V&65535);V-- >0;)B[B.l++]=z[W++]}return B.l}function U(z,B){for(var W=0,V=0,J=se?new Uint16Array(32768):[];V<z.length;){var re=Math.min(65535,z.length-V);if(re<10){for(W=yr(B,W,+(V+re==z.length)),W&7&&(W+=8-(W&7)),B.l=W/8|0,B.write_shift(2,re),B.write_shift(2,~re&65535);re-- >0;)B[B.l++]=z[V++];W=B.l*8;continue}W=yr(B,W,+(V+re==z.length)+2);for(var ae=0;re-- >0;){var Z=z[V];ae=(ae<<5^Z)&32767;var ie=-1,pe=0;if((ie=J[ae])&&(ie|=V&-32768,ie>V&&(ie-=32768),ie<V))for(;z[ie+pe]==z[V+pe]&&pe<250;)++pe;if(pe>2){Z=A[pe],Z<=22?W=ai(B,W,ne[Z+1]>>1)-1:(ai(B,W,3),W+=5,ai(B,W,ne[Z-23]>>5),W+=3);var je=Z<8?0:Z-4>>2;je>0&&(Wu(B,W,pe-X[Z]),W+=je),Z=S[V-ie],W=ai(B,W,ne[Z]>>3),W-=3;var $e=Z<4?0:Z-2>>1;$e>0&&(Wu(B,W,V-ie-oe[Z]),W+=$e);for(var ht=0;ht<pe;++ht)J[ae]=V&32767,ae=(ae<<5^z[V])&32767,++V;re-=pe-1}else Z<=143?Z=Z+48:W=_n(B,W,1),W=ai(B,W,ne[Z]),J[ae]=V&32767,++V}W=ai(B,W,0)-1}return B.l=(W+7)/8|0,B.l}return function(B,W){return B.length<8?C(B,W):U(B,W)}}();function Vu(y){var S=G(50+Math.floor(y.length*1.1)),E=Hv(y,S);return S.slice(0,E)}var Gu=se?new Uint16Array(32768):ir(32768),zu=se?new Uint16Array(32768):ir(32768),qu=se?new Uint16Array(128):ir(128),Ku=1,Xu=1;function Wv(y,S){var E=Ue(y,S)+257;S+=5;var T=Ue(y,S)+1;S+=5;var A=xr(y,S)+4;S+=4;for(var C=0,U=se?new Uint8Array(19):ir(19),z=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],B=1,W=se?new Uint8Array(8):ir(8),V=se?new Uint8Array(8):ir(8),J=U.length,re=0;re<A;++re)U[P[re]]=C=Ae(y,S),B<C&&(B=C),W[C]++,S+=3;var ae=0;for(W[0]=0,re=1;re<=B;++re)V[re]=ae=ae+W[re-1]<<1;for(re=0;re<J;++re)(ae=U[re])!=0&&(z[re]=V[ae]++);var Z=0;for(re=0;re<J;++re)if(Z=U[re],Z!=0){ae=ne[z[re]]>>8-Z;for(var ie=(1<<7-Z)-1;ie>=0;--ie)qu[ae|ie<<Z]=Z&7|re<<3}var pe=[];for(B=1;pe.length<E+T;)switch(ae=qu[le(y,S)],S+=ae&7,ae>>>=3){case 16:for(C=3+vt(y,S),S+=2,ae=pe[pe.length-1];C-- >0;)pe.push(ae);break;case 17:for(C=3+Ae(y,S),S+=3;C-- >0;)pe.push(0);break;case 18:for(C=11+le(y,S),S+=7;C-- >0;)pe.push(0);break;default:pe.push(ae),B<ae&&(B=ae);break}var je=pe.slice(0,E),$e=pe.slice(E);for(re=E;re<286;++re)je[re]=0;for(re=T;re<30;++re)$e[re]=0;return Ku=ra(je,Gu,286),Xu=ra($e,zu,30),S}function Vv(y,S){if(y[0]==3&&!(y[1]&3))return[Kn(S),2];for(var E=0,T=0,A=Rh(S||1<<18),C=0,U=A.length>>>0,z=0,B=0;!(T&1);){if(T=Ae(y,E),E+=3,T>>>1)T>>1==1?(z=9,B=5):(E=Wv(y,E),z=Ku,B=Xu);else{E&7&&(E+=8-(E&7));var W=y[E>>>3]|y[(E>>>3)+1]<<8;if(E+=32,W>0)for(!S&&U<C+W&&(A=zo(A,C+W),U=A.length);W-- >0;)A[C++]=y[E>>>3],E+=8;continue}for(;;){!S&&U<C+32767&&(A=zo(A,C+32767),U=A.length);var V=jt(y,E,z),J=T>>>1==1?qo[V]:Gu[V];if(E+=J&15,J>>>=4,!(J>>>8&255))A[C++]=J;else{if(J==256)break;J-=257;var re=J<8?0:J-4>>2;re>5&&(re=0);var ae=C+X[J];re>0&&(ae+=jt(y,E,re),E+=re),V=jt(y,E,B),J=T>>>1==1?Ko[V]:zu[V],E+=J&15,J>>>=4;var Z=J<4?0:J-2>>1,ie=oe[J];for(Z>0&&(ie+=jt(y,E,Z),E+=Z),!S&&U<ae&&(A=zo(A,ae+100),U=A.length);C<ae;)A[C]=A[C-ie],++C}}}return S?[A,E+7>>>3]:[A.slice(0,C),E+7>>>3]}function Yu(y,S){var E=y.slice(y.l||0),T=Vv(E,S);return y.l+=T[1],T[0]}function Ju(y,S){if(y)typeof console<"u"&&console.error(S);else throw new Error(S)}function Qu(y,S){var E=y;Pt(E,0);var T=[],A=[],C={FileIndex:T,FullPaths:A};I(C,{root:S.root});for(var U=E.length-4;(E[U]!=80||E[U+1]!=75||E[U+2]!=5||E[U+3]!=6)&&U>=0;)--U;E.l=U+4,E.l+=4;var z=E.read_shift(2);E.l+=6;var B=E.read_shift(4);for(E.l=B,U=0;U<z;++U){E.l+=20;var W=E.read_shift(4),V=E.read_shift(4),J=E.read_shift(2),re=E.read_shift(2),ae=E.read_shift(2);E.l+=8;var Z=E.read_shift(4),ie=o(E.slice(E.l+J,E.l+J+re));E.l+=J+re+ae;var pe=E.l;E.l=Z+4,Gv(E,W,V,C,ie),E.l=pe}return C}function Gv(y,S,E,T,A){y.l+=2;var C=y.read_shift(2),U=y.read_shift(2),z=a(y);if(C&8257)throw new Error("Unsupported ZIP encryption");for(var B=y.read_shift(4),W=y.read_shift(4),V=y.read_shift(4),J=y.read_shift(2),re=y.read_shift(2),ae="",Z=0;Z<J;++Z)ae+=String.fromCharCode(y[y.l++]);if(re){var ie=o(y.slice(y.l,y.l+re));(ie[21589]||{}).mt&&(z=ie[21589].mt),((A||{})[21589]||{}).mt&&(z=A[21589].mt)}y.l+=re;var pe=y.slice(y.l,y.l+W);switch(U){case 8:pe=j(y,V);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+U)}var je=!1;C&8&&(B=y.read_shift(4),B==134695760&&(B=y.read_shift(4),je=!0),W=y.read_shift(4),V=y.read_shift(4)),W!=S&&Ju(je,"Bad compressed size: "+S+" != "+W),V!=E&&Ju(je,"Bad uncompressed size: "+E+" != "+V),Xo(T,ae,pe,{unsafe:!0,mt:z})}function zv(y,S){var E=S||{},T=[],A=[],C=G(1),U=E.compression?8:0,z=0,B=0,W=0,V=0,J=0,re=y.FullPaths[0],ae=re,Z=y.FileIndex[0],ie=[],pe=0;for(B=1;B<y.FullPaths.length;++B)if(ae=y.FullPaths[B].slice(re.length),Z=y.FileIndex[B],!(!Z.size||!Z.content||ae=="Sh33tJ5")){var je=V,$e=G(ae.length);for(W=0;W<ae.length;++W)$e.write_shift(1,ae.charCodeAt(W)&127);$e=$e.slice(0,$e.l),ie[J]=xk.buf(Z.content,0);var ht=Z.content;U==8&&(ht=D(ht)),C=G(30),C.write_shift(4,67324752),C.write_shift(2,20),C.write_shift(2,z),C.write_shift(2,U),Z.mt?s(C,Z.mt):C.write_shift(4,0),C.write_shift(-4,ie[J]),C.write_shift(4,ht.length),C.write_shift(4,Z.content.length),C.write_shift(2,$e.length),C.write_shift(2,0),V+=C.length,T.push(C),V+=$e.length,T.push($e),V+=ht.length,T.push(ht),C=G(46),C.write_shift(4,33639248),C.write_shift(2,0),C.write_shift(2,20),C.write_shift(2,z),C.write_shift(2,U),C.write_shift(4,0),C.write_shift(-4,ie[J]),C.write_shift(4,ht.length),C.write_shift(4,Z.content.length),C.write_shift(2,$e.length),C.write_shift(2,0),C.write_shift(2,0),C.write_shift(2,0),C.write_shift(2,0),C.write_shift(4,0),C.write_shift(4,je),pe+=C.l,A.push(C),pe+=$e.length,A.push($e),++J}return C=G(22),C.write_shift(4,101010256),C.write_shift(2,0),C.write_shift(2,0),C.write_shift(2,J),C.write_shift(2,J),C.write_shift(4,pe),C.write_shift(4,V),C.write_shift(2,0),ot([ot(T),ot(A),C])}var na={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function qv(y,S){if(y.ctype)return y.ctype;var E=y.name||"",T=E.match(/\.([^\.]+)$/);return T&&na[T[1]]||S&&(T=(E=S).match(/[\.\\]([^\.\\])+$/),T&&na[T[1]])?na[T[1]]:"application/octet-stream"}function Kv(y){for(var S=Cs(y),E=[],T=0;T<S.length;T+=76)E.push(S.slice(T,T+76));return E.join(`\r
`)+`\r
`}function Xv(y){var S=y.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(W){var V=W.charCodeAt(0).toString(16).toUpperCase();return"="+(V.length==1?"0"+V:V)});S=S.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),S.charAt(0)==`
`&&(S="=0D"+S.slice(1)),S=S.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var E=[],T=S.split(`\r
`),A=0;A<T.length;++A){var C=T[A];if(C.length==0){E.push("");continue}for(var U=0;U<C.length;){var z=76,B=C.slice(U,U+z);B.charAt(z-1)=="="?z--:B.charAt(z-2)=="="?z-=2:B.charAt(z-3)=="="&&(z-=3),B=C.slice(U,U+z),U+=z,U<C.length&&(B+="="),E.push(B)}}return E.join(`\r
`)}function Yv(y){for(var S=[],E=0;E<y.length;++E){for(var T=y[E];E<=y.length&&T.charAt(T.length-1)=="=";)T=T.slice(0,T.length-1)+y[++E];S.push(T)}for(var A=0;A<S.length;++A)S[A]=S[A].replace(/[=][0-9A-Fa-f]{2}/g,function(C){return String.fromCharCode(parseInt(C.slice(1),16))});return Jt(S.join(`\r
`))}function Jv(y,S,E){for(var T="",A="",C="",U,z=0;z<10;++z){var B=S[z];if(!B||B.match(/^\s*$/))break;var W=B.match(/^(.*?):\s*([^\s].*)$/);if(W)switch(W[1].toLowerCase()){case"content-location":T=W[2].trim();break;case"content-type":C=W[2].trim();break;case"content-transfer-encoding":A=W[2].trim();break}}switch(++z,A.toLowerCase()){case"base64":U=Jt(Br(S.slice(z).join("")));break;case"quoted-printable":U=Yv(S.slice(z));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+A)}var V=Xo(y,T.slice(E.length),U,{unsafe:!0});C&&(V.ctype=C)}function Qv(y,S){if(Q(y.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var E=S&&S.root||"",T=(Se&&Buffer.isBuffer(y)?y.toString("binary"):Q(y)).split(`\r
`),A=0,C="";for(A=0;A<T.length;++A)if(C=T[A],!!/^Content-Location:/i.test(C)&&(C=C.slice(C.indexOf("file")),E||(E=C.slice(0,C.lastIndexOf("/")+1)),C.slice(0,E.length)!=E))for(;E.length>0&&(E=E.slice(0,E.length-1),E=E.slice(0,E.lastIndexOf("/")+1),C.slice(0,E.length)!=E););var U=(T[1]||"").match(/boundary="(.*?)"/);if(!U)throw new Error("MAD cannot find boundary");var z="--"+(U[1]||""),B=[],W=[],V={FileIndex:B,FullPaths:W};I(V);var J,re=0;for(A=0;A<T.length;++A){var ae=T[A];ae!==z&&ae!==z+"--"||(re++&&Jv(V,T.slice(J,A),E),J=A)}return V}function Zv(y,S){var E=S||{},T=E.boundary||"SheetJS";T="------="+T;for(var A=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+T.slice(2)+'"',"","",""],C=y.FullPaths[0],U=C,z=y.FileIndex[0],B=1;B<y.FullPaths.length;++B)if(U=y.FullPaths[B].slice(C.length),z=y.FileIndex[B],!(!z.size||!z.content||U=="Sh33tJ5")){U=U.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(pe){return"_x"+pe.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(pe){return"_u"+pe.charCodeAt(0).toString(16)+"_"});for(var W=z.content,V=Se&&Buffer.isBuffer(W)?W.toString("binary"):Q(W),J=0,re=Math.min(1024,V.length),ae=0,Z=0;Z<=re;++Z)(ae=V.charCodeAt(Z))>=32&&ae<128&&++J;var ie=J>=re*4/5;A.push(T),A.push("Content-Location: "+(E.root||"file:///C:/SheetJS/")+U),A.push("Content-Transfer-Encoding: "+(ie?"quoted-printable":"base64")),A.push("Content-Type: "+qv(z,U)),A.push(""),A.push(ie?Xv(V):Kv(V))}return A.push(T+`--\r
`),A.join(`\r
`)}function e1(y){var S={};return I(S,y),S}function Xo(y,S,E,T){var A=T&&T.unsafe;A||I(y);var C=!A&&Pe.find(y,S);if(!C){var U=y.FullPaths[0];S.slice(0,U.length)==U?U=S:(U.slice(-1)!="/"&&(U+="/"),U=(U+S).replace("//","/")),C={name:i(S),type:2},y.FileIndex.push(C),y.FullPaths.push(U),A||Pe.utils.cfb_gc(y)}return C.content=E,C.size=E?E.length:0,T&&(T.CLSID&&(C.clsid=T.CLSID),T.mt&&(C.mt=T.mt),T.ct&&(C.ct=T.ct)),C}function t1(y,S){I(y);var E=Pe.find(y,S);if(E){for(var T=0;T<y.FileIndex.length;++T)if(y.FileIndex[T]==E)return y.FileIndex.splice(T,1),y.FullPaths.splice(T,1),!0}return!1}function r1(y,S,E){I(y);var T=Pe.find(y,S);if(T){for(var A=0;A<y.FileIndex.length;++A)if(y.FileIndex[A]==T)return y.FileIndex[A].name=i(E),y.FullPaths[A]=E,!0}return!1}function n1(y){R(y,!0)}return e.find=H,e.read=M,e.parse=u,e.write=_e,e.writeFile=he,e.utils={cfb_new:e1,cfb_add:Xo,cfb_del:t1,cfb_mov:r1,cfb_gc:n1,ReadShift:ps,CheckField:dg,prep_blob:Pt,bconcat:ot,use_zlib:O,_deflateRaw:Vu,_inflateRaw:Yu,consts:xe},e}();function yk(t){return typeof t=="string"?Ro(t):Array.isArray(t)?GI(t):t}function Ks(t,e,r){if(typeof Deno<"u"){if(r&&typeof e=="string")switch(r){case"utf8":e=new TextEncoder(r).encode(e);break;case"binary":e=Ro(e);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(t,e)}var n=r=="utf8"?Or(e):e;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,t);if(typeof Blob<"u"){var i=new Blob([yk(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(i,t);if(typeof saveAs<"u")return saveAs(i,t);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var s=URL.createObjectURL(i);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),chrome.downloads.download({url:s,filename:t,saveAs:!0});var a=document.createElement("a");if(a.download!=null)return a.download=t,a.href=s,document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),s}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var o=File(t);return o.open("w"),o.encoding="binary",Array.isArray(e)&&(e=qs(e)),o.write(e),o.close(),e}catch(l){if(!l.message||!l.message.match(/onstruct/))throw l}throw new Error("cannot save file "+t)}function ut(t){for(var e=Object.keys(t),r=[],n=0;n<e.length;++n)Object.prototype.hasOwnProperty.call(t,e[n])&&r.push(e[n]);return r}function $h(t,e){for(var r=[],n=ut(t),i=0;i!==n.length;++i)r[t[n[i]][e]]==null&&(r[t[n[i]][e]]=n[i]);return r}function yu(t){for(var e=[],r=ut(t),n=0;n!==r.length;++n)e[t[r[n]]]=r[n];return e}function No(t){for(var e=[],r=ut(t),n=0;n!==r.length;++n)e[t[r[n]]]=parseInt(r[n],10);return e}function wk(t){for(var e=[],r=ut(t),n=0;n!==r.length;++n)e[t[r[n]]]==null&&(e[t[r[n]]]=[]),e[t[r[n]]].push(r[n]);return e}var Qa=new Date(1899,11,30,0,0,0);function It(t,e){var r=t.getTime();e&&(r-=1462*24*60*60*1e3);var n=Qa.getTime()+(t.getTimezoneOffset()-Qa.getTimezoneOffset())*6e4;return(r-n)/(24*60*60*1e3)}var Ym=new Date,_k=Qa.getTime()+(Ym.getTimezoneOffset()-Qa.getTimezoneOffset())*6e4,Bh=Ym.getTimezoneOffset();function Jm(t){var e=new Date;return e.setTime(t*24*60*60*1e3+_k),e.getTimezoneOffset()!==Bh&&e.setTime(e.getTime()+(e.getTimezoneOffset()-Bh)*6e4),e}var Uh=new Date("2017-02-19T19:06:09.000Z"),Qm=isNaN(Uh.getFullYear())?new Date("2/19/17"):Uh,Ek=Qm.getFullYear()==2017;function Et(t,e){var r=new Date(t);if(Ek)return e>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):e<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(t instanceof Date)return t;if(Qm.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return t.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var i=t.match(/\d+/g)||["2017","2","19","0","0","0"],s=new Date(+i[0],+i[1]-1,+i[2],+i[3]||0,+i[4]||0,+i[5]||0);return t.indexOf("Z")>-1&&(s=new Date(s.getTime()-s.getTimezoneOffset()*60*1e3)),s}function Do(t,e){if(Se&&Buffer.isBuffer(t)){if(e){if(t[0]==255&&t[1]==254)return Or(t.slice(2).toString("utf16le"));if(t[1]==254&&t[2]==255)return Or(VI(t.slice(2).toString("binary")))}return t.toString("binary")}if(typeof TextDecoder<"u")try{if(e){if(t[0]==255&&t[1]==254)return Or(new TextDecoder("utf-16le").decode(t.slice(2)));if(t[0]==254&&t[1]==255)return Or(new TextDecoder("utf-16be").decode(t.slice(2)))}var r={"€":"","‚":"",ƒ:"","„":"","…":"","†":"","‡":"","ˆ":"","‰":"",Š:"","‹":"",Œ:"",Ž:"","‘":"","’":"","“":"","”":"","•":"","–":"","—":"","˜":"","™":"",š:"","›":"",œ:"",ž:"",Ÿ:""};return Array.isArray(t)&&(t=new Uint8Array(t)),new TextDecoder("latin1").decode(t).replace(/[€‚ƒ„…†‡ˆ‰Š‹ŒŽ‘’“”•–—˜™š›œžŸ]/g,function(s){return r[s]||s})}catch{}for(var n=[],i=0;i!=t.length;++i)n.push(String.fromCharCode(t[i]));return n.join("")}function kt(t){if(typeof JSON<"u"&&!Array.isArray(t))return JSON.parse(JSON.stringify(t));if(typeof t!="object"||t==null)return t;if(t instanceof Date)return new Date(t.getTime());var e={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=kt(t[r]));return e}function We(t,e){for(var r="";r.length<e;)r+=t;return r}function Fr(t){var e=Number(t);if(!isNaN(e))return isFinite(e)?e:NaN;if(!/\d/.test(t))return e;var r=1,n=t.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(e=Number(n))||(n=n.replace(/[(](.*)[)]/,function(i,s){return r=-r,s}),!isNaN(e=Number(n)))?e/r:e}var bk=["january","february","march","april","may","june","july","august","september","october","november","december"];function Is(t){var e=new Date(t),r=new Date(NaN),n=e.getYear(),i=e.getMonth(),s=e.getDate();if(isNaN(s))return r;var a=t.toLowerCase();if(a.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(a=a.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),a.length>3&&bk.indexOf(a)==-1)return r}else if(a.match(/[a-z]/))return r;return n<0||n>8099?r:(i>0||s>1)&&n!=101?e:t.match(/[^-0-9:,\/\\]/)?r:e}function ye(t,e,r){if(t.FullPaths){if(typeof r=="string"){var n;return Se?n=Vr(r):n=zI(r),Pe.utils.cfb_add(t,e,n)}Pe.utils.cfb_add(t,e,r)}else t.file(e,r)}function wu(){return Pe.utils.cfb_new()}var Xe=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,Tk={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},_u=yu(Tk),Eu=/[&<>'"]/g,Sk=/[\u0000-\u0008\u000b-\u001f]/g;function ke(t){var e=t+"";return e.replace(Eu,function(r){return _u[r]}).replace(Sk,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function Hh(t){return ke(t).replace(/ /g,"_x0020_")}var Zm=/[\u0000-\u001f]/g;function Ak(t){var e=t+"";return e.replace(Eu,function(r){return _u[r]}).replace(/\n/g,"<br/>").replace(Zm,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function Ck(t){var e=t+"";return e.replace(Eu,function(r){return _u[r]}).replace(Zm,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}function Ik(t){return t.replace(/(\r\n|[\r\n])/g,"&#10;")}function kk(t){switch(t){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function yl(t){for(var e="",r=0,n=0,i=0,s=0,a=0,o=0;r<t.length;){if(n=t.charCodeAt(r++),n<128){e+=String.fromCharCode(n);continue}if(i=t.charCodeAt(r++),n>191&&n<224){a=(n&31)<<6,a|=i&63,e+=String.fromCharCode(a);continue}if(s=t.charCodeAt(r++),n<240){e+=String.fromCharCode((n&15)<<12|(i&63)<<6|s&63);continue}a=t.charCodeAt(r++),o=((n&7)<<18|(i&63)<<12|(s&63)<<6|a&63)-65536,e+=String.fromCharCode(55296+(o>>>10&1023)),e+=String.fromCharCode(56320+(o&1023))}return e}function Wh(t){var e=Kn(2*t.length),r,n,i=1,s=0,a=0,o;for(n=0;n<t.length;n+=i)i=1,(o=t.charCodeAt(n))<128?r=o:o<224?(r=(o&31)*64+(t.charCodeAt(n+1)&63),i=2):o<240?(r=(o&15)*4096+(t.charCodeAt(n+1)&63)*64+(t.charCodeAt(n+2)&63),i=3):(i=4,r=(o&7)*262144+(t.charCodeAt(n+1)&63)*4096+(t.charCodeAt(n+2)&63)*64+(t.charCodeAt(n+3)&63),r-=65536,a=55296+(r>>>10&1023),r=56320+(r&1023)),a!==0&&(e[s++]=a&255,e[s++]=a>>>8,a=0),e[s++]=r%256,e[s++]=r>>>8;return e.slice(0,s).toString("ucs2")}function Vh(t){return Vr(t,"binary").toString("utf8")}var ma="foo bar bazâð£",ds=Se&&(Vh(ma)==yl(ma)&&Vh||Wh(ma)==yl(ma)&&Wh)||yl,Or=Se?function(t){return Vr(t,"utf8").toString("binary")}:function(t){for(var e=[],r=0,n=0,i=0;r<t.length;)switch(n=t.charCodeAt(r++),!0){case n<128:e.push(String.fromCharCode(n));break;case n<2048:e.push(String.fromCharCode(192+(n>>6))),e.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,i=t.charCodeAt(r++)-56320+(n<<10),e.push(String.fromCharCode(240+(i>>18&7))),e.push(String.fromCharCode(144+(i>>12&63))),e.push(String.fromCharCode(128+(i>>6&63))),e.push(String.fromCharCode(128+(i&63)));break;default:e.push(String.fromCharCode(224+(n>>12))),e.push(String.fromCharCode(128+(n>>6&63))),e.push(String.fromCharCode(128+(n&63)))}return e.join("")},Ok=function(){var t=[["nbsp"," "],["middot","·"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(e){return[new RegExp("&"+e[0]+";","ig"),e[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),i=0;i<t.length;++i)n=n.replace(t[i][0],t[i][1]);return n}}(),eg=/(^\s|\s$|\n)/;function lt(t,e){return"<"+t+(e.match(eg)?' xml:space="preserve"':"")+">"+e+"</"+t+">"}function ks(t){return ut(t).map(function(e){return" "+e+'="'+t[e]+'"'}).join("")}function ee(t,e,r){return"<"+t+(r!=null?ks(r):"")+(e!=null?(e.match(eg)?' xml:space="preserve"':"")+">"+e+"</"+t:"/")+">"}function pc(t,e){try{return t.toISOString().replace(/\.\d*/,"")}catch(r){if(e)throw r}return""}function Rk(t,e){switch(typeof t){case"string":var r=ee("vt:lpwstr",ke(t));return e&&(r=r.replace(/&quot;/g,"_x0022_")),r;case"number":return ee((t|0)==t?"vt:i4":"vt:r8",ke(String(t)));case"boolean":return ee("vt:bool",t?"true":"false")}if(t instanceof Date)return ee("vt:filetime",pc(t));throw new Error("Unable to serialize "+t)}var Ze={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",mx:"http://schemas.microsoft.com/office/mac/excel/2008/main",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",sjs:"http://schemas.openxmlformats.org/package/2006/sheetjs/core-properties",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},Hi=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],Ft={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function Pk(t,e){for(var r=1-2*(t[e+7]>>>7),n=((t[e+7]&127)<<4)+(t[e+6]>>>4&15),i=t[e+6]&15,s=5;s>=0;--s)i=i*256+t[e+s];return n==2047?i==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,i+=Math.pow(2,52)),r*Math.pow(2,n-52)*i)}function Fk(t,e,r){var n=(e<0||1/e==-1/0?1:0)<<7,i=0,s=0,a=n?-e:e;isFinite(a)?a==0?i=s=0:(i=Math.floor(Math.log(a)/Math.LN2),s=a*Math.pow(2,52-i),i<=-1023&&(!isFinite(s)||s<Math.pow(2,52))?i=-1022:(s-=Math.pow(2,52),i+=1023)):(i=2047,s=isNaN(e)?26985:0);for(var o=0;o<=5;++o,s/=256)t[r+o]=s&255;t[r+6]=(i&15)<<4|s&15,t[r+7]=i>>4|n}var Gh=function(t){for(var e=[],r=10240,n=0;n<t[0].length;++n)if(t[0][n])for(var i=0,s=t[0][n].length;i<s;i+=r)e.push.apply(e,t[0][n].slice(i,i+r));return e},zh=Se?function(t){return t[0].length>0&&Buffer.isBuffer(t[0][0])?Buffer.concat(t[0].map(function(e){return Buffer.isBuffer(e)?e:Vr(e)})):Gh(t)}:Gh,qh=function(t,e,r){for(var n=[],i=e;i<r;i+=2)n.push(String.fromCharCode(ss(t,i)));return n.join("").replace(hs,"")},bu=Se?function(t,e,r){return Buffer.isBuffer(t)?t.toString("utf16le",e,r).replace(hs,""):qh(t,e,r)}:qh,Kh=function(t,e,r){for(var n=[],i=e;i<e+r;++i)n.push(("0"+t[i].toString(16)).slice(-2));return n.join("")},tg=Se?function(t,e,r){return Buffer.isBuffer(t)?t.toString("hex",e,e+r):Kh(t,e,r)}:Kh,Xh=function(t,e,r){for(var n=[],i=e;i<r;i++)n.push(String.fromCharCode(mi(t,i)));return n.join("")},Xs=Se?function(e,r,n){return Buffer.isBuffer(e)?e.toString("utf8",r,n):Xh(e,r,n)}:Xh,rg=function(t,e){var r=Nt(t,e);return r>0?Xs(t,e+4,e+4+r-1):""},ng=rg,ig=function(t,e){var r=Nt(t,e);return r>0?Xs(t,e+4,e+4+r-1):""},sg=ig,ag=function(t,e){var r=2*Nt(t,e);return r>0?Xs(t,e+4,e+4+r-1):""},og=ag,lg=function(e,r){var n=Nt(e,r);return n>0?bu(e,r+4,r+4+n):""},cg=lg,ug=function(t,e){var r=Nt(t,e);return r>0?Xs(t,e+4,e+4+r):""},fg=ug,hg=function(t,e){return Pk(t,e)},Za=hg,Tu=function(e){return Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array};Se&&(ng=function(e,r){if(!Buffer.isBuffer(e))return rg(e,r);var n=e.readUInt32LE(r);return n>0?e.toString("utf8",r+4,r+4+n-1):""},sg=function(e,r){if(!Buffer.isBuffer(e))return ig(e,r);var n=e.readUInt32LE(r);return n>0?e.toString("utf8",r+4,r+4+n-1):""},og=function(e,r){if(!Buffer.isBuffer(e))return ag(e,r);var n=2*e.readUInt32LE(r);return e.toString("utf16le",r+4,r+4+n-1)},cg=function(e,r){if(!Buffer.isBuffer(e))return lg(e,r);var n=e.readUInt32LE(r);return e.toString("utf16le",r+4,r+4+n)},fg=function(e,r){if(!Buffer.isBuffer(e))return ug(e,r);var n=e.readUInt32LE(r);return e.toString("utf8",r+4,r+4+n)},Za=function(e,r){return Buffer.isBuffer(e)?e.readDoubleLE(r):hg(e,r)},Tu=function(e){return Buffer.isBuffer(e)||Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array});var mi=function(t,e){return t[e]},ss=function(t,e){return t[e+1]*256+t[e]},Nk=function(t,e){var r=t[e+1]*256+t[e];return r<32768?r:(65535-r+1)*-1},Nt=function(t,e){return t[e+3]*(1<<24)+(t[e+2]<<16)+(t[e+1]<<8)+t[e]},Rn=function(t,e){return t[e+3]<<24|t[e+2]<<16|t[e+1]<<8|t[e]},Dk=function(t,e){return t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3]};function ps(t,e){var r="",n,i,s=[],a,o,l,c;switch(e){case"dbcs":if(c=this.l,Se&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*t).toString("utf16le");else for(l=0;l<t;++l)r+=String.fromCharCode(ss(this,c)),c+=2;t*=2;break;case"utf8":r=Xs(this,this.l,this.l+t);break;case"utf16le":t*=2,r=bu(this,this.l,this.l+t);break;case"wstr":return ps.call(this,t,"dbcs");case"lpstr-ansi":r=ng(this,this.l),t=4+Nt(this,this.l);break;case"lpstr-cp":r=sg(this,this.l),t=4+Nt(this,this.l);break;case"lpwstr":r=og(this,this.l),t=4+2*Nt(this,this.l);break;case"lpp4":t=4+Nt(this,this.l),r=cg(this,this.l),t&2&&(t+=2);break;case"8lpp4":t=4+Nt(this,this.l),r=fg(this,this.l),t&3&&(t+=4-(t&3));break;case"cstr":for(t=0,r="";(a=mi(this,this.l+t++))!==0;)s.push(ha(a));r=s.join("");break;case"_wstr":for(t=0,r="";(a=ss(this,this.l+t))!==0;)s.push(ha(a)),t+=2;t+=2,r=s.join("");break;case"dbcs-cont":for(r="",c=this.l,l=0;l<t;++l){if(this.lens&&this.lens.indexOf(c)!==-1)return a=mi(this,c),this.l=c+1,o=ps.call(this,t-l,a?"dbcs-cont":"sbcs-cont"),s.join("")+o;s.push(ha(ss(this,c))),c+=2}r=s.join(""),t*=2;break;case"cpstr":case"sbcs-cont":for(r="",c=this.l,l=0;l!=t;++l){if(this.lens&&this.lens.indexOf(c)!==-1)return a=mi(this,c),this.l=c+1,o=ps.call(this,t-l,a?"dbcs-cont":"sbcs-cont"),s.join("")+o;s.push(ha(mi(this,c))),c+=1}r=s.join("");break;default:switch(t){case 1:return n=mi(this,this.l),this.l++,n;case 2:return n=(e==="i"?Nk:ss)(this,this.l),this.l+=2,n;case 4:case-4:return e==="i"||!(this[this.l+3]&128)?(n=(t>0?Rn:Dk)(this,this.l),this.l+=4,n):(i=Nt(this,this.l),this.l+=4,i);case 8:case-8:if(e==="f")return t==8?i=Za(this,this.l):i=Za([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,i;t=8;case 16:r=tg(this,this.l,t);break}}return this.l+=t,r}var Lk=function(t,e,r){t[r]=e&255,t[r+1]=e>>>8&255,t[r+2]=e>>>16&255,t[r+3]=e>>>24&255},Mk=function(t,e,r){t[r]=e&255,t[r+1]=e>>8&255,t[r+2]=e>>16&255,t[r+3]=e>>24&255},jk=function(t,e,r){t[r]=e&255,t[r+1]=e>>>8&255};function $k(t,e,r){var n=0,i=0;if(r==="dbcs"){for(i=0;i!=e.length;++i)jk(this,e.charCodeAt(i),this.l+2*i);n=2*e.length}else if(r==="sbcs"){for(e=e.replace(/[^\x00-\x7F]/g,"_"),i=0;i!=e.length;++i)this[this.l+i]=e.charCodeAt(i)&255;n=e.length}else if(r==="hex"){for(;i<t;++i)this[this.l++]=parseInt(e.slice(2*i,2*i+2),16)||0;return this}else if(r==="utf16le"){var s=Math.min(this.l+t,this.length);for(i=0;i<Math.min(e.length,t);++i){var a=e.charCodeAt(i);this[this.l++]=a&255,this[this.l++]=a>>8}for(;this.l<s;)this[this.l++]=0;return this}else switch(t){case 1:n=1,this[this.l]=e&255;break;case 2:n=2,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255;break;case 3:n=3,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255,e>>>=8,this[this.l+2]=e&255;break;case 4:n=4,Lk(this,e,this.l);break;case 8:if(n=8,r==="f"){Fk(this,e,this.l);break}case 16:break;case-4:n=4,Mk(this,e,this.l);break}return this.l+=n,this}function dg(t,e){var r=tg(this,this.l,t.length>>1);if(r!==t)throw new Error(e+"Expected "+t+" saw "+r);this.l+=t.length>>1}function Pt(t,e){t.l=e,t.read_shift=ps,t.chk=dg,t.write_shift=$k}function mr(t,e){t.l+=e}function G(t){var e=Kn(t);return Pt(e,0),e}function Ct(){var t=[],e=Se?256:2048,r=function(c){var u=G(c);return Pt(u,0),u},n=r(e),i=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&t.push(n),n=null)},s=function(c){return n&&c<n.length-n.l?n:(i(),n=r(Math.max(c+1,e)))},a=function(){return i(),ot(t)},o=function(c){i(),n=c,n.l==null&&(n.l=n.length),s(e)};return{next:s,push:o,end:a,_bufs:t}}function K(t,e,r,n){var i=+e,s;if(!isNaN(i)){n||(n=P3[i].p||(r||[]).length||0),s=1+(i>=128?1:0)+1,n>=128&&++s,n>=16384&&++s,n>=2097152&&++s;var a=t.next(s);i<=127?a.write_shift(1,i):(a.write_shift(1,(i&127)+128),a.write_shift(1,i>>7));for(var o=0;o!=4;++o)if(n>=128)a.write_shift(1,(n&127)+128),n>>=7;else{a.write_shift(1,n);break}n>0&&Tu(r)&&t.push(r)}}function ms(t,e,r){var n=kt(t);if(e.s?(n.cRel&&(n.c+=e.s.c),n.rRel&&(n.r+=e.s.r)):(n.cRel&&(n.c+=e.c),n.rRel&&(n.r+=e.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function Yh(t,e,r){var n=kt(t);return n.s=ms(n.s,e.s,r),n.e=ms(n.e,e.s,r),n}function gs(t,e){if(t.cRel&&t.c<0)for(t=kt(t);t.c<0;)t.c+=e>8?16384:256;if(t.rRel&&t.r<0)for(t=kt(t);t.r<0;)t.r+=e>8?1048576:e>5?65536:16384;var r=Oe(t);return!t.cRel&&t.cRel!=null&&(r=Hk(r)),!t.rRel&&t.rRel!=null&&(r=Bk(r)),r}function wl(t,e){return t.s.r==0&&!t.s.rRel&&t.e.r==(e.biff>=12?1048575:e.biff>=8?65536:16384)&&!t.e.rRel?(t.s.cRel?"":"$")+mt(t.s.c)+":"+(t.e.cRel?"":"$")+mt(t.e.c):t.s.c==0&&!t.s.cRel&&t.e.c==(e.biff>=12?16383:255)&&!t.e.cRel?(t.s.rRel?"":"$")+ct(t.s.r)+":"+(t.e.rRel?"":"$")+ct(t.e.r):gs(t.s,e.biff)+":"+gs(t.e,e.biff)}function Su(t){return parseInt(Uk(t),10)-1}function ct(t){return""+(t+1)}function Bk(t){return t.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function Uk(t){return t.replace(/\$(\d+)$/,"$1")}function Au(t){for(var e=Wk(t),r=0,n=0;n!==e.length;++n)r=26*r+e.charCodeAt(n)-64;return r-1}function mt(t){if(t<0)throw new Error("invalid column "+t);var e="";for(++t;t;t=Math.floor((t-1)/26))e=String.fromCharCode((t-1)%26+65)+e;return e}function Hk(t){return t.replace(/^([A-Z])/,"$$$1")}function Wk(t){return t.replace(/^\$([A-Z])/,"$1")}function Vk(t){return t.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function et(t){for(var e=0,r=0,n=0;n<t.length;++n){var i=t.charCodeAt(n);i>=48&&i<=57?e=10*e+(i-48):i>=65&&i<=90&&(r=26*r+(i-64))}return{c:r-1,r:e-1}}function Oe(t){for(var e=t.c+1,r="";e;e=(e-1)/26|0)r=String.fromCharCode((e-1)%26+65)+r;return r+(t.r+1)}function Mt(t){var e=t.indexOf(":");return e==-1?{s:et(t),e:et(t)}:{s:et(t.slice(0,e)),e:et(t.slice(e+1))}}function Ke(t,e){return typeof e>"u"||typeof e=="number"?Ke(t.s,t.e):(typeof t!="string"&&(t=Oe(t)),typeof e!="string"&&(e=Oe(e)),t==e?t:t+":"+e)}function Me(t){var e={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,i=0,s=t.length;for(r=0;n<s&&!((i=t.charCodeAt(n)-64)<1||i>26);++n)r=26*r+i;for(e.s.c=--r,r=0;n<s&&!((i=t.charCodeAt(n)-48)<0||i>9);++n)r=10*r+i;if(e.s.r=--r,n===s||i!=10)return e.e.c=e.s.c,e.e.r=e.s.r,e;for(++n,r=0;n!=s&&!((i=t.charCodeAt(n)-64)<1||i>26);++n)r=26*r+i;for(e.e.c=--r,r=0;n!=s&&!((i=t.charCodeAt(n)-48)<0||i>9);++n)r=10*r+i;return e.e.r=--r,e}function Jh(t,e){var r=t.t=="d"&&e instanceof Date;if(t.z!=null)try{return t.w=hn(t.z,r?It(e):e)}catch{}try{return t.w=hn((t.XF||{}).numFmtId||(r?14:0),r?It(e):e)}catch{return""+e}}function Ur(t,e,r){return t==null||t.t==null||t.t=="z"?"":t.w!==void 0?t.w:(t.t=="d"&&!t.z&&r&&r.dateNF&&(t.z=r.dateNF),t.t=="e"?Ys[t.v]||t.v:e==null?Jh(t,t.v):Jh(t,e))}function ei(t,e){var r=e&&e.sheet?e.sheet:"Sheet1",n={};return n[r]=t,{SheetNames:[r],Sheets:n}}function pg(t,e,r){var n=r||{},i=t?Array.isArray(t):n.dense,s=t||(i?[]:{}),a=0,o=0;if(s&&n.origin!=null){if(typeof n.origin=="number")a=n.origin;else{var l=typeof n.origin=="string"?et(n.origin):n.origin;a=l.r,o=l.c}s["!ref"]||(s["!ref"]="A1:A1")}var c={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(s["!ref"]){var u=Me(s["!ref"]);c.s.c=u.s.c,c.s.r=u.s.r,c.e.c=Math.max(c.e.c,u.e.c),c.e.r=Math.max(c.e.r,u.e.r),a==-1&&(c.e.r=a=u.e.r+1)}for(var f=0;f!=e.length;++f)if(e[f]){if(!Array.isArray(e[f]))throw new Error("aoa_to_sheet expects an array of arrays");for(var d=0;d!=e[f].length;++d)if(!(typeof e[f][d]>"u")){var h={v:e[f][d]},m=a+f,p=o+d;if(c.s.r>m&&(c.s.r=m),c.s.c>p&&(c.s.c=p),c.e.r<m&&(c.e.r=m),c.e.c<p&&(c.e.c=p),e[f][d]&&typeof e[f][d]=="object"&&!Array.isArray(e[f][d])&&!(e[f][d]instanceof Date))h=e[f][d];else if(Array.isArray(h.v)&&(h.f=e[f][d][1],h.v=h.v[0]),h.v===null)if(h.f)h.t="n";else if(n.nullError)h.t="e",h.v=0;else if(n.sheetStubs)h.t="z";else continue;else typeof h.v=="number"?h.t="n":typeof h.v=="boolean"?h.t="b":h.v instanceof Date?(h.z=n.dateNF||Ve[14],n.cellDates?(h.t="d",h.w=hn(h.z,It(h.v))):(h.t="n",h.v=It(h.v),h.w=hn(h.z,h.v))):h.t="s";if(i)s[m]||(s[m]=[]),s[m][p]&&s[m][p].z&&(h.z=s[m][p].z),s[m][p]=h;else{var g=Oe({c:p,r:m});s[g]&&s[g].z&&(h.z=s[g].z),s[g]=h}}}return c.s.c<1e7&&(s["!ref"]=Ke(c)),s}function Wi(t,e){return pg(null,t,e)}function Gk(t){return t.read_shift(4,"i")}function tr(t,e){return e||(e=G(4)),e.write_shift(4,t),e}function gt(t){var e=t.read_shift(4);return e===0?"":t.read_shift(e,"dbcs")}function tt(t,e){var r=!1;return e==null&&(r=!0,e=G(4+2*t.length)),e.write_shift(4,t.length),t.length>0&&e.write_shift(0,t,"dbcs"),r?e.slice(0,e.l):e}function zk(t){return{ich:t.read_shift(2),ifnt:t.read_shift(2)}}function qk(t,e){return e||(e=G(4)),e.write_shift(2,t.ich||0),e.write_shift(2,t.ifnt||0),e}function Cu(t,e){var r=t.l,n=t.read_shift(1),i=gt(t),s=[],a={t:i,h:i};if(n&1){for(var o=t.read_shift(4),l=0;l!=o;++l)s.push(zk(t));a.r=s}else a.r=[{ich:0,ifnt:0}];return t.l=r+e,a}function Kk(t,e){var r=!1;return e==null&&(r=!0,e=G(15+4*t.t.length)),e.write_shift(1,0),tt(t.t,e),r?e.slice(0,e.l):e}var Xk=Cu;function Yk(t,e){var r=!1;return e==null&&(r=!0,e=G(23+4*t.t.length)),e.write_shift(1,1),tt(t.t,e),e.write_shift(4,1),qk({ich:0,ifnt:0},e),r?e.slice(0,e.l):e}function zt(t){var e=t.read_shift(4),r=t.read_shift(2);return r+=t.read_shift(1)<<16,t.l++,{c:e,iStyleRef:r}}function ti(t,e){return e==null&&(e=G(8)),e.write_shift(-4,t.c),e.write_shift(3,t.iStyleRef||t.s),e.write_shift(1,0),e}function ri(t){var e=t.read_shift(2);return e+=t.read_shift(1)<<16,t.l++,{c:-1,iStyleRef:e}}function ni(t,e){return e==null&&(e=G(4)),e.write_shift(3,t.iStyleRef||t.s),e.write_shift(1,0),e}var Jk=gt,mg=tt;function Iu(t){var e=t.read_shift(4);return e===0||e===4294967295?"":t.read_shift(e,"dbcs")}function eo(t,e){var r=!1;return e==null&&(r=!0,e=G(127)),e.write_shift(4,t.length>0?t.length:4294967295),t.length>0&&e.write_shift(0,t,"dbcs"),r?e.slice(0,e.l):e}var Qk=gt,mc=Iu,ku=eo;function gg(t){var e=t.slice(t.l,t.l+4),r=e[0]&1,n=e[0]&2;t.l+=4;var i=n===0?Za([0,0,0,0,e[0]&252,e[1],e[2],e[3]],0):Rn(e,0)>>2;return r?i/100:i}function vg(t,e){e==null&&(e=G(4));var r=0,n=0,i=t*100;if(t==(t|0)&&t>=-(1<<29)&&t<1<<29?n=1:i==(i|0)&&i>=-(1<<29)&&i<1<<29&&(n=1,r=1),n)e.write_shift(-4,((r?i:t)<<2)+(r+2));else throw new Error("unsupported RkNumber "+t)}function xg(t){var e={s:{},e:{}};return e.s.r=t.read_shift(4),e.e.r=t.read_shift(4),e.s.c=t.read_shift(4),e.e.c=t.read_shift(4),e}function Zk(t,e){return e||(e=G(16)),e.write_shift(4,t.s.r),e.write_shift(4,t.e.r),e.write_shift(4,t.s.c),e.write_shift(4,t.e.c),e}var ii=xg,Vi=Zk;function Gi(t){if(t.length-t.l<8)throw"XLS Xnum Buffer underflow";return t.read_shift(8,"f")}function Xn(t,e){return(e||G(8)).write_shift(8,t,"f")}function eO(t){var e={},r=t.read_shift(1),n=r>>>1,i=t.read_shift(1),s=t.read_shift(2,"i"),a=t.read_shift(1),o=t.read_shift(1),l=t.read_shift(1);switch(t.l++,n){case 0:e.auto=1;break;case 1:e.index=i;var c=cO[i];c&&(e.rgb=l0(c));break;case 2:e.rgb=l0([a,o,l]);break;case 3:e.theme=i;break}return s!=0&&(e.tint=s>0?s/32767:s/32768),e}function to(t,e){if(e||(e=G(8)),!t||t.auto)return e.write_shift(4,0),e.write_shift(4,0),e;t.index!=null?(e.write_shift(1,2),e.write_shift(1,t.index)):t.theme!=null?(e.write_shift(1,6),e.write_shift(1,t.theme)):(e.write_shift(1,5),e.write_shift(1,0));var r=t.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),e.write_shift(2,r),!t.rgb||t.theme!=null)e.write_shift(2,0),e.write_shift(1,0),e.write_shift(1,0);else{var n=t.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),e.write_shift(1,parseInt(n.slice(0,2),16)),e.write_shift(1,parseInt(n.slice(2,4),16)),e.write_shift(1,parseInt(n.slice(4,6),16)),e.write_shift(1,255)}return e}function tO(t){var e=t.read_shift(1);t.l++;var r={fBold:e&1,fItalic:e&2,fUnderline:e&4,fStrikeout:e&8,fOutline:e&16,fShadow:e&32,fCondense:e&64,fExtend:e&128};return r}function rO(t,e){e||(e=G(2));var r=(t.italic?2:0)|(t.strike?8:0)|(t.outline?16:0)|(t.shadow?32:0)|(t.condense?64:0)|(t.extend?128:0);return e.write_shift(1,r),e.write_shift(1,0),e}var yg=2,Rt=3,ga=11,ro=19,va=64,nO=65,iO=71,sO=4108,aO=4126,it=80,Qh={1:{n:"CodePage",t:yg},2:{n:"Category",t:it},3:{n:"PresentationFormat",t:it},4:{n:"ByteCount",t:Rt},5:{n:"LineCount",t:Rt},6:{n:"ParagraphCount",t:Rt},7:{n:"SlideCount",t:Rt},8:{n:"NoteCount",t:Rt},9:{n:"HiddenCount",t:Rt},10:{n:"MultimediaClipCount",t:Rt},11:{n:"ScaleCrop",t:ga},12:{n:"HeadingPairs",t:sO},13:{n:"TitlesOfParts",t:aO},14:{n:"Manager",t:it},15:{n:"Company",t:it},16:{n:"LinksUpToDate",t:ga},17:{n:"CharacterCount",t:Rt},19:{n:"SharedDoc",t:ga},22:{n:"HyperlinksChanged",t:ga},23:{n:"AppVersion",t:Rt,p:"version"},24:{n:"DigSig",t:nO},26:{n:"ContentType",t:it},27:{n:"ContentStatus",t:it},28:{n:"Language",t:it},29:{n:"Version",t:it},255:{},2147483648:{n:"Locale",t:ro},2147483651:{n:"Behavior",t:ro},1919054434:{}},Zh={1:{n:"CodePage",t:yg},2:{n:"Title",t:it},3:{n:"Subject",t:it},4:{n:"Author",t:it},5:{n:"Keywords",t:it},6:{n:"Comments",t:it},7:{n:"Template",t:it},8:{n:"LastAuthor",t:it},9:{n:"RevNumber",t:it},10:{n:"EditTime",t:va},11:{n:"LastPrinted",t:va},12:{n:"CreatedDate",t:va},13:{n:"ModifiedDate",t:va},14:{n:"PageCount",t:Rt},15:{n:"WordCount",t:Rt},16:{n:"CharCount",t:Rt},17:{n:"Thumbnail",t:iO},18:{n:"Application",t:it},19:{n:"DocSecurity",t:Rt},255:{},2147483648:{n:"Locale",t:ro},2147483651:{n:"Behavior",t:ro},1919054434:{}};function oO(t){return t.map(function(e){return[e>>16&255,e>>8&255,e&255]})}var lO=oO([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),cO=kt(lO),Ys={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},uO={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},xa={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function wg(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function _g(t,e){var r=wk(uO),n=[],i;n[n.length]=Xe,n[n.length]=ee("Types",null,{xmlns:Ze.CT,"xmlns:xsd":Ze.xsd,"xmlns:xsi":Ze.xsi}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(l){return ee("Default",null,{Extension:l[0],ContentType:l[1]})}));var s=function(l){t[l]&&t[l].length>0&&(i=t[l][0],n[n.length]=ee("Override",null,{PartName:(i[0]=="/"?"":"/")+i,ContentType:xa[l][e.bookType]||xa[l].xlsx}))},a=function(l){(t[l]||[]).forEach(function(c){n[n.length]=ee("Override",null,{PartName:(c[0]=="/"?"":"/")+c,ContentType:xa[l][e.bookType]||xa[l].xlsx})})},o=function(l){(t[l]||[]).forEach(function(c){n[n.length]=ee("Override",null,{PartName:(c[0]=="/"?"":"/")+c,ContentType:r[l][0]})})};return s("workbooks"),a("sheets"),a("charts"),o("themes"),["strs","styles"].forEach(s),["coreprops","extprops","custprops"].forEach(o),o("vba"),o("comments"),o("threadedcomments"),o("drawings"),a("metadata"),o("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var Te={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function Eg(t){var e=t.lastIndexOf("/");return t.slice(0,e+1)+"_rels/"+t.slice(e+1)+".rels"}function Ai(t){var e=[Xe,ee("Relationships",null,{xmlns:Ze.RELS})];return ut(t["!id"]).forEach(function(r){e[e.length]=ee("Relationship",null,t["!id"][r])}),e.length>2&&(e[e.length]="</Relationships>",e[1]=e[1].replace("/>",">")),e.join("")}function Ie(t,e,r,n,i,s){if(i||(i={}),t["!id"]||(t["!id"]={}),t["!idx"]||(t["!idx"]=1),e<0)for(e=t["!idx"];t["!id"]["rId"+e];++e);if(t["!idx"]=e+1,i.Id="rId"+e,i.Type=n,i.Target=r,s?i.TargetMode=s:[Te.HLINK,Te.XPATH,Te.XMISS].indexOf(i.Type)>-1&&(i.TargetMode="External"),t["!id"][i.Id])throw new Error("Cannot rewrite rId "+e);return t["!id"][i.Id]=i,t[("/"+i.Target).replace("//","/")]=i,e}function fO(t){var e=[Xe];e.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),e.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<t.length;++r)e.push('  <manifest:file-entry manifest:full-path="'+t[r][0]+'" manifest:media-type="'+t[r][1]+`"/>
`);return e.push("</manifest:manifest>"),e.join("")}function e0(t,e,r){return['  <rdf:Description rdf:about="'+t+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+e+`"/>
`,`  </rdf:Description>
`].join("")}function hO(t,e){return['  <rdf:Description rdf:about="'+t+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+e+`"/>
`,`  </rdf:Description>
`].join("")}function dO(t){var e=[Xe];e.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=t.length;++r)e.push(e0(t[r][0],t[r][1])),e.push(hO("",t[r][0]));return e.push(e0("","Document","pkg")),e.push("</rdf:RDF>"),e.join("")}function bg(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+Ka.version+"</meta:generator></office:meta></office:document-meta>"}var Bn=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]];function _l(t,e,r,n,i){i[t]!=null||e==null||e===""||(i[t]=e,e=ke(e),n[n.length]=r?ee(t,e,r):lt(t,e))}function Tg(t,e){var r=e||{},n=[Xe,ee("cp:coreProperties",null,{"xmlns:cp":Ze.CORE_PROPS,"xmlns:dc":Ze.dc,"xmlns:dcterms":Ze.dcterms,"xmlns:dcmitype":Ze.dcmitype,"xmlns:xsi":Ze.xsi})],i={};if(!t&&!r.Props)return n.join("");t&&(t.CreatedDate!=null&&_l("dcterms:created",typeof t.CreatedDate=="string"?t.CreatedDate:pc(t.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,i),t.ModifiedDate!=null&&_l("dcterms:modified",typeof t.ModifiedDate=="string"?t.ModifiedDate:pc(t.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,i));for(var s=0;s!=Bn.length;++s){var a=Bn[s],o=r.Props&&r.Props[a[1]]!=null?r.Props[a[1]]:t?t[a[1]]:null;o===!0?o="1":o===!1?o="0":typeof o=="number"&&(o=String(o)),o!=null&&_l(a[0],o,null,n,i)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var Ci=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],Sg=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function Ag(t){var e=[],r=ee;return t||(t={}),t.Application="SheetJS",e[e.length]=Xe,e[e.length]=ee("Properties",null,{xmlns:Ze.EXT_PROPS,"xmlns:vt":Ze.vt}),Ci.forEach(function(n){if(t[n[1]]!==void 0){var i;switch(n[2]){case"string":i=ke(String(t[n[1]]));break;case"bool":i=t[n[1]]?"true":"false";break}i!==void 0&&(e[e.length]=r(n[0],i))}}),e[e.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(t.Worksheets))),{size:2,baseType:"variant"})),e[e.length]=r("TitlesOfParts",r("vt:vector",t.SheetNames.map(function(n){return"<vt:lpstr>"+ke(n)+"</vt:lpstr>"}).join(""),{size:t.Worksheets,baseType:"lpstr"})),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}function Cg(t){var e=[Xe,ee("Properties",null,{xmlns:Ze.CUST_PROPS,"xmlns:vt":Ze.vt})];if(!t)return e.join("");var r=1;return ut(t).forEach(function(i){++r,e[e.length]=ee("property",Rk(t[i],!0),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:ke(i)})}),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}var t0={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"};function pO(t,e){var r=[];return ut(t0).map(function(n){for(var i=0;i<Bn.length;++i)if(Bn[i][1]==n)return Bn[i];for(i=0;i<Ci.length;++i)if(Ci[i][1]==n)return Ci[i];throw n}).forEach(function(n){if(t[n[1]]!=null){var i=e&&e.Props&&e.Props[n[1]]!=null?e.Props[n[1]]:t[n[1]];switch(n[2]){case"date":i=new Date(i).toISOString().replace(/\.\d*Z/,"Z");break}typeof i=="number"?i=String(i):i===!0||i===!1?i=i?"1":"0":i instanceof Date&&(i=new Date(i).toISOString().replace(/\.\d*Z/,"")),r.push(lt(t0[n[1]]||n[1],i))}}),ee("DocumentProperties",r.join(""),{xmlns:Ft.o})}function mO(t,e){var r=["Worksheets","SheetNames"],n="CustomDocumentProperties",i=[];return t&&ut(t).forEach(function(s){if(Object.prototype.hasOwnProperty.call(t,s)){for(var a=0;a<Bn.length;++a)if(s==Bn[a][1])return;for(a=0;a<Ci.length;++a)if(s==Ci[a][1])return;for(a=0;a<r.length;++a)if(s==r[a])return;var o=t[s],l="string";typeof o=="number"?(l="float",o=String(o)):o===!0||o===!1?(l="boolean",o=o?"1":"0"):o=String(o),i.push(ee(Hh(s),o,{"dt:dt":l}))}}),e&&ut(e).forEach(function(s){if(Object.prototype.hasOwnProperty.call(e,s)&&!(t&&Object.prototype.hasOwnProperty.call(t,s))){var a=e[s],o="string";typeof a=="number"?(o="float",a=String(a)):a===!0||a===!1?(o="boolean",a=a?"1":"0"):a instanceof Date?(o="dateTime.tz",a=a.toISOString()):a=String(a),i.push(ee(Hh(s),a,{"dt:dt":o}))}}),"<"+n+' xmlns="'+Ft.o+'">'+i.join("")+"</"+n+">"}function gO(t){var e=typeof t=="string"?new Date(Date.parse(t)):t,r=e.getTime()/1e3+11644473600,n=r%Math.pow(2,32),i=(r-n)/Math.pow(2,32);n*=1e7,i*=1e7;var s=n/Math.pow(2,32)|0;s>0&&(n=n%Math.pow(2,32),i+=s);var a=G(8);return a.write_shift(4,n),a.write_shift(4,i),a}function r0(t,e){var r=G(4),n=G(4);switch(r.write_shift(4,t==80?31:t),t){case 3:n.write_shift(-4,e);break;case 5:n=G(8),n.write_shift(8,e,"f");break;case 11:n.write_shift(4,e?1:0);break;case 64:n=gO(e);break;case 31:case 80:for(n=G(4+2*(e.length+1)+(e.length%2?0:2)),n.write_shift(4,e.length+1),n.write_shift(0,e,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+e)}return ot([r,n])}var Ig=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function vO(t){switch(typeof t){case"boolean":return 11;case"number":return(t|0)==t?3:5;case"string":return 31;case"object":if(t instanceof Date)return 64;break}return-1}function n0(t,e,r){var n=G(8),i=[],s=[],a=8,o=0,l=G(8),c=G(8);if(l.write_shift(4,2),l.write_shift(4,1200),c.write_shift(4,1),s.push(l),i.push(c),a+=8+l.length,!e){c=G(8),c.write_shift(4,0),i.unshift(c);var u=[G(4)];for(u[0].write_shift(4,t.length),o=0;o<t.length;++o){var f=t[o][0];for(l=G(4+4+2*(f.length+1)+(f.length%2?0:2)),l.write_shift(4,o+2),l.write_shift(4,f.length+1),l.write_shift(0,f,"dbcs");l.l!=l.length;)l.write_shift(1,0);u.push(l)}l=ot(u),s.unshift(l),a+=8+l.length}for(o=0;o<t.length;++o)if(!(e&&!e[t[o][0]])&&!(Ig.indexOf(t[o][0])>-1||Sg.indexOf(t[o][0])>-1)&&t[o][1]!=null){var d=t[o][1],h=0;if(e){h=+e[t[o][0]];var m=r[h];if(m.p=="version"&&typeof d=="string"){var p=d.split(".");d=(+p[0]<<16)+(+p[1]||0)}l=r0(m.t,d)}else{var g=vO(d);g==-1&&(g=31,d=String(d)),l=r0(g,d)}s.push(l),c=G(8),c.write_shift(4,e?h:2+o),i.push(c),a+=8+l.length}var w=8*(s.length+1);for(o=0;o<s.length;++o)i[o].write_shift(4,w),w+=s[o].length;return n.write_shift(4,a),n.write_shift(4,s.length),ot([n].concat(i).concat(s))}function i0(t,e,r,n,i,s){var a=G(i?68:48),o=[a];a.write_shift(2,65534),a.write_shift(2,0),a.write_shift(4,842412599),a.write_shift(16,Pe.utils.consts.HEADER_CLSID,"hex"),a.write_shift(4,i?2:1),a.write_shift(16,e,"hex"),a.write_shift(4,i?68:48);var l=n0(t,r,n);if(o.push(l),i){var c=n0(i,null,null);a.write_shift(16,s,"hex"),a.write_shift(4,68+l.length),o.push(c)}return ot(o)}function xO(t,e){e||(e=G(t));for(var r=0;r<t;++r)e.write_shift(1,0);return e}function yO(t,e){return t.read_shift(e)===1}function yt(t,e){return e||(e=G(2)),e.write_shift(2,+!!t),e}function kg(t){return t.read_shift(2,"u")}function Ht(t,e){return e||(e=G(2)),e.write_shift(2,t),e}function Og(t,e,r){return r||(r=G(2)),r.write_shift(1,e=="e"?+t:+!!t),r.write_shift(1,e=="e"?1:0),r}function Rg(t,e,r){var n=t.read_shift(r&&r.biff>=12?2:1),i="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var s=t.read_shift(1);s&&(i="dbcs-cont")}else r.biff==12&&(i="wstr");r.biff>=2&&r.biff<=5&&(i="cpstr");var a=n?t.read_shift(n,i):"";return a}function wO(t){var e=t.t||"",r=G(3+0);r.write_shift(2,e.length),r.write_shift(1,1);var n=G(2*e.length);n.write_shift(2*e.length,e,"utf16le");var i=[r,n];return ot(i)}function _O(t,e,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return t.read_shift(e,"cpstr");if(r.biff>=12)return t.read_shift(e,"dbcs-cont")}var i=t.read_shift(1);return i===0?n=t.read_shift(e,"sbcs-cont"):n=t.read_shift(e,"dbcs-cont"),n}function EO(t,e,r){var n=t.read_shift(r&&r.biff==2?1:2);return n===0?(t.l++,""):_O(t,n,r)}function bO(t,e,r){if(r.biff>5)return EO(t,e,r);var n=t.read_shift(1);return n===0?(t.l++,""):t.read_shift(n,r.biff<=4||!t.lens?"cpstr":"sbcs-cont")}function Pg(t,e,r){return r||(r=G(3+2*t.length)),r.write_shift(2,t.length),r.write_shift(1,1),r.write_shift(31,t,"utf16le"),r}function s0(t,e){e||(e=G(6+t.length*2)),e.write_shift(4,1+t.length);for(var r=0;r<t.length;++r)e.write_shift(2,t.charCodeAt(r));return e.write_shift(2,0),e}function TO(t){var e=G(512),r=0,n=t.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var i=n.indexOf("#"),s=i>-1?31:23;switch(n.charAt(0)){case"#":s=28;break;case".":s&=-3;break}e.write_shift(4,2),e.write_shift(4,s);var a=[8,6815827,6619237,4849780,83];for(r=0;r<a.length;++r)e.write_shift(4,a[r]);if(s==28)n=n.slice(1),s0(n,e);else if(s&2){for(a="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<a.length;++r)e.write_shift(1,parseInt(a[r],16));var o=i>-1?n.slice(0,i):n;for(e.write_shift(4,2*(o.length+1)),r=0;r<o.length;++r)e.write_shift(2,o.charCodeAt(r));e.write_shift(2,0),s&8&&s0(i>-1?n.slice(i+1):"",e)}else{for(a="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<a.length;++r)e.write_shift(1,parseInt(a[r],16));for(var l=0;n.slice(l*3,l*3+3)=="../"||n.slice(l*3,l*3+3)=="..\\";)++l;for(e.write_shift(2,l),e.write_shift(4,n.length-3*l+1),r=0;r<n.length-3*l;++r)e.write_shift(1,n.charCodeAt(r+3*l)&255);for(e.write_shift(1,0),e.write_shift(2,65535),e.write_shift(2,57005),r=0;r<6;++r)e.write_shift(4,0)}return e.slice(0,e.l)}function Yn(t,e,r,n){return n||(n=G(6)),n.write_shift(2,t),n.write_shift(2,e),n.write_shift(2,r||0),n}function SO(t,e,r){var n=r.biff>8?4:2,i=t.read_shift(n),s=t.read_shift(n,"i"),a=t.read_shift(n,"i");return[i,s,a]}function AO(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2),i=t.read_shift(2);return{s:{c:n,r:e},e:{c:i,r}}}function Fg(t,e){return e||(e=G(8)),e.write_shift(2,t.s.r),e.write_shift(2,t.e.r),e.write_shift(2,t.s.c),e.write_shift(2,t.e.c),e}function Ou(t,e,r){var n=1536,i=16;switch(r.bookType){case"biff8":break;case"biff5":n=1280,i=8;break;case"biff4":n=4,i=6;break;case"biff3":n=3,i=6;break;case"biff2":n=2,i=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var s=G(i);return s.write_shift(2,n),s.write_shift(2,e),i>4&&s.write_shift(2,29282),i>6&&s.write_shift(2,1997),i>8&&(s.write_shift(2,49161),s.write_shift(2,1),s.write_shift(2,1798),s.write_shift(2,0)),s}function CO(t,e){var r=!e||e.biff==8,n=G(r?112:54);for(n.write_shift(e.biff==8?2:1,7),r&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(r?0:536870912));n.l<n.length;)n.write_shift(1,r?0:32);return n}function IO(t,e){var r=!e||e.biff>=8?2:1,n=G(8+r*t.name.length);n.write_shift(4,t.pos),n.write_shift(1,t.hs||0),n.write_shift(1,t.dt),n.write_shift(1,t.name.length),e.biff>=8&&n.write_shift(1,1),n.write_shift(r*t.name.length,t.name,e.biff<8?"sbcs":"utf16le");var i=n.slice(0,n.l);return i.l=n.l,i}function kO(t,e){var r=G(8);r.write_shift(4,t.Count),r.write_shift(4,t.Unique);for(var n=[],i=0;i<t.length;++i)n[i]=wO(t[i]);var s=ot([r].concat(n));return s.parts=[r.length].concat(n.map(function(a){return a.length})),s}function OO(){var t=G(18);return t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,29280),t.write_shift(2,17600),t.write_shift(2,56),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,1),t.write_shift(2,500),t}function RO(t){var e=G(18),r=1718;return t&&t.RTL&&(r|=64),e.write_shift(2,r),e.write_shift(4,0),e.write_shift(4,64),e.write_shift(4,0),e.write_shift(4,0),e}function PO(t,e){var r=t.name||"Arial",n=e&&e.biff==5,i=n?15+r.length:16+2*r.length,s=G(i);return s.write_shift(2,(t.sz||12)*20),s.write_shift(4,0),s.write_shift(2,400),s.write_shift(4,0),s.write_shift(2,0),s.write_shift(1,r.length),n||s.write_shift(1,1),s.write_shift((n?1:2)*r.length,r,n?"sbcs":"utf16le"),s}function FO(t,e,r,n){var i=G(10);return Yn(t,e,n,i),i.write_shift(4,r),i}function NO(t,e,r,n,i){var s=!i||i.biff==8,a=G(6+2+ +s+(1+s)*r.length);return Yn(t,e,n,a),a.write_shift(2,r.length),s&&a.write_shift(1,1),a.write_shift((1+s)*r.length,r,s?"utf16le":"sbcs"),a}function DO(t,e,r,n){var i=r&&r.biff==5;n||(n=G(i?3+e.length:5+2*e.length)),n.write_shift(2,t),n.write_shift(i?1:2,e.length),i||n.write_shift(1,1),n.write_shift((i?1:2)*e.length,e,i?"sbcs":"utf16le");var s=n.length>n.l?n.slice(0,n.l):n;return s.l==null&&(s.l=s.length),s}function LO(t,e){var r=e.biff==8||!e.biff?4:2,n=G(2*r+6);return n.write_shift(r,t.s.r),n.write_shift(r,t.e.r+1),n.write_shift(2,t.s.c),n.write_shift(2,t.e.c+1),n.write_shift(2,0),n}function a0(t,e,r,n){var i=r&&r.biff==5;n||(n=G(i?16:20)),n.write_shift(2,0),t.style?(n.write_shift(2,t.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,t.numFmtId||0),n.write_shift(2,e<<4));var s=0;return t.numFmtId>0&&i&&(s|=1024),n.write_shift(4,s),n.write_shift(4,0),i||n.write_shift(4,0),n.write_shift(2,0),n}function MO(t){var e=G(8);return e.write_shift(4,0),e.write_shift(2,t[0]?t[0]+1:0),e.write_shift(2,t[1]?t[1]+1:0),e}function jO(t,e,r,n,i,s){var a=G(8);return Yn(t,e,n,a),Og(r,s,a),a}function $O(t,e,r,n){var i=G(14);return Yn(t,e,n,i),Xn(r,i),i}function BO(t,e,r){if(r.biff<8)return UO(t,e,r);for(var n=[],i=t.l+e,s=t.read_shift(r.biff>8?4:2);s--!==0;)n.push(SO(t,r.biff>8?12:6,r));if(t.l!=i)throw new Error("Bad ExternSheet: "+t.l+" != "+i);return n}function UO(t,e,r){t[t.l+1]==3&&t[t.l]++;var n=Rg(t,e,r);return n.charCodeAt(0)==3?n.slice(1):n}function HO(t){var e=G(2+t.length*8);e.write_shift(2,t.length);for(var r=0;r<t.length;++r)Fg(t[r],e);return e}function WO(t){var e=G(24),r=et(t[0]);e.write_shift(2,r.r),e.write_shift(2,r.r),e.write_shift(2,r.c),e.write_shift(2,r.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),i=0;i<16;++i)e.write_shift(1,parseInt(n[i],16));return ot([e,TO(t[1])])}function VO(t){var e=t[1].Tooltip,r=G(10+2*(e.length+1));r.write_shift(2,2048);var n=et(t[0]);r.write_shift(2,n.r),r.write_shift(2,n.r),r.write_shift(2,n.c),r.write_shift(2,n.c);for(var i=0;i<e.length;++i)r.write_shift(2,e.charCodeAt(i));return r.write_shift(2,0),r}function GO(t){return t||(t=G(4)),t.write_shift(2,1),t.write_shift(2,1),t}function zO(t,e,r){if(!r.cellStyles)return mr(t,e);var n=r&&r.biff>=12?4:2,i=t.read_shift(n),s=t.read_shift(n),a=t.read_shift(n),o=t.read_shift(n),l=t.read_shift(2);n==2&&(t.l+=2);var c={s:i,e:s,w:a,ixfe:o,flags:l};return(r.biff>=5||!r.biff)&&(c.level=l>>8&7),c}function qO(t,e){var r=G(12);r.write_shift(2,e),r.write_shift(2,e),r.write_shift(2,t.width*256),r.write_shift(2,0);var n=0;return t.hidden&&(n|=1),r.write_shift(1,n),n=t.level||0,r.write_shift(1,n),r.write_shift(2,0),r}function KO(t){for(var e=G(2*t),r=0;r<t;++r)e.write_shift(2,r+1);return e}function XO(t,e,r){var n=G(15);return Qs(n,t,e),n.write_shift(8,r,"f"),n}function YO(t,e,r){var n=G(9);return Qs(n,t,e),n.write_shift(2,r),n}var JO=function(){var t={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},e=yu({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(o,l){var c=[],u=Kn(1);switch(l.type){case"base64":u=Jt(Br(o));break;case"binary":u=Jt(o);break;case"buffer":case"array":u=o;break}Pt(u,0);var f=u.read_shift(1),d=!!(f&136),h=!1,m=!1;switch(f){case 2:break;case 3:break;case 48:h=!0,d=!0;break;case 49:h=!0,d=!0;break;case 131:break;case 139:break;case 140:m=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+f.toString(16))}var p=0,g=521;f==2&&(p=u.read_shift(2)),u.l+=3,f!=2&&(p=u.read_shift(4)),p>1048576&&(p=1e6),f!=2&&(g=u.read_shift(2));var w=u.read_shift(2),b=l.codepage||1252;f!=2&&(u.l+=16,u.read_shift(1),u[u.l]!==0&&(b=t[u[u.l]]),u.l+=1,u.l+=2),m&&(u.l+=36);for(var _=[],k={},L=Math.min(u.length,f==2?521:g-10-(h?264:0)),M=m?32:11;u.l<L&&u[u.l]!=13;)switch(k={},k.name=On.utils.decode(b,u.slice(u.l,u.l+M)).replace(/[\u0000\r\n].*$/g,""),u.l+=M,k.type=String.fromCharCode(u.read_shift(1)),f!=2&&!m&&(k.offset=u.read_shift(4)),k.len=u.read_shift(1),f==2&&(k.offset=u.read_shift(2)),k.dec=u.read_shift(1),k.name.length&&_.push(k),f!=2&&(u.l+=m?13:14),k.type){case"B":(!h||k.len!=8)&&l.WTF&&console.log("Skipping "+k.name+":"+k.type);break;case"G":case"P":l.WTF&&console.log("Skipping "+k.name+":"+k.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+k.type)}if(u[u.l]!==13&&(u.l=g-1),u.read_shift(1)!==13)throw new Error("DBF Terminator not found "+u.l+" "+u[u.l]);u.l=g;var I=0,F=0;for(c[0]=[],F=0;F!=_.length;++F)c[0][F]=_[F].name;for(;p-- >0;){if(u[u.l]===42){u.l+=w;continue}for(++u.l,c[++I]=[],F=0,F=0;F!=_.length;++F){var R=u.slice(u.l,u.l+_[F].len);u.l+=_[F].len,Pt(R,0);var N=On.utils.decode(b,R);switch(_[F].type){case"C":N.trim().length&&(c[I][F]=N.replace(/\s+$/,""));break;case"D":N.length===8?c[I][F]=new Date(+N.slice(0,4),+N.slice(4,6)-1,+N.slice(6,8)):c[I][F]=N;break;case"F":c[I][F]=parseFloat(N.trim());break;case"+":case"I":c[I][F]=m?R.read_shift(-4,"i")^2147483648:R.read_shift(4,"i");break;case"L":switch(N.trim().toUpperCase()){case"Y":case"T":c[I][F]=!0;break;case"N":case"F":c[I][F]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+N+"|")}break;case"M":if(!d)throw new Error("DBF Unexpected MEMO for type "+f.toString(16));c[I][F]="##MEMO##"+(m?parseInt(N.trim(),10):R.read_shift(4));break;case"N":N=N.replace(/\u0000/g,"").trim(),N&&N!="."&&(c[I][F]=+N||0);break;case"@":c[I][F]=new Date(R.read_shift(-8,"f")-621356832e5);break;case"T":c[I][F]=new Date((R.read_shift(4)-2440588)*864e5+R.read_shift(4));break;case"Y":c[I][F]=R.read_shift(4,"i")/1e4+R.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":c[I][F]=-R.read_shift(-8,"f");break;case"B":if(h&&_[F].len==8){c[I][F]=R.read_shift(8,"f");break}case"G":case"P":R.l+=_[F].len;break;case"0":if(_[F].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+_[F].type)}}}if(f!=2&&u.l<u.length&&u[u.l++]!=26)throw new Error("DBF EOF Marker missing "+(u.l-1)+" of "+u.length+" "+u[u.l-1].toString(16));return l&&l.sheetRows&&(c=c.slice(0,l.sheetRows)),l.DBF=_,c}function n(o,l){var c=l||{};c.dateNF||(c.dateNF="yyyymmdd");var u=Wi(r(o,c),c);return u["!cols"]=c.DBF.map(function(f){return{wch:f.len,DBF:f}}),delete c.DBF,u}function i(o,l){try{return ei(n(o,l),l)}catch(c){if(l&&l.WTF)throw c}return{SheetNames:[],Sheets:{}}}var s={B:8,C:250,L:1,D:8,"?":0,"":0};function a(o,l){var c=l||{};if(+c.codepage>=0&&As(+c.codepage),c.type=="string")throw new Error("Cannot write DBF to JS string");var u=Ct(),f=oo(o,{header:1,raw:!0,cellDates:!0}),d=f[0],h=f.slice(1),m=o["!cols"]||[],p=0,g=0,w=0,b=1;for(p=0;p<d.length;++p){if(((m[p]||{}).DBF||{}).name){d[p]=m[p].DBF.name,++w;continue}if(d[p]!=null){if(++w,typeof d[p]=="number"&&(d[p]=d[p].toString(10)),typeof d[p]!="string")throw new Error("DBF Invalid column name "+d[p]+" |"+typeof d[p]+"|");if(d.indexOf(d[p])!==p){for(g=0;g<1024;++g)if(d.indexOf(d[p]+"_"+g)==-1){d[p]+="_"+g;break}}}}var _=Me(o["!ref"]),k=[],L=[],M=[];for(p=0;p<=_.e.c-_.s.c;++p){var I="",F="",R=0,N=[];for(g=0;g<h.length;++g)h[g][p]!=null&&N.push(h[g][p]);if(N.length==0||d[p]==null){k[p]="?";continue}for(g=0;g<N.length;++g){switch(typeof N[g]){case"number":F="B";break;case"string":F="C";break;case"boolean":F="L";break;case"object":F=N[g]instanceof Date?"D":"C";break;default:F="C"}R=Math.max(R,String(N[g]).length),I=I&&I!=F?"C":F}R>250&&(R=250),F=((m[p]||{}).DBF||{}).type,F=="C"&&m[p].DBF.len>R&&(R=m[p].DBF.len),I=="B"&&F=="N"&&(I="N",M[p]=m[p].DBF.dec,R=m[p].DBF.len),L[p]=I=="C"||F=="N"?R:s[I]||0,b+=L[p],k[p]=I}var H=u.next(32);for(H.write_shift(4,318902576),H.write_shift(4,h.length),H.write_shift(2,296+32*w),H.write_shift(2,b),p=0;p<4;++p)H.write_shift(4,0);for(H.write_shift(4,0|(+e[Dm]||3)<<8),p=0,g=0;p<d.length;++p)if(d[p]!=null){var q=u.next(32),Y=(d[p].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);q.write_shift(1,Y,"sbcs"),q.write_shift(1,k[p]=="?"?"C":k[p],"sbcs"),q.write_shift(4,g),q.write_shift(1,L[p]||s[k[p]]||0),q.write_shift(1,M[p]||0),q.write_shift(1,2),q.write_shift(4,0),q.write_shift(1,0),q.write_shift(4,0),q.write_shift(4,0),g+=L[p]||s[k[p]]||0}var fe=u.next(264);for(fe.write_shift(4,13),p=0;p<65;++p)fe.write_shift(4,0);for(p=0;p<h.length;++p){var ue=u.next(b);for(ue.write_shift(1,0),g=0;g<d.length;++g)if(d[g]!=null)switch(k[g]){case"L":ue.write_shift(1,h[p][g]==null?63:h[p][g]?84:70);break;case"B":ue.write_shift(8,h[p][g]||0,"f");break;case"N":var we="0";for(typeof h[p][g]=="number"&&(we=h[p][g].toFixed(M[g]||0)),w=0;w<L[g]-we.length;++w)ue.write_shift(1,32);ue.write_shift(1,we,"sbcs");break;case"D":h[p][g]?(ue.write_shift(4,("0000"+h[p][g].getFullYear()).slice(-4),"sbcs"),ue.write_shift(2,("00"+(h[p][g].getMonth()+1)).slice(-2),"sbcs"),ue.write_shift(2,("00"+h[p][g].getDate()).slice(-2),"sbcs")):ue.write_shift(8,"00000000","sbcs");break;case"C":var xe=String(h[p][g]!=null?h[p][g]:"").slice(0,L[g]);for(ue.write_shift(1,xe,"sbcs"),w=0;w<L[g]-xe.length;++w)ue.write_shift(1,32);break}}return u.next(1).write_shift(1,26),u.end()}return{to_workbook:i,to_sheet:n,from_sheet:a}}(),QO=function(){var t={AA:"À",BA:"Á",CA:"Â",DA:195,HA:"Ä",JA:197,AE:"È",BE:"É",CE:"Ê",HE:"Ë",AI:"Ì",BI:"Í",CI:"Î",HI:"Ï",AO:"Ò",BO:"Ó",CO:"Ô",DO:213,HO:"Ö",AU:"Ù",BU:"Ú",CU:"Û",HU:"Ü",Aa:"à",Ba:"á",Ca:"â",Da:227,Ha:"ä",Ja:229,Ae:"è",Be:"é",Ce:"ê",He:"ë",Ai:"ì",Bi:"í",Ci:"î",Hi:"ï",Ao:"ò",Bo:"ó",Co:"ô",Do:245,Ho:"ö",Au:"ù",Bu:"ú",Cu:"û",Hu:"ü",KC:"Ç",Kc:"ç",q:"æ",z:"œ",a:"Æ",j:"Œ",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},e=new RegExp("\x1BN("+ut(t).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(d,h){var m=t[h];return typeof m=="number"?Oh(m):m},n=function(d,h,m){var p=h.charCodeAt(0)-32<<4|m.charCodeAt(0)-48;return p==59?d:Oh(p)};t["|"]=254;function i(d,h){switch(h.type){case"base64":return s(Br(d),h);case"binary":return s(d,h);case"buffer":return s(Se&&Buffer.isBuffer(d)?d.toString("binary"):qs(d),h);case"array":return s(Do(d),h)}throw new Error("Unrecognized type "+h.type)}function s(d,h){var m=d.split(/[\n\r]+/),p=-1,g=-1,w=0,b=0,_=[],k=[],L=null,M={},I=[],F=[],R=[],N=0,H;for(+h.codepage>=0&&As(+h.codepage);w!==m.length;++w){N=0;var q=m[w].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(e,r),Y=q.replace(/;;/g,"\0").split(";").map(function(P){return P.replace(/\u0000/g,";")}),fe=Y[0],ue;if(q.length>0)switch(fe){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":Y[1].charAt(0)=="P"&&k.push(q.slice(3).replace(/;;/g,";"));break;case"C":var we=!1,xe=!1,he=!1,Q=!1,_e=-1,Be=-1;for(b=1;b<Y.length;++b)switch(Y[b].charAt(0)){case"A":break;case"X":g=parseInt(Y[b].slice(1))-1,xe=!0;break;case"Y":for(p=parseInt(Y[b].slice(1))-1,xe||(g=0),H=_.length;H<=p;++H)_[H]=[];break;case"K":ue=Y[b].slice(1),ue.charAt(0)==='"'?ue=ue.slice(1,ue.length-1):ue==="TRUE"?ue=!0:ue==="FALSE"?ue=!1:isNaN(Fr(ue))?isNaN(Is(ue).getDate())||(ue=Et(ue)):(ue=Fr(ue),L!==null&&qm(L)&&(ue=Jm(ue))),we=!0;break;case"E":Q=!0;var O=Y4(Y[b].slice(1),{r:p,c:g});_[p][g]=[_[p][g],O];break;case"S":he=!0,_[p][g]=[_[p][g],"S5S"];break;case"G":break;case"R":_e=parseInt(Y[b].slice(1))-1;break;case"C":Be=parseInt(Y[b].slice(1))-1;break;default:if(h&&h.WTF)throw new Error("SYLK bad record "+q)}if(we&&(_[p][g]&&_[p][g].length==2?_[p][g][0]=ue:_[p][g]=ue,L=null),he){if(Q)throw new Error("SYLK shared formula cannot have own formula");var j=_e>-1&&_[_e][Be];if(!j||!j[1])throw new Error("SYLK shared formula cannot find base");_[p][g][1]=J4(j[1],{r:p-_e,c:g-Be})}break;case"F":var D=0;for(b=1;b<Y.length;++b)switch(Y[b].charAt(0)){case"X":g=parseInt(Y[b].slice(1))-1,++D;break;case"Y":for(p=parseInt(Y[b].slice(1))-1,H=_.length;H<=p;++H)_[H]=[];break;case"M":N=parseInt(Y[b].slice(1))/20;break;case"F":break;case"G":break;case"P":L=k[parseInt(Y[b].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(R=Y[b].slice(1).split(" "),H=parseInt(R[0],10);H<=parseInt(R[1],10);++H)N=parseInt(R[2],10),F[H-1]=N===0?{hidden:!0}:{wch:N},Ru(F[H-1]);break;case"C":g=parseInt(Y[b].slice(1))-1,F[g]||(F[g]={});break;case"R":p=parseInt(Y[b].slice(1))-1,I[p]||(I[p]={}),N>0?(I[p].hpt=N,I[p].hpx=jg(N)):N===0&&(I[p].hidden=!0);break;default:if(h&&h.WTF)throw new Error("SYLK bad record "+q)}D<1&&(L=null);break;default:if(h&&h.WTF)throw new Error("SYLK bad record "+q)}}return I.length>0&&(M["!rows"]=I),F.length>0&&(M["!cols"]=F),h&&h.sheetRows&&(_=_.slice(0,h.sheetRows)),[_,M]}function a(d,h){var m=i(d,h),p=m[0],g=m[1],w=Wi(p,h);return ut(g).forEach(function(b){w[b]=g[b]}),w}function o(d,h){return ei(a(d,h),h)}function l(d,h,m,p){var g="C;Y"+(m+1)+";X"+(p+1)+";K";switch(d.t){case"n":g+=d.v||0,d.f&&!d.F&&(g+=";E"+Fu(d.f,{r:m,c:p}));break;case"b":g+=d.v?"TRUE":"FALSE";break;case"e":g+=d.w||d.v;break;case"d":g+='"'+(d.w||d.v)+'"';break;case"s":g+='"'+d.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return g}function c(d,h){h.forEach(function(m,p){var g="F;W"+(p+1)+" "+(p+1)+" ";m.hidden?g+="0":(typeof m.width=="number"&&!m.wpx&&(m.wpx=no(m.width)),typeof m.wpx=="number"&&!m.wch&&(m.wch=io(m.wpx)),typeof m.wch=="number"&&(g+=Math.round(m.wch))),g.charAt(g.length-1)!=" "&&d.push(g)})}function u(d,h){h.forEach(function(m,p){var g="F;";m.hidden?g+="M0;":m.hpt?g+="M"+20*m.hpt+";":m.hpx&&(g+="M"+20*so(m.hpx)+";"),g.length>2&&d.push(g+"R"+(p+1))})}function f(d,h){var m=["ID;PWXL;N;E"],p=[],g=Me(d["!ref"]),w,b=Array.isArray(d),_=`\r
`;m.push("P;PGeneral"),m.push("F;P0;DG0G8;M255"),d["!cols"]&&c(m,d["!cols"]),d["!rows"]&&u(m,d["!rows"]),m.push("B;Y"+(g.e.r-g.s.r+1)+";X"+(g.e.c-g.s.c+1)+";D"+[g.s.c,g.s.r,g.e.c,g.e.r].join(" "));for(var k=g.s.r;k<=g.e.r;++k)for(var L=g.s.c;L<=g.e.c;++L){var M=Oe({r:k,c:L});w=b?(d[k]||[])[L]:d[M],!(!w||w.v==null&&(!w.f||w.F))&&p.push(l(w,d,k,L))}return m.join(_)+_+p.join(_)+_+"E"+_}return{to_workbook:o,to_sheet:a,from_sheet:f}}(),ZO=function(){function t(s,a){switch(a.type){case"base64":return e(Br(s),a);case"binary":return e(s,a);case"buffer":return e(Se&&Buffer.isBuffer(s)?s.toString("binary"):qs(s),a);case"array":return e(Do(s),a)}throw new Error("Unrecognized type "+a.type)}function e(s,a){for(var o=s.split(`
`),l=-1,c=-1,u=0,f=[];u!==o.length;++u){if(o[u].trim()==="BOT"){f[++l]=[],c=0;continue}if(!(l<0)){var d=o[u].trim().split(","),h=d[0],m=d[1];++u;for(var p=o[u]||"";(p.match(/["]/g)||[]).length&1&&u<o.length-1;)p+=`
`+o[++u];switch(p=p.trim(),+h){case-1:if(p==="BOT"){f[++l]=[],c=0;continue}else if(p!=="EOD")throw new Error("Unrecognized DIF special command "+p);break;case 0:p==="TRUE"?f[l][c]=!0:p==="FALSE"?f[l][c]=!1:isNaN(Fr(m))?isNaN(Is(m).getDate())?f[l][c]=m:f[l][c]=Et(m):f[l][c]=Fr(m),++c;break;case 1:p=p.slice(1,p.length-1),p=p.replace(/""/g,'"'),p&&p.match(/^=".*"$/)&&(p=p.slice(2,-1)),f[l][c++]=p!==""?p:null;break}if(p==="EOD")break}}return a&&a.sheetRows&&(f=f.slice(0,a.sheetRows)),f}function r(s,a){return Wi(t(s,a),a)}function n(s,a){return ei(r(s,a),a)}var i=function(){var s=function(l,c,u,f,d){l.push(c),l.push(u+","+f),l.push('"'+d.replace(/"/g,'""')+'"')},a=function(l,c,u,f){l.push(c+","+u),l.push(c==1?'"'+f.replace(/"/g,'""')+'"':f)};return function(l){var c=[],u=Me(l["!ref"]),f,d=Array.isArray(l);s(c,"TABLE",0,1,"sheetjs"),s(c,"VECTORS",0,u.e.r-u.s.r+1,""),s(c,"TUPLES",0,u.e.c-u.s.c+1,""),s(c,"DATA",0,0,"");for(var h=u.s.r;h<=u.e.r;++h){a(c,-1,0,"BOT");for(var m=u.s.c;m<=u.e.c;++m){var p=Oe({r:h,c:m});if(f=d?(l[h]||[])[m]:l[p],!f){a(c,1,0,"");continue}switch(f.t){case"n":var g=f.w;!g&&f.v!=null&&(g=f.v),g==null?f.f&&!f.F?a(c,1,0,"="+f.f):a(c,1,0,""):a(c,0,g,"V");break;case"b":a(c,0,f.v?1:0,f.v?"TRUE":"FALSE");break;case"s":a(c,1,0,isNaN(f.v)?f.v:'="'+f.v+'"');break;case"d":f.w||(f.w=hn(f.z||Ve[14],It(Et(f.v)))),a(c,0,f.w,"V");break;default:a(c,1,0,"")}}}a(c,-1,0,"EOD");var w=`\r
`,b=c.join(w);return b}}();return{to_workbook:n,to_sheet:r,from_sheet:i}}(),Ng=function(){function t(f){return f.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function e(f){return f.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(f,d){for(var h=f.split(`
`),m=-1,p=-1,g=0,w=[];g!==h.length;++g){var b=h[g].trim().split(":");if(b[0]==="cell"){var _=et(b[1]);if(w.length<=_.r)for(m=w.length;m<=_.r;++m)w[m]||(w[m]=[]);switch(m=_.r,p=_.c,b[2]){case"t":w[m][p]=t(b[3]);break;case"v":w[m][p]=+b[3];break;case"vtf":var k=b[b.length-1];case"vtc":switch(b[3]){case"nl":w[m][p]=!!+b[4];break;default:w[m][p]=+b[4];break}b[2]=="vtf"&&(w[m][p]=[w[m][p],k])}}}return d&&d.sheetRows&&(w=w.slice(0,d.sheetRows)),w}function n(f,d){return Wi(r(f,d),d)}function i(f,d){return ei(n(f,d),d)}var s=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),a=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,o=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),l="--SocialCalcSpreadsheetControlSave--";function c(f){if(!f||!f["!ref"])return"";for(var d=[],h=[],m,p="",g=Mt(f["!ref"]),w=Array.isArray(f),b=g.s.r;b<=g.e.r;++b)for(var _=g.s.c;_<=g.e.c;++_)if(p=Oe({r:b,c:_}),m=w?(f[b]||[])[_]:f[p],!(!m||m.v==null||m.t==="z")){switch(h=["cell",p,"t"],m.t){case"s":case"str":h.push(e(m.v));break;case"n":m.f?(h[2]="vtf",h[3]="n",h[4]=m.v,h[5]=e(m.f)):(h[2]="v",h[3]=m.v);break;case"b":h[2]="vt"+(m.f?"f":"c"),h[3]="nl",h[4]=m.v?"1":"0",h[5]=e(m.f||(m.v?"TRUE":"FALSE"));break;case"d":var k=It(Et(m.v));h[2]="vtc",h[3]="nd",h[4]=""+k,h[5]=m.w||hn(m.z||Ve[14],k);break;case"e":continue}d.push(h.join(":"))}return d.push("sheet:c:"+(g.e.c-g.s.c+1)+":r:"+(g.e.r-g.s.r+1)+":tvf:1"),d.push("valueformat:1:text-wiki"),d.join(`
`)}function u(f){return[s,a,o,a,c(f),l].join(`
`)}return{to_workbook:i,to_sheet:n,from_sheet:u}}(),e4=function(){function t(u,f,d,h,m){m.raw?f[d][h]=u:u===""||(u==="TRUE"?f[d][h]=!0:u==="FALSE"?f[d][h]=!1:isNaN(Fr(u))?isNaN(Is(u).getDate())?f[d][h]=u:f[d][h]=Et(u):f[d][h]=Fr(u))}function e(u,f){var d=f||{},h=[];if(!u||u.length===0)return h;for(var m=u.split(/[\r\n]/),p=m.length-1;p>=0&&m[p].length===0;)--p;for(var g=10,w=0,b=0;b<=p;++b)w=m[b].indexOf(" "),w==-1?w=m[b].length:w++,g=Math.max(g,w);for(b=0;b<=p;++b){h[b]=[];var _=0;for(t(m[b].slice(0,g).trim(),h,b,_,d),_=1;_<=(m[b].length-g)/10+1;++_)t(m[b].slice(g+(_-1)*10,g+_*10).trim(),h,b,_,d)}return d.sheetRows&&(h=h.slice(0,d.sheetRows)),h}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function i(u){for(var f={},d=!1,h=0,m=0;h<u.length;++h)(m=u.charCodeAt(h))==34?d=!d:!d&&m in r&&(f[m]=(f[m]||0)+1);m=[];for(h in f)Object.prototype.hasOwnProperty.call(f,h)&&m.push([f[h],h]);if(!m.length){f=n;for(h in f)Object.prototype.hasOwnProperty.call(f,h)&&m.push([f[h],h])}return m.sort(function(p,g){return p[0]-g[0]||n[p[1]]-n[g[1]]}),r[m.pop()[1]]||44}function s(u,f){var d=f||{},h="",m=d.dense?[]:{},p={s:{c:0,r:0},e:{c:0,r:0}};u.slice(0,4)=="sep="?u.charCodeAt(5)==13&&u.charCodeAt(6)==10?(h=u.charAt(4),u=u.slice(7)):u.charCodeAt(5)==13||u.charCodeAt(5)==10?(h=u.charAt(4),u=u.slice(6)):h=i(u.slice(0,1024)):d&&d.FS?h=d.FS:h=i(u.slice(0,1024));var g=0,w=0,b=0,_=0,k=0,L=h.charCodeAt(0),M=!1,I=0,F=u.charCodeAt(0);u=u.replace(/\r\n/mg,`
`);var R=d.dateNF!=null?gk(d.dateNF):null;function N(){var H=u.slice(_,k),q={};if(H.charAt(0)=='"'&&H.charAt(H.length-1)=='"'&&(H=H.slice(1,-1).replace(/""/g,'"')),H.length===0)q.t="z";else if(d.raw)q.t="s",q.v=H;else if(H.trim().length===0)q.t="s",q.v=H;else if(H.charCodeAt(0)==61)H.charCodeAt(1)==34&&H.charCodeAt(H.length-1)==34?(q.t="s",q.v=H.slice(2,-1).replace(/""/g,'"')):Q4(H)?(q.t="n",q.f=H.slice(1)):(q.t="s",q.v=H);else if(H=="TRUE")q.t="b",q.v=!0;else if(H=="FALSE")q.t="b",q.v=!1;else if(!isNaN(b=Fr(H)))q.t="n",d.cellText!==!1&&(q.w=H),q.v=b;else if(!isNaN(Is(H).getDate())||R&&H.match(R)){q.z=d.dateNF||Ve[14];var Y=0;R&&H.match(R)&&(H=vk(H,d.dateNF,H.match(R)||[]),Y=1),d.cellDates?(q.t="d",q.v=Et(H,Y)):(q.t="n",q.v=It(Et(H,Y))),d.cellText!==!1&&(q.w=hn(q.z,q.v instanceof Date?It(q.v):q.v)),d.cellNF||delete q.z}else q.t="s",q.v=H;if(q.t=="z"||(d.dense?(m[g]||(m[g]=[]),m[g][w]=q):m[Oe({c:w,r:g})]=q),_=k+1,F=u.charCodeAt(_),p.e.c<w&&(p.e.c=w),p.e.r<g&&(p.e.r=g),I==L)++w;else if(w=0,++g,d.sheetRows&&d.sheetRows<=g)return!0}e:for(;k<u.length;++k)switch(I=u.charCodeAt(k)){case 34:F===34&&(M=!M);break;case L:case 10:case 13:if(!M&&N())break e;break}return k-_>0&&N(),m["!ref"]=Ke(p),m}function a(u,f){return!(f&&f.PRN)||f.FS||u.slice(0,4)=="sep="||u.indexOf("	")>=0||u.indexOf(",")>=0||u.indexOf(";")>=0?s(u,f):Wi(e(u,f),f)}function o(u,f){var d="",h=f.type=="string"?[0,0,0,0]:hN(u,f);switch(f.type){case"base64":d=Br(u);break;case"binary":d=u;break;case"buffer":f.codepage==65001?d=u.toString("utf8"):f.codepage&&typeof On<"u"?d=On.utils.decode(f.codepage,u):d=Se&&Buffer.isBuffer(u)?u.toString("binary"):qs(u);break;case"array":d=Do(u);break;case"string":d=u;break;default:throw new Error("Unrecognized type "+f.type)}return h[0]==239&&h[1]==187&&h[2]==191?d=ds(d.slice(3)):f.type!="string"&&f.type!="buffer"&&f.codepage==65001?d=ds(d):f.type=="binary"&&typeof On<"u"&&f.codepage&&(d=On.utils.decode(f.codepage,On.utils.encode(28591,d))),d.slice(0,19)=="socialcalc:version:"?Ng.to_sheet(f.type=="string"?d:ds(d),f):a(d,f)}function l(u,f){return ei(o(u,f),f)}function c(u){for(var f=[],d=Me(u["!ref"]),h,m=Array.isArray(u),p=d.s.r;p<=d.e.r;++p){for(var g=[],w=d.s.c;w<=d.e.c;++w){var b=Oe({r:p,c:w});if(h=m?(u[p]||[])[w]:u[b],!h||h.v==null){g.push("          ");continue}for(var _=(h.w||(Ur(h),h.w)||"").slice(0,10);_.length<10;)_+=" ";g.push(_+(w===0?" ":""))}f.push(g.join(""))}return f.join(`
`)}return{to_workbook:l,to_sheet:o,from_sheet:c}}(),o0=function(){function t(O,j,D){if(O){Pt(O,O.l||0);for(var P=D.Enum||_e;O.l<O.length;){var X=O.read_shift(2),oe=P[X]||P[65535],ce=O.read_shift(2),se=O.l+ce,ne=oe.f&&oe.f(O,ce,D);if(O.l=se,j(ne,oe,X))return}}}function e(O,j){switch(j.type){case"base64":return r(Jt(Br(O)),j);case"binary":return r(Jt(O),j);case"buffer":case"array":return r(O,j)}throw"Unsupported type "+j.type}function r(O,j){if(!O)return O;var D=j||{},P=D.dense?[]:{},X="Sheet1",oe="",ce=0,se={},ne=[],Fe=[],be={s:{r:0,c:0},e:{r:0,c:0}},vt=D.sheetRows||0;if(O[2]==0&&(O[3]==8||O[3]==9)&&O.length>=16&&O[14]==5&&O[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(O[2]==2)D.Enum=_e,t(O,function(le,jt,yr){switch(yr){case 0:D.vers=le,le>=4096&&(D.qpro=!0);break;case 6:be=le;break;case 204:le&&(oe=le);break;case 222:oe=le;break;case 15:case 51:D.qpro||(le[1].v=le[1].v.slice(1));case 13:case 14:case 16:yr==14&&(le[2]&112)==112&&(le[2]&15)>1&&(le[2]&15)<15&&(le[1].z=D.dateNF||Ve[14],D.cellDates&&(le[1].t="d",le[1].v=Jm(le[1].v))),D.qpro&&le[3]>ce&&(P["!ref"]=Ke(be),se[X]=P,ne.push(X),P=D.dense?[]:{},be={s:{r:0,c:0},e:{r:0,c:0}},ce=le[3],X=oe||"Sheet"+(ce+1),oe="");var _n=D.dense?(P[le[0].r]||[])[le[0].c]:P[Oe(le[0])];if(_n){_n.t=le[1].t,_n.v=le[1].v,le[1].z!=null&&(_n.z=le[1].z),le[1].f!=null&&(_n.f=le[1].f);break}D.dense?(P[le[0].r]||(P[le[0].r]=[]),P[le[0].r][le[0].c]=le[1]):P[Oe(le[0])]=le[1];break}},D);else if(O[2]==26||O[2]==14)D.Enum=Be,O[2]==14&&(D.qpro=!0,O.l=0),t(O,function(le,jt,yr){switch(yr){case 204:X=le;break;case 22:le[1].v=le[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(le[3]>ce&&(P["!ref"]=Ke(be),se[X]=P,ne.push(X),P=D.dense?[]:{},be={s:{r:0,c:0},e:{r:0,c:0}},ce=le[3],X="Sheet"+(ce+1)),vt>0&&le[0].r>=vt)break;D.dense?(P[le[0].r]||(P[le[0].r]=[]),P[le[0].r][le[0].c]=le[1]):P[Oe(le[0])]=le[1],be.e.c<le[0].c&&(be.e.c=le[0].c),be.e.r<le[0].r&&(be.e.r=le[0].r);break;case 27:le[14e3]&&(Fe[le[14e3][0]]=le[14e3][1]);break;case 1537:Fe[le[0]]=le[1],le[0]==ce&&(X=le[1]);break}},D);else throw new Error("Unrecognized LOTUS BOF "+O[2]);if(P["!ref"]=Ke(be),se[oe||X]=P,ne.push(oe||X),!Fe.length)return{SheetNames:ne,Sheets:se};for(var Ae={},xr=[],Ue=0;Ue<Fe.length;++Ue)se[ne[Ue]]?(xr.push(Fe[Ue]||ne[Ue]),Ae[Fe[Ue]]=se[Fe[Ue]]||se[ne[Ue]]):(xr.push(Fe[Ue]),Ae[Fe[Ue]]={"!ref":"A1"});return{SheetNames:xr,Sheets:Ae}}function n(O,j){var D=j||{};if(+D.codepage>=0&&As(+D.codepage),D.type=="string")throw new Error("Cannot write WK1 to JS string");var P=Ct(),X=Me(O["!ref"]),oe=Array.isArray(O),ce=[];te(P,0,s(1030)),te(P,6,l(X));for(var se=Math.min(X.e.r,8191),ne=X.s.r;ne<=se;++ne)for(var Fe=ct(ne),be=X.s.c;be<=X.e.c;++be){ne===X.s.r&&(ce[be]=mt(be));var vt=ce[be]+Fe,Ae=oe?(O[ne]||[])[be]:O[vt];if(!(!Ae||Ae.t=="z"))if(Ae.t=="n")(Ae.v|0)==Ae.v&&Ae.v>=-32768&&Ae.v<=32767?te(P,13,h(ne,be,Ae.v)):te(P,14,p(ne,be,Ae.v));else{var xr=Ur(Ae);te(P,15,f(ne,be,xr.slice(0,239)))}}return te(P,1),P.end()}function i(O,j){var D=j||{};if(+D.codepage>=0&&As(+D.codepage),D.type=="string")throw new Error("Cannot write WK3 to JS string");var P=Ct();te(P,0,a(O));for(var X=0,oe=0;X<O.SheetNames.length;++X)(O.Sheets[O.SheetNames[X]]||{})["!ref"]&&te(P,27,Q(O.SheetNames[X],oe++));var ce=0;for(X=0;X<O.SheetNames.length;++X){var se=O.Sheets[O.SheetNames[X]];if(!(!se||!se["!ref"])){for(var ne=Me(se["!ref"]),Fe=Array.isArray(se),be=[],vt=Math.min(ne.e.r,8191),Ae=ne.s.r;Ae<=vt;++Ae)for(var xr=ct(Ae),Ue=ne.s.c;Ue<=ne.e.c;++Ue){Ae===ne.s.r&&(be[Ue]=mt(Ue));var le=be[Ue]+xr,jt=Fe?(se[Ae]||[])[Ue]:se[le];if(!(!jt||jt.t=="z"))if(jt.t=="n")te(P,23,N(Ae,Ue,ce,jt.v));else{var yr=Ur(jt);te(P,22,I(Ae,Ue,ce,yr.slice(0,239)))}}++ce}}return te(P,1),P.end()}function s(O){var j=G(2);return j.write_shift(2,O),j}function a(O){var j=G(26);j.write_shift(2,4096),j.write_shift(2,4),j.write_shift(4,0);for(var D=0,P=0,X=0,oe=0;oe<O.SheetNames.length;++oe){var ce=O.SheetNames[oe],se=O.Sheets[ce];if(!(!se||!se["!ref"])){++X;var ne=Mt(se["!ref"]);D<ne.e.r&&(D=ne.e.r),P<ne.e.c&&(P=ne.e.c)}}return D>8191&&(D=8191),j.write_shift(2,D),j.write_shift(1,X),j.write_shift(1,P),j.write_shift(2,0),j.write_shift(2,0),j.write_shift(1,1),j.write_shift(1,2),j.write_shift(4,0),j.write_shift(4,0),j}function o(O,j,D){var P={s:{c:0,r:0},e:{c:0,r:0}};return j==8&&D.qpro?(P.s.c=O.read_shift(1),O.l++,P.s.r=O.read_shift(2),P.e.c=O.read_shift(1),O.l++,P.e.r=O.read_shift(2),P):(P.s.c=O.read_shift(2),P.s.r=O.read_shift(2),j==12&&D.qpro&&(O.l+=2),P.e.c=O.read_shift(2),P.e.r=O.read_shift(2),j==12&&D.qpro&&(O.l+=2),P.s.c==65535&&(P.s.c=P.e.c=P.s.r=P.e.r=0),P)}function l(O){var j=G(8);return j.write_shift(2,O.s.c),j.write_shift(2,O.s.r),j.write_shift(2,O.e.c),j.write_shift(2,O.e.r),j}function c(O,j,D){var P=[{c:0,r:0},{t:"n",v:0},0,0];return D.qpro&&D.vers!=20768?(P[0].c=O.read_shift(1),P[3]=O.read_shift(1),P[0].r=O.read_shift(2),O.l+=2):(P[2]=O.read_shift(1),P[0].c=O.read_shift(2),P[0].r=O.read_shift(2)),P}function u(O,j,D){var P=O.l+j,X=c(O,j,D);if(X[1].t="s",D.vers==20768){O.l++;var oe=O.read_shift(1);return X[1].v=O.read_shift(oe,"utf8"),X}return D.qpro&&O.l++,X[1].v=O.read_shift(P-O.l,"cstr"),X}function f(O,j,D){var P=G(7+D.length);P.write_shift(1,255),P.write_shift(2,j),P.write_shift(2,O),P.write_shift(1,39);for(var X=0;X<P.length;++X){var oe=D.charCodeAt(X);P.write_shift(1,oe>=128?95:oe)}return P.write_shift(1,0),P}function d(O,j,D){var P=c(O,j,D);return P[1].v=O.read_shift(2,"i"),P}function h(O,j,D){var P=G(7);return P.write_shift(1,255),P.write_shift(2,j),P.write_shift(2,O),P.write_shift(2,D,"i"),P}function m(O,j,D){var P=c(O,j,D);return P[1].v=O.read_shift(8,"f"),P}function p(O,j,D){var P=G(13);return P.write_shift(1,255),P.write_shift(2,j),P.write_shift(2,O),P.write_shift(8,D,"f"),P}function g(O,j,D){var P=O.l+j,X=c(O,j,D);if(X[1].v=O.read_shift(8,"f"),D.qpro)O.l=P;else{var oe=O.read_shift(2);k(O.slice(O.l,O.l+oe),X),O.l+=oe}return X}function w(O,j,D){var P=j&32768;return j&=-32769,j=(P?O:0)+(j>=8192?j-16384:j),(P?"":"$")+(D?mt(j):ct(j))}var b={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},_=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function k(O,j){Pt(O,0);for(var D=[],P=0,X="",oe="",ce="",se="";O.l<O.length;){var ne=O[O.l++];switch(ne){case 0:D.push(O.read_shift(8,"f"));break;case 1:oe=w(j[0].c,O.read_shift(2),!0),X=w(j[0].r,O.read_shift(2),!1),D.push(oe+X);break;case 2:{var Fe=w(j[0].c,O.read_shift(2),!0),be=w(j[0].r,O.read_shift(2),!1);oe=w(j[0].c,O.read_shift(2),!0),X=w(j[0].r,O.read_shift(2),!1),D.push(Fe+be+":"+oe+X)}break;case 3:if(O.l<O.length){console.error("WK1 premature formula end");return}break;case 4:D.push("("+D.pop()+")");break;case 5:D.push(O.read_shift(2));break;case 6:{for(var vt="";ne=O[O.l++];)vt+=String.fromCharCode(ne);D.push('"'+vt.replace(/"/g,'""')+'"')}break;case 8:D.push("-"+D.pop());break;case 23:D.push("+"+D.pop());break;case 22:D.push("NOT("+D.pop()+")");break;case 20:case 21:se=D.pop(),ce=D.pop(),D.push(["AND","OR"][ne-20]+"("+ce+","+se+")");break;default:if(ne<32&&_[ne])se=D.pop(),ce=D.pop(),D.push(ce+_[ne]+se);else if(b[ne]){if(P=b[ne][1],P==69&&(P=O[O.l++]),P>D.length){console.error("WK1 bad formula parse 0x"+ne.toString(16)+":|"+D.join("|")+"|");return}var Ae=D.slice(-P);D.length-=P,D.push(b[ne][0]+"("+Ae.join(",")+")")}else return ne<=7?console.error("WK1 invalid opcode "+ne.toString(16)):ne<=24?console.error("WK1 unsupported op "+ne.toString(16)):ne<=30?console.error("WK1 invalid opcode "+ne.toString(16)):ne<=115?console.error("WK1 unsupported function opcode "+ne.toString(16)):console.error("WK1 unrecognized opcode "+ne.toString(16))}}D.length==1?j[1].f=""+D[0]:console.error("WK1 bad formula parse |"+D.join("|")+"|")}function L(O){var j=[{c:0,r:0},{t:"n",v:0},0];return j[0].r=O.read_shift(2),j[3]=O[O.l++],j[0].c=O[O.l++],j}function M(O,j){var D=L(O);return D[1].t="s",D[1].v=O.read_shift(j-4,"cstr"),D}function I(O,j,D,P){var X=G(6+P.length);X.write_shift(2,O),X.write_shift(1,D),X.write_shift(1,j),X.write_shift(1,39);for(var oe=0;oe<P.length;++oe){var ce=P.charCodeAt(oe);X.write_shift(1,ce>=128?95:ce)}return X.write_shift(1,0),X}function F(O,j){var D=L(O);D[1].v=O.read_shift(2);var P=D[1].v>>1;if(D[1].v&1)switch(P&7){case 0:P=(P>>3)*5e3;break;case 1:P=(P>>3)*500;break;case 2:P=(P>>3)/20;break;case 3:P=(P>>3)/200;break;case 4:P=(P>>3)/2e3;break;case 5:P=(P>>3)/2e4;break;case 6:P=(P>>3)/16;break;case 7:P=(P>>3)/64;break}return D[1].v=P,D}function R(O,j){var D=L(O),P=O.read_shift(4),X=O.read_shift(4),oe=O.read_shift(2);if(oe==65535)return P===0&&X===3221225472?(D[1].t="e",D[1].v=15):P===0&&X===3489660928?(D[1].t="e",D[1].v=42):D[1].v=0,D;var ce=oe&32768;return oe=(oe&32767)-16446,D[1].v=(1-ce*2)*(X*Math.pow(2,oe+32)+P*Math.pow(2,oe)),D}function N(O,j,D,P){var X=G(14);if(X.write_shift(2,O),X.write_shift(1,D),X.write_shift(1,j),P==0)return X.write_shift(4,0),X.write_shift(4,0),X.write_shift(2,65535),X;var oe=0,ce=0,se=0,ne=0;return P<0&&(oe=1,P=-P),ce=Math.log2(P)|0,P/=Math.pow(2,ce-31),ne=P>>>0,ne&2147483648||(P/=2,++ce,ne=P>>>0),P-=ne,ne|=2147483648,ne>>>=0,P*=Math.pow(2,32),se=P>>>0,X.write_shift(4,se),X.write_shift(4,ne),ce+=16383+(oe?32768:0),X.write_shift(2,ce),X}function H(O,j){var D=R(O);return O.l+=j-14,D}function q(O,j){var D=L(O),P=O.read_shift(4);return D[1].v=P>>6,D}function Y(O,j){var D=L(O),P=O.read_shift(8,"f");return D[1].v=P,D}function fe(O,j){var D=Y(O);return O.l+=j-10,D}function ue(O,j){return O[O.l+j-1]==0?O.read_shift(j,"cstr"):""}function we(O,j){var D=O[O.l++];D>j-1&&(D=j-1);for(var P="";P.length<D;)P+=String.fromCharCode(O[O.l++]);return P}function xe(O,j,D){if(!(!D.qpro||j<21)){var P=O.read_shift(1);O.l+=17,O.l+=1,O.l+=2;var X=O.read_shift(j-21,"cstr");return[P,X]}}function he(O,j){for(var D={},P=O.l+j;O.l<P;){var X=O.read_shift(2);if(X==14e3){for(D[X]=[0,""],D[X][0]=O.read_shift(2);O[O.l];)D[X][1]+=String.fromCharCode(O[O.l]),O.l++;O.l++}}return D}function Q(O,j){var D=G(5+O.length);D.write_shift(2,14e3),D.write_shift(2,j);for(var P=0;P<O.length;++P){var X=O.charCodeAt(P);D[D.l++]=X>127?95:X}return D[D.l++]=0,D}var _e={0:{n:"BOF",f:kg},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:o},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:d},14:{n:"NUMBER",f:m},15:{n:"LABEL",f:u},16:{n:"FORMULA",f:g},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:u},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:ue},222:{n:"SHEETNAMELP",f:we},65535:{n:""}},Be={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:M},23:{n:"NUMBER17",f:R},24:{n:"NUMBER18",f:F},25:{n:"FORMULA19",f:H},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:he},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:q},38:{n:"??"},39:{n:"NUMBER27",f:Y},40:{n:"FORMULA28",f:fe},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:ue},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:xe},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:i,to_workbook:e}}(),t4=/^\s|\s$|[\t\n\r]/;function Dg(t,e){if(!e.bookSST)return"";var r=[Xe];r[r.length]=ee("sst",null,{xmlns:Hi[0],count:t.Count,uniqueCount:t.Unique});for(var n=0;n!=t.length;++n)if(t[n]!=null){var i=t[n],s="<si>";i.r?s+=i.r:(s+="<t",i.t||(i.t=""),i.t.match(t4)&&(s+=' xml:space="preserve"'),s+=">"+ke(i.t)+"</t>"),s+="</si>",r[r.length]=s}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function r4(t){return[t.read_shift(4),t.read_shift(4)]}function n4(t,e){return e||(e=G(8)),e.write_shift(4,t.Count),e.write_shift(4,t.Unique),e}var i4=Kk;function s4(t){var e=Ct();K(e,159,n4(t));for(var r=0;r<t.length;++r)K(e,19,i4(t[r]));return K(e,160),e.end()}function a4(t){for(var e=[],r=t.split(""),n=0;n<r.length;++n)e[n]=r[n].charCodeAt(0);return e}function Lg(t){var e=0,r,n=a4(t),i=n.length+1,s,a,o,l,c;for(r=Kn(i),r[0]=n.length,s=1;s!=i;++s)r[s]=n[s-1];for(s=i-1;s>=0;--s)a=r[s],o=e&16384?1:0,l=e<<1&32767,c=o|l,e=c^a;return e^52811}var o4=function(){function t(i,s){switch(s.type){case"base64":return e(Br(i),s);case"binary":return e(i,s);case"buffer":return e(Se&&Buffer.isBuffer(i)?i.toString("binary"):qs(i),s);case"array":return e(Do(i),s)}throw new Error("Unrecognized type "+s.type)}function e(i,s){var a=s||{},o=a.dense?[]:{},l=i.match(/\\trowd.*?\\row\b/g);if(!l.length)throw new Error("RTF missing table");var c={s:{c:0,r:0},e:{c:0,r:l.length-1}};return l.forEach(function(u,f){Array.isArray(o)&&(o[f]=[]);for(var d=/\\\w+\b/g,h=0,m,p=-1;m=d.exec(u);){switch(m[0]){case"\\cell":var g=u.slice(h,d.lastIndex-m[0].length);if(g[0]==" "&&(g=g.slice(1)),++p,g.length){var w={v:g,t:"s"};Array.isArray(o)?o[f][p]=w:o[Oe({r:f,c:p})]=w}break}h=d.lastIndex}p>c.e.c&&(c.e.c=p)}),o["!ref"]=Ke(c),o}function r(i,s){return ei(t(i,s),s)}function n(i){for(var s=["{\\rtf1\\ansi"],a=Me(i["!ref"]),o,l=Array.isArray(i),c=a.s.r;c<=a.e.r;++c){s.push("\\trowd\\trautofit1");for(var u=a.s.c;u<=a.e.c;++u)s.push("\\cellx"+(u+1));for(s.push("\\pard\\intbl"),u=a.s.c;u<=a.e.c;++u){var f=Oe({r:c,c:u});o=l?(i[c]||[])[u]:i[f],!(!o||o.v==null&&(!o.f||o.F))&&(s.push(" "+(o.w||(Ur(o),o.w))),s.push("\\cell"))}s.push("\\pard\\intbl\\row")}return s.join("")+"}"}return{to_workbook:r,to_sheet:t,from_sheet:n}}();function l0(t){for(var e=0,r=1;e!=3;++e)r=r*256+(t[e]>255?255:t[e]<0?0:t[e]);return r.toString(16).toUpperCase().slice(1)}var l4=6,Nr=l4;function no(t){return Math.floor((t+Math.round(128/Nr)/256)*Nr)}function io(t){return Math.floor((t-5)/Nr*100+.5)/100}function gc(t){return Math.round((t*Nr+5)/Nr*256)/256}function Ru(t){t.width?(t.wpx=no(t.width),t.wch=io(t.wpx),t.MDW=Nr):t.wpx?(t.wch=io(t.wpx),t.width=gc(t.wch),t.MDW=Nr):typeof t.wch=="number"&&(t.width=gc(t.wch),t.wpx=no(t.width),t.MDW=Nr),t.customWidth&&delete t.customWidth}var c4=96,Mg=c4;function so(t){return t*96/Mg}function jg(t){return t*Mg/96}function u4(t){var e=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var n=r[0];n<=r[1];++n)t[n]!=null&&(e[e.length]=ee("numFmt",null,{numFmtId:n,formatCode:ke(t[n])}))}),e.length===1?"":(e[e.length]="</numFmts>",e[0]=ee("numFmts",null,{count:e.length-2}).replace("/>",">"),e.join(""))}function f4(t){var e=[];return e[e.length]=ee("cellXfs",null),t.forEach(function(r){e[e.length]=ee("xf",null,r)}),e[e.length]="</cellXfs>",e.length===2?"":(e[0]=ee("cellXfs",null,{count:e.length-2}).replace("/>",">"),e.join(""))}function $g(t,e){var r=[Xe,ee("styleSheet",null,{xmlns:Hi[0],"xmlns:vt":Ze.vt})],n;return t.SSF&&(n=u4(t.SSF))!=null&&(r[r.length]=n),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=f4(e.cellXfs))&&(r[r.length]=n),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function h4(t,e){var r=t.read_shift(2),n=gt(t);return[r,n]}function d4(t,e,r){r||(r=G(6+4*e.length)),r.write_shift(2,t),tt(e,r);var n=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),n}function p4(t,e,r){var n={};n.sz=t.read_shift(2)/20;var i=tO(t);i.fItalic&&(n.italic=1),i.fCondense&&(n.condense=1),i.fExtend&&(n.extend=1),i.fShadow&&(n.shadow=1),i.fOutline&&(n.outline=1),i.fStrikeout&&(n.strike=1);var s=t.read_shift(2);switch(s===700&&(n.bold=1),t.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var a=t.read_shift(1);a!=0&&(n.underline=a);var o=t.read_shift(1);o>0&&(n.family=o);var l=t.read_shift(1);switch(l>0&&(n.charset=l),t.l++,n.color=eO(t),t.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=gt(t),n}function m4(t,e){e||(e=G(25+4*32)),e.write_shift(2,t.sz*20),rO(t,e),e.write_shift(2,t.bold?700:400);var r=0;t.vertAlign=="superscript"?r=1:t.vertAlign=="subscript"&&(r=2),e.write_shift(2,r),e.write_shift(1,t.underline||0),e.write_shift(1,t.family||0),e.write_shift(1,t.charset||0),e.write_shift(1,0),to(t.color,e);var n=0;return t.scheme=="major"&&(n=1),t.scheme=="minor"&&(n=2),e.write_shift(1,n),tt(t.name,e),e.length>e.l?e.slice(0,e.l):e}var g4=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],El,v4=mr;function c0(t,e){e||(e=G(4*3+8*7+16*1)),El||(El=yu(g4));var r=El[t.patternType];r==null&&(r=40),e.write_shift(4,r);var n=0;if(r!=40)for(to({auto:1},e),to({auto:1},e);n<12;++n)e.write_shift(4,0);else{for(;n<4;++n)e.write_shift(4,0);for(;n<12;++n)e.write_shift(4,0)}return e.length>e.l?e.slice(0,e.l):e}function x4(t,e){var r=t.l+e,n=t.read_shift(2),i=t.read_shift(2);return t.l=r,{ixfe:n,numFmtId:i}}function Bg(t,e,r){r||(r=G(16)),r.write_shift(2,e||0),r.write_shift(2,t.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var n=0;return r.write_shift(1,n),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function Qi(t,e){return e||(e=G(10)),e.write_shift(1,0),e.write_shift(1,0),e.write_shift(4,0),e.write_shift(4,0),e}var y4=mr;function w4(t,e){return e||(e=G(51)),e.write_shift(1,0),Qi(null,e),Qi(null,e),Qi(null,e),Qi(null,e),Qi(null,e),e.length>e.l?e.slice(0,e.l):e}function _4(t,e){return e||(e=G(12+4*10)),e.write_shift(4,t.xfId),e.write_shift(2,1),e.write_shift(1,+t.builtinId),e.write_shift(1,0),eo(t.name||"",e),e.length>e.l?e.slice(0,e.l):e}function E4(t,e,r){var n=G(2052);return n.write_shift(4,t),eo(e,n),eo(r,n),n.length>n.l?n.slice(0,n.l):n}function b4(t,e){if(e){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)e[i]!=null&&++r}),r!=0&&(K(t,615,tr(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)e[i]!=null&&K(t,44,d4(i,e[i]))}),K(t,616))}}function T4(t){var e=1;K(t,611,tr(e)),K(t,43,m4({sz:12,color:{theme:1},name:"Calibri",family:2,scheme:"minor"})),K(t,612)}function S4(t){var e=2;K(t,603,tr(e)),K(t,45,c0({patternType:"none"})),K(t,45,c0({patternType:"gray125"})),K(t,604)}function A4(t){var e=1;K(t,613,tr(e)),K(t,46,w4()),K(t,614)}function C4(t){var e=1;K(t,626,tr(e)),K(t,47,Bg({numFmtId:0,fontId:0,fillId:0,borderId:0},65535)),K(t,627)}function I4(t,e){K(t,617,tr(e.length)),e.forEach(function(r){K(t,47,Bg(r,0))}),K(t,618)}function k4(t){var e=1;K(t,619,tr(e)),K(t,48,_4({xfId:0,builtinId:0,name:"Normal"})),K(t,620)}function O4(t){var e=0;K(t,505,tr(e)),K(t,506)}function R4(t){var e=0;K(t,508,E4(e,"TableStyleMedium9","PivotStyleMedium4")),K(t,509)}function P4(t,e){var r=Ct();return K(r,278),b4(r,t.SSF),T4(r),S4(r),A4(r),C4(r),I4(r,e.cellXfs),k4(r),O4(r),R4(r),K(r,279),r.end()}function Ug(t,e){if(e&&e.themeXLSX)return e.themeXLSX;if(t&&typeof t.raw=="string")return t.raw;var r=[Xe];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',r[r.length]='<a:font script="Hang" typeface="맑은 고딕"/>',r[r.length]='<a:font script="Hans" typeface="宋体"/>',r[r.length]='<a:font script="Hant" typeface="新細明體"/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',r[r.length]='<a:font script="Hang" typeface="맑은 고딕"/>',r[r.length]='<a:font script="Hans" typeface="宋体"/>',r[r.length]='<a:font script="Hant" typeface="新細明體"/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function F4(t,e){return{flags:t.read_shift(4),version:t.read_shift(4),name:gt(t)}}function N4(t){var e=G(12+2*t.name.length);return e.write_shift(4,t.flags),e.write_shift(4,t.version),tt(t.name,e),e.slice(0,e.l)}function D4(t){for(var e=[],r=t.read_shift(4);r-- >0;)e.push([t.read_shift(4),t.read_shift(4)]);return e}function L4(t){var e=G(4+8*t.length);e.write_shift(4,t.length);for(var r=0;r<t.length;++r)e.write_shift(4,t[r][0]),e.write_shift(4,t[r][1]);return e}function M4(t,e){var r=G(8+2*e.length);return r.write_shift(4,t),tt(e,r),r.slice(0,r.l)}function j4(t){return t.l+=4,t.read_shift(4)!=0}function $4(t,e){var r=G(8);return r.write_shift(4,t),r.write_shift(4,e?1:0),r}function B4(){var t=Ct();return K(t,332),K(t,334,tr(1)),K(t,335,N4({name:"XLDAPR",version:12e4,flags:3496657072})),K(t,336),K(t,339,M4(1,"XLDAPR")),K(t,52),K(t,35,tr(514)),K(t,4096,tr(0)),K(t,4097,Ht(1)),K(t,36),K(t,53),K(t,340),K(t,337,$4(1,!0)),K(t,51,L4([[1,0]])),K(t,338),K(t,333),t.end()}function Hg(){var t=[Xe];return t.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),t.join("")}function U4(t){var e={};e.i=t.read_shift(4);var r={};r.r=t.read_shift(4),r.c=t.read_shift(4),e.r=Oe(r);var n=t.read_shift(1);return n&2&&(e.l="1"),n&8&&(e.a="1"),e}var yi=1024;function Wg(t,e){for(var r=[21600,21600],n=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),i=[ee("xml",null,{"xmlns:v":Ft.v,"xmlns:o":Ft.o,"xmlns:x":Ft.x,"xmlns:mv":Ft.mv}).replace(/\/>/,">"),ee("o:shapelayout",ee("o:idmap",null,{"v:ext":"edit",data:t}),{"v:ext":"edit"}),ee("v:shapetype",[ee("v:stroke",null,{joinstyle:"miter"}),ee("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:n})];yi<t*1e3;)yi+=1e3;return e.forEach(function(s){var a=et(s[0]),o={color2:"#BEFF82",type:"gradient"};o.type=="gradient"&&(o.angle="-180");var l=o.type=="gradient"?ee("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,c=ee("v:fill",l,o),u={on:"t",obscured:"t"};++yi,i=i.concat(["<v:shape"+ks({id:"_x0000_s"+yi,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(s[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",c,ee("v:shadow",null,u),ee("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",lt("x:Anchor",[a.c+1,0,a.r+1,0,a.c+3,20,a.r+5,20].join(",")),lt("x:AutoFill","False"),lt("x:Row",String(a.r)),lt("x:Column",String(a.c)),s[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),i.push("</xml>"),i.join("")}function Vg(t){var e=[Xe,ee("comments",null,{xmlns:Hi[0]})],r=[];return e.push("<authors>"),t.forEach(function(n){n[1].forEach(function(i){var s=ke(i.a);r.indexOf(s)==-1&&(r.push(s),e.push("<author>"+s+"</author>")),i.T&&i.ID&&r.indexOf("tc="+i.ID)==-1&&(r.push("tc="+i.ID),e.push("<author>tc="+i.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),e.push("<author>SheetJ5</author>")),e.push("</authors>"),e.push("<commentList>"),t.forEach(function(n){var i=0,s=[];if(n[1][0]&&n[1][0].T&&n[1][0].ID?i=r.indexOf("tc="+n[1][0].ID):n[1].forEach(function(l){l.a&&(i=r.indexOf(ke(l.a))),s.push(l.t||"")}),e.push('<comment ref="'+n[0]+'" authorId="'+i+'"><text>'),s.length<=1)e.push(lt("t",ke(s[0]||"")));else{for(var a=`Comment:
    `+s[0]+`
`,o=1;o<s.length;++o)a+=`Reply:
    `+s[o]+`
`;e.push(lt("t",ke(a)))}e.push("</text></comment>")}),e.push("</commentList>"),e.length>2&&(e[e.length]="</comments>",e[1]=e[1].replace("/>",">")),e.join("")}function H4(t,e,r){var n=[Xe,ee("ThreadedComments",null,{xmlns:Ze.TCMNT}).replace(/[\/]>/,">")];return t.forEach(function(i){var s="";(i[1]||[]).forEach(function(a,o){if(!a.T){delete a.ID;return}a.a&&e.indexOf(a.a)==-1&&e.push(a.a);var l={ref:i[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};o==0?s=l.id:l.parentId=s,a.ID=l.id,a.a&&(l.personId="{54EE7950-7262-4200-6969-"+("000000000000"+e.indexOf(a.a)).slice(-12)+"}"),n.push(ee("threadedComment",lt("text",a.t||""),l))})}),n.push("</ThreadedComments>"),n.join("")}function W4(t){var e=[Xe,ee("personList",null,{xmlns:Ze.TCMNT,"xmlns:x":Hi[0]}).replace(/[\/]>/,">")];return t.forEach(function(r,n){e.push(ee("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:r,providerId:"None"}))}),e.push("</personList>"),e.join("")}function V4(t){var e={};e.iauthor=t.read_shift(4);var r=ii(t);return e.rfx=r.s,e.ref=Oe(r.s),t.l+=16,e}function G4(t,e){return e==null&&(e=G(36)),e.write_shift(4,t[1].iauthor),Vi(t[0],e),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e}var z4=gt;function q4(t){return tt(t.slice(0,54))}function K4(t){var e=Ct(),r=[];return K(e,628),K(e,630),t.forEach(function(n){n[1].forEach(function(i){r.indexOf(i.a)>-1||(r.push(i.a.slice(0,54)),K(e,632,q4(i.a)))})}),K(e,631),K(e,633),t.forEach(function(n){n[1].forEach(function(i){i.iauthor=r.indexOf(i.a);var s={s:et(n[0]),e:et(n[0])};K(e,635,G4([s,i])),i.t&&i.t.length>0&&K(e,637,Yk(i)),K(e,636),delete i.iauthor})}),K(e,634),K(e,629),e.end()}function X4(t,e){e.FullPaths.forEach(function(r,n){if(n!=0){var i=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");i.slice(-1)!=="/"&&Pe.utils.cfb_add(t,i,e.FileIndex[n].content)}})}var Gg=["xlsb","xlsm","xlam","biff8","xla"],Y4=function(){var t=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,e={r:0,c:0};function r(n,i,s,a){var o=!1,l=!1;s.length==0?l=!0:s.charAt(0)=="["&&(l=!0,s=s.slice(1,-1)),a.length==0?o=!0:a.charAt(0)=="["&&(o=!0,a=a.slice(1,-1));var c=s.length>0?parseInt(s,10)|0:0,u=a.length>0?parseInt(a,10)|0:0;return o?u+=e.c:--u,l?c+=e.r:--c,i+(o?"":"$")+mt(u)+(l?"":"$")+ct(c)}return function(i,s){return e=s,i.replace(t,r)}}(),Pu=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,Fu=function(){return function(e,r){return e.replace(Pu,function(n,i,s,a,o,l){var c=Au(a)-(s?0:r.c),u=Su(l)-(o?0:r.r),f=u==0?"":o?u+1:"["+u+"]",d=c==0?"":s?c+1:"["+c+"]";return i+"R"+f+"C"+d})}}();function J4(t,e){return t.replace(Pu,function(r,n,i,s,a,o){return n+(i=="$"?i+s:mt(Au(s)+e.c))+(a=="$"?a+o:ct(Su(o)+e.r))})}function Q4(t){return t.length!=1}function ze(t){t.l+=1}function dn(t,e){var r=t.read_shift(e==1?1:2);return[r&16383,r>>14&1,r>>15&1]}function zg(t,e,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return qg(t);r.biff==12&&(n=4)}var i=t.read_shift(n),s=t.read_shift(n),a=dn(t,2),o=dn(t,2);return{s:{r:i,c:a[0],cRel:a[1],rRel:a[2]},e:{r:s,c:o[0],cRel:o[1],rRel:o[2]}}}function qg(t){var e=dn(t,2),r=dn(t,2),n=t.read_shift(1),i=t.read_shift(1);return{s:{r:e[0],c:n,cRel:e[1],rRel:e[2]},e:{r:r[0],c:i,cRel:r[1],rRel:r[2]}}}function Z4(t,e,r){if(r.biff<8)return qg(t);var n=t.read_shift(r.biff==12?4:2),i=t.read_shift(r.biff==12?4:2),s=dn(t,2),a=dn(t,2);return{s:{r:n,c:s[0],cRel:s[1],rRel:s[2]},e:{r:i,c:a[0],cRel:a[1],rRel:a[2]}}}function Kg(t,e,r){if(r&&r.biff>=2&&r.biff<=5)return eR(t);var n=t.read_shift(r&&r.biff==12?4:2),i=dn(t,2);return{r:n,c:i[0],cRel:i[1],rRel:i[2]}}function eR(t){var e=dn(t,2),r=t.read_shift(1);return{r:e[0],c:r,cRel:e[1],rRel:e[2]}}function tR(t){var e=t.read_shift(2),r=t.read_shift(2);return{r:e,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function rR(t,e,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return nR(t);var i=t.read_shift(n>=12?4:2),s=t.read_shift(2),a=(s&16384)>>14,o=(s&32768)>>15;if(s&=16383,o==1)for(;i>524287;)i-=1048576;if(a==1)for(;s>8191;)s=s-16384;return{r:i,c:s,cRel:a,rRel:o}}function nR(t){var e=t.read_shift(2),r=t.read_shift(1),n=(e&32768)>>15,i=(e&16384)>>14;return e&=16383,n==1&&e>=8192&&(e=e-16384),i==1&&r>=128&&(r=r-256),{r:e,c:r,cRel:i,rRel:n}}function iR(t,e,r){var n=(t[t.l++]&96)>>5,i=zg(t,r.biff>=2&&r.biff<=5?6:8,r);return[n,i]}function sR(t,e,r){var n=(t[t.l++]&96)>>5,i=t.read_shift(2,"i"),s=8;if(r)switch(r.biff){case 5:t.l+=12,s=6;break;case 12:s=12;break}var a=zg(t,s,r);return[n,i,a]}function aR(t,e,r){var n=(t[t.l++]&96)>>5;return t.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function oR(t,e,r){var n=(t[t.l++]&96)>>5,i=t.read_shift(2),s=8;if(r)switch(r.biff){case 5:t.l+=12,s=6;break;case 12:s=12;break}return t.l+=s,[n,i]}function lR(t,e,r){var n=(t[t.l++]&96)>>5,i=Z4(t,e-1,r);return[n,i]}function cR(t,e,r){var n=(t[t.l++]&96)>>5;return t.l+=r.biff==2?6:r.biff==12?14:7,[n]}function u0(t){var e=t[t.l+1]&1,r=1;return t.l+=4,[e,r]}function uR(t,e,r){t.l+=2;for(var n=t.read_shift(r&&r.biff==2?1:2),i=[],s=0;s<=n;++s)i.push(t.read_shift(r&&r.biff==2?1:2));return i}function fR(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(r&&r.biff==2?1:2)]}function hR(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(r&&r.biff==2?1:2)]}function dR(t){var e=t[t.l+1]&255?1:0;return t.l+=2,[e,t.read_shift(2)]}function pR(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=r&&r.biff==2?3:4,[n]}function Xg(t){var e=t.read_shift(1),r=t.read_shift(1);return[e,r]}function mR(t){return t.read_shift(2),Xg(t)}function gR(t){return t.read_shift(2),Xg(t)}function vR(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var i=Kg(t,0,r);return[n,i]}function xR(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var i=rR(t,0,r);return[n,i]}function yR(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var i=t.read_shift(2);r&&r.biff==5&&(t.l+=12);var s=Kg(t,0,r);return[n,i,s]}function wR(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var i=t.read_shift(r&&r.biff<=3?1:2);return[wP[i],Qg[i],n]}function _R(t,e,r){var n=t[t.l++],i=t.read_shift(1),s=r&&r.biff<=3?[n==88?-1:0,t.read_shift(1)]:ER(t);return[i,(s[0]===0?Qg:yP)[s[1]]]}function ER(t){return[t[t.l+1]>>7,t.read_shift(2)&32767]}function bR(t,e,r){t.l+=r&&r.biff==2?3:4}function TR(t,e,r){if(t.l++,r&&r.biff==12)return[t.read_shift(4,"i"),0];var n=t.read_shift(2),i=t.read_shift(r&&r.biff==2?1:2);return[n,i]}function SR(t){return t.l++,Ys[t.read_shift(1)]}function AR(t){return t.l++,t.read_shift(2)}function CR(t){return t.l++,t.read_shift(1)!==0}function IR(t){return t.l++,Gi(t)}function kR(t,e,r){return t.l++,Rg(t,e-1,r)}function OR(t,e){var r=[t.read_shift(1)];if(e==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=yO(t,1)?"TRUE":"FALSE",e!=12&&(t.l+=7);break;case 37:case 16:r[1]=Ys[t[t.l]],t.l+=e==12?4:8;break;case 0:t.l+=8;break;case 1:r[1]=Gi(t);break;case 2:r[1]=bO(t,0,{biff:e>0&&e<8?2:e});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function RR(t,e,r){for(var n=t.read_shift(r.biff==12?4:2),i=[],s=0;s!=n;++s)i.push((r.biff==12?ii:AO)(t));return i}function PR(t,e,r){var n=0,i=0;r.biff==12?(n=t.read_shift(4),i=t.read_shift(4)):(i=1+t.read_shift(1),n=1+t.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--i==0&&(i=256));for(var s=0,a=[];s!=n&&(a[s]=[]);++s)for(var o=0;o!=i;++o)a[s][o]=OR(t,r.biff);return a}function FR(t,e,r){var n=t.read_shift(1)>>>5&3,i=!r||r.biff>=8?4:2,s=t.read_shift(i);switch(r.biff){case 2:t.l+=5;break;case 3:case 4:t.l+=8;break;case 5:t.l+=12;break}return[n,0,s]}function NR(t,e,r){if(r.biff==5)return DR(t);var n=t.read_shift(1)>>>5&3,i=t.read_shift(2),s=t.read_shift(4);return[n,i,s]}function DR(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2,"i");t.l+=8;var n=t.read_shift(2);return t.l+=12,[e,r,n]}function LR(t,e,r){var n=t.read_shift(1)>>>5&3;t.l+=r&&r.biff==2?3:4;var i=t.read_shift(r&&r.biff==2?1:2);return[n,i]}function MR(t,e,r){var n=t.read_shift(1)>>>5&3,i=t.read_shift(r&&r.biff==2?1:2);return[n,i]}function jR(t,e,r){var n=t.read_shift(1)>>>5&3;return t.l+=4,r.biff<8&&t.l--,r.biff==12&&(t.l+=2),[n]}function $R(t,e,r){var n=(t[t.l++]&96)>>5,i=t.read_shift(2),s=4;if(r)switch(r.biff){case 5:s=15;break;case 12:s=6;break}return t.l+=s,[n,i]}var BR=mr,UR=mr,HR=mr;function Js(t,e,r){return t.l+=2,[tR(t)]}function Nu(t){return t.l+=6,[]}var WR=Js,VR=Nu,GR=Nu,zR=Js;function Yg(t){return t.l+=2,[kg(t),t.read_shift(2)&1]}var qR=Js,KR=Yg,XR=Nu,YR=Js,JR=Js,QR=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function ZR(t){t.l+=2;var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(4),i=t.read_shift(2),s=t.read_shift(2),a=QR[r>>2&31];return{ixti:e,coltype:r&3,rt:a,idx:n,c:i,C:s}}function eP(t){return t.l+=2,[t.read_shift(4)]}function tP(t,e,r){return t.l+=5,t.l+=2,t.l+=r.biff==2?1:4,["PTGSHEET"]}function rP(t,e,r){return t.l+=r.biff==2?4:5,["PTGENDSHEET"]}function nP(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[e,r]}function iP(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[e,r]}function sP(t){return t.l+=4,[0,0]}var f0={1:{n:"PtgExp",f:TR},2:{n:"PtgTbl",f:HR},3:{n:"PtgAdd",f:ze},4:{n:"PtgSub",f:ze},5:{n:"PtgMul",f:ze},6:{n:"PtgDiv",f:ze},7:{n:"PtgPower",f:ze},8:{n:"PtgConcat",f:ze},9:{n:"PtgLt",f:ze},10:{n:"PtgLe",f:ze},11:{n:"PtgEq",f:ze},12:{n:"PtgGe",f:ze},13:{n:"PtgGt",f:ze},14:{n:"PtgNe",f:ze},15:{n:"PtgIsect",f:ze},16:{n:"PtgUnion",f:ze},17:{n:"PtgRange",f:ze},18:{n:"PtgUplus",f:ze},19:{n:"PtgUminus",f:ze},20:{n:"PtgPercent",f:ze},21:{n:"PtgParen",f:ze},22:{n:"PtgMissArg",f:ze},23:{n:"PtgStr",f:kR},26:{n:"PtgSheet",f:tP},27:{n:"PtgEndSheet",f:rP},28:{n:"PtgErr",f:SR},29:{n:"PtgBool",f:CR},30:{n:"PtgInt",f:AR},31:{n:"PtgNum",f:IR},32:{n:"PtgArray",f:cR},33:{n:"PtgFunc",f:wR},34:{n:"PtgFuncVar",f:_R},35:{n:"PtgName",f:FR},36:{n:"PtgRef",f:vR},37:{n:"PtgArea",f:iR},38:{n:"PtgMemArea",f:LR},39:{n:"PtgMemErr",f:BR},40:{n:"PtgMemNoMem",f:UR},41:{n:"PtgMemFunc",f:MR},42:{n:"PtgRefErr",f:jR},43:{n:"PtgAreaErr",f:aR},44:{n:"PtgRefN",f:xR},45:{n:"PtgAreaN",f:lR},46:{n:"PtgMemAreaN",f:nP},47:{n:"PtgMemNoMemN",f:iP},57:{n:"PtgNameX",f:NR},58:{n:"PtgRef3d",f:yR},59:{n:"PtgArea3d",f:sR},60:{n:"PtgRefErr3d",f:$R},61:{n:"PtgAreaErr3d",f:oR},255:{}},aP={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},oP={1:{n:"PtgElfLel",f:Yg},2:{n:"PtgElfRw",f:YR},3:{n:"PtgElfCol",f:WR},6:{n:"PtgElfRwV",f:JR},7:{n:"PtgElfColV",f:zR},10:{n:"PtgElfRadical",f:qR},11:{n:"PtgElfRadicalS",f:XR},13:{n:"PtgElfColS",f:VR},15:{n:"PtgElfColSV",f:GR},16:{n:"PtgElfRadicalLel",f:KR},25:{n:"PtgList",f:ZR},29:{n:"PtgSxName",f:eP},255:{}},lP={0:{n:"PtgAttrNoop",f:sP},1:{n:"PtgAttrSemi",f:pR},2:{n:"PtgAttrIf",f:hR},4:{n:"PtgAttrChoose",f:uR},8:{n:"PtgAttrGoto",f:fR},16:{n:"PtgAttrSum",f:bR},32:{n:"PtgAttrBaxcel",f:u0},33:{n:"PtgAttrBaxcel",f:u0},64:{n:"PtgAttrSpace",f:mR},65:{n:"PtgAttrSpaceSemi",f:gR},128:{n:"PtgAttrIfError",f:dR},255:{}};function cP(t,e,r,n){if(n.biff<8)return mr(t,e);for(var i=t.l+e,s=[],a=0;a!==r.length;++a)switch(r[a][0]){case"PtgArray":r[a][1]=PR(t,0,n),s.push(r[a][1]);break;case"PtgMemArea":r[a][2]=RR(t,r[a][1],n),s.push(r[a][2]);break;case"PtgExp":n&&n.biff==12&&(r[a][1][1]=t.read_shift(4),s.push(r[a][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[a][0]}return e=i-t.l,e!==0&&s.push(mr(t,e)),s}function uP(t,e,r){for(var n=t.l+e,i,s,a=[];n!=t.l;)e=n-t.l,s=t[t.l],i=f0[s]||f0[aP[s]],(s===24||s===25)&&(i=(s===24?oP:lP)[t[t.l+1]]),!i||!i.f?mr(t,e):a.push([i.n,i.f(t,e,r)]);return a}function fP(t){for(var e=[],r=0;r<t.length;++r){for(var n=t[r],i=[],s=0;s<n.length;++s){var a=n[s];if(a)switch(a[0]){case 2:i.push('"'+a[1].replace(/"/g,'""')+'"');break;default:i.push(a[1])}else i.push("")}e.push(i.join(","))}return e.join(";")}var hP={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function dP(t,e){if(!t&&!(e&&e.biff<=5&&e.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(t)?"'"+t+"'":t}function Jg(t,e,r){if(!t)return"SH33TJSERR0";if(r.biff>8&&(!t.XTI||!t.XTI[e]))return t.SheetNames[e];if(!t.XTI)return"SH33TJSERR6";var n=t.XTI[e];if(r.biff<8)return e>1e4&&(e-=65536),e<0&&(e=-e),e==0?"":t.XTI[e-1];if(!n)return"SH33TJSERR1";var i="";if(r.biff>8)switch(t[n[0]][0]){case 357:return i=n[1]==-1?"#REF":t.SheetNames[n[1]],n[1]==n[2]?i:i+":"+t.SheetNames[n[2]];case 358:return r.SID!=null?t.SheetNames[r.SID]:"SH33TJSSAME"+t[n[0]][0];case 355:default:return"SH33TJSSRC"+t[n[0]][0]}switch(t[n[0]][0][0]){case 1025:return i=n[1]==-1?"#REF":t.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?i:i+":"+t.SheetNames[n[2]];case 14849:return t[n[0]].slice(1).map(function(s){return s.Name}).join(";;");default:return t[n[0]][0][3]?(i=n[1]==-1?"#REF":t[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?i:i+":"+t[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function h0(t,e,r){var n=Jg(t,e,r);return n=="#REF"?n:dP(n,r)}function Fi(t,e,r,n,i){var s=i&&i.biff||8,a={s:{c:0,r:0},e:{c:0,r:0}},o=[],l,c,u,f=0,d=0,h,m="";if(!t[0]||!t[0][0])return"";for(var p=-1,g="",w=0,b=t[0].length;w<b;++w){var _=t[0][w];switch(_[0]){case"PtgUminus":o.push("-"+o.pop());break;case"PtgUplus":o.push("+"+o.pop());break;case"PtgPercent":o.push(o.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(l=o.pop(),c=o.pop(),p>=0){switch(t[0][p][1][0]){case 0:g=We(" ",t[0][p][1][1]);break;case 1:g=We("\r",t[0][p][1][1]);break;default:if(g="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][p][1][0])}c=c+g,p=-1}o.push(c+hP[_[0]]+l);break;case"PtgIsect":l=o.pop(),c=o.pop(),o.push(c+" "+l);break;case"PtgUnion":l=o.pop(),c=o.pop(),o.push(c+","+l);break;case"PtgRange":l=o.pop(),c=o.pop(),o.push(c+":"+l);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":u=ms(_[1][1],a,i),o.push(gs(u,s));break;case"PtgRefN":u=r?ms(_[1][1],r,i):_[1][1],o.push(gs(u,s));break;case"PtgRef3d":f=_[1][1],u=ms(_[1][2],a,i),m=h0(n,f,i),o.push(m+"!"+gs(u,s));break;case"PtgFunc":case"PtgFuncVar":var k=_[1][0],L=_[1][1];k||(k=0),k&=127;var M=k==0?[]:o.slice(-k);o.length-=k,L==="User"&&(L=M.shift()),o.push(L+"("+M.join(",")+")");break;case"PtgBool":o.push(_[1]?"TRUE":"FALSE");break;case"PtgInt":o.push(_[1]);break;case"PtgNum":o.push(String(_[1]));break;case"PtgStr":o.push('"'+_[1].replace(/"/g,'""')+'"');break;case"PtgErr":o.push(_[1]);break;case"PtgAreaN":h=Yh(_[1][1],r?{s:r}:a,i),o.push(wl(h,i));break;case"PtgArea":h=Yh(_[1][1],a,i),o.push(wl(h,i));break;case"PtgArea3d":f=_[1][1],h=_[1][2],m=h0(n,f,i),o.push(m+"!"+wl(h,i));break;case"PtgAttrSum":o.push("SUM("+o.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":d=_[1][2];var I=(n.names||[])[d-1]||(n[0]||[])[d],F=I?I.Name:"SH33TJSNAME"+String(d);F&&F.slice(0,6)=="_xlfn."&&!i.xlfn&&(F=F.slice(6)),o.push(F);break;case"PtgNameX":var R=_[1][1];d=_[1][2];var N;if(i.biff<=5)R<0&&(R=-R),n[R]&&(N=n[R][d]);else{var H="";if(((n[R]||[])[0]||[])[0]==14849||(((n[R]||[])[0]||[])[0]==1025?n[R][d]&&n[R][d].itab>0&&(H=n.SheetNames[n[R][d].itab-1]+"!"):H=n.SheetNames[d-1]+"!"),n[R]&&n[R][d])H+=n[R][d].Name;else if(n[0]&&n[0][d])H+=n[0][d].Name;else{var q=(Jg(n,R,i)||"").split(";;");q[d-1]?H=q[d-1]:H+="SH33TJSERRX"}o.push(H);break}N||(N={Name:"SH33TJSERRY"}),o.push(N.Name);break;case"PtgParen":var Y="(",fe=")";if(p>=0){switch(g="",t[0][p][1][0]){case 2:Y=We(" ",t[0][p][1][1])+Y;break;case 3:Y=We("\r",t[0][p][1][1])+Y;break;case 4:fe=We(" ",t[0][p][1][1])+fe;break;case 5:fe=We("\r",t[0][p][1][1])+fe;break;default:if(i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][p][1][0])}p=-1}o.push(Y+o.pop()+fe);break;case"PtgRefErr":o.push("#REF!");break;case"PtgRefErr3d":o.push("#REF!");break;case"PtgExp":u={c:_[1][1],r:_[1][0]};var ue={c:r.c,r:r.r};if(n.sharedf[Oe(u)]){var we=n.sharedf[Oe(u)];o.push(Fi(we,a,ue,n,i))}else{var xe=!1;for(l=0;l!=n.arrayf.length;++l)if(c=n.arrayf[l],!(u.c<c[0].s.c||u.c>c[0].e.c)&&!(u.r<c[0].s.r||u.r>c[0].e.r)){o.push(Fi(c[1],a,ue,n,i)),xe=!0;break}xe||o.push(_[1])}break;case"PtgArray":o.push("{"+fP(_[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":p=w;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":o.push("");break;case"PtgAreaErr":o.push("#REF!");break;case"PtgAreaErr3d":o.push("#REF!");break;case"PtgList":o.push("Table"+_[1].idx+"[#"+_[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(_));default:throw new Error("Unrecognized Formula Token: "+String(_))}var he=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(i.biff!=3&&p>=0&&he.indexOf(t[0][w][0])==-1){_=t[0][p];var Q=!0;switch(_[1][0]){case 4:Q=!1;case 0:g=We(" ",_[1][1]);break;case 5:Q=!1;case 1:g=We("\r",_[1][1]);break;default:if(g="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+_[1][0])}o.push((Q?g:"")+o.pop()+(Q?"":g)),p=-1}}if(o.length>1&&i.WTF)throw new Error("bad formula stack");return o[0]}function pP(t){if(t==null){var e=G(8);return e.write_shift(1,3),e.write_shift(1,0),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,65535),e}else if(typeof t=="number")return Xn(t);return Xn(0)}function mP(t,e,r,n,i){var s=Yn(e,r,i),a=pP(t.v),o=G(6),l=33;o.write_shift(2,l),o.write_shift(4,0);for(var c=G(t.bf.length),u=0;u<t.bf.length;++u)c[u]=t.bf[u];var f=ot([s,a,o,c]);return f}function Lo(t,e,r){var n=t.read_shift(4),i=uP(t,n,r),s=t.read_shift(4),a=s>0?cP(t,s,i,r):null;return[i,a]}var gP=Lo,Mo=Lo,vP=Lo,xP=Lo,yP={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},Qg={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},wP={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function _P(t){var e="of:="+t.replace(Pu,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return e.replace(/;/g,"|").replace(/,/g,";")}function EP(t){return t.replace(/\./,"!")}var vs=typeof Map<"u";function Du(t,e,r){var n=0,i=t.length;if(r){if(vs?r.has(e):Object.prototype.hasOwnProperty.call(r,e)){for(var s=vs?r.get(e):r[e];n<s.length;++n)if(t[s[n]].t===e)return t.Count++,s[n]}}else for(;n<i;++n)if(t[n].t===e)return t.Count++,n;return t[i]={t:e},t.Count++,t.Unique++,r&&(vs?(r.has(e)||r.set(e,[]),r.get(e).push(i)):(Object.prototype.hasOwnProperty.call(r,e)||(r[e]=[]),r[e].push(i))),i}function jo(t,e){var r={min:t+1,max:t+1},n=-1;return e.MDW&&(Nr=e.MDW),e.width!=null?r.customWidth=1:e.wpx!=null?n=io(e.wpx):e.wch!=null&&(n=e.wch),n>-1?(r.width=gc(n),r.customWidth=1):e.width!=null&&(r.width=e.width),e.hidden&&(r.hidden=!0),e.level!=null&&(r.outlineLevel=r.level=e.level),r}function Zg(t,e){if(t){var r=[.7,.7,.75,.75,.3,.3];e=="xlml"&&(r=[1,1,1,1,.5,.5]),t.left==null&&(t.left=r[0]),t.right==null&&(t.right=r[1]),t.top==null&&(t.top=r[2]),t.bottom==null&&(t.bottom=r[3]),t.header==null&&(t.header=r[4]),t.footer==null&&(t.footer=r[5])}}function yn(t,e,r){var n=r.revssf[e.z!=null?e.z:"General"],i=60,s=t.length;if(n==null&&r.ssf){for(;i<392;++i)if(r.ssf[i]==null){Km(e.z,i),r.ssf[i]=e.z,r.revssf[e.z]=n=i;break}}for(i=0;i!=s;++i)if(t[i].numFmtId===n)return i;return t[s]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},s}function bP(t,e,r){if(t&&t["!ref"]){var n=Me(t["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+r+"): "+t["!ref"])}}function TP(t){if(t.length===0)return"";for(var e='<mergeCells count="'+t.length+'">',r=0;r!=t.length;++r)e+='<mergeCell ref="'+Ke(t[r])+'"/>';return e+"</mergeCells>"}function SP(t,e,r,n,i){var s=!1,a={},o=null;if(n.bookType!=="xlsx"&&e.vbaraw){var l=e.SheetNames[r];try{e.Workbook&&(l=e.Workbook.Sheets[r].CodeName||l)}catch{}s=!0,a.codeName=Or(ke(l))}if(t&&t["!outline"]){var c={summaryBelow:1,summaryRight:1};t["!outline"].above&&(c.summaryBelow=0),t["!outline"].left&&(c.summaryRight=0),o=(o||"")+ee("outlinePr",null,c)}!s&&!o||(i[i.length]=ee("sheetPr",o,a))}var AP=["objects","scenarios","selectLockedCells","selectUnlockedCells"],CP=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function IP(t){var e={sheet:1};return AP.forEach(function(r){t[r]!=null&&t[r]&&(e[r]="1")}),CP.forEach(function(r){t[r]!=null&&!t[r]&&(e[r]="0")}),t.password&&(e.password=Lg(t.password).toString(16).toUpperCase()),ee("sheetProtection",null,e)}function kP(t){return Zg(t),ee("pageMargins",null,t)}function OP(t,e){for(var r=["<cols>"],n,i=0;i!=e.length;++i)(n=e[i])&&(r[r.length]=ee("col",null,jo(i,n)));return r[r.length]="</cols>",r.join("")}function RP(t,e,r,n){var i=typeof t.ref=="string"?t.ref:Ke(t.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var s=r.Workbook.Names,a=Mt(i);a.s.r==a.e.r&&(a.e.r=Mt(e["!ref"]).e.r,i=Ke(a));for(var o=0;o<s.length;++o){var l=s[o];if(l.Name=="_xlnm._FilterDatabase"&&l.Sheet==n){l.Ref="'"+r.SheetNames[n]+"'!"+i;break}}return o==s.length&&s.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+i}),ee("autoFilter",null,{ref:i})}function PP(t,e,r,n){var i={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(i.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),ee("sheetViews",ee("sheetView",null,i),{})}function FP(t,e,r,n){if(t.c&&r["!comments"].push([e,t.c]),t.v===void 0&&typeof t.f!="string"||t.t==="z"&&!t.f)return"";var i="",s=t.t,a=t.v;if(t.t!=="z")switch(t.t){case"b":i=t.v?"1":"0";break;case"n":i=""+t.v;break;case"e":i=Ys[t.v];break;case"d":n&&n.cellDates?i=Et(t.v,-1).toISOString():(t=kt(t),t.t="n",i=""+(t.v=It(Et(t.v)))),typeof t.z>"u"&&(t.z=Ve[14]);break;default:i=t.v;break}var o=lt("v",ke(i)),l={r:e},c=yn(n.cellXfs,t,n);switch(c!==0&&(l.s=c),t.t){case"n":break;case"d":l.t="d";break;case"b":l.t="b";break;case"e":l.t="e";break;case"z":break;default:if(t.v==null){delete t.t;break}if(t.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){o=lt("v",""+Du(n.Strings,t.v,n.revStrings)),l.t="s";break}l.t="str";break}if(t.t!=s&&(t.t=s,t.v=a),typeof t.f=="string"&&t.f){var u=t.F&&t.F.slice(0,e.length)==e?{t:"array",ref:t.F}:null;o=ee("f",ke(t.f),u)+(t.v!=null?o:"")}return t.l&&r["!links"].push([e,t.l]),t.D&&(l.cm=1),ee("c",o,l)}function NP(t,e,r,n){var i=[],s=[],a=Me(t["!ref"]),o="",l,c="",u=[],f=0,d=0,h=t["!rows"],m=Array.isArray(t),p={r:c},g,w=-1;for(d=a.s.c;d<=a.e.c;++d)u[d]=mt(d);for(f=a.s.r;f<=a.e.r;++f){for(s=[],c=ct(f),d=a.s.c;d<=a.e.c;++d){l=u[d]+c;var b=m?(t[f]||[])[d]:t[l];b!==void 0&&(o=FP(b,l,t,e))!=null&&s.push(o)}(s.length>0||h&&h[f])&&(p={r:c},h&&h[f]&&(g=h[f],g.hidden&&(p.hidden=1),w=-1,g.hpx?w=so(g.hpx):g.hpt&&(w=g.hpt),w>-1&&(p.ht=w,p.customHeight=1),g.level&&(p.outlineLevel=g.level)),i[i.length]=ee("row",s.join(""),p))}if(h)for(;f<h.length;++f)h&&h[f]&&(p={r:f+1},g=h[f],g.hidden&&(p.hidden=1),w=-1,g.hpx?w=so(g.hpx):g.hpt&&(w=g.hpt),w>-1&&(p.ht=w,p.customHeight=1),g.level&&(p.outlineLevel=g.level),i[i.length]=ee("row","",p));return i.join("")}function ev(t,e,r,n){var i=[Xe,ee("worksheet",null,{xmlns:Hi[0],"xmlns:r":Ze.r})],s=r.SheetNames[t],a=0,o="",l=r.Sheets[s];l==null&&(l={});var c=l["!ref"]||"A1",u=Me(c);if(u.e.c>16383||u.e.r>1048575){if(e.WTF)throw new Error("Range "+c+" exceeds format limit A1:XFD1048576");u.e.c=Math.min(u.e.c,16383),u.e.r=Math.min(u.e.c,1048575),c=Ke(u)}n||(n={}),l["!comments"]=[];var f=[];SP(l,r,t,e,i),i[i.length]=ee("dimension",null,{ref:c}),i[i.length]=PP(l,e,t,r),e.sheetFormat&&(i[i.length]=ee("sheetFormatPr",null,{defaultRowHeight:e.sheetFormat.defaultRowHeight||"16",baseColWidth:e.sheetFormat.baseColWidth||"10",outlineLevelRow:e.sheetFormat.outlineLevelRow||"7"})),l["!cols"]!=null&&l["!cols"].length>0&&(i[i.length]=OP(l,l["!cols"])),i[a=i.length]="<sheetData/>",l["!links"]=[],l["!ref"]!=null&&(o=NP(l,e),o.length>0&&(i[i.length]=o)),i.length>a+1&&(i[i.length]="</sheetData>",i[a]=i[a].replace("/>",">")),l["!protect"]&&(i[i.length]=IP(l["!protect"])),l["!autofilter"]!=null&&(i[i.length]=RP(l["!autofilter"],l,r,t)),l["!merges"]!=null&&l["!merges"].length>0&&(i[i.length]=TP(l["!merges"]));var d=-1,h,m=-1;return l["!links"].length>0&&(i[i.length]="<hyperlinks>",l["!links"].forEach(function(p){p[1].Target&&(h={ref:p[0]},p[1].Target.charAt(0)!="#"&&(m=Ie(n,-1,ke(p[1].Target).replace(/#.*$/,""),Te.HLINK),h["r:id"]="rId"+m),(d=p[1].Target.indexOf("#"))>-1&&(h.location=ke(p[1].Target.slice(d+1))),p[1].Tooltip&&(h.tooltip=ke(p[1].Tooltip)),i[i.length]=ee("hyperlink",null,h))}),i[i.length]="</hyperlinks>"),delete l["!links"],l["!margins"]!=null&&(i[i.length]=kP(l["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&(i[i.length]=lt("ignoredErrors",ee("ignoredError",null,{numberStoredAsText:1,sqref:c}))),f.length>0&&(m=Ie(n,-1,"../drawings/drawing"+(t+1)+".xml",Te.DRAW),i[i.length]=ee("drawing",null,{"r:id":"rId"+m}),l["!drawing"]=f),l["!comments"].length>0&&(m=Ie(n,-1,"../drawings/vmlDrawing"+(t+1)+".vml",Te.VML),i[i.length]=ee("legacyDrawing",null,{"r:id":"rId"+m}),l["!legacy"]=m),i.length>1&&(i[i.length]="</worksheet>",i[1]=i[1].replace("/>",">")),i.join("")}function DP(t,e){var r={},n=t.l+e;r.r=t.read_shift(4),t.l+=4;var i=t.read_shift(2);t.l+=1;var s=t.read_shift(1);return t.l=n,s&7&&(r.level=s&7),s&16&&(r.hidden=!0),s&32&&(r.hpt=i/20),r}function LP(t,e,r){var n=G(145),i=(r["!rows"]||[])[t]||{};n.write_shift(4,t),n.write_shift(4,0);var s=320;i.hpx?s=so(i.hpx)*20:i.hpt&&(s=i.hpt*20),n.write_shift(2,s),n.write_shift(1,0);var a=0;i.level&&(a|=i.level),i.hidden&&(a|=16),(i.hpx||i.hpt)&&(a|=32),n.write_shift(1,a),n.write_shift(1,0);var o=0,l=n.l;n.l+=4;for(var c={r:t,c:0},u=0;u<16;++u)if(!(e.s.c>u+1<<10||e.e.c<u<<10)){for(var f=-1,d=-1,h=u<<10;h<u+1<<10;++h){c.c=h;var m=Array.isArray(r)?(r[c.r]||[])[c.c]:r[Oe(c)];m&&(f<0&&(f=h),d=h)}f<0||(++o,n.write_shift(4,f),n.write_shift(4,d))}var p=n.l;return n.l=l,n.write_shift(4,o),n.l=p,n.length>n.l?n.slice(0,n.l):n}function MP(t,e,r,n){var i=LP(n,r,e);(i.length>17||(e["!rows"]||[])[n])&&K(t,0,i)}var jP=ii,$P=Vi;function BP(){}function UP(t,e){var r={},n=t[t.l];return++t.l,r.above=!(n&64),r.left=!(n&128),t.l+=18,r.name=Jk(t),r}function HP(t,e,r){r==null&&(r=G(84+4*t.length));var n=192;e&&(e.above&&(n&=-65),e.left&&(n&=-129)),r.write_shift(1,n);for(var i=1;i<3;++i)r.write_shift(1,0);return to({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),mg(t,r),r.slice(0,r.l)}function WP(t){var e=zt(t);return[e]}function VP(t,e,r){return r==null&&(r=G(8)),ti(e,r)}function GP(t){var e=ri(t);return[e]}function zP(t,e,r){return r==null&&(r=G(4)),ni(e,r)}function qP(t){var e=zt(t),r=t.read_shift(1);return[e,r,"b"]}function KP(t,e,r){return r==null&&(r=G(9)),ti(e,r),r.write_shift(1,t.v?1:0),r}function XP(t){var e=ri(t),r=t.read_shift(1);return[e,r,"b"]}function YP(t,e,r){return r==null&&(r=G(5)),ni(e,r),r.write_shift(1,t.v?1:0),r}function JP(t){var e=zt(t),r=t.read_shift(1);return[e,r,"e"]}function QP(t,e,r){return r==null&&(r=G(9)),ti(e,r),r.write_shift(1,t.v),r}function ZP(t){var e=ri(t),r=t.read_shift(1);return[e,r,"e"]}function eF(t,e,r){return r==null&&(r=G(8)),ni(e,r),r.write_shift(1,t.v),r.write_shift(2,0),r.write_shift(1,0),r}function tF(t){var e=zt(t),r=t.read_shift(4);return[e,r,"s"]}function rF(t,e,r){return r==null&&(r=G(12)),ti(e,r),r.write_shift(4,e.v),r}function nF(t){var e=ri(t),r=t.read_shift(4);return[e,r,"s"]}function iF(t,e,r){return r==null&&(r=G(8)),ni(e,r),r.write_shift(4,e.v),r}function sF(t){var e=zt(t),r=Gi(t);return[e,r,"n"]}function aF(t,e,r){return r==null&&(r=G(16)),ti(e,r),Xn(t.v,r),r}function oF(t){var e=ri(t),r=Gi(t);return[e,r,"n"]}function lF(t,e,r){return r==null&&(r=G(12)),ni(e,r),Xn(t.v,r),r}function cF(t){var e=zt(t),r=gg(t);return[e,r,"n"]}function uF(t,e,r){return r==null&&(r=G(12)),ti(e,r),vg(t.v,r),r}function fF(t){var e=ri(t),r=gg(t);return[e,r,"n"]}function hF(t,e,r){return r==null&&(r=G(8)),ni(e,r),vg(t.v,r),r}function dF(t){var e=zt(t),r=Cu(t);return[e,r,"is"]}function pF(t){var e=zt(t),r=gt(t);return[e,r,"str"]}function mF(t,e,r){return r==null&&(r=G(12+4*t.v.length)),ti(e,r),tt(t.v,r),r.length>r.l?r.slice(0,r.l):r}function gF(t){var e=ri(t),r=gt(t);return[e,r,"str"]}function vF(t,e,r){return r==null&&(r=G(8+4*t.v.length)),ni(e,r),tt(t.v,r),r.length>r.l?r.slice(0,r.l):r}function xF(t,e,r){var n=t.l+e,i=zt(t);i.r=r["!row"];var s=t.read_shift(1),a=[i,s,"b"];if(r.cellFormula){t.l+=2;var o=Mo(t,n-t.l,r);a[3]=Fi(o,null,i,r.supbooks,r)}else t.l=n;return a}function yF(t,e,r){var n=t.l+e,i=zt(t);i.r=r["!row"];var s=t.read_shift(1),a=[i,s,"e"];if(r.cellFormula){t.l+=2;var o=Mo(t,n-t.l,r);a[3]=Fi(o,null,i,r.supbooks,r)}else t.l=n;return a}function wF(t,e,r){var n=t.l+e,i=zt(t);i.r=r["!row"];var s=Gi(t),a=[i,s,"n"];if(r.cellFormula){t.l+=2;var o=Mo(t,n-t.l,r);a[3]=Fi(o,null,i,r.supbooks,r)}else t.l=n;return a}function _F(t,e,r){var n=t.l+e,i=zt(t);i.r=r["!row"];var s=gt(t),a=[i,s,"str"];if(r.cellFormula){t.l+=2;var o=Mo(t,n-t.l,r);a[3]=Fi(o,null,i,r.supbooks,r)}else t.l=n;return a}var EF=ii,bF=Vi;function TF(t,e){return e==null&&(e=G(4)),e.write_shift(4,t),e}function SF(t,e){var r=t.l+e,n=ii(t),i=Iu(t),s=gt(t),a=gt(t),o=gt(t);t.l=r;var l={rfx:n,relId:i,loc:s,display:o};return a&&(l.Tooltip=a),l}function AF(t,e){var r=G(50+4*(t[1].Target.length+(t[1].Tooltip||"").length));Vi({s:et(t[0]),e:et(t[0])},r),ku("rId"+e,r);var n=t[1].Target.indexOf("#"),i=n==-1?"":t[1].Target.slice(n+1);return tt(i||"",r),tt(t[1].Tooltip||"",r),tt("",r),r.slice(0,r.l)}function CF(){}function IF(t,e,r){var n=t.l+e,i=xg(t),s=t.read_shift(1),a=[i];if(a[2]=s,r.cellFormula){var o=gP(t,n-t.l,r);a[1]=o}else t.l=n;return a}function kF(t,e,r){var n=t.l+e,i=ii(t),s=[i];if(r.cellFormula){var a=xP(t,n-t.l,r);s[1]=a,t.l=n}else t.l=n;return s}function OF(t,e,r){r==null&&(r=G(18));var n=jo(t,e);r.write_shift(-4,t),r.write_shift(-4,t),r.write_shift(4,(n.width||10)*256),r.write_shift(4,0);var i=0;return e.hidden&&(i|=1),typeof n.width=="number"&&(i|=2),e.level&&(i|=e.level<<8),r.write_shift(2,i),r}var tv=["left","right","top","bottom","header","footer"];function RF(t){var e={};return tv.forEach(function(r){e[r]=Gi(t)}),e}function PF(t,e){return e==null&&(e=G(6*8)),Zg(t),tv.forEach(function(r){Xn(t[r],e)}),e}function FF(t){var e=t.read_shift(2);return t.l+=28,{RTL:e&32}}function NF(t,e,r){r==null&&(r=G(30));var n=924;return(((e||{}).Views||[])[0]||{}).RTL&&(n|=32),r.write_shift(2,n),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function DF(t){var e=G(24);return e.write_shift(4,4),e.write_shift(4,1),Vi(t,e),e}function LF(t,e){return e==null&&(e=G(16*4+2)),e.write_shift(2,t.password?Lg(t.password):0),e.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?e.write_shift(4,t[r[0]]!=null&&!t[r[0]]?1:0):e.write_shift(4,t[r[0]]!=null&&t[r[0]]?0:1)}),e}function MF(){}function jF(){}function $F(t,e,r,n,i,s,a){if(e.v===void 0)return!1;var o="";switch(e.t){case"b":o=e.v?"1":"0";break;case"d":e=kt(e),e.z=e.z||Ve[14],e.v=It(Et(e.v)),e.t="n";break;case"n":case"e":o=""+e.v;break;default:o=e.v;break}var l={r,c:n};switch(l.s=yn(i.cellXfs,e,i),e.l&&s["!links"].push([Oe(l),e.l]),e.c&&s["!comments"].push([Oe(l),e.c]),e.t){case"s":case"str":return i.bookSST?(o=Du(i.Strings,e.v,i.revStrings),l.t="s",l.v=o,a?K(t,18,iF(e,l)):K(t,7,rF(e,l))):(l.t="str",a?K(t,17,vF(e,l)):K(t,6,mF(e,l))),!0;case"n":return e.v==(e.v|0)&&e.v>-1e3&&e.v<1e3?a?K(t,13,hF(e,l)):K(t,2,uF(e,l)):a?K(t,16,lF(e,l)):K(t,5,aF(e,l)),!0;case"b":return l.t="b",a?K(t,15,YP(e,l)):K(t,4,KP(e,l)),!0;case"e":return l.t="e",a?K(t,14,eF(e,l)):K(t,3,QP(e,l)),!0}return a?K(t,12,zP(e,l)):K(t,1,VP(e,l)),!0}function BF(t,e,r,n){var i=Me(e["!ref"]||"A1"),s,a="",o=[];K(t,145);var l=Array.isArray(e),c=i.e.r;e["!rows"]&&(c=Math.max(i.e.r,e["!rows"].length-1));for(var u=i.s.r;u<=c;++u){a=ct(u),MP(t,e,i,u);var f=!1;if(u<=i.e.r)for(var d=i.s.c;d<=i.e.c;++d){u===i.s.r&&(o[d]=mt(d)),s=o[d]+a;var h=l?(e[u]||[])[d]:e[s];if(!h){f=!1;continue}f=$F(t,h,u,d,n,e,f)}}K(t,146)}function UF(t,e){!e||!e["!merges"]||(K(t,177,TF(e["!merges"].length)),e["!merges"].forEach(function(r){K(t,176,bF(r))}),K(t,178))}function HF(t,e){!e||!e["!cols"]||(K(t,390),e["!cols"].forEach(function(r,n){r&&K(t,60,OF(n,r))}),K(t,391))}function WF(t,e){!e||!e["!ref"]||(K(t,648),K(t,649,DF(Me(e["!ref"]))),K(t,650))}function VF(t,e,r){e["!links"].forEach(function(n){if(n[1].Target){var i=Ie(r,-1,n[1].Target.replace(/#.*$/,""),Te.HLINK);K(t,494,AF(n,i))}}),delete e["!links"]}function GF(t,e,r,n){if(e["!comments"].length>0){var i=Ie(n,-1,"../drawings/vmlDrawing"+(r+1)+".vml",Te.VML);K(t,551,ku("rId"+i)),e["!legacy"]=i}}function zF(t,e,r,n){if(e["!autofilter"]){var i=e["!autofilter"],s=typeof i.ref=="string"?i.ref:Ke(i.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var a=r.Workbook.Names,o=Mt(s);o.s.r==o.e.r&&(o.e.r=Mt(e["!ref"]).e.r,s=Ke(o));for(var l=0;l<a.length;++l){var c=a[l];if(c.Name=="_xlnm._FilterDatabase"&&c.Sheet==n){c.Ref="'"+r.SheetNames[n]+"'!"+s;break}}l==a.length&&a.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+s}),K(t,161,Vi(Me(s))),K(t,162)}}function qF(t,e,r){K(t,133),K(t,137,NF(e,r)),K(t,138),K(t,134)}function KF(t,e){e["!protect"]&&K(t,535,LF(e["!protect"]))}function XF(t,e,r,n){var i=Ct(),s=r.SheetNames[t],a=r.Sheets[s]||{},o=s;try{r&&r.Workbook&&(o=r.Workbook.Sheets[t].CodeName||o)}catch{}var l=Me(a["!ref"]||"A1");if(l.e.c>16383||l.e.r>1048575){if(e.WTF)throw new Error("Range "+(a["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");l.e.c=Math.min(l.e.c,16383),l.e.r=Math.min(l.e.c,1048575)}return a["!links"]=[],a["!comments"]=[],K(i,129),(r.vbaraw||a["!outline"])&&K(i,147,HP(o,a["!outline"])),K(i,148,$P(l)),qF(i,a,r.Workbook),HF(i,a),BF(i,a,t,e),KF(i,a),zF(i,a,r,t),UF(i,a),VF(i,a,n),a["!margins"]&&K(i,476,PF(a["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&WF(i,a),GF(i,a,t,n),K(i,130),i.end()}function YF(t,e){t.l+=10;var r=gt(t);return{name:r}}var JF=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]];function QF(t){return!t.Workbook||!t.Workbook.WBProps?"false":kk(t.Workbook.WBProps.date1904)?"true":"false"}var ZF="][*?/\\".split("");function rv(t,e){if(t.length>31){if(e)return!1;throw new Error("Sheet names cannot exceed 31 chars")}var r=!0;return ZF.forEach(function(n){if(t.indexOf(n)!=-1){if(!e)throw new Error("Sheet name cannot contain : \\ / ? * [ ]");r=!1}}),r}function e3(t,e,r){t.forEach(function(n,i){rv(n);for(var s=0;s<i;++s)if(n==t[s])throw new Error("Duplicate Sheet Name: "+n);if(r){var a=e&&e[i]&&e[i].CodeName||n;if(a.charCodeAt(0)==95&&a.length>22)throw new Error("Bad Code Name: Worksheet"+a)}})}function t3(t){if(!t||!t.SheetNames||!t.Sheets)throw new Error("Invalid Workbook");if(!t.SheetNames.length)throw new Error("Workbook is empty");var e=t.Workbook&&t.Workbook.Sheets||[];e3(t.SheetNames,e,!!t.vbaraw);for(var r=0;r<t.SheetNames.length;++r)bP(t.Sheets[t.SheetNames[r]],t.SheetNames[r],r)}function nv(t){var e=[Xe];e[e.length]=ee("workbook",null,{xmlns:Hi[0],"xmlns:r":Ze.r});var r=t.Workbook&&(t.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};t.Workbook&&t.Workbook.WBProps&&(JF.forEach(function(o){t.Workbook.WBProps[o[0]]!=null&&t.Workbook.WBProps[o[0]]!=o[1]&&(n[o[0]]=t.Workbook.WBProps[o[0]])}),t.Workbook.WBProps.CodeName&&(n.codeName=t.Workbook.WBProps.CodeName,delete n.CodeName)),e[e.length]=ee("workbookPr",null,n);var i=t.Workbook&&t.Workbook.Sheets||[],s=0;if(i&&i[0]&&i[0].Hidden){for(e[e.length]="<bookViews>",s=0;s!=t.SheetNames.length&&!(!i[s]||!i[s].Hidden);++s);s==t.SheetNames.length&&(s=0),e[e.length]='<workbookView firstSheet="'+s+'" activeTab="'+s+'"/>',e[e.length]="</bookViews>"}for(e[e.length]="<sheets>",s=0;s!=t.SheetNames.length;++s){var a={name:ke(t.SheetNames[s].slice(0,31))};if(a.sheetId=""+(s+1),a["r:id"]="rId"+(s+1),i[s])switch(i[s].Hidden){case 1:a.state="hidden";break;case 2:a.state="veryHidden";break}e[e.length]=ee("sheet",null,a)}return e[e.length]="</sheets>",r&&(e[e.length]="<definedNames>",t.Workbook&&t.Workbook.Names&&t.Workbook.Names.forEach(function(o){var l={name:o.Name};o.Comment&&(l.comment=o.Comment),o.Sheet!=null&&(l.localSheetId=""+o.Sheet),o.Hidden&&(l.hidden="1"),o.Ref&&(e[e.length]=ee("definedName",ke(o.Ref),l))}),e[e.length]="</definedNames>"),e.length>2&&(e[e.length]="</workbook>",e[1]=e[1].replace("/>",">")),e.join("")}function r3(t,e){var r={};return r.Hidden=t.read_shift(4),r.iTabID=t.read_shift(4),r.strRelID=mc(t),r.name=gt(t),r}function n3(t,e){return e||(e=G(127)),e.write_shift(4,t.Hidden),e.write_shift(4,t.iTabID),ku(t.strRelID,e),tt(t.name.slice(0,31),e),e.length>e.l?e.slice(0,e.l):e}function i3(t,e){var r={},n=t.read_shift(4);r.defaultThemeVersion=t.read_shift(4);var i=e>8?gt(t):"";return i.length>0&&(r.CodeName=i),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function s3(t,e){e||(e=G(72));var r=0;return t&&t.filterPrivacy&&(r|=8),e.write_shift(4,r),e.write_shift(4,0),mg(t&&t.CodeName||"ThisWorkbook",e),e.slice(0,e.l)}function a3(t,e,r){var n=t.l+e;t.l+=4,t.l+=1;var i=t.read_shift(4),s=Qk(t),a=vP(t,0,r),o=Iu(t);t.l=n;var l={Name:s,Ptg:a};return i<268435455&&(l.Sheet=i),o&&(l.Comment=o),l}function o3(t,e){K(t,143);for(var r=0;r!=e.SheetNames.length;++r){var n=e.Workbook&&e.Workbook.Sheets&&e.Workbook.Sheets[r]&&e.Workbook.Sheets[r].Hidden||0,i={Hidden:n,iTabID:r+1,strRelID:"rId"+(r+1),name:e.SheetNames[r]};K(t,156,n3(i))}K(t,144)}function l3(t,e){e||(e=G(127));for(var r=0;r!=4;++r)e.write_shift(4,0);return tt("SheetJS",e),tt(Ka.version,e),tt(Ka.version,e),tt("7262",e),e.length>e.l?e.slice(0,e.l):e}function c3(t,e){e||(e=G(29)),e.write_shift(-4,0),e.write_shift(-4,460),e.write_shift(4,28800),e.write_shift(4,17600),e.write_shift(4,500),e.write_shift(4,t),e.write_shift(4,t);var r=120;return e.write_shift(1,r),e.length>e.l?e.slice(0,e.l):e}function u3(t,e){if(!(!e.Workbook||!e.Workbook.Sheets)){for(var r=e.Workbook.Sheets,n=0,i=-1,s=-1;n<r.length;++n)!r[n]||!r[n].Hidden&&i==-1?i=n:r[n].Hidden==1&&s==-1&&(s=n);s>i||(K(t,135),K(t,158,c3(i)),K(t,136))}}function f3(t,e){var r=Ct();return K(r,131),K(r,128,l3()),K(r,153,s3(t.Workbook&&t.Workbook.WBProps||null)),u3(r,t),o3(r,t),K(r,132),r.end()}function h3(t,e,r){return(e.slice(-4)===".bin"?f3:nv)(t)}function d3(t,e,r,n,i){return(e.slice(-4)===".bin"?XF:ev)(t,r,n,i)}function p3(t,e,r){return(e.slice(-4)===".bin"?P4:$g)(t,r)}function m3(t,e,r){return(e.slice(-4)===".bin"?s4:Dg)(t,r)}function g3(t,e,r){return(e.slice(-4)===".bin"?K4:Vg)(t)}function v3(t){return(t.slice(-4)===".bin"?B4:Hg)()}function x3(t,e){var r=[];return t.Props&&r.push(pO(t.Props,e)),t.Custprops&&r.push(mO(t.Props,t.Custprops)),r.join("")}function y3(){return""}function w3(t,e){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return e.cellXfs.forEach(function(n,i){var s=[];s.push(ee("NumberFormat",null,{"ss:Format":ke(Ve[n.numFmtId])}));var a={"ss:ID":"s"+(21+i)};r.push(ee("Style",s.join(""),a))}),ee("Styles",r.join(""))}function iv(t){return ee("NamedRange",null,{"ss:Name":t.Name,"ss:RefersTo":"="+Fu(t.Ref,{r:0,c:0})})}function _3(t){if(!((t||{}).Workbook||{}).Names)return"";for(var e=t.Workbook.Names,r=[],n=0;n<e.length;++n){var i=e[n];i.Sheet==null&&(i.Name.match(/^_xlfn\./)||r.push(iv(i)))}return ee("Names",r.join(""))}function E3(t,e,r,n){if(!t||!((n||{}).Workbook||{}).Names)return"";for(var i=n.Workbook.Names,s=[],a=0;a<i.length;++a){var o=i[a];o.Sheet==r&&(o.Name.match(/^_xlfn\./)||s.push(iv(o)))}return s.join("")}function b3(t,e,r,n){if(!t)return"";var i=[];if(t["!margins"]&&(i.push("<PageSetup>"),t["!margins"].header&&i.push(ee("Header",null,{"x:Margin":t["!margins"].header})),t["!margins"].footer&&i.push(ee("Footer",null,{"x:Margin":t["!margins"].footer})),i.push(ee("PageMargins",null,{"x:Bottom":t["!margins"].bottom||"0.75","x:Left":t["!margins"].left||"0.7","x:Right":t["!margins"].right||"0.7","x:Top":t["!margins"].top||"0.75"})),i.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[r])if(n.Workbook.Sheets[r].Hidden)i.push(ee("Visible",n.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var s=0;s<r&&!(n.Workbook.Sheets[s]&&!n.Workbook.Sheets[s].Hidden);++s);s==r&&i.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&i.push("<DisplayRightToLeft/>"),t["!protect"]&&(i.push(lt("ProtectContents","True")),t["!protect"].objects&&i.push(lt("ProtectObjects","True")),t["!protect"].scenarios&&i.push(lt("ProtectScenarios","True")),t["!protect"].selectLockedCells!=null&&!t["!protect"].selectLockedCells?i.push(lt("EnableSelection","NoSelection")):t["!protect"].selectUnlockedCells!=null&&!t["!protect"].selectUnlockedCells&&i.push(lt("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(a){t["!protect"][a[0]]&&i.push("<"+a[1]+"/>")})),i.length==0?"":ee("WorksheetOptions",i.join(""),{xmlns:Ft.x})}function T3(t){return t.map(function(e){var r=Ik(e.t||""),n=ee("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return ee("Comment",n,{"ss:Author":e.a})}).join("")}function S3(t,e,r,n,i,s,a){if(!t||t.v==null&&t.f==null)return"";var o={};if(t.f&&(o["ss:Formula"]="="+ke(Fu(t.f,a))),t.F&&t.F.slice(0,e.length)==e){var l=et(t.F.slice(e.length+1));o["ss:ArrayRange"]="RC:R"+(l.r==a.r?"":"["+(l.r-a.r)+"]")+"C"+(l.c==a.c?"":"["+(l.c-a.c)+"]")}if(t.l&&t.l.Target&&(o["ss:HRef"]=ke(t.l.Target),t.l.Tooltip&&(o["x:HRefScreenTip"]=ke(t.l.Tooltip))),r["!merges"])for(var c=r["!merges"],u=0;u!=c.length;++u)c[u].s.c!=a.c||c[u].s.r!=a.r||(c[u].e.c>c[u].s.c&&(o["ss:MergeAcross"]=c[u].e.c-c[u].s.c),c[u].e.r>c[u].s.r&&(o["ss:MergeDown"]=c[u].e.r-c[u].s.r));var f="",d="";switch(t.t){case"z":if(!n.sheetStubs)return"";break;case"n":f="Number",d=String(t.v);break;case"b":f="Boolean",d=t.v?"1":"0";break;case"e":f="Error",d=Ys[t.v];break;case"d":f="DateTime",d=new Date(t.v).toISOString(),t.z==null&&(t.z=t.z||Ve[14]);break;case"s":f="String",d=Ck(t.v||"");break}var h=yn(n.cellXfs,t,n);o["ss:StyleID"]="s"+(21+h),o["ss:Index"]=a.c+1;var m=t.v!=null?d:"",p=t.t=="z"?"":'<Data ss:Type="'+f+'">'+m+"</Data>";return(t.c||[]).length>0&&(p+=T3(t.c)),ee("Cell",p,o)}function A3(t,e){var r='<Row ss:Index="'+(t+1)+'"';return e&&(e.hpt&&!e.hpx&&(e.hpx=jg(e.hpt)),e.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+e.hpx+'"'),e.hidden&&(r+=' ss:Hidden="1"')),r+">"}function C3(t,e,r,n){if(!t["!ref"])return"";var i=Me(t["!ref"]),s=t["!merges"]||[],a=0,o=[];t["!cols"]&&t["!cols"].forEach(function(g,w){Ru(g);var b=!!g.width,_=jo(w,g),k={"ss:Index":w+1};b&&(k["ss:Width"]=no(_.width)),g.hidden&&(k["ss:Hidden"]="1"),o.push(ee("Column",null,k))});for(var l=Array.isArray(t),c=i.s.r;c<=i.e.r;++c){for(var u=[A3(c,(t["!rows"]||[])[c])],f=i.s.c;f<=i.e.c;++f){var d=!1;for(a=0;a!=s.length;++a)if(!(s[a].s.c>f)&&!(s[a].s.r>c)&&!(s[a].e.c<f)&&!(s[a].e.r<c)){(s[a].s.c!=f||s[a].s.r!=c)&&(d=!0);break}if(!d){var h={r:c,c:f},m=Oe(h),p=l?(t[c]||[])[f]:t[m];u.push(S3(p,m,t,e,r,n,h))}}u.push("</Row>"),u.length>2&&o.push(u.join(""))}return o.join("")}function I3(t,e,r){var n=[],i=r.SheetNames[t],s=r.Sheets[i],a=s?E3(s,e,t,r):"";return a.length>0&&n.push("<Names>"+a+"</Names>"),a=s?C3(s,e,t,r):"",a.length>0&&n.push("<Table>"+a+"</Table>"),n.push(b3(s,e,t,r)),n.join("")}function k3(t,e){e||(e={}),t.SSF||(t.SSF=kt(Ve)),t.SSF&&(Fo(),Po(t.SSF),e.revssf=No(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF,e.cellXfs=[],yn(e.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(x3(t,e)),r.push(y3()),r.push(""),r.push("");for(var n=0;n<t.SheetNames.length;++n)r.push(ee("Worksheet",I3(n,e,t),{"ss:Name":ke(t.SheetNames[n])}));return r[2]=w3(t,e),r[3]=_3(t),Xe+ee("Workbook",r.join(""),{xmlns:Ft.ss,"xmlns:o":Ft.o,"xmlns:x":Ft.x,"xmlns:ss":Ft.ss,"xmlns:dt":Ft.dt,"xmlns:html":Ft.html})}var bl={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function O3(t,e){var r=[],n=[],i=[],s=0,a,o=$h(Qh,"n"),l=$h(Zh,"n");if(t.Props)for(a=ut(t.Props),s=0;s<a.length;++s)(Object.prototype.hasOwnProperty.call(o,a[s])?r:Object.prototype.hasOwnProperty.call(l,a[s])?n:i).push([a[s],t.Props[a[s]]]);if(t.Custprops)for(a=ut(t.Custprops),s=0;s<a.length;++s)Object.prototype.hasOwnProperty.call(t.Props||{},a[s])||(Object.prototype.hasOwnProperty.call(o,a[s])?r:Object.prototype.hasOwnProperty.call(l,a[s])?n:i).push([a[s],t.Custprops[a[s]]]);var c=[];for(s=0;s<i.length;++s)Ig.indexOf(i[s][0])>-1||Sg.indexOf(i[s][0])>-1||i[s][1]!=null&&c.push(i[s]);n.length&&Pe.utils.cfb_add(e,"/SummaryInformation",i0(n,bl.SI,l,Zh)),(r.length||c.length)&&Pe.utils.cfb_add(e,"/DocumentSummaryInformation",i0(r,bl.DSI,o,Qh,c.length?c:null,bl.UDI))}function R3(t,e){var r=e||{},n=Pe.utils.cfb_new({root:"R"}),i="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":i="/Workbook",r.biff=8;break;case"biff5":i="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return Pe.utils.cfb_add(n,i,sv(t,r)),r.biff==8&&(t.Props||t.Custprops)&&O3(t,n),r.biff==8&&t.vbaraw&&X4(n,Pe.read(t.vbaraw,{type:typeof t.vbaraw=="string"?"binary":"buffer"})),n}var P3={0:{f:DP},1:{f:WP},2:{f:cF},3:{f:JP},4:{f:qP},5:{f:sF},6:{f:pF},7:{f:tF},8:{f:_F},9:{f:wF},10:{f:xF},11:{f:yF},12:{f:GP},13:{f:fF},14:{f:ZP},15:{f:XP},16:{f:oF},17:{f:gF},18:{f:nF},19:{f:Cu},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:a3},40:{},42:{},43:{f:p4},44:{f:h4},45:{f:v4},46:{f:y4},47:{f:x4},48:{},49:{f:Gk},50:{},51:{f:D4},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:zO},62:{f:dF},63:{f:U4},64:{f:MF},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:mr,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:FF},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:UP},148:{f:jP,p:16},151:{f:CF},152:{},153:{f:i3},154:{},155:{},156:{f:r3},157:{},158:{},159:{T:1,f:r4},160:{T:-1},161:{T:1,f:ii},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:EF},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:F4},336:{T:-1},337:{f:j4,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:mc},357:{},358:{},359:{},360:{T:1},361:{},362:{f:BO},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:IF},427:{f:kF},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:RF},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:BP},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:SF},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:mc},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:z4},633:{T:1},634:{T:-1},635:{T:1,f:V4},636:{T:-1},637:{f:Xk},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:YF},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:jF},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}};function te(t,e,r,n){var i=e;if(!isNaN(i)){var s=n||(r||[]).length||0,a=t.next(4);a.write_shift(2,i),a.write_shift(2,s),s>0&&Tu(r)&&t.push(r)}}function F3(t,e,r,n){var i=n||(r||[]).length||0;if(i<=8224)return te(t,e,r,i);var s=e;if(!isNaN(s)){for(var a=r.parts||[],o=0,l=0,c=0;c+(a[o]||8224)<=8224;)c+=a[o]||8224,o++;var u=t.next(4);for(u.write_shift(2,s),u.write_shift(2,c),t.push(r.slice(l,l+c)),l+=c;l<i;){for(u=t.next(4),u.write_shift(2,60),c=0;c+(a[o]||8224)<=8224;)c+=a[o]||8224,o++;u.write_shift(2,c),t.push(r.slice(l,l+c)),l+=c}}}function Qs(t,e,r){return t||(t=G(7)),t.write_shift(2,e),t.write_shift(2,r),t.write_shift(2,0),t.write_shift(1,0),t}function N3(t,e,r,n){var i=G(9);return Qs(i,t,e),Og(r,n||"b",i),i}function D3(t,e,r){var n=G(8+2*r.length);return Qs(n,t,e),n.write_shift(1,r.length),n.write_shift(r.length,r,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function L3(t,e,r,n){if(e.v!=null)switch(e.t){case"d":case"n":var i=e.t=="d"?It(Et(e.v)):e.v;i==(i|0)&&i>=0&&i<65536?te(t,2,YO(r,n,i)):te(t,3,XO(r,n,i));return;case"b":case"e":te(t,5,N3(r,n,e.v,e.t));return;case"s":case"str":te(t,4,D3(r,n,(e.v||"").slice(0,255)));return}te(t,1,Qs(null,r,n))}function M3(t,e,r,n){var i=Array.isArray(e),s=Me(e["!ref"]||"A1"),a,o="",l=[];if(s.e.c>255||s.e.r>16383){if(n.WTF)throw new Error("Range "+(e["!ref"]||"A1")+" exceeds format limit A1:IV16384");s.e.c=Math.min(s.e.c,255),s.e.r=Math.min(s.e.c,16383),a=Ke(s)}for(var c=s.s.r;c<=s.e.r;++c){o=ct(c);for(var u=s.s.c;u<=s.e.c;++u){c===s.s.r&&(l[u]=mt(u)),a=l[u]+o;var f=i?(e[c]||[])[u]:e[a];f&&L3(t,f,c,u)}}}function j3(t,e){for(var r=e||{},n=Ct(),i=0,s=0;s<t.SheetNames.length;++s)t.SheetNames[s]==r.sheet&&(i=s);if(i==0&&r.sheet&&t.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return te(n,r.biff==4?1033:r.biff==3?521:9,Ou(t,16,r)),M3(n,t.Sheets[t.SheetNames[i]],i,r),te(n,10),n.end()}function $3(t,e,r){te(t,49,PO({sz:12,color:{theme:1},name:"Arial",family:2,scheme:"minor"},r))}function B3(t,e,r){e&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)e[i]!=null&&te(t,1054,DO(i,e[i],r))})}function U3(t,e){var r=G(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),te(t,2151,r),r=G(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),Fg(Me(e["!ref"]||"A1"),r),r.write_shift(4,4),te(t,2152,r)}function H3(t,e){for(var r=0;r<16;++r)te(t,224,a0({numFmtId:0,style:!0},0,e));e.cellXfs.forEach(function(n){te(t,224,a0(n,0,e))})}function W3(t,e){for(var r=0;r<e["!links"].length;++r){var n=e["!links"][r];te(t,440,WO(n)),n[1].Tooltip&&te(t,2048,VO(n))}delete e["!links"]}function V3(t,e){if(e){var r=0;e.forEach(function(n,i){++r<=256&&n&&te(t,125,qO(jo(i,n),i))})}}function G3(t,e,r,n,i){var s=16+yn(i.cellXfs,e,i);if(e.v==null&&!e.bf){te(t,513,Yn(r,n,s));return}if(e.bf)te(t,6,mP(e,r,n,i,s));else switch(e.t){case"d":case"n":var a=e.t=="d"?It(Et(e.v)):e.v;te(t,515,$O(r,n,a,s));break;case"b":case"e":te(t,517,jO(r,n,e.v,s,i,e.t));break;case"s":case"str":if(i.bookSST){var o=Du(i.Strings,e.v,i.revStrings);te(t,253,FO(r,n,o,s))}else te(t,516,NO(r,n,(e.v||"").slice(0,255),s,i));break;default:te(t,513,Yn(r,n,s))}}function z3(t,e,r){var n=Ct(),i=r.SheetNames[t],s=r.Sheets[i]||{},a=(r||{}).Workbook||{},o=(a.Sheets||[])[t]||{},l=Array.isArray(s),c=e.biff==8,u,f="",d=[],h=Me(s["!ref"]||"A1"),m=c?65536:16384;if(h.e.c>255||h.e.r>=m){if(e.WTF)throw new Error("Range "+(s["!ref"]||"A1")+" exceeds format limit A1:IV16384");h.e.c=Math.min(h.e.c,255),h.e.r=Math.min(h.e.c,m-1)}te(n,2057,Ou(r,16,e)),te(n,13,Ht(1)),te(n,12,Ht(100)),te(n,15,yt(!0)),te(n,17,yt(!1)),te(n,16,Xn(.001)),te(n,95,yt(!0)),te(n,42,yt(!1)),te(n,43,yt(!1)),te(n,130,Ht(1)),te(n,128,MO([0,0])),te(n,131,yt(!1)),te(n,132,yt(!1)),c&&V3(n,s["!cols"]),te(n,512,LO(h,e)),c&&(s["!links"]=[]);for(var p=h.s.r;p<=h.e.r;++p){f=ct(p);for(var g=h.s.c;g<=h.e.c;++g){p===h.s.r&&(d[g]=mt(g)),u=d[g]+f;var w=l?(s[p]||[])[g]:s[u];w&&(G3(n,w,p,g,e),c&&w.l&&s["!links"].push([u,w.l]))}}var b=o.CodeName||o.name||i;return c&&te(n,574,RO((a.Views||[])[0])),c&&(s["!merges"]||[]).length&&te(n,229,HO(s["!merges"])),c&&W3(n,s),te(n,442,Pg(b)),c&&U3(n,s),te(n,10),n.end()}function q3(t,e,r){var n=Ct(),i=(t||{}).Workbook||{},s=i.Sheets||[],a=i.WBProps||{},o=r.biff==8,l=r.biff==5;if(te(n,2057,Ou(t,5,r)),r.bookType=="xla"&&te(n,135),te(n,225,o?Ht(1200):null),te(n,193,xO(2)),l&&te(n,191),l&&te(n,192),te(n,226),te(n,92,CO("SheetJS",r)),te(n,66,Ht(o?1200:1252)),o&&te(n,353,Ht(0)),o&&te(n,448),te(n,317,KO(t.SheetNames.length)),o&&t.vbaraw&&te(n,211),o&&t.vbaraw){var c=a.CodeName||"ThisWorkbook";te(n,442,Pg(c))}te(n,156,Ht(17)),te(n,25,yt(!1)),te(n,18,yt(!1)),te(n,19,Ht(0)),o&&te(n,431,yt(!1)),o&&te(n,444,Ht(0)),te(n,61,OO()),te(n,64,yt(!1)),te(n,141,Ht(0)),te(n,34,yt(QF(t)=="true")),te(n,14,yt(!0)),o&&te(n,439,yt(!1)),te(n,218,Ht(0)),$3(n,t,r),B3(n,t.SSF,r),H3(n,r),o&&te(n,352,yt(!1));var u=n.end(),f=Ct();o&&te(f,140,GO()),o&&r.Strings&&F3(f,252,kO(r.Strings)),te(f,10);var d=f.end(),h=Ct(),m=0,p=0;for(p=0;p<t.SheetNames.length;++p)m+=(o?12:11)+(o?2:1)*t.SheetNames[p].length;var g=u.length+m+d.length;for(p=0;p<t.SheetNames.length;++p){var w=s[p]||{};te(h,133,IO({pos:g,hs:w.Hidden||0,dt:0,name:t.SheetNames[p]},r)),g+=e[p].length}var b=h.end();if(m!=b.length)throw new Error("BS8 "+m+" != "+b.length);var _=[];return u.length&&_.push(u),b.length&&_.push(b),d.length&&_.push(d),ot(_)}function K3(t,e){var r=e||{},n=[];t&&!t.SSF&&(t.SSF=kt(Ve)),t&&t.SSF&&(Fo(),Po(t.SSF),r.revssf=No(t.SSF),r.revssf[t.SSF[65535]]=0,r.ssf=t.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,Lu(r),r.cellXfs=[],yn(r.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={});for(var i=0;i<t.SheetNames.length;++i)n[n.length]=z3(i,r,t);return n.unshift(q3(t,n,r)),ot(n)}function sv(t,e){for(var r=0;r<=t.SheetNames.length;++r){var n=t.Sheets[t.SheetNames[r]];if(!(!n||!n["!ref"])){var i=Mt(n["!ref"]);i.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+t.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var s=e||{};switch(s.biff||2){case 8:case 5:return K3(t,e);case 4:case 3:case 2:return j3(t,e)}throw new Error("invalid type "+s.bookType+" for BIFF")}function X3(t,e,r,n){for(var i=t["!merges"]||[],s=[],a=e.s.c;a<=e.e.c;++a){for(var o=0,l=0,c=0;c<i.length;++c)if(!(i[c].s.r>r||i[c].s.c>a)&&!(i[c].e.r<r||i[c].e.c<a)){if(i[c].s.r<r||i[c].s.c<a){o=-1;break}o=i[c].e.r-i[c].s.r+1,l=i[c].e.c-i[c].s.c+1;break}if(!(o<0)){var u=Oe({r,c:a}),f=n.dense?(t[r]||[])[a]:t[u],d=f&&f.v!=null&&(f.h||Ak(f.w||(Ur(f),f.w)||""))||"",h={};o>1&&(h.rowspan=o),l>1&&(h.colspan=l),n.editable?d='<span contenteditable="true">'+d+"</span>":f&&(h["data-t"]=f&&f.t||"z",f.v!=null&&(h["data-v"]=f.v),f.z!=null&&(h["data-z"]=f.z),f.l&&(f.l.Target||"#").charAt(0)!="#"&&(d='<a href="'+f.l.Target+'">'+d+"</a>")),h.id=(n.id||"sjs")+"-"+u,s.push(ee("td",d,h))}}var m="<tr>";return m+s.join("")+"</tr>"}var Y3='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',J3="</body></html>";function Q3(t,e,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function av(t,e){var r=e||{},n=r.header!=null?r.header:Y3,i=r.footer!=null?r.footer:J3,s=[n],a=Mt(t["!ref"]);r.dense=Array.isArray(t),s.push(Q3(t,a,r));for(var o=a.s.r;o<=a.e.r;++o)s.push(X3(t,a,o,r));return s.push("</table>"+i),s.join("")}function ov(t,e,r){var n=r||{},i=0,s=0;if(n.origin!=null)if(typeof n.origin=="number")i=n.origin;else{var a=typeof n.origin=="string"?et(n.origin):n.origin;i=a.r,s=a.c}var o=e.getElementsByTagName("tr"),l=Math.min(n.sheetRows||1e7,o.length),c={s:{r:0,c:0},e:{r:i,c:s}};if(t["!ref"]){var u=Mt(t["!ref"]);c.s.r=Math.min(c.s.r,u.s.r),c.s.c=Math.min(c.s.c,u.s.c),c.e.r=Math.max(c.e.r,u.e.r),c.e.c=Math.max(c.e.c,u.e.c),i==-1&&(c.e.r=i=u.e.r+1)}var f=[],d=0,h=t["!rows"]||(t["!rows"]=[]),m=0,p=0,g=0,w=0,b=0,_=0;for(t["!cols"]||(t["!cols"]=[]);m<o.length&&p<l;++m){var k=o[m];if(d0(k)){if(n.display)continue;h[p]={hidden:!0}}var L=k.children;for(g=w=0;g<L.length;++g){var M=L[g];if(!(n.display&&d0(M))){var I=M.hasAttribute("data-v")?M.getAttribute("data-v"):M.hasAttribute("v")?M.getAttribute("v"):Ok(M.innerHTML),F=M.getAttribute("data-z")||M.getAttribute("z");for(d=0;d<f.length;++d){var R=f[d];R.s.c==w+s&&R.s.r<p+i&&p+i<=R.e.r&&(w=R.e.c+1-s,d=-1)}_=+M.getAttribute("colspan")||1,((b=+M.getAttribute("rowspan")||1)>1||_>1)&&f.push({s:{r:p+i,c:w+s},e:{r:p+i+(b||1)-1,c:w+s+(_||1)-1}});var N={t:"s",v:I},H=M.getAttribute("data-t")||M.getAttribute("t")||"";I!=null&&(I.length==0?N.t=H||"z":n.raw||I.trim().length==0||H=="s"||(I==="TRUE"?N={t:"b",v:!0}:I==="FALSE"?N={t:"b",v:!1}:isNaN(Fr(I))?isNaN(Is(I).getDate())||(N={t:"d",v:Et(I)},n.cellDates||(N={t:"n",v:It(N.v)}),N.z=n.dateNF||Ve[14]):N={t:"n",v:Fr(I)})),N.z===void 0&&F!=null&&(N.z=F);var q="",Y=M.getElementsByTagName("A");if(Y&&Y.length)for(var fe=0;fe<Y.length&&!(Y[fe].hasAttribute("href")&&(q=Y[fe].getAttribute("href"),q.charAt(0)!="#"));++fe);q&&q.charAt(0)!="#"&&(N.l={Target:q}),n.dense?(t[p+i]||(t[p+i]=[]),t[p+i][w+s]=N):t[Oe({c:w+s,r:p+i})]=N,c.e.c<w+s&&(c.e.c=w+s),w+=_}}++p}return f.length&&(t["!merges"]=(t["!merges"]||[]).concat(f)),c.e.r=Math.max(c.e.r,p-1+i),t["!ref"]=Ke(c),p>=l&&(t["!fullref"]=Ke((c.e.r=o.length-m+p-1+i,c))),t}function lv(t,e){var r=e||{},n=r.dense?[]:{};return ov(n,t,e)}function Z3(t,e){return ei(lv(t,e),e)}function d0(t){var e="",r=eN(t);return r&&(e=r(t).getPropertyValue("display")),e||(e=t.style&&t.style.display),e==="none"}function eN(t){return t.ownerDocument.defaultView&&typeof t.ownerDocument.defaultView.getComputedStyle=="function"?t.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}var tN=function(){var t=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),e="<office:document-styles "+ks({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+t+"</office:document-styles>";return function(){return Xe+e}}(),p0=function(){var t=function(s){return ke(s).replace(/  +/g,function(a){return'<text:s text:c="'+a.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},e=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,n=function(s,a,o){var l=[];l.push('      <table:table table:name="'+ke(a.SheetNames[o])+`" table:style-name="ta1">
`);var c=0,u=0,f=Mt(s["!ref"]||"A1"),d=s["!merges"]||[],h=0,m=Array.isArray(s);if(s["!cols"])for(u=0;u<=f.e.c;++u)l.push("        <table:table-column"+(s["!cols"][u]?' table:style-name="co'+s["!cols"][u].ods+'"':"")+`></table:table-column>
`);var p="",g=s["!rows"]||[];for(c=0;c<f.s.r;++c)p=g[c]?' table:style-name="ro'+g[c].ods+'"':"",l.push("        <table:table-row"+p+`></table:table-row>
`);for(;c<=f.e.r;++c){for(p=g[c]?' table:style-name="ro'+g[c].ods+'"':"",l.push("        <table:table-row"+p+`>
`),u=0;u<f.s.c;++u)l.push(e);for(;u<=f.e.c;++u){var w=!1,b={},_="";for(h=0;h!=d.length;++h)if(!(d[h].s.c>u)&&!(d[h].s.r>c)&&!(d[h].e.c<u)&&!(d[h].e.r<c)){(d[h].s.c!=u||d[h].s.r!=c)&&(w=!0),b["table:number-columns-spanned"]=d[h].e.c-d[h].s.c+1,b["table:number-rows-spanned"]=d[h].e.r-d[h].s.r+1;break}if(w){l.push(r);continue}var k=Oe({r:c,c:u}),L=m?(s[c]||[])[u]:s[k];if(L&&L.f&&(b["table:formula"]=ke(_P(L.f)),L.F&&L.F.slice(0,k.length)==k)){var M=Mt(L.F);b["table:number-matrix-columns-spanned"]=M.e.c-M.s.c+1,b["table:number-matrix-rows-spanned"]=M.e.r-M.s.r+1}if(!L){l.push(e);continue}switch(L.t){case"b":_=L.v?"TRUE":"FALSE",b["office:value-type"]="boolean",b["office:boolean-value"]=L.v?"true":"false";break;case"n":_=L.w||String(L.v||0),b["office:value-type"]="float",b["office:value"]=L.v||0;break;case"s":case"str":_=L.v==null?"":L.v,b["office:value-type"]="string";break;case"d":_=L.w||Et(L.v).toISOString(),b["office:value-type"]="date",b["office:date-value"]=Et(L.v).toISOString(),b["table:style-name"]="ce1";break;default:l.push(e);continue}var I=t(_);if(L.l&&L.l.Target){var F=L.l.Target;F=F.charAt(0)=="#"?"#"+EP(F.slice(1)):F,F.charAt(0)!="#"&&!F.match(/^\w+:/)&&(F="../"+F),I=ee("text:a",I,{"xlink:href":F.replace(/&/g,"&amp;")})}l.push("          "+ee("table:table-cell",ee("text:p",I,{}),b)+`
`)}l.push(`        </table:table-row>
`)}return l.push(`      </table:table>
`),l.join("")},i=function(s,a){s.push(` <office:automatic-styles>
`),s.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),s.push(`   <number:month number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:day number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:year/>
`),s.push(`  </number:date-style>
`);var o=0;a.SheetNames.map(function(c){return a.Sheets[c]}).forEach(function(c){if(c&&c["!cols"]){for(var u=0;u<c["!cols"].length;++u)if(c["!cols"][u]){var f=c["!cols"][u];if(f.width==null&&f.wpx==null&&f.wch==null)continue;Ru(f),f.ods=o;var d=c["!cols"][u].wpx+"px";s.push('  <style:style style:name="co'+o+`" style:family="table-column">
`),s.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+d+`"/>
`),s.push(`  </style:style>
`),++o}}});var l=0;a.SheetNames.map(function(c){return a.Sheets[c]}).forEach(function(c){if(c&&c["!rows"]){for(var u=0;u<c["!rows"].length;++u)if(c["!rows"][u]){c["!rows"][u].ods=l;var f=c["!rows"][u].hpx+"px";s.push('  <style:style style:name="ro'+l+`" style:family="table-row">
`),s.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+f+`"/>
`),s.push(`  </style:style>
`),++l}}}),s.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),s.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),s.push(`  </style:style>
`),s.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),s.push(` </office:automatic-styles>
`)};return function(a,o){var l=[Xe],c=ks({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),u=ks({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});o.bookType=="fods"?(l.push("<office:document"+c+u+`>
`),l.push(bg().replace(/office:document-meta/g,"office:meta"))):l.push("<office:document-content"+c+`>
`),i(l,a),l.push(`  <office:body>
`),l.push(`    <office:spreadsheet>
`);for(var f=0;f!=a.SheetNames.length;++f)l.push(n(a.Sheets[a.SheetNames[f]],a,f));return l.push(`    </office:spreadsheet>
`),l.push(`  </office:body>
`),o.bookType=="fods"?l.push("</office:document>"):l.push("</office:document-content>"),l.join("")}}();function cv(t,e){if(e.bookType=="fods")return p0(t,e);var r=wu(),n="",i=[],s=[];return n="mimetype",ye(r,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",ye(r,n,p0(t,e)),i.push([n,"text/xml"]),s.push([n,"ContentFile"]),n="styles.xml",ye(r,n,tN(t,e)),i.push([n,"text/xml"]),s.push([n,"StylesFile"]),n="meta.xml",ye(r,n,Xe+bg()),i.push([n,"text/xml"]),s.push([n,"MetadataFile"]),n="manifest.rdf",ye(r,n,dO(s)),i.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",ye(r,n,fO(i)),r}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function ao(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function rN(t){return typeof TextEncoder<"u"?new TextEncoder().encode(t):Jt(Or(t))}function nN(t,e){e:for(var r=0;r<=t.length-e.length;++r){for(var n=0;n<e.length;++n)if(t[r+n]!=e[n])continue e;return!0}return!1}function pn(t){var e=t.reduce(function(i,s){return i+s.length},0),r=new Uint8Array(e),n=0;return t.forEach(function(i){r.set(i,n),n+=i.length}),r}function iN(t,e,r){var n=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,i=r/Math.pow(10,n-6176);t[e+15]|=n>>7,t[e+14]|=(n&127)<<1;for(var s=0;i>=1;++s,i/=256)t[e+s]=i&255;t[e+15]|=r>=0?0:128}function Os(t,e){var r=e?e[0]:0,n=t[r]&127;e:if(t[r++]>=128&&(n|=(t[r]&127)<<7,t[r++]<128||(n|=(t[r]&127)<<14,t[r++]<128)||(n|=(t[r]&127)<<21,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,28),++r,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,35),++r,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,42),++r,t[r++]<128)))break e;return e&&(e[0]=r),n}function Ce(t){var e=new Uint8Array(7);e[0]=t&127;var r=1;e:if(t>127){if(e[r-1]|=128,e[r]=t>>7&127,++r,t<=16383||(e[r-1]|=128,e[r]=t>>14&127,++r,t<=2097151)||(e[r-1]|=128,e[r]=t>>21&127,++r,t<=268435455)||(e[r-1]|=128,e[r]=t/256>>>21&127,++r,t<=34359738367)||(e[r-1]|=128,e[r]=t/65536>>>21&127,++r,t<=4398046511103))break e;e[r-1]|=128,e[r]=t/16777216>>>21&127,++r}return e.slice(0,r)}function Ii(t){var e=0,r=t[e]&127;e:if(t[e++]>=128){if(r|=(t[e]&127)<<7,t[e++]<128||(r|=(t[e]&127)<<14,t[e++]<128)||(r|=(t[e]&127)<<21,t[e++]<128))break e;r|=(t[e]&127)<<28}return r}function Ye(t){for(var e=[],r=[0];r[0]<t.length;){var n=r[0],i=Os(t,r),s=i&7;i=Math.floor(i/8);var a=0,o;if(i==0)break;switch(s){case 0:{for(var l=r[0];t[r[0]++]>=128;);o=t.slice(l,r[0])}break;case 5:a=4,o=t.slice(r[0],r[0]+a),r[0]+=a;break;case 1:a=8,o=t.slice(r[0],r[0]+a),r[0]+=a;break;case 2:a=Os(t,r),o=t.slice(r[0],r[0]+a),r[0]+=a;break;case 3:case 4:default:throw new Error("PB Type ".concat(s," for Field ").concat(i," at offset ").concat(n))}var c={data:o,type:s};e[i]==null?e[i]=[c]:e[i].push(c)}return e}function nt(t){var e=[];return t.forEach(function(r,n){r.forEach(function(i){i.data&&(e.push(Ce(n*8+i.type)),i.type==2&&e.push(Ce(i.data.length)),e.push(i.data))})}),pn(e)}function qt(t){for(var e,r=[],n=[0];n[0]<t.length;){var i=Os(t,n),s=Ye(t.slice(n[0],n[0]+i));n[0]+=i;var a={id:Ii(s[1][0].data),messages:[]};s[2].forEach(function(o){var l=Ye(o.data),c=Ii(l[3][0].data);a.messages.push({meta:l,data:t.slice(n[0],n[0]+c)}),n[0]+=c}),(e=s[3])!=null&&e[0]&&(a.merge=Ii(s[3][0].data)>>>0>0),r.push(a)}return r}function li(t){var e=[];return t.forEach(function(r){var n=[];n[1]=[{data:Ce(r.id),type:0}],n[2]=[],r.merge!=null&&(n[3]=[{data:Ce(+!!r.merge),type:0}]);var i=[];r.messages.forEach(function(a){i.push(a.data),a.meta[3]=[{type:0,data:Ce(a.data.length)}],n[2].push({data:nt(a.meta),type:2})});var s=nt(n);e.push(Ce(s.length)),e.push(s),i.forEach(function(a){return e.push(a)})}),pn(e)}function sN(t,e){if(t!=0)throw new Error("Unexpected Snappy chunk type ".concat(t));for(var r=[0],n=Os(e,r),i=[];r[0]<e.length;){var s=e[r[0]]&3;if(s==0){var a=e[r[0]++]>>2;if(a<60)++a;else{var o=a-59;a=e[r[0]],o>1&&(a|=e[r[0]+1]<<8),o>2&&(a|=e[r[0]+2]<<16),o>3&&(a|=e[r[0]+3]<<24),a>>>=0,a++,r[0]+=o}i.push(e.slice(r[0],r[0]+a)),r[0]+=a;continue}else{var l=0,c=0;if(s==1?(c=(e[r[0]]>>2&7)+4,l=(e[r[0]++]&224)<<3,l|=e[r[0]++]):(c=(e[r[0]++]>>2)+1,s==2?(l=e[r[0]]|e[r[0]+1]<<8,r[0]+=2):(l=(e[r[0]]|e[r[0]+1]<<8|e[r[0]+2]<<16|e[r[0]+3]<<24)>>>0,r[0]+=4)),i=[pn(i)],l==0)throw new Error("Invalid offset 0");if(l>i[0].length)throw new Error("Invalid offset beyond length");if(c>=l)for(i.push(i[0].slice(-l)),c-=l;c>=i[i.length-1].length;)i.push(i[i.length-1]),c-=i[i.length-1].length;i.push(i[0].slice(-l,-l+c))}}var u=pn(i);if(u.length!=n)throw new Error("Unexpected length: ".concat(u.length," != ").concat(n));return u}function Kt(t){for(var e=[],r=0;r<t.length;){var n=t[r++],i=t[r]|t[r+1]<<8|t[r+2]<<16;r+=3,e.push(sN(n,t.slice(r,r+i))),r+=i}if(r!==t.length)throw new Error("data is not a valid framed stream!");return pn(e)}function ci(t){for(var e=[],r=0;r<t.length;){var n=Math.min(t.length-r,268435455),i=new Uint8Array(4);e.push(i);var s=Ce(n),a=s.length;e.push(s),n<=60?(a++,e.push(new Uint8Array([n-1<<2]))):n<=256?(a+=2,e.push(new Uint8Array([240,n-1&255]))):n<=65536?(a+=3,e.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(a+=4,e.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(a+=5,e.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),e.push(t.slice(r,r+n)),a+=n,i[0]=0,i[1]=a&255,i[2]=a>>8&255,i[3]=a>>16&255,r+=n}return pn(e)}function Tl(t,e){var r=new Uint8Array(32),n=ao(r),i=12,s=0;switch(r[0]=5,t.t){case"n":r[1]=2,iN(r,i,t.v),s|=1,i+=16;break;case"b":r[1]=6,n.setFloat64(i,t.v?1:0,!0),s|=2,i+=8;break;case"s":if(e.indexOf(t.v)==-1)throw new Error("Value ".concat(t.v," missing from SST!"));r[1]=3,n.setUint32(i,e.indexOf(t.v),!0),s|=8,i+=4;break;default:throw"unsupported cell type "+t.t}return n.setUint32(8,s,!0),r.slice(0,i)}function Sl(t,e){var r=new Uint8Array(32),n=ao(r),i=12,s=0;switch(r[0]=3,t.t){case"n":r[2]=2,n.setFloat64(i,t.v,!0),s|=32,i+=8;break;case"b":r[2]=6,n.setFloat64(i,t.v?1:0,!0),s|=32,i+=8;break;case"s":if(e.indexOf(t.v)==-1)throw new Error("Value ".concat(t.v," missing from SST!"));r[2]=3,n.setUint32(i,e.indexOf(t.v),!0),s|=16,i+=4;break;default:throw"unsupported cell type "+t.t}return n.setUint32(4,s,!0),r.slice(0,i)}function qr(t){var e=Ye(t);return Os(e[1][0].data)}function aN(t,e,r){var n,i,s,a;if(!((n=t[6])!=null&&n[0])||!((i=t[7])!=null&&i[0]))throw"Mutation only works on post-BNC storages!";var o=((a=(s=t[8])==null?void 0:s[0])==null?void 0:a.data)&&Ii(t[8][0].data)>0||!1;if(o)throw"Math only works with normal offsets";for(var l=0,c=ao(t[7][0].data),u=0,f=[],d=ao(t[4][0].data),h=0,m=[],p=0;p<e.length;++p){if(e[p]==null){c.setUint16(p*2,65535,!0),d.setUint16(p*2,65535);continue}c.setUint16(p*2,u,!0),d.setUint16(p*2,h,!0);var g,w;switch(typeof e[p]){case"string":g=Tl({t:"s",v:e[p]},r),w=Sl({t:"s",v:e[p]},r);break;case"number":g=Tl({t:"n",v:e[p]},r),w=Sl({t:"n",v:e[p]},r);break;case"boolean":g=Tl({t:"b",v:e[p]},r),w=Sl({t:"b",v:e[p]},r);break;default:throw new Error("Unsupported value "+e[p])}f.push(g),u+=g.length,m.push(w),h+=w.length,++l}for(t[2][0].data=Ce(l);p<t[7][0].data.length/2;++p)c.setUint16(p*2,65535,!0),d.setUint16(p*2,65535,!0);return t[6][0].data=pn(f),t[3][0].data=pn(m),l}function oN(t,e){if(!e||!e.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=t.Sheets[t.SheetNames[0]];t.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=Mt(r["!ref"]);n.s.r=n.s.c=0;var i=!1;n.e.c>9&&(i=!0,n.e.c=9),n.e.r>49&&(i=!0,n.e.r=49),i&&console.error("The Numbers writer is currently limited to ".concat(Ke(n)));var s=oo(r,{range:n,header:1}),a=["~Sh33tJ5~"];s.forEach(function(j){return j.forEach(function(D){typeof D=="string"&&a.push(D)})});var o={},l=[],c=Pe.read(e.numbers,{type:"base64"});c.FileIndex.map(function(j,D){return[j,c.FullPaths[D]]}).forEach(function(j){var D=j[0],P=j[1];if(D.type==2&&D.name.match(/\.iwa/)){var X=D.content,oe=Kt(X),ce=qt(oe);ce.forEach(function(se){l.push(se.id),o[se.id]={deps:[],location:P,type:Ii(se.messages[0].meta[1][0].data)}})}}),l.sort(function(j,D){return j-D});var u=l.filter(function(j){return j>1}).map(function(j){return[j,Ce(j)]});c.FileIndex.map(function(j,D){return[j,c.FullPaths[D]]}).forEach(function(j){var D=j[0];if(j[1],!!D.name.match(/\.iwa/)){var P=qt(Kt(D.content));P.forEach(function(X){X.messages.forEach(function(oe){u.forEach(function(ce){X.messages.some(function(se){return Ii(se.meta[1][0].data)!=11006&&nN(se.data,ce[1])})&&o[ce[0]].deps.push(X.id)})})})}});for(var f=Pe.find(c,o[1].location),d=qt(Kt(f.content)),h,m=0;m<d.length;++m){var p=d[m];p.id==1&&(h=p)}var g=qr(Ye(h.messages[0].data)[1][0].data);for(f=Pe.find(c,o[g].location),d=qt(Kt(f.content)),m=0;m<d.length;++m)p=d[m],p.id==g&&(h=p);for(g=qr(Ye(h.messages[0].data)[2][0].data),f=Pe.find(c,o[g].location),d=qt(Kt(f.content)),m=0;m<d.length;++m)p=d[m],p.id==g&&(h=p);for(g=qr(Ye(h.messages[0].data)[2][0].data),f=Pe.find(c,o[g].location),d=qt(Kt(f.content)),m=0;m<d.length;++m)p=d[m],p.id==g&&(h=p);var w=Ye(h.messages[0].data);{w[6][0].data=Ce(n.e.r+1),w[7][0].data=Ce(n.e.c+1);var b=qr(w[46][0].data),_=Pe.find(c,o[b].location),k=qt(Kt(_.content));{for(var L=0;L<k.length&&k[L].id!=b;++L);if(k[L].id!=b)throw"Bad ColumnRowUIDMapArchive";var M=Ye(k[L].messages[0].data);M[1]=[],M[2]=[],M[3]=[];for(var I=0;I<=n.e.c;++I){var F=[];F[1]=F[2]=[{type:0,data:Ce(I+420690)}],M[1].push({type:2,data:nt(F)}),M[2].push({type:0,data:Ce(I)}),M[3].push({type:0,data:Ce(I)})}M[4]=[],M[5]=[],M[6]=[];for(var R=0;R<=n.e.r;++R)F=[],F[1]=F[2]=[{type:0,data:Ce(R+726270)}],M[4].push({type:2,data:nt(F)}),M[5].push({type:0,data:Ce(R)}),M[6].push({type:0,data:Ce(R)});k[L].messages[0].data=nt(M)}_.content=ci(li(k)),_.size=_.content.length,delete w[46];var N=Ye(w[4][0].data);{N[7][0].data=Ce(n.e.r+1);var H=Ye(N[1][0].data),q=qr(H[2][0].data);_=Pe.find(c,o[q].location),k=qt(Kt(_.content));{if(k[0].id!=q)throw"Bad HeaderStorageBucket";var Y=Ye(k[0].messages[0].data);for(R=0;R<s.length;++R){var fe=Ye(Y[2][0].data);fe[1][0].data=Ce(R),fe[4][0].data=Ce(s[R].length),Y[2][R]={type:Y[2][0].type,data:nt(fe)}}k[0].messages[0].data=nt(Y)}_.content=ci(li(k)),_.size=_.content.length;var ue=qr(N[2][0].data);_=Pe.find(c,o[ue].location),k=qt(Kt(_.content));{if(k[0].id!=ue)throw"Bad HeaderStorageBucket";for(Y=Ye(k[0].messages[0].data),I=0;I<=n.e.c;++I)fe=Ye(Y[2][0].data),fe[1][0].data=Ce(I),fe[4][0].data=Ce(n.e.r+1),Y[2][I]={type:Y[2][0].type,data:nt(fe)};k[0].messages[0].data=nt(Y)}_.content=ci(li(k)),_.size=_.content.length;var we=qr(N[4][0].data);(function(){for(var j=Pe.find(c,o[we].location),D=qt(Kt(j.content)),P,X=0;X<D.length;++X){var oe=D[X];oe.id==we&&(P=oe)}var ce=Ye(P.messages[0].data);{ce[3]=[];var se=[];a.forEach(function(be,vt){se[1]=[{type:0,data:Ce(vt)}],se[2]=[{type:0,data:Ce(1)}],se[3]=[{type:2,data:rN(be)}],ce[3].push({type:2,data:nt(se)})})}P.messages[0].data=nt(ce);var ne=li(D),Fe=ci(ne);j.content=Fe,j.size=j.content.length})();var xe=Ye(N[3][0].data);{var he=xe[1][0];delete xe[2];var Q=Ye(he.data);{var _e=qr(Q[2][0].data);(function(){for(var j=Pe.find(c,o[_e].location),D=qt(Kt(j.content)),P,X=0;X<D.length;++X){var oe=D[X];oe.id==_e&&(P=oe)}var ce=Ye(P.messages[0].data);{delete ce[6],delete xe[7];var se=new Uint8Array(ce[5][0].data);ce[5]=[];for(var ne=0,Fe=0;Fe<=n.e.r;++Fe){var be=Ye(se);ne+=aN(be,s[Fe],a),be[1][0].data=Ce(Fe),ce[5].push({data:nt(be),type:2})}ce[1]=[{type:0,data:Ce(n.e.c+1)}],ce[2]=[{type:0,data:Ce(n.e.r+1)}],ce[3]=[{type:0,data:Ce(ne)}],ce[4]=[{type:0,data:Ce(n.e.r+1)}]}P.messages[0].data=nt(ce);var vt=li(D),Ae=ci(vt);j.content=Ae,j.size=j.content.length})()}he.data=nt(Q)}N[3][0].data=nt(xe)}w[4][0].data=nt(N)}h.messages[0].data=nt(w);var Be=li(d),O=ci(Be);return f.content=O,f.size=f.content.length,c}function lN(t){return function(r){for(var n=0;n!=t.length;++n){var i=t[n];r[i[0]]===void 0&&(r[i[0]]=i[1]),i[2]==="n"&&(r[i[0]]=Number(r[i[0]]))}}}function Lu(t){lN([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(t)}function cN(t,e){return e.bookType=="ods"?cv(t,e):e.bookType=="numbers"?oN(t,e):e.bookType=="xlsb"?uN(t,e):fN(t,e)}function uN(t,e){yi=1024,t&&!t.SSF&&(t.SSF=kt(Ve)),t&&t.SSF&&(Fo(),Po(t.SSF),e.revssf=No(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,vs?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var r=e.bookType=="xlsb"?"bin":"xml",n=Gg.indexOf(e.bookType)>-1,i=wg();Lu(e=e||{});var s=wu(),a="",o=0;if(e.cellXfs=[],yn(e.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={}),a="docProps/core.xml",ye(s,a,Tg(t.Props,e)),i.coreprops.push(a),Ie(e.rels,2,a,Te.CORE_PROPS),a="docProps/app.xml",!(t.Props&&t.Props.SheetNames))if(!t.Workbook||!t.Workbook.Sheets)t.Props.SheetNames=t.SheetNames;else{for(var l=[],c=0;c<t.SheetNames.length;++c)(t.Workbook.Sheets[c]||{}).Hidden!=2&&l.push(t.SheetNames[c]);t.Props.SheetNames=l}for(t.Props.Worksheets=t.Props.SheetNames.length,ye(s,a,Ag(t.Props)),i.extprops.push(a),Ie(e.rels,3,a,Te.EXT_PROPS),t.Custprops!==t.Props&&ut(t.Custprops||{}).length>0&&(a="docProps/custom.xml",ye(s,a,Cg(t.Custprops)),i.custprops.push(a),Ie(e.rels,4,a,Te.CUST_PROPS)),o=1;o<=t.SheetNames.length;++o){var u={"!id":{}},f=t.Sheets[t.SheetNames[o-1]],d=(f||{})["!type"]||"sheet";switch(d){case"chart":default:a="xl/worksheets/sheet"+o+"."+r,ye(s,a,d3(o-1,a,e,t,u)),i.sheets.push(a),Ie(e.wbrels,-1,"worksheets/sheet"+o+"."+r,Te.WS[0])}if(f){var h=f["!comments"],m=!1,p="";h&&h.length>0&&(p="xl/comments"+o+"."+r,ye(s,p,g3(h,p)),i.comments.push(p),Ie(u,-1,"../comments"+o+"."+r,Te.CMNT),m=!0),f["!legacy"]&&m&&ye(s,"xl/drawings/vmlDrawing"+o+".vml",Wg(o,f["!comments"])),delete f["!comments"],delete f["!legacy"]}u["!id"].rId1&&ye(s,Eg(a),Ai(u))}return e.Strings!=null&&e.Strings.length>0&&(a="xl/sharedStrings."+r,ye(s,a,m3(e.Strings,a,e)),i.strs.push(a),Ie(e.wbrels,-1,"sharedStrings."+r,Te.SST)),a="xl/workbook."+r,ye(s,a,h3(t,a)),i.workbooks.push(a),Ie(e.rels,1,a,Te.WB),a="xl/theme/theme1.xml",ye(s,a,Ug(t.Themes,e)),i.themes.push(a),Ie(e.wbrels,-1,"theme/theme1.xml",Te.THEME),a="xl/styles."+r,ye(s,a,p3(t,a,e)),i.styles.push(a),Ie(e.wbrels,-1,"styles."+r,Te.STY),t.vbaraw&&n&&(a="xl/vbaProject.bin",ye(s,a,t.vbaraw),i.vba.push(a),Ie(e.wbrels,-1,"vbaProject.bin",Te.VBA)),a="xl/metadata."+r,ye(s,a,v3(a)),i.metadata.push(a),Ie(e.wbrels,-1,"metadata."+r,Te.XLMETA),ye(s,"[Content_Types].xml",_g(i,e)),ye(s,"_rels/.rels",Ai(e.rels)),ye(s,"xl/_rels/workbook."+r+".rels",Ai(e.wbrels)),delete e.revssf,delete e.ssf,s}function fN(t,e){yi=1024,t&&!t.SSF&&(t.SSF=kt(Ve)),t&&t.SSF&&(Fo(),Po(t.SSF),e.revssf=No(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,vs?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var r="xml",n=Gg.indexOf(e.bookType)>-1,i=wg();Lu(e=e||{});var s=wu(),a="",o=0;if(e.cellXfs=[],yn(e.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={}),a="docProps/core.xml",ye(s,a,Tg(t.Props,e)),i.coreprops.push(a),Ie(e.rels,2,a,Te.CORE_PROPS),a="docProps/app.xml",!(t.Props&&t.Props.SheetNames))if(!t.Workbook||!t.Workbook.Sheets)t.Props.SheetNames=t.SheetNames;else{for(var l=[],c=0;c<t.SheetNames.length;++c)(t.Workbook.Sheets[c]||{}).Hidden!=2&&l.push(t.SheetNames[c]);t.Props.SheetNames=l}t.Props.Worksheets=t.Props.SheetNames.length,ye(s,a,Ag(t.Props)),i.extprops.push(a),Ie(e.rels,3,a,Te.EXT_PROPS),t.Custprops!==t.Props&&ut(t.Custprops||{}).length>0&&(a="docProps/custom.xml",ye(s,a,Cg(t.Custprops)),i.custprops.push(a),Ie(e.rels,4,a,Te.CUST_PROPS));var u=["SheetJ5"];for(e.tcid=0,o=1;o<=t.SheetNames.length;++o){var f={"!id":{}},d=t.Sheets[t.SheetNames[o-1]],h=(d||{})["!type"]||"sheet";switch(h){case"chart":default:a="xl/worksheets/sheet"+o+"."+r,ye(s,a,ev(o-1,e,t,f)),i.sheets.push(a),Ie(e.wbrels,-1,"worksheets/sheet"+o+"."+r,Te.WS[0])}if(d){var m=d["!comments"],p=!1,g="";if(m&&m.length>0){var w=!1;m.forEach(function(b){b[1].forEach(function(_){_.T==!0&&(w=!0)})}),w&&(g="xl/threadedComments/threadedComment"+o+"."+r,ye(s,g,H4(m,u,e)),i.threadedcomments.push(g),Ie(f,-1,"../threadedComments/threadedComment"+o+"."+r,Te.TCMNT)),g="xl/comments"+o+"."+r,ye(s,g,Vg(m)),i.comments.push(g),Ie(f,-1,"../comments"+o+"."+r,Te.CMNT),p=!0}d["!legacy"]&&p&&ye(s,"xl/drawings/vmlDrawing"+o+".vml",Wg(o,d["!comments"])),delete d["!comments"],delete d["!legacy"]}f["!id"].rId1&&ye(s,Eg(a),Ai(f))}return e.Strings!=null&&e.Strings.length>0&&(a="xl/sharedStrings."+r,ye(s,a,Dg(e.Strings,e)),i.strs.push(a),Ie(e.wbrels,-1,"sharedStrings."+r,Te.SST)),a="xl/workbook."+r,ye(s,a,nv(t)),i.workbooks.push(a),Ie(e.rels,1,a,Te.WB),a="xl/theme/theme1.xml",ye(s,a,Ug(t.Themes,e)),i.themes.push(a),Ie(e.wbrels,-1,"theme/theme1.xml",Te.THEME),a="xl/styles."+r,ye(s,a,$g(t,e)),i.styles.push(a),Ie(e.wbrels,-1,"styles."+r,Te.STY),t.vbaraw&&n&&(a="xl/vbaProject.bin",ye(s,a,t.vbaraw),i.vba.push(a),Ie(e.wbrels,-1,"vbaProject.bin",Te.VBA)),a="xl/metadata."+r,ye(s,a,Hg()),i.metadata.push(a),Ie(e.wbrels,-1,"metadata."+r,Te.XLMETA),u.length>1&&(a="xl/persons/person.xml",ye(s,a,W4(u)),i.people.push(a),Ie(e.wbrels,-1,"persons/person.xml",Te.PEOPLE)),ye(s,"[Content_Types].xml",_g(i,e)),ye(s,"_rels/.rels",Ai(e.rels)),ye(s,"xl/_rels/workbook."+r+".rels",Ai(e.wbrels)),delete e.revssf,delete e.ssf,s}function hN(t,e){var r="";switch((e||{}).type||"base64"){case"buffer":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];case"base64":r=Br(t.slice(0,12));break;case"binary":r=t;break;case"array":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];default:throw new Error("Unrecognized type "+(e&&e.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function uv(t,e){switch(e.type){case"base64":case"binary":break;case"buffer":case"array":e.type="";break;case"file":return Ks(e.file,Pe.write(t,{type:Se?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");default:throw new Error("Unrecognized type "+e.type)}return Pe.write(t,e)}function dN(t,e){var r=kt(e||{}),n=cN(t,r);return pN(n,r)}function pN(t,e){var r={},n=Se?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(e.compression&&(r.compression="DEFLATE"),e.password)r.type=n;else switch(e.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");case"buffer":case"file":r.type=n;break;default:throw new Error("Unrecognized type "+e.type)}var i=t.FullPaths?Pe.write(t,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!e.compression}):t.generate(r);if(typeof Deno<"u"&&typeof i=="string"){if(e.type=="binary"||e.type=="base64")return i;i=new Uint8Array(Ro(i))}return e.password&&typeof encrypt_agile<"u"?uv(encrypt_agile(i,e.password),e):e.type==="file"?Ks(e.file,i):e.type=="string"?ds(i):i}function mN(t,e){var r=e||{},n=R3(t,r);return uv(n,r)}function or(t,e,r){r||(r="");var n=r+t;switch(e.type){case"base64":return Cs(Or(n));case"binary":return Or(n);case"string":return t;case"file":return Ks(e.file,n,"utf8");case"buffer":return Se?Vr(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):or(n,{type:"binary"}).split("").map(function(i){return i.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function gN(t,e){switch(e.type){case"base64":return Cs(t);case"binary":return t;case"string":return t;case"file":return Ks(e.file,t,"binary");case"buffer":return Se?Vr(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function ya(t,e){switch(e.type){case"string":case"base64":case"binary":for(var r="",n=0;n<t.length;++n)r+=String.fromCharCode(t[n]);return e.type=="base64"?Cs(r):e.type=="string"?ds(r):r;case"file":return Ks(e.file,t);case"buffer":return t;default:throw new Error("Unrecognized type "+e.type)}}function fv(t,e){WI(),t3(t);var r=kt(e||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var n=fv(t,r);return r.type="array",Ro(n)}var i=0;if(r.sheet&&(typeof r.sheet=="number"?i=r.sheet:i=t.SheetNames.indexOf(r.sheet),!t.SheetNames[i]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return or(k3(t,r),r);case"slk":case"sylk":return or(QO.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"htm":case"html":return or(av(t.Sheets[t.SheetNames[i]],r),r);case"txt":return gN(hv(t.Sheets[t.SheetNames[i]],r),r);case"csv":return or(Mu(t.Sheets[t.SheetNames[i]],r),r,"\uFEFF");case"dif":return or(ZO.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"dbf":return ya(JO.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"prn":return or(e4.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"rtf":return or(o4.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"eth":return or(Ng.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"fods":return or(cv(t,r),r);case"wk1":return ya(o0.sheet_to_wk1(t.Sheets[t.SheetNames[i]],r),r);case"wk3":return ya(o0.book_to_wk3(t,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),ya(sv(t,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),mN(t,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return dN(t,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function vN(t,e,r,n,i,s,a,o){var l=ct(r),c=o.defval,u=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),f=!0,d=i===1?[]:{};if(i!==1)if(Object.defineProperty)try{Object.defineProperty(d,"__rowNum__",{value:r,enumerable:!1})}catch{d.__rowNum__=r}else d.__rowNum__=r;if(!a||t[r])for(var h=e.s.c;h<=e.e.c;++h){var m=a?t[r][h]:t[n[h]+l];if(m===void 0||m.t===void 0){if(c===void 0)continue;s[h]!=null&&(d[s[h]]=c);continue}var p=m.v;switch(m.t){case"z":if(p==null)break;continue;case"e":p=p==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+m.t)}if(s[h]!=null){if(p==null)if(m.t=="e"&&p===null)d[s[h]]=null;else if(c!==void 0)d[s[h]]=c;else if(u&&p===null)d[s[h]]=null;else continue;else d[s[h]]=u&&(m.t!=="n"||m.t==="n"&&o.rawNumbers!==!1)?p:Ur(m,p,o);p!=null&&(f=!1)}}return{row:d,isempty:f}}function oo(t,e){if(t==null||t["!ref"]==null)return[];var r={t:"n",v:0},n=0,i=1,s=[],a=0,o="",l={s:{r:0,c:0},e:{r:0,c:0}},c=e||{},u=c.range!=null?c.range:t["!ref"];switch(c.header===1?n=1:c.header==="A"?n=2:Array.isArray(c.header)?n=3:c.header==null&&(n=0),typeof u){case"string":l=Me(u);break;case"number":l=Me(t["!ref"]),l.s.r=u;break;default:l=u}n>0&&(i=0);var f=ct(l.s.r),d=[],h=[],m=0,p=0,g=Array.isArray(t),w=l.s.r,b=0,_={};g&&!t[w]&&(t[w]=[]);var k=c.skipHidden&&t["!cols"]||[],L=c.skipHidden&&t["!rows"]||[];for(b=l.s.c;b<=l.e.c;++b)if(!(k[b]||{}).hidden)switch(d[b]=mt(b),r=g?t[w][b]:t[d[b]+f],n){case 1:s[b]=b-l.s.c;break;case 2:s[b]=d[b];break;case 3:s[b]=c.header[b-l.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),o=a=Ur(r,null,c),p=_[a]||0,!p)_[a]=1;else{do o=a+"_"+p++;while(_[o]);_[a]=p,_[o]=1}s[b]=o}for(w=l.s.r+i;w<=l.e.r;++w)if(!(L[w]||{}).hidden){var M=vN(t,l,w,d,n,s,g,c);(M.isempty===!1||(n===1?c.blankrows!==!1:c.blankrows))&&(h[m++]=M.row)}return h.length=m,h}var m0=/"/g;function xN(t,e,r,n,i,s,a,o){for(var l=!0,c=[],u="",f=ct(r),d=e.s.c;d<=e.e.c;++d)if(n[d]){var h=o.dense?(t[r]||[])[d]:t[n[d]+f];if(h==null)u="";else if(h.v!=null){l=!1,u=""+(o.rawNumbers&&h.t=="n"?h.v:Ur(h,null,o));for(var m=0,p=0;m!==u.length;++m)if((p=u.charCodeAt(m))===i||p===s||p===34||o.forceQuotes){u='"'+u.replace(m0,'""')+'"';break}u=="ID"&&(u='"ID"')}else h.f!=null&&!h.F?(l=!1,u="="+h.f,u.indexOf(",")>=0&&(u='"'+u.replace(m0,'""')+'"')):u="";c.push(u)}return o.blankrows===!1&&l?null:c.join(a)}function Mu(t,e){var r=[],n=e??{};if(t==null||t["!ref"]==null)return"";var i=Me(t["!ref"]),s=n.FS!==void 0?n.FS:",",a=s.charCodeAt(0),o=n.RS!==void 0?n.RS:`
`,l=o.charCodeAt(0),c=new RegExp((s=="|"?"\\|":s)+"+$"),u="",f=[];n.dense=Array.isArray(t);for(var d=n.skipHidden&&t["!cols"]||[],h=n.skipHidden&&t["!rows"]||[],m=i.s.c;m<=i.e.c;++m)(d[m]||{}).hidden||(f[m]=mt(m));for(var p=0,g=i.s.r;g<=i.e.r;++g)(h[g]||{}).hidden||(u=xN(t,i,g,f,a,l,s,n),u!=null&&(n.strip&&(u=u.replace(c,"")),(u||n.blankrows!==!1)&&r.push((p++?o:"")+u)));return delete n.dense,r.join("")}function hv(t,e){e||(e={}),e.FS="	",e.RS=`
`;var r=Mu(t,e);return r}function yN(t){var e="",r,n="";if(t==null||t["!ref"]==null)return[];var i=Me(t["!ref"]),s="",a=[],o,l=[],c=Array.isArray(t);for(o=i.s.c;o<=i.e.c;++o)a[o]=mt(o);for(var u=i.s.r;u<=i.e.r;++u)for(s=ct(u),o=i.s.c;o<=i.e.c;++o)if(e=a[o]+s,r=c?(t[u]||[])[o]:t[e],n="",r!==void 0){if(r.F!=null){if(e=r.F,!r.f)continue;n=r.f,e.indexOf(":")==-1&&(e=e+":"+e)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}l[l.length]=e+"="+n}return l}function dv(t,e,r){var n=r||{},i=+!n.skipHeader,s=t||{},a=0,o=0;if(s&&n.origin!=null)if(typeof n.origin=="number")a=n.origin;else{var l=typeof n.origin=="string"?et(n.origin):n.origin;a=l.r,o=l.c}var c,u={s:{c:0,r:0},e:{c:o,r:a+e.length-1+i}};if(s["!ref"]){var f=Me(s["!ref"]);u.e.c=Math.max(u.e.c,f.e.c),u.e.r=Math.max(u.e.r,f.e.r),a==-1&&(a=f.e.r+1,u.e.r=a+e.length-1+i)}else a==-1&&(a=0,u.e.r=e.length-1+i);var d=n.header||[],h=0;e.forEach(function(p,g){ut(p).forEach(function(w){(h=d.indexOf(w))==-1&&(d[h=d.length]=w);var b=p[w],_="z",k="",L=Oe({c:o+h,r:a+g+i});c=Rs(s,L),b&&typeof b=="object"&&!(b instanceof Date)?s[L]=b:(typeof b=="number"?_="n":typeof b=="boolean"?_="b":typeof b=="string"?_="s":b instanceof Date?(_="d",n.cellDates||(_="n",b=It(b)),k=n.dateNF||Ve[14]):b===null&&n.nullError&&(_="e",b=0),c?(c.t=_,c.v=b,delete c.w,delete c.R,k&&(c.z=k)):s[L]=c={t:_,v:b},k&&(c.z=k))})}),u.e.c=Math.max(u.e.c,o+d.length-1);var m=ct(a);if(i)for(h=0;h<d.length;++h)s[mt(h+o)+m]={t:"s",v:d[h]};return s["!ref"]=Ke(u),s}function wN(t,e){return dv(null,t,e)}function Rs(t,e,r){if(typeof e=="string"){if(Array.isArray(t)){var n=et(e);return t[n.r]||(t[n.r]=[]),t[n.r][n.c]||(t[n.r][n.c]={t:"z"})}return t[e]||(t[e]={t:"z"})}return typeof e!="number"?Rs(t,Oe(e)):Rs(t,Oe({r:e,c:r||0}))}function _N(t,e){if(typeof e=="number"){if(e>=0&&t.SheetNames.length>e)return e;throw new Error("Cannot find sheet # "+e)}else if(typeof e=="string"){var r=t.SheetNames.indexOf(e);if(r>-1)return r;throw new Error("Cannot find sheet name |"+e+"|")}else throw new Error("Cannot find sheet |"+e+"|")}function EN(){return{SheetNames:[],Sheets:{}}}function bN(t,e,r,n){var i=1;if(!r)for(;i<=65535&&t.SheetNames.indexOf(r="Sheet"+i)!=-1;++i,r=void 0);if(!r||t.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&t.SheetNames.indexOf(r)>=0){var s=r.match(/(^.*?)(\d+)$/);i=s&&+s[2]||0;var a=s&&s[1]||r;for(++i;i<=65535&&t.SheetNames.indexOf(r=a+i)!=-1;++i);}if(rv(r),t.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return t.SheetNames.push(r),t.Sheets[r]=e,r}function TN(t,e,r){t.Workbook||(t.Workbook={}),t.Workbook.Sheets||(t.Workbook.Sheets=[]);var n=_N(t,e);switch(t.Workbook.Sheets[n]||(t.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}t.Workbook.Sheets[n].Hidden=r}function SN(t,e){return t.z=e,t}function pv(t,e,r){return e?(t.l={Target:e},r&&(t.l.Tooltip=r)):delete t.l,t}function AN(t,e,r){return pv(t,"#"+e,r)}function CN(t,e,r){t.c||(t.c=[]),t.c.push({t:e,a:r||"SheetJS"})}function IN(t,e,r,n){for(var i=typeof e!="string"?e:Me(e),s=typeof e=="string"?e:Ke(e),a=i.s.r;a<=i.e.r;++a)for(var o=i.s.c;o<=i.e.c;++o){var l=Rs(t,a,o);l.t="n",l.F=s,delete l.v,a==i.s.r&&o==i.s.c&&(l.f=r,n&&(l.D=!0))}return t}var Al={encode_col:mt,encode_row:ct,encode_cell:Oe,encode_range:Ke,decode_col:Au,decode_row:Su,split_cell:Vk,decode_cell:et,decode_range:Mt,format_cell:Ur,sheet_add_aoa:pg,sheet_add_json:dv,sheet_add_dom:ov,aoa_to_sheet:Wi,json_to_sheet:wN,table_to_sheet:lv,table_to_book:Z3,sheet_to_csv:Mu,sheet_to_txt:hv,sheet_to_json:oo,sheet_to_html:av,sheet_to_formulae:yN,sheet_to_row_object_array:oo,sheet_get_cell:Rs,book_new:EN,book_append_sheet:bN,book_set_sheet_visibility:TN,cell_set_number_format:SN,cell_set_hyperlink:pv,cell_set_internal_link:AN,cell_add_comment:CN,sheet_set_array_formula:IN,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}},mv={exports:{}};(function(t,e){(function(r,n){n()})(at,function(){function r(c,u){return typeof u>"u"?u={autoBom:!1}:typeof u!="object"&&(console.warn("Deprecated: Expected third argument to be a object"),u={autoBom:!u}),u.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(c.type)?new Blob(["\uFEFF",c],{type:c.type}):c}function n(c,u,f){var d=new XMLHttpRequest;d.open("GET",c),d.responseType="blob",d.onload=function(){l(d.response,u,f)},d.onerror=function(){console.error("could not download file")},d.send()}function i(c){var u=new XMLHttpRequest;u.open("HEAD",c,!1);try{u.send()}catch{}return 200<=u.status&&299>=u.status}function s(c){try{c.dispatchEvent(new MouseEvent("click"))}catch{var u=document.createEvent("MouseEvents");u.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),c.dispatchEvent(u)}}var a=typeof window=="object"&&window.window===window?window:typeof self=="object"&&self.self===self?self:typeof at=="object"&&at.global===at?at:void 0,o=a.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),l=a.saveAs||(typeof window!="object"||window!==a?function(){}:"download"in HTMLAnchorElement.prototype&&!o?function(c,u,f){var d=a.URL||a.webkitURL,h=document.createElement("a");u=u||c.name||"download",h.download=u,h.rel="noopener",typeof c=="string"?(h.href=c,h.origin===location.origin?s(h):i(h.href)?n(c,u,f):s(h,h.target="_blank")):(h.href=d.createObjectURL(c),setTimeout(function(){d.revokeObjectURL(h.href)},4e4),setTimeout(function(){s(h)},0))}:"msSaveOrOpenBlob"in navigator?function(c,u,f){if(u=u||c.name||"download",typeof c!="string")navigator.msSaveOrOpenBlob(r(c,f),u);else if(i(c))n(c,u,f);else{var d=document.createElement("a");d.href=c,d.target="_blank",setTimeout(function(){s(d)})}}:function(c,u,f,d){if(d=d||open("","_blank"),d&&(d.document.title=d.document.body.innerText="downloading..."),typeof c=="string")return n(c,u,f);var h=c.type==="application/octet-stream",m=/constructor/i.test(a.HTMLElement)||a.safari,p=/CriOS\/[\d]+/.test(navigator.userAgent);if((p||h&&m||o)&&typeof FileReader<"u"){var g=new FileReader;g.onloadend=function(){var _=g.result;_=p?_:_.replace(/^data:[^;]*;/,"data:attachment/file;"),d?d.location.href=_:location=_,d=null},g.readAsDataURL(c)}else{var w=a.URL||a.webkitURL,b=w.createObjectURL(c);d?d.location=b:location.href=b,d=null,setTimeout(function(){w.revokeObjectURL(b)},4e4)}});a.saveAs=l.saveAs=l,t.exports=l})})(mv);var kN=mv.exports;const ON=(t,e="companies_export")=>{try{const r=Al.book_new(),n=Al.json_to_sheet(t,{header:["name","business_id","industry","city","company_type","registration_date","address"],skipHeader:!1}),i=[{wch:30},{wch:15},{wch:25},{wch:20},{wch:20},{wch:15},{wch:40}];n["!cols"]=i,Al.book_append_sheet(r,n,"Companies");const s=fv(r,{bookType:"xlsx",type:"array"}),a=new Blob([s],{type:"application/octet-stream"}),o=new Date().toISOString().slice(0,10),l=`${e}_${o}.xlsx`;return kN.saveAs(a,l),!0}catch(r){throw console.error("Error exporting to Excel:",r),new Error("Failed to export data to Excel")}},RN="modulepreload",PN=function(t){return"/"+t},g0={},Zs=function(e,r,n){if(!r||r.length===0)return e();const i=document.getElementsByTagName("link");return Promise.all(r.map(s=>{if(s=PN(s),s in g0)return;g0[s]=!0;const a=s.endsWith(".css"),o=a?'[rel="stylesheet"]':"";if(!!n)for(let u=i.length-1;u>=0;u--){const f=i[u];if(f.href===s&&(!a||f.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${s}"]${o}`))return;const c=document.createElement("link");if(c.rel=a?"stylesheet":RN,a||(c.as="script",c.crossOrigin=""),c.href=s,document.head.appendChild(c),a)return new Promise((u,f)=>{c.addEventListener("load",u),c.addEventListener("error",()=>f(new Error(`Unable to preload CSS for ${s}`)))})})).then(()=>e()).catch(s=>{const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=s,window.dispatchEvent(a),!a.defaultPrevented)throw s})},FN=t=>{let e;return t?e=t:typeof fetch>"u"?e=(...r)=>Zs(()=>Promise.resolve().then(()=>zi),void 0).then(({default:n})=>n(...r)):e=fetch,(...r)=>e(...r)};class ju extends Error{constructor(e,r="FunctionsError",n){super(e),this.name=r,this.context=n}}class NN extends ju{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class v0 extends ju{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class x0 extends ju{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var vc;(function(t){t.Any="any",t.ApNortheast1="ap-northeast-1",t.ApNortheast2="ap-northeast-2",t.ApSouth1="ap-south-1",t.ApSoutheast1="ap-southeast-1",t.ApSoutheast2="ap-southeast-2",t.CaCentral1="ca-central-1",t.EuCentral1="eu-central-1",t.EuWest1="eu-west-1",t.EuWest2="eu-west-2",t.EuWest3="eu-west-3",t.SaEast1="sa-east-1",t.UsEast1="us-east-1",t.UsWest1="us-west-1",t.UsWest2="us-west-2"})(vc||(vc={}));var DN=globalThis&&globalThis.__awaiter||function(t,e,r,n){function i(s){return s instanceof r?s:new r(function(a){a(s)})}return new(r||(r=Promise))(function(s,a){function o(u){try{c(n.next(u))}catch(f){a(f)}}function l(u){try{c(n.throw(u))}catch(f){a(f)}}function c(u){u.done?s(u.value):i(u.value).then(o,l)}c((n=n.apply(t,e||[])).next())})};class LN{constructor(e,{headers:r={},customFetch:n,region:i=vc.Any}={}){this.url=e,this.headers=r,this.region=i,this.fetch=FN(n)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e,r={}){var n;return DN(this,void 0,void 0,function*(){try{const{headers:i,method:s,body:a}=r;let o={},{region:l}=r;l||(l=this.region);const c=new URL(`${this.url}/${e}`);l&&l!=="any"&&(o["x-region"]=l,c.searchParams.set("forceFunctionRegion",l));let u;a&&(i&&!Object.prototype.hasOwnProperty.call(i,"Content-Type")||!i)&&(typeof Blob<"u"&&a instanceof Blob||a instanceof ArrayBuffer?(o["Content-Type"]="application/octet-stream",u=a):typeof a=="string"?(o["Content-Type"]="text/plain",u=a):typeof FormData<"u"&&a instanceof FormData?u=a:(o["Content-Type"]="application/json",u=JSON.stringify(a)));const f=yield this.fetch(c.toString(),{method:s||"POST",headers:Object.assign(Object.assign(Object.assign({},o),this.headers),i),body:u}).catch(p=>{throw new NN(p)}),d=f.headers.get("x-relay-error");if(d&&d==="true")throw new v0(f);if(!f.ok)throw new x0(f);let h=((n=f.headers.get("Content-Type"))!==null&&n!==void 0?n:"text/plain").split(";")[0].trim(),m;return h==="application/json"?m=yield f.json():h==="application/octet-stream"?m=yield f.blob():h==="text/event-stream"?m=f:h==="multipart/form-data"?m=yield f.formData():m=yield f.text(),{data:m,error:null,response:f}}catch(i){return{data:null,error:i,response:i instanceof x0||i instanceof v0?i.context:void 0}}})}}var St={},$u={},$o={},ea={},Bo={},Uo={},MN=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},Ni=MN();const jN=Ni.fetch,gv=Ni.fetch.bind(Ni),vv=Ni.Headers,$N=Ni.Request,BN=Ni.Response,zi=Object.freeze(Object.defineProperty({__proto__:null,Headers:vv,Request:$N,Response:BN,default:gv,fetch:jN},Symbol.toStringTag,{value:"Module"})),UN=i1(zi);var Ho={};Object.defineProperty(Ho,"__esModule",{value:!0});let HN=class extends Error{constructor(e){super(e.message),this.name="PostgrestError",this.details=e.details,this.hint=e.hint,this.code=e.code}};Ho.default=HN;var xv=at&&at.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(Uo,"__esModule",{value:!0});const WN=xv(UN),VN=xv(Ho);let GN=class{constructor(e){this.shouldThrowOnError=!1,this.method=e.method,this.url=e.url,this.headers=e.headers,this.schema=e.schema,this.body=e.body,this.shouldThrowOnError=e.shouldThrowOnError,this.signal=e.signal,this.isMaybeSingle=e.isMaybeSingle,e.fetch?this.fetch=e.fetch:typeof fetch>"u"?this.fetch=WN.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(e,r){return this.headers=Object.assign({},this.headers),this.headers[e]=r,this}then(e,r){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),this.method!=="GET"&&this.method!=="HEAD"&&(this.headers["Content-Type"]="application/json");const n=this.fetch;let i=n(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async s=>{var a,o,l;let c=null,u=null,f=null,d=s.status,h=s.statusText;if(s.ok){if(this.method!=="HEAD"){const w=await s.text();w===""||(this.headers.Accept==="text/csv"||this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?u=w:u=JSON.parse(w))}const p=(a=this.headers.Prefer)===null||a===void 0?void 0:a.match(/count=(exact|planned|estimated)/),g=(o=s.headers.get("content-range"))===null||o===void 0?void 0:o.split("/");p&&g&&g.length>1&&(f=parseInt(g[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(u)&&(u.length>1?(c={code:"PGRST116",details:`Results contain ${u.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},u=null,f=null,d=406,h="Not Acceptable"):u.length===1?u=u[0]:u=null)}else{const p=await s.text();try{c=JSON.parse(p),Array.isArray(c)&&s.status===404&&(u=[],c=null,d=200,h="OK")}catch{s.status===404&&p===""?(d=204,h="No Content"):c={message:p}}if(c&&this.isMaybeSingle&&(!((l=c==null?void 0:c.details)===null||l===void 0)&&l.includes("0 rows"))&&(c=null,d=200,h="OK"),c&&this.shouldThrowOnError)throw new VN.default(c)}return{error:c,data:u,count:f,status:d,statusText:h}});return this.shouldThrowOnError||(i=i.catch(s=>{var a,o,l;return{error:{message:`${(a=s==null?void 0:s.name)!==null&&a!==void 0?a:"FetchError"}: ${s==null?void 0:s.message}`,details:`${(o=s==null?void 0:s.stack)!==null&&o!==void 0?o:""}`,hint:"",code:`${(l=s==null?void 0:s.code)!==null&&l!==void 0?l:""}`},data:null,count:null,status:0,statusText:""}})),i.then(e,r)}returns(){return this}overrideTypes(){return this}};Uo.default=GN;var zN=at&&at.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(Bo,"__esModule",{value:!0});const qN=zN(Uo);let KN=class extends qN.default{select(e){let r=!1;const n=(e??"*").split("").map(i=>/\s/.test(i)&&!r?"":(i==='"'&&(r=!r),i)).join("");return this.url.searchParams.set("select",n),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(e,{ascending:r=!0,nullsFirst:n,foreignTable:i,referencedTable:s=i}={}){const a=s?`${s}.order`:"order",o=this.url.searchParams.get(a);return this.url.searchParams.set(a,`${o?`${o},`:""}${e}.${r?"asc":"desc"}${n===void 0?"":n?".nullsfirst":".nullslast"}`),this}limit(e,{foreignTable:r,referencedTable:n=r}={}){const i=typeof n>"u"?"limit":`${n}.limit`;return this.url.searchParams.set(i,`${e}`),this}range(e,r,{foreignTable:n,referencedTable:i=n}={}){const s=typeof i>"u"?"offset":`${i}.offset`,a=typeof i>"u"?"limit":`${i}.limit`;return this.url.searchParams.set(s,`${e}`),this.url.searchParams.set(a,`${r-e+1}`),this}abortSignal(e){return this.signal=e,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return this.method==="GET"?this.headers.Accept="application/json":this.headers.Accept="application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain({analyze:e=!1,verbose:r=!1,settings:n=!1,buffers:i=!1,wal:s=!1,format:a="text"}={}){var o;const l=[e?"analyze":null,r?"verbose":null,n?"settings":null,i?"buffers":null,s?"wal":null].filter(Boolean).join("|"),c=(o=this.headers.Accept)!==null&&o!==void 0?o:"application/json";return this.headers.Accept=`application/vnd.pgrst.plan+${a}; for="${c}"; options=${l};`,a==="json"?this:this}rollback(){var e;return((e=this.headers.Prefer)!==null&&e!==void 0?e:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}};Bo.default=KN;var XN=at&&at.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(ea,"__esModule",{value:!0});const YN=XN(Bo);let JN=class extends YN.default{eq(e,r){return this.url.searchParams.append(e,`eq.${r}`),this}neq(e,r){return this.url.searchParams.append(e,`neq.${r}`),this}gt(e,r){return this.url.searchParams.append(e,`gt.${r}`),this}gte(e,r){return this.url.searchParams.append(e,`gte.${r}`),this}lt(e,r){return this.url.searchParams.append(e,`lt.${r}`),this}lte(e,r){return this.url.searchParams.append(e,`lte.${r}`),this}like(e,r){return this.url.searchParams.append(e,`like.${r}`),this}likeAllOf(e,r){return this.url.searchParams.append(e,`like(all).{${r.join(",")}}`),this}likeAnyOf(e,r){return this.url.searchParams.append(e,`like(any).{${r.join(",")}}`),this}ilike(e,r){return this.url.searchParams.append(e,`ilike.${r}`),this}ilikeAllOf(e,r){return this.url.searchParams.append(e,`ilike(all).{${r.join(",")}}`),this}ilikeAnyOf(e,r){return this.url.searchParams.append(e,`ilike(any).{${r.join(",")}}`),this}is(e,r){return this.url.searchParams.append(e,`is.${r}`),this}in(e,r){const n=Array.from(new Set(r)).map(i=>typeof i=="string"&&new RegExp("[,()]").test(i)?`"${i}"`:`${i}`).join(",");return this.url.searchParams.append(e,`in.(${n})`),this}contains(e,r){return typeof r=="string"?this.url.searchParams.append(e,`cs.${r}`):Array.isArray(r)?this.url.searchParams.append(e,`cs.{${r.join(",")}}`):this.url.searchParams.append(e,`cs.${JSON.stringify(r)}`),this}containedBy(e,r){return typeof r=="string"?this.url.searchParams.append(e,`cd.${r}`):Array.isArray(r)?this.url.searchParams.append(e,`cd.{${r.join(",")}}`):this.url.searchParams.append(e,`cd.${JSON.stringify(r)}`),this}rangeGt(e,r){return this.url.searchParams.append(e,`sr.${r}`),this}rangeGte(e,r){return this.url.searchParams.append(e,`nxl.${r}`),this}rangeLt(e,r){return this.url.searchParams.append(e,`sl.${r}`),this}rangeLte(e,r){return this.url.searchParams.append(e,`nxr.${r}`),this}rangeAdjacent(e,r){return this.url.searchParams.append(e,`adj.${r}`),this}overlaps(e,r){return typeof r=="string"?this.url.searchParams.append(e,`ov.${r}`):this.url.searchParams.append(e,`ov.{${r.join(",")}}`),this}textSearch(e,r,{config:n,type:i}={}){let s="";i==="plain"?s="pl":i==="phrase"?s="ph":i==="websearch"&&(s="w");const a=n===void 0?"":`(${n})`;return this.url.searchParams.append(e,`${s}fts${a}.${r}`),this}match(e){return Object.entries(e).forEach(([r,n])=>{this.url.searchParams.append(r,`eq.${n}`)}),this}not(e,r,n){return this.url.searchParams.append(e,`not.${r}.${n}`),this}or(e,{foreignTable:r,referencedTable:n=r}={}){const i=n?`${n}.or`:"or";return this.url.searchParams.append(i,`(${e})`),this}filter(e,r,n){return this.url.searchParams.append(e,`${r}.${n}`),this}};ea.default=JN;var QN=at&&at.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty($o,"__esModule",{value:!0});const Zi=QN(ea);let ZN=class{constructor(e,{headers:r={},schema:n,fetch:i}){this.url=e,this.headers=r,this.schema=n,this.fetch=i}select(e,{head:r=!1,count:n}={}){const i=r?"HEAD":"GET";let s=!1;const a=(e??"*").split("").map(o=>/\s/.test(o)&&!s?"":(o==='"'&&(s=!s),o)).join("");return this.url.searchParams.set("select",a),n&&(this.headers.Prefer=`count=${n}`),new Zi.default({method:i,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(e,{count:r,defaultToNull:n=!0}={}){const i="POST",s=[];if(this.headers.Prefer&&s.push(this.headers.Prefer),r&&s.push(`count=${r}`),n||s.push("missing=default"),this.headers.Prefer=s.join(","),Array.isArray(e)){const a=e.reduce((o,l)=>o.concat(Object.keys(l)),[]);if(a.length>0){const o=[...new Set(a)].map(l=>`"${l}"`);this.url.searchParams.set("columns",o.join(","))}}return new Zi.default({method:i,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}upsert(e,{onConflict:r,ignoreDuplicates:n=!1,count:i,defaultToNull:s=!0}={}){const a="POST",o=[`resolution=${n?"ignore":"merge"}-duplicates`];if(r!==void 0&&this.url.searchParams.set("on_conflict",r),this.headers.Prefer&&o.push(this.headers.Prefer),i&&o.push(`count=${i}`),s||o.push("missing=default"),this.headers.Prefer=o.join(","),Array.isArray(e)){const l=e.reduce((c,u)=>c.concat(Object.keys(u)),[]);if(l.length>0){const c=[...new Set(l)].map(u=>`"${u}"`);this.url.searchParams.set("columns",c.join(","))}}return new Zi.default({method:a,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}update(e,{count:r}={}){const n="PATCH",i=[];return this.headers.Prefer&&i.push(this.headers.Prefer),r&&i.push(`count=${r}`),this.headers.Prefer=i.join(","),new Zi.default({method:n,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}delete({count:e}={}){const r="DELETE",n=[];return e&&n.push(`count=${e}`),this.headers.Prefer&&n.unshift(this.headers.Prefer),this.headers.Prefer=n.join(","),new Zi.default({method:r,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}};$o.default=ZN;var Wo={},Vo={};Object.defineProperty(Vo,"__esModule",{value:!0});Vo.version=void 0;Vo.version="0.0.0-automated";Object.defineProperty(Wo,"__esModule",{value:!0});Wo.DEFAULT_HEADERS=void 0;const eD=Vo;Wo.DEFAULT_HEADERS={"X-Client-Info":`postgrest-js/${eD.version}`};var yv=at&&at.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty($u,"__esModule",{value:!0});const tD=yv($o),rD=yv(ea),nD=Wo;let iD=class wv{constructor(e,{headers:r={},schema:n,fetch:i}={}){this.url=e,this.headers=Object.assign(Object.assign({},nD.DEFAULT_HEADERS),r),this.schemaName=n,this.fetch=i}from(e){const r=new URL(`${this.url}/${e}`);return new tD.default(r,{headers:Object.assign({},this.headers),schema:this.schemaName,fetch:this.fetch})}schema(e){return new wv(this.url,{headers:this.headers,schema:e,fetch:this.fetch})}rpc(e,r={},{head:n=!1,get:i=!1,count:s}={}){let a;const o=new URL(`${this.url}/rpc/${e}`);let l;n||i?(a=n?"HEAD":"GET",Object.entries(r).filter(([u,f])=>f!==void 0).map(([u,f])=>[u,Array.isArray(f)?`{${f.join(",")}}`:`${f}`]).forEach(([u,f])=>{o.searchParams.append(u,f)})):(a="POST",l=r);const c=Object.assign({},this.headers);return s&&(c.Prefer=`count=${s}`),new rD.default({method:a,url:o,headers:c,schema:this.schemaName,body:l,fetch:this.fetch,allowEmpty:!1})}};$u.default=iD;var qi=at&&at.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(St,"__esModule",{value:!0});St.PostgrestError=St.PostgrestBuilder=St.PostgrestTransformBuilder=St.PostgrestFilterBuilder=St.PostgrestQueryBuilder=St.PostgrestClient=void 0;const _v=qi($u);St.PostgrestClient=_v.default;const Ev=qi($o);St.PostgrestQueryBuilder=Ev.default;const bv=qi(ea);St.PostgrestFilterBuilder=bv.default;const Tv=qi(Bo);St.PostgrestTransformBuilder=Tv.default;const Sv=qi(Uo);St.PostgrestBuilder=Sv.default;const Av=qi(Ho);St.PostgrestError=Av.default;var sD=St.default={PostgrestClient:_v.default,PostgrestQueryBuilder:Ev.default,PostgrestFilterBuilder:bv.default,PostgrestTransformBuilder:Tv.default,PostgrestBuilder:Sv.default,PostgrestError:Av.default};const{PostgrestClient:aD,PostgrestQueryBuilder:fL,PostgrestFilterBuilder:hL,PostgrestTransformBuilder:dL,PostgrestBuilder:pL,PostgrestError:mL}=sD;function oD(){if(typeof WebSocket<"u")return WebSocket;if(typeof global.WebSocket<"u")return global.WebSocket;if(typeof window.WebSocket<"u")return window.WebSocket;if(typeof self.WebSocket<"u")return self.WebSocket;throw new Error("`WebSocket` is not supported in this environment")}const lD=oD(),cD="2.11.15",uD=`realtime-js/${cD}`,fD="1.0.0",Cv=1e4,hD=1e3;var xs;(function(t){t[t.connecting=0]="connecting",t[t.open=1]="open",t[t.closing=2]="closing",t[t.closed=3]="closed"})(xs||(xs={}));var dt;(function(t){t.closed="closed",t.errored="errored",t.joined="joined",t.joining="joining",t.leaving="leaving"})(dt||(dt={}));var Yt;(function(t){t.close="phx_close",t.error="phx_error",t.join="phx_join",t.reply="phx_reply",t.leave="phx_leave",t.access_token="access_token"})(Yt||(Yt={}));var xc;(function(t){t.websocket="websocket"})(xc||(xc={}));var Pn;(function(t){t.Connecting="connecting",t.Open="open",t.Closing="closing",t.Closed="closed"})(Pn||(Pn={}));class dD{constructor(){this.HEADER_LENGTH=1}decode(e,r){return e.constructor===ArrayBuffer?r(this._binaryDecode(e)):r(typeof e=="string"?JSON.parse(e):{})}_binaryDecode(e){const r=new DataView(e),n=new TextDecoder;return this._decodeBroadcast(e,r,n)}_decodeBroadcast(e,r,n){const i=r.getUint8(1),s=r.getUint8(2);let a=this.HEADER_LENGTH+2;const o=n.decode(e.slice(a,a+i));a=a+i;const l=n.decode(e.slice(a,a+s));a=a+s;const c=JSON.parse(n.decode(e.slice(a,e.byteLength)));return{ref:null,topic:o,event:l,payload:c}}}class Iv{constructor(e,r){this.callback=e,this.timerCalc=r,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=r}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var De;(function(t){t.abstime="abstime",t.bool="bool",t.date="date",t.daterange="daterange",t.float4="float4",t.float8="float8",t.int2="int2",t.int4="int4",t.int4range="int4range",t.int8="int8",t.int8range="int8range",t.json="json",t.jsonb="jsonb",t.money="money",t.numeric="numeric",t.oid="oid",t.reltime="reltime",t.text="text",t.time="time",t.timestamp="timestamp",t.timestamptz="timestamptz",t.timetz="timetz",t.tsrange="tsrange",t.tstzrange="tstzrange"})(De||(De={}));const y0=(t,e,r={})=>{var n;const i=(n=r.skipTypes)!==null&&n!==void 0?n:[];return Object.keys(e).reduce((s,a)=>(s[a]=pD(a,t,e,i),s),{})},pD=(t,e,r,n)=>{const i=e.find(o=>o.name===t),s=i==null?void 0:i.type,a=r[t];return s&&!n.includes(s)?kv(s,a):yc(a)},kv=(t,e)=>{if(t.charAt(0)==="_"){const r=t.slice(1,t.length);return xD(e,r)}switch(t){case De.bool:return mD(e);case De.float4:case De.float8:case De.int2:case De.int4:case De.int8:case De.numeric:case De.oid:return gD(e);case De.json:case De.jsonb:return vD(e);case De.timestamp:return yD(e);case De.abstime:case De.date:case De.daterange:case De.int4range:case De.int8range:case De.money:case De.reltime:case De.text:case De.time:case De.timestamptz:case De.timetz:case De.tsrange:case De.tstzrange:return yc(e);default:return yc(e)}},yc=t=>t,mD=t=>{switch(t){case"t":return!0;case"f":return!1;default:return t}},gD=t=>{if(typeof t=="string"){const e=parseFloat(t);if(!Number.isNaN(e))return e}return t},vD=t=>{if(typeof t=="string")try{return JSON.parse(t)}catch(e){return console.log(`JSON parse error: ${e}`),t}return t},xD=(t,e)=>{if(typeof t!="string")return t;const r=t.length-1,n=t[r];if(t[0]==="{"&&n==="}"){let s;const a=t.slice(1,r);try{s=JSON.parse("["+a+"]")}catch{s=a?a.split(","):[]}return s.map(o=>kv(e,o))}return t},yD=t=>typeof t=="string"?t.replace(" ","T"):t,Ov=t=>{let e=t;return e=e.replace(/^ws/i,"http"),e=e.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),e.replace(/\/+$/,"")};class Cl{constructor(e,r,n={},i=Cv){this.channel=e,this.event=r,this.payload=n,this.timeout=i,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,r){var n;return this._hasReceived(e)&&r((n=this.receivedResp)===null||n===void 0?void 0:n.response),this.recHooks.push({status:e,callback:r}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=r=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=r,this._matchReceive(r)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,r){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:r})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:r}){this.recHooks.filter(n=>n.status===e).forEach(n=>n.callback(r))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var w0;(function(t){t.SYNC="sync",t.JOIN="join",t.LEAVE="leave"})(w0||(w0={}));class ys{constructor(e,r){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const n=(r==null?void 0:r.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(n.state,{},i=>{const{onJoin:s,onLeave:a,onSync:o}=this.caller;this.joinRef=this.channel._joinRef(),this.state=ys.syncState(this.state,i,s,a),this.pendingDiffs.forEach(l=>{this.state=ys.syncDiff(this.state,l,s,a)}),this.pendingDiffs=[],o()}),this.channel._on(n.diff,{},i=>{const{onJoin:s,onLeave:a,onSync:o}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(i):(this.state=ys.syncDiff(this.state,i,s,a),o())}),this.onJoin((i,s,a)=>{this.channel._trigger("presence",{event:"join",key:i,currentPresences:s,newPresences:a})}),this.onLeave((i,s,a)=>{this.channel._trigger("presence",{event:"leave",key:i,currentPresences:s,leftPresences:a})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,r,n,i){const s=this.cloneDeep(e),a=this.transformState(r),o={},l={};return this.map(s,(c,u)=>{a[c]||(l[c]=u)}),this.map(a,(c,u)=>{const f=s[c];if(f){const d=u.map(g=>g.presence_ref),h=f.map(g=>g.presence_ref),m=u.filter(g=>h.indexOf(g.presence_ref)<0),p=f.filter(g=>d.indexOf(g.presence_ref)<0);m.length>0&&(o[c]=m),p.length>0&&(l[c]=p)}else o[c]=u}),this.syncDiff(s,{joins:o,leaves:l},n,i)}static syncDiff(e,r,n,i){const{joins:s,leaves:a}={joins:this.transformState(r.joins),leaves:this.transformState(r.leaves)};return n||(n=()=>{}),i||(i=()=>{}),this.map(s,(o,l)=>{var c;const u=(c=e[o])!==null&&c!==void 0?c:[];if(e[o]=this.cloneDeep(l),u.length>0){const f=e[o].map(h=>h.presence_ref),d=u.filter(h=>f.indexOf(h.presence_ref)<0);e[o].unshift(...d)}n(o,u,l)}),this.map(a,(o,l)=>{let c=e[o];if(!c)return;const u=l.map(f=>f.presence_ref);c=c.filter(f=>u.indexOf(f.presence_ref)<0),e[o]=c,i(o,c,l),c.length===0&&delete e[o]}),e}static map(e,r){return Object.getOwnPropertyNames(e).map(n=>r(n,e[n]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((r,n)=>{const i=e[n];return"metas"in i?r[n]=i.metas.map(s=>(s.presence_ref=s.phx_ref,delete s.phx_ref,delete s.phx_ref_prev,s)):r[n]=i,r},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var _0;(function(t){t.ALL="*",t.INSERT="INSERT",t.UPDATE="UPDATE",t.DELETE="DELETE"})(_0||(_0={}));var E0;(function(t){t.BROADCAST="broadcast",t.PRESENCE="presence",t.POSTGRES_CHANGES="postgres_changes",t.SYSTEM="system"})(E0||(E0={}));var br;(function(t){t.SUBSCRIBED="SUBSCRIBED",t.TIMED_OUT="TIMED_OUT",t.CLOSED="CLOSED",t.CHANNEL_ERROR="CHANNEL_ERROR"})(br||(br={}));class Bu{constructor(e,r={config:{}},n){this.topic=e,this.params=r,this.socket=n,this.bindings={},this.state=dt.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:""},private:!1},r.config),this.timeout=this.socket.timeout,this.joinPush=new Cl(this,Yt.join,this.params,this.timeout),this.rejoinTimer=new Iv(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=dt.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(i=>i.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=dt.closed,this.socket._remove(this)}),this._onError(i=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,i),this.state=dt.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=dt.errored,this.rejoinTimer.scheduleTimeout())}),this._on(Yt.reply,{},(i,s)=>{this._trigger(this._replyEventName(s),i)}),this.presence=new ys(this),this.broadcastEndpointURL=Ov(this.socket.endPoint)+"/api/broadcast",this.private=this.params.config.private||!1}subscribe(e,r=this.timeout){var n,i;if(this.socket.isConnected()||this.socket.connect(),this.state==dt.closed){const{config:{broadcast:s,presence:a,private:o}}=this.params;this._onError(u=>e==null?void 0:e(br.CHANNEL_ERROR,u)),this._onClose(()=>e==null?void 0:e(br.CLOSED));const l={},c={broadcast:s,presence:a,postgres_changes:(i=(n=this.bindings.postgres_changes)===null||n===void 0?void 0:n.map(u=>u.filter))!==null&&i!==void 0?i:[],private:o};this.socket.accessTokenValue&&(l.access_token=this.socket.accessTokenValue),this.updateJoinPayload(Object.assign({config:c},l)),this.joinedOnce=!0,this._rejoin(r),this.joinPush.receive("ok",async({postgres_changes:u})=>{var f;if(this.socket.setAuth(),u===void 0){e==null||e(br.SUBSCRIBED);return}else{const d=this.bindings.postgres_changes,h=(f=d==null?void 0:d.length)!==null&&f!==void 0?f:0,m=[];for(let p=0;p<h;p++){const g=d[p],{filter:{event:w,schema:b,table:_,filter:k}}=g,L=u&&u[p];if(L&&L.event===w&&L.schema===b&&L.table===_&&L.filter===k)m.push(Object.assign(Object.assign({},g),{id:L.id}));else{this.unsubscribe(),this.state=dt.errored,e==null||e(br.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=m,e&&e(br.SUBSCRIBED);return}}).receive("error",u=>{this.state=dt.errored,e==null||e(br.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(u).join(", ")||"error")))}).receive("timeout",()=>{e==null||e(br.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,r={}){return await this.send({type:"presence",event:"track",payload:e},r.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,r,n){return this._on(e,r,n)}async send(e,r={}){var n,i;if(!this._canPush()&&e.type==="broadcast"){const{event:s,payload:a}=e,l={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:s,payload:a,private:this.private}]})};try{const c=await this._fetchWithTimeout(this.broadcastEndpointURL,l,(n=r.timeout)!==null&&n!==void 0?n:this.timeout);return await((i=c.body)===null||i===void 0?void 0:i.cancel()),c.ok?"ok":"error"}catch(c){return c.name==="AbortError"?"timed out":"error"}}else return new Promise(s=>{var a,o,l;const c=this._push(e.type,e,r.timeout||this.timeout);e.type==="broadcast"&&!(!((l=(o=(a=this.params)===null||a===void 0?void 0:a.config)===null||o===void 0?void 0:o.broadcast)===null||l===void 0)&&l.ack)&&s("ok"),c.receive("ok",()=>s("ok")),c.receive("error",()=>s("error")),c.receive("timeout",()=>s("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=dt.leaving;const r=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(Yt.close,"leave",this._joinRef())};this.joinPush.destroy();let n=null;return new Promise(i=>{n=new Cl(this,Yt.leave,{},e),n.receive("ok",()=>{r(),i("ok")}).receive("timeout",()=>{r(),i("timed out")}).receive("error",()=>{i("error")}),n.send(),this._canPush()||n.trigger("ok",{})}).finally(()=>{n==null||n.destroy()})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.rejoinTimer&&clearTimeout(this.rejoinTimer.timer),this.joinPush.destroy()}async _fetchWithTimeout(e,r,n){const i=new AbortController,s=setTimeout(()=>i.abort(),n),a=await this.socket.fetch(e,Object.assign(Object.assign({},r),{signal:i.signal}));return clearTimeout(s),a}_push(e,r,n=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let i=new Cl(this,e,r,n);return this._canPush()?i.send():(i.startTimeout(),this.pushBuffer.push(i)),i}_onMessage(e,r,n){return r}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,r,n){var i,s;const a=e.toLocaleLowerCase(),{close:o,error:l,leave:c,join:u}=Yt;if(n&&[o,l,c,u].indexOf(a)>=0&&n!==this._joinRef())return;let d=this._onMessage(a,r,n);if(r&&!d)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(a)?(i=this.bindings.postgres_changes)===null||i===void 0||i.filter(h=>{var m,p,g;return((m=h.filter)===null||m===void 0?void 0:m.event)==="*"||((g=(p=h.filter)===null||p===void 0?void 0:p.event)===null||g===void 0?void 0:g.toLocaleLowerCase())===a}).map(h=>h.callback(d,n)):(s=this.bindings[a])===null||s===void 0||s.filter(h=>{var m,p,g,w,b,_;if(["broadcast","presence","postgres_changes"].includes(a))if("id"in h){const k=h.id,L=(m=h.filter)===null||m===void 0?void 0:m.event;return k&&((p=r.ids)===null||p===void 0?void 0:p.includes(k))&&(L==="*"||(L==null?void 0:L.toLocaleLowerCase())===((g=r.data)===null||g===void 0?void 0:g.type.toLocaleLowerCase()))}else{const k=(b=(w=h==null?void 0:h.filter)===null||w===void 0?void 0:w.event)===null||b===void 0?void 0:b.toLocaleLowerCase();return k==="*"||k===((_=r==null?void 0:r.event)===null||_===void 0?void 0:_.toLocaleLowerCase())}else return h.type.toLocaleLowerCase()===a}).map(h=>{if(typeof d=="object"&&"ids"in d){const m=d.data,{schema:p,table:g,commit_timestamp:w,type:b,errors:_}=m;d=Object.assign(Object.assign({},{schema:p,table:g,commit_timestamp:w,eventType:b,new:{},old:{},errors:_}),this._getPayloadRecords(m))}h.callback(d,n)})}_isClosed(){return this.state===dt.closed}_isJoined(){return this.state===dt.joined}_isJoining(){return this.state===dt.joining}_isLeaving(){return this.state===dt.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,r,n){const i=e.toLocaleLowerCase(),s={type:i,filter:r,callback:n};return this.bindings[i]?this.bindings[i].push(s):this.bindings[i]=[s],this}_off(e,r){const n=e.toLocaleLowerCase();return this.bindings[n]=this.bindings[n].filter(i=>{var s;return!(((s=i.type)===null||s===void 0?void 0:s.toLocaleLowerCase())===n&&Bu.isEqual(i.filter,r))}),this}static isEqual(e,r){if(Object.keys(e).length!==Object.keys(r).length)return!1;for(const n in e)if(e[n]!==r[n])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(Yt.close,{},e)}_onError(e){this._on(Yt.error,{},r=>e(r))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=dt.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const r={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(r.new=y0(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(r.old=y0(e.columns,e.old_record)),r}}const b0=()=>{},wD=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class _D{constructor(e,r){var n;this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=Cv,this.heartbeatIntervalMs=25e3,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=b0,this.ref=0,this.logger=b0,this.conn=null,this.sendBuffer=[],this.serializer=new dD,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._resolveFetch=s=>{let a;return s?a=s:typeof fetch>"u"?a=(...o)=>Zs(()=>Promise.resolve().then(()=>zi),void 0).then(({default:l})=>l(...o)):a=fetch,(...o)=>a(...o)},this.endPoint=`${e}/${xc.websocket}`,this.httpEndpoint=Ov(e),r!=null&&r.transport?this.transport=r.transport:this.transport=null,r!=null&&r.params&&(this.params=r.params),r!=null&&r.timeout&&(this.timeout=r.timeout),r!=null&&r.logger&&(this.logger=r.logger),(r!=null&&r.logLevel||r!=null&&r.log_level)&&(this.logLevel=r.logLevel||r.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),r!=null&&r.heartbeatIntervalMs&&(this.heartbeatIntervalMs=r.heartbeatIntervalMs);const i=(n=r==null?void 0:r.params)===null||n===void 0?void 0:n.apikey;if(i&&(this.accessTokenValue=i,this.apiKey=i),this.reconnectAfterMs=r!=null&&r.reconnectAfterMs?r.reconnectAfterMs:s=>[1e3,2e3,5e3,1e4][s-1]||1e4,this.encode=r!=null&&r.encode?r.encode:(s,a)=>a(JSON.stringify(s)),this.decode=r!=null&&r.decode?r.decode:this.serializer.decode.bind(this.serializer),this.reconnectTimer=new Iv(async()=>{this.disconnect(),this.connect()},this.reconnectAfterMs),this.fetch=this._resolveFetch(r==null?void 0:r.fetch),r!=null&&r.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.worker=(r==null?void 0:r.worker)||!1,this.workerUrl=r==null?void 0:r.workerUrl}this.accessToken=(r==null?void 0:r.accessToken)||null}connect(){if(!this.conn){if(this.transport||(this.transport=lD),!this.transport)throw new Error("No transport provided");this.conn=new this.transport(this.endpointURL()),this.setupConnection()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:fD}))}disconnect(e,r){this.conn&&(this.conn.onclose=function(){},e?this.conn.close(e,r??""):this.conn.close(),this.conn=null,this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.reset(),this.channels.forEach(n=>n.teardown()))}getChannels(){return this.channels}async removeChannel(e){const r=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),r}async removeAllChannels(){const e=await Promise.all(this.channels.map(r=>r.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,r,n){this.logger(e,r,n)}connectionState(){switch(this.conn&&this.conn.readyState){case xs.connecting:return Pn.Connecting;case xs.open:return Pn.Open;case xs.closing:return Pn.Closing;default:return Pn.Closed}}isConnected(){return this.connectionState()===Pn.Open}channel(e,r={config:{}}){const n=`realtime:${e}`,i=this.getChannels().find(s=>s.topic===n);if(i)return i;{const s=new Bu(`realtime:${e}`,r,this);return this.channels.push(s),s}}push(e){const{topic:r,event:n,payload:i,ref:s}=e,a=()=>{this.encode(e,o=>{var l;(l=this.conn)===null||l===void 0||l.send(o)})};this.log("push",`${r} ${n} (${s})`,i),this.isConnected()?a():this.sendBuffer.push(a)}async setAuth(e=null){let r=e||this.accessToken&&await this.accessToken()||this.accessTokenValue;this.accessTokenValue!=r&&(this.accessTokenValue=r,this.channels.forEach(n=>{const i={access_token:r,version:uD};r&&n.updateJoinPayload(i),n.joinedOnce&&n._isJoined()&&n._push(Yt.access_token,{access_token:r})}))}async sendHeartbeat(){var e;if(!this.isConnected()){this.heartbeatCallback("disconnected");return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),this.heartbeatCallback("timeout"),(e=this.conn)===null||e===void 0||e.close(hD,"hearbeat timeout");return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.heartbeatCallback("sent"),await this.setAuth()}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let r=this.channels.find(n=>n.topic===e&&(n._isJoined()||n._isJoining()));r&&(this.log("transport",`leaving duplicate topic "${e}"`),r.unsubscribe())}_remove(e){this.channels=this.channels.filter(r=>r.topic!==e.topic)}setupConnection(){this.conn&&(this.conn.binaryType="arraybuffer",this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_onConnMessage(e){this.decode(e.data,r=>{let{topic:n,event:i,payload:s,ref:a}=r;n==="phoenix"&&i==="phx_reply"&&this.heartbeatCallback(r.payload.status=="ok"?"ok":"error"),a&&a===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null),this.log("receive",`${s.status||""} ${n} ${i} ${a&&"("+a+")"||""}`,s),Array.from(this.channels).filter(o=>o._isMember(n)).forEach(o=>o._trigger(i,s,a)),this.stateChangeCallbacks.message.forEach(o=>o(r))})}_onConnOpen(){this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this.reconnectTimer.reset(),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this.stateChangeCallbacks.open.forEach(e=>e())}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=r=>{this.log("worker","worker error",r.message),this.workerRef.terminate()},this.workerRef.onmessage=r=>{r.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(e){this.log("transport","close",e),this._triggerChanError(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach(r=>r(e))}_onConnError(e){this.log("transport",`${e}`),this._triggerChanError(),this.stateChangeCallbacks.error.forEach(r=>r(e))}_triggerChanError(){this.channels.forEach(e=>e._trigger(Yt.error))}_appendParams(e,r){if(Object.keys(r).length===0)return e;const n=e.match(/\?/)?"&":"?",i=new URLSearchParams(r);return`${e}${n}${i}`}_workerObjectUrl(e){let r;if(e)r=e;else{const n=new Blob([wD],{type:"application/javascript"});r=URL.createObjectURL(n)}return r}}class Uu extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function Je(t){return typeof t=="object"&&t!==null&&"__isStorageError"in t}class ED extends Uu{constructor(e,r){super(e),this.name="StorageApiError",this.status=r}toJSON(){return{name:this.name,message:this.message,status:this.status}}}class wc extends Uu{constructor(e,r){super(e),this.name="StorageUnknownError",this.originalError=r}}var bD=globalThis&&globalThis.__awaiter||function(t,e,r,n){function i(s){return s instanceof r?s:new r(function(a){a(s)})}return new(r||(r=Promise))(function(s,a){function o(u){try{c(n.next(u))}catch(f){a(f)}}function l(u){try{c(n.throw(u))}catch(f){a(f)}}function c(u){u.done?s(u.value):i(u.value).then(o,l)}c((n=n.apply(t,e||[])).next())})};const Rv=t=>{let e;return t?e=t:typeof fetch>"u"?e=(...r)=>Zs(()=>Promise.resolve().then(()=>zi),void 0).then(({default:n})=>n(...r)):e=fetch,(...r)=>e(...r)},TD=()=>bD(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield Zs(()=>Promise.resolve().then(()=>zi),void 0)).Response:Response}),_c=t=>{if(Array.isArray(t))return t.map(r=>_c(r));if(typeof t=="function"||t!==Object(t))return t;const e={};return Object.entries(t).forEach(([r,n])=>{const i=r.replace(/([-_][a-z])/gi,s=>s.toUpperCase().replace(/[-_]/g,""));e[i]=_c(n)}),e};var si=globalThis&&globalThis.__awaiter||function(t,e,r,n){function i(s){return s instanceof r?s:new r(function(a){a(s)})}return new(r||(r=Promise))(function(s,a){function o(u){try{c(n.next(u))}catch(f){a(f)}}function l(u){try{c(n.throw(u))}catch(f){a(f)}}function c(u){u.done?s(u.value):i(u.value).then(o,l)}c((n=n.apply(t,e||[])).next())})};const Il=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),SD=(t,e,r)=>si(void 0,void 0,void 0,function*(){const n=yield TD();t instanceof n&&!(r!=null&&r.noResolveJson)?t.json().then(i=>{e(new ED(Il(i),t.status||500))}).catch(i=>{e(new wc(Il(i),i))}):e(new wc(Il(t),t))}),AD=(t,e,r,n)=>{const i={method:t,headers:(e==null?void 0:e.headers)||{}};return t==="GET"?i:(i.headers=Object.assign({"Content-Type":"application/json"},e==null?void 0:e.headers),n&&(i.body=JSON.stringify(n)),Object.assign(Object.assign({},i),r))};function ta(t,e,r,n,i,s){return si(this,void 0,void 0,function*(){return new Promise((a,o)=>{t(r,AD(e,n,i,s)).then(l=>{if(!l.ok)throw l;return n!=null&&n.noResolveJson?l:l.json()}).then(l=>a(l)).catch(l=>SD(l,o,n))})})}function lo(t,e,r,n){return si(this,void 0,void 0,function*(){return ta(t,"GET",e,r,n)})}function Jr(t,e,r,n,i){return si(this,void 0,void 0,function*(){return ta(t,"POST",e,n,i,r)})}function CD(t,e,r,n,i){return si(this,void 0,void 0,function*(){return ta(t,"PUT",e,n,i,r)})}function ID(t,e,r,n){return si(this,void 0,void 0,function*(){return ta(t,"HEAD",e,Object.assign(Object.assign({},r),{noResolveJson:!0}),n)})}function Pv(t,e,r,n,i){return si(this,void 0,void 0,function*(){return ta(t,"DELETE",e,n,i,r)})}var Tt=globalThis&&globalThis.__awaiter||function(t,e,r,n){function i(s){return s instanceof r?s:new r(function(a){a(s)})}return new(r||(r=Promise))(function(s,a){function o(u){try{c(n.next(u))}catch(f){a(f)}}function l(u){try{c(n.throw(u))}catch(f){a(f)}}function c(u){u.done?s(u.value):i(u.value).then(o,l)}c((n=n.apply(t,e||[])).next())})};const kD={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},T0={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class OD{constructor(e,r={},n,i){this.url=e,this.headers=r,this.bucketId=n,this.fetch=Rv(i)}uploadOrUpdate(e,r,n,i){return Tt(this,void 0,void 0,function*(){try{let s;const a=Object.assign(Object.assign({},T0),i);let o=Object.assign(Object.assign({},this.headers),e==="POST"&&{"x-upsert":String(a.upsert)});const l=a.metadata;typeof Blob<"u"&&n instanceof Blob?(s=new FormData,s.append("cacheControl",a.cacheControl),l&&s.append("metadata",this.encodeMetadata(l)),s.append("",n)):typeof FormData<"u"&&n instanceof FormData?(s=n,s.append("cacheControl",a.cacheControl),l&&s.append("metadata",this.encodeMetadata(l))):(s=n,o["cache-control"]=`max-age=${a.cacheControl}`,o["content-type"]=a.contentType,l&&(o["x-metadata"]=this.toBase64(this.encodeMetadata(l)))),i!=null&&i.headers&&(o=Object.assign(Object.assign({},o),i.headers));const c=this._removeEmptyFolders(r),u=this._getFinalPath(c),f=yield this.fetch(`${this.url}/object/${u}`,Object.assign({method:e,body:s,headers:o},a!=null&&a.duplex?{duplex:a.duplex}:{})),d=yield f.json();return f.ok?{data:{path:c,id:d.Id,fullPath:d.Key},error:null}:{data:null,error:d}}catch(s){if(Je(s))return{data:null,error:s};throw s}})}upload(e,r,n){return Tt(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,r,n)})}uploadToSignedUrl(e,r,n,i){return Tt(this,void 0,void 0,function*(){const s=this._removeEmptyFolders(e),a=this._getFinalPath(s),o=new URL(this.url+`/object/upload/sign/${a}`);o.searchParams.set("token",r);try{let l;const c=Object.assign({upsert:T0.upsert},i),u=Object.assign(Object.assign({},this.headers),{"x-upsert":String(c.upsert)});typeof Blob<"u"&&n instanceof Blob?(l=new FormData,l.append("cacheControl",c.cacheControl),l.append("",n)):typeof FormData<"u"&&n instanceof FormData?(l=n,l.append("cacheControl",c.cacheControl)):(l=n,u["cache-control"]=`max-age=${c.cacheControl}`,u["content-type"]=c.contentType);const f=yield this.fetch(o.toString(),{method:"PUT",body:l,headers:u}),d=yield f.json();return f.ok?{data:{path:s,fullPath:d.Key},error:null}:{data:null,error:d}}catch(l){if(Je(l))return{data:null,error:l};throw l}})}createSignedUploadUrl(e,r){return Tt(this,void 0,void 0,function*(){try{let n=this._getFinalPath(e);const i=Object.assign({},this.headers);r!=null&&r.upsert&&(i["x-upsert"]="true");const s=yield Jr(this.fetch,`${this.url}/object/upload/sign/${n}`,{},{headers:i}),a=new URL(this.url+s.url),o=a.searchParams.get("token");if(!o)throw new Uu("No token returned by API");return{data:{signedUrl:a.toString(),path:e,token:o},error:null}}catch(n){if(Je(n))return{data:null,error:n};throw n}})}update(e,r,n){return Tt(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,r,n)})}move(e,r,n){return Tt(this,void 0,void 0,function*(){try{return{data:yield Jr(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:r,destinationBucket:n==null?void 0:n.destinationBucket},{headers:this.headers}),error:null}}catch(i){if(Je(i))return{data:null,error:i};throw i}})}copy(e,r,n){return Tt(this,void 0,void 0,function*(){try{return{data:{path:(yield Jr(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:r,destinationBucket:n==null?void 0:n.destinationBucket},{headers:this.headers})).Key},error:null}}catch(i){if(Je(i))return{data:null,error:i};throw i}})}createSignedUrl(e,r,n){return Tt(this,void 0,void 0,function*(){try{let i=this._getFinalPath(e),s=yield Jr(this.fetch,`${this.url}/object/sign/${i}`,Object.assign({expiresIn:r},n!=null&&n.transform?{transform:n.transform}:{}),{headers:this.headers});const a=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return s={signedUrl:encodeURI(`${this.url}${s.signedURL}${a}`)},{data:s,error:null}}catch(i){if(Je(i))return{data:null,error:i};throw i}})}createSignedUrls(e,r,n){return Tt(this,void 0,void 0,function*(){try{const i=yield Jr(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:r,paths:e},{headers:this.headers}),s=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return{data:i.map(a=>Object.assign(Object.assign({},a),{signedUrl:a.signedURL?encodeURI(`${this.url}${a.signedURL}${s}`):null})),error:null}}catch(i){if(Je(i))return{data:null,error:i};throw i}})}download(e,r){return Tt(this,void 0,void 0,function*(){const i=typeof(r==null?void 0:r.transform)<"u"?"render/image/authenticated":"object",s=this.transformOptsToQueryString((r==null?void 0:r.transform)||{}),a=s?`?${s}`:"";try{const o=this._getFinalPath(e);return{data:yield(yield lo(this.fetch,`${this.url}/${i}/${o}${a}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(o){if(Je(o))return{data:null,error:o};throw o}})}info(e){return Tt(this,void 0,void 0,function*(){const r=this._getFinalPath(e);try{const n=yield lo(this.fetch,`${this.url}/object/info/${r}`,{headers:this.headers});return{data:_c(n),error:null}}catch(n){if(Je(n))return{data:null,error:n};throw n}})}exists(e){return Tt(this,void 0,void 0,function*(){const r=this._getFinalPath(e);try{return yield ID(this.fetch,`${this.url}/object/${r}`,{headers:this.headers}),{data:!0,error:null}}catch(n){if(Je(n)&&n instanceof wc){const i=n.originalError;if([400,404].includes(i==null?void 0:i.status))return{data:!1,error:n}}throw n}})}getPublicUrl(e,r){const n=this._getFinalPath(e),i=[],s=r!=null&&r.download?`download=${r.download===!0?"":r.download}`:"";s!==""&&i.push(s);const o=typeof(r==null?void 0:r.transform)<"u"?"render/image":"object",l=this.transformOptsToQueryString((r==null?void 0:r.transform)||{});l!==""&&i.push(l);let c=i.join("&");return c!==""&&(c=`?${c}`),{data:{publicUrl:encodeURI(`${this.url}/${o}/public/${n}${c}`)}}}remove(e){return Tt(this,void 0,void 0,function*(){try{return{data:yield Pv(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(r){if(Je(r))return{data:null,error:r};throw r}})}list(e,r,n){return Tt(this,void 0,void 0,function*(){try{const i=Object.assign(Object.assign(Object.assign({},kD),r),{prefix:e||""});return{data:yield Jr(this.fetch,`${this.url}/object/list/${this.bucketId}`,i,{headers:this.headers},n),error:null}}catch(i){if(Je(i))return{data:null,error:i};throw i}})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return typeof Buffer<"u"?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const r=[];return e.width&&r.push(`width=${e.width}`),e.height&&r.push(`height=${e.height}`),e.resize&&r.push(`resize=${e.resize}`),e.format&&r.push(`format=${e.format}`),e.quality&&r.push(`quality=${e.quality}`),r.join("&")}}const RD="2.7.1",PD={"X-Client-Info":`storage-js/${RD}`};var ui=globalThis&&globalThis.__awaiter||function(t,e,r,n){function i(s){return s instanceof r?s:new r(function(a){a(s)})}return new(r||(r=Promise))(function(s,a){function o(u){try{c(n.next(u))}catch(f){a(f)}}function l(u){try{c(n.throw(u))}catch(f){a(f)}}function c(u){u.done?s(u.value):i(u.value).then(o,l)}c((n=n.apply(t,e||[])).next())})};class FD{constructor(e,r={},n){this.url=e,this.headers=Object.assign(Object.assign({},PD),r),this.fetch=Rv(n)}listBuckets(){return ui(this,void 0,void 0,function*(){try{return{data:yield lo(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(e){if(Je(e))return{data:null,error:e};throw e}})}getBucket(e){return ui(this,void 0,void 0,function*(){try{return{data:yield lo(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(r){if(Je(r))return{data:null,error:r};throw r}})}createBucket(e,r={public:!1}){return ui(this,void 0,void 0,function*(){try{return{data:yield Jr(this.fetch,`${this.url}/bucket`,{id:e,name:e,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(Je(n))return{data:null,error:n};throw n}})}updateBucket(e,r){return ui(this,void 0,void 0,function*(){try{return{data:yield CD(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(Je(n))return{data:null,error:n};throw n}})}emptyBucket(e){return ui(this,void 0,void 0,function*(){try{return{data:yield Jr(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(r){if(Je(r))return{data:null,error:r};throw r}})}deleteBucket(e){return ui(this,void 0,void 0,function*(){try{return{data:yield Pv(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(r){if(Je(r))return{data:null,error:r};throw r}})}}class ND extends FD{constructor(e,r={},n){super(e,r,n)}from(e){return new OD(this.url,this.headers,e,this.fetch)}}const DD="2.52.0";let as="";typeof Deno<"u"?as="deno":typeof document<"u"?as="web":typeof navigator<"u"&&navigator.product==="ReactNative"?as="react-native":as="node";const LD={"X-Client-Info":`supabase-js-${as}/${DD}`},MD={headers:LD},jD={schema:"public"},$D={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},BD={};var UD=globalThis&&globalThis.__awaiter||function(t,e,r,n){function i(s){return s instanceof r?s:new r(function(a){a(s)})}return new(r||(r=Promise))(function(s,a){function o(u){try{c(n.next(u))}catch(f){a(f)}}function l(u){try{c(n.throw(u))}catch(f){a(f)}}function c(u){u.done?s(u.value):i(u.value).then(o,l)}c((n=n.apply(t,e||[])).next())})};const HD=t=>{let e;return t?e=t:typeof fetch>"u"?e=gv:e=fetch,(...r)=>e(...r)},WD=()=>typeof Headers>"u"?vv:Headers,VD=(t,e,r)=>{const n=HD(r),i=WD();return(s,a)=>UD(void 0,void 0,void 0,function*(){var o;const l=(o=yield e())!==null&&o!==void 0?o:t;let c=new i(a==null?void 0:a.headers);return c.has("apikey")||c.set("apikey",t),c.has("Authorization")||c.set("Authorization",`Bearer ${l}`),n(s,Object.assign(Object.assign({},a),{headers:c}))})};var GD=globalThis&&globalThis.__awaiter||function(t,e,r,n){function i(s){return s instanceof r?s:new r(function(a){a(s)})}return new(r||(r=Promise))(function(s,a){function o(u){try{c(n.next(u))}catch(f){a(f)}}function l(u){try{c(n.throw(u))}catch(f){a(f)}}function c(u){u.done?s(u.value):i(u.value).then(o,l)}c((n=n.apply(t,e||[])).next())})};function zD(t){return t.endsWith("/")?t:t+"/"}function qD(t,e){var r,n;const{db:i,auth:s,realtime:a,global:o}=t,{db:l,auth:c,realtime:u,global:f}=e,d={db:Object.assign(Object.assign({},l),i),auth:Object.assign(Object.assign({},c),s),realtime:Object.assign(Object.assign({},u),a),global:Object.assign(Object.assign(Object.assign({},f),o),{headers:Object.assign(Object.assign({},(r=f==null?void 0:f.headers)!==null&&r!==void 0?r:{}),(n=o==null?void 0:o.headers)!==null&&n!==void 0?n:{})}),accessToken:()=>GD(this,void 0,void 0,function*(){return""})};return t.accessToken?d.accessToken=t.accessToken:delete d.accessToken,d}const Fv="2.71.1",gi=30*1e3,Ec=3,kl=Ec*gi,KD="http://localhost:9999",XD="supabase.auth.token",YD={"X-Client-Info":`gotrue-js/${Fv}`},bc="X-Supabase-Api-Version",Nv={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},JD=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,QD=10*60*1e3;class Hu extends Error{constructor(e,r,n){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=r,this.code=n}}function me(t){return typeof t=="object"&&t!==null&&"__isAuthError"in t}class ZD extends Hu{constructor(e,r,n){super(e,r,n),this.name="AuthApiError",this.status=r,this.code=n}}function e5(t){return me(t)&&t.name==="AuthApiError"}class Dv extends Hu{constructor(e,r){super(e),this.name="AuthUnknownError",this.originalError=r}}class wn extends Hu{constructor(e,r,n,i){super(e,n,i),this.name=r,this.status=n}}class Xr extends wn{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function t5(t){return me(t)&&t.name==="AuthSessionMissingError"}class wa extends wn{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class _a extends wn{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class Ea extends wn{constructor(e,r=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function r5(t){return me(t)&&t.name==="AuthImplicitGrantRedirectError"}class S0 extends wn{constructor(e,r=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class Tc extends wn{constructor(e,r){super(e,"AuthRetryableFetchError",r,void 0)}}function Ol(t){return me(t)&&t.name==="AuthRetryableFetchError"}class A0 extends wn{constructor(e,r,n){super(e,"AuthWeakPasswordError",r,"weak_password"),this.reasons=n}}class Sc extends wn{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const co="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),C0=` 	
\r=`.split(""),n5=(()=>{const t=new Array(128);for(let e=0;e<t.length;e+=1)t[e]=-1;for(let e=0;e<C0.length;e+=1)t[C0[e].charCodeAt(0)]=-2;for(let e=0;e<co.length;e+=1)t[co[e].charCodeAt(0)]=e;return t})();function I0(t,e,r){if(t!==null)for(e.queue=e.queue<<8|t,e.queuedBits+=8;e.queuedBits>=6;){const n=e.queue>>e.queuedBits-6&63;r(co[n]),e.queuedBits-=6}else if(e.queuedBits>0)for(e.queue=e.queue<<6-e.queuedBits,e.queuedBits=6;e.queuedBits>=6;){const n=e.queue>>e.queuedBits-6&63;r(co[n]),e.queuedBits-=6}}function Lv(t,e,r){const n=n5[t];if(n>-1)for(e.queue=e.queue<<6|n,e.queuedBits+=6;e.queuedBits>=8;)r(e.queue>>e.queuedBits-8&255),e.queuedBits-=8;else{if(n===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(t)}"`)}}function k0(t){const e=[],r=a=>{e.push(String.fromCodePoint(a))},n={utf8seq:0,codepoint:0},i={queue:0,queuedBits:0},s=a=>{a5(a,n,r)};for(let a=0;a<t.length;a+=1)Lv(t.charCodeAt(a),i,s);return e.join("")}function i5(t,e){if(t<=127){e(t);return}else if(t<=2047){e(192|t>>6),e(128|t&63);return}else if(t<=65535){e(224|t>>12),e(128|t>>6&63),e(128|t&63);return}else if(t<=1114111){e(240|t>>18),e(128|t>>12&63),e(128|t>>6&63),e(128|t&63);return}throw new Error(`Unrecognized Unicode codepoint: ${t.toString(16)}`)}function s5(t,e){for(let r=0;r<t.length;r+=1){let n=t.charCodeAt(r);if(n>55295&&n<=56319){const i=(n-55296)*1024&65535;n=(t.charCodeAt(r+1)-56320&65535|i)+65536,r+=1}i5(n,e)}}function a5(t,e,r){if(e.utf8seq===0){if(t<=127){r(t);return}for(let n=1;n<6;n+=1)if(!(t>>7-n&1)){e.utf8seq=n;break}if(e.utf8seq===2)e.codepoint=t&31;else if(e.utf8seq===3)e.codepoint=t&15;else if(e.utf8seq===4)e.codepoint=t&7;else throw new Error("Invalid UTF-8 sequence");e.utf8seq-=1}else if(e.utf8seq>0){if(t<=127)throw new Error("Invalid UTF-8 sequence");e.codepoint=e.codepoint<<6|t&63,e.utf8seq-=1,e.utf8seq===0&&r(e.codepoint)}}function o5(t){const e=[],r={queue:0,queuedBits:0},n=i=>{e.push(i)};for(let i=0;i<t.length;i+=1)Lv(t.charCodeAt(i),r,n);return new Uint8Array(e)}function l5(t){const e=[];return s5(t,r=>e.push(r)),new Uint8Array(e)}function c5(t){const e=[],r={queue:0,queuedBits:0},n=i=>{e.push(i)};return t.forEach(i=>I0(i,r,n)),I0(null,r,n),e.join("")}function u5(t){return Math.round(Date.now()/1e3)+t}function f5(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){const e=Math.random()*16|0;return(t=="x"?e:e&3|8).toString(16)})}const Xt=()=>typeof window<"u"&&typeof document<"u",Sn={tested:!1,writable:!1},Mv=()=>{if(!Xt())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Sn.tested)return Sn.writable;const t=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(t,t),globalThis.localStorage.removeItem(t),Sn.tested=!0,Sn.writable=!0}catch{Sn.tested=!0,Sn.writable=!1}return Sn.writable};function h5(t){const e={},r=new URL(t);if(r.hash&&r.hash[0]==="#")try{new URLSearchParams(r.hash.substring(1)).forEach((i,s)=>{e[s]=i})}catch{}return r.searchParams.forEach((n,i)=>{e[i]=n}),e}const jv=t=>{let e;return t?e=t:typeof fetch>"u"?e=(...r)=>Zs(()=>Promise.resolve().then(()=>zi),void 0).then(({default:n})=>n(...r)):e=fetch,(...r)=>e(...r)},d5=t=>typeof t=="object"&&t!==null&&"status"in t&&"ok"in t&&"json"in t&&typeof t.json=="function",vi=async(t,e,r)=>{await t.setItem(e,JSON.stringify(r))},An=async(t,e)=>{const r=await t.getItem(e);if(!r)return null;try{return JSON.parse(r)}catch{return r}},Kr=async(t,e)=>{await t.removeItem(e)};class Go{constructor(){this.promise=new Go.promiseConstructor((e,r)=>{this.resolve=e,this.reject=r})}}Go.promiseConstructor=Promise;function Rl(t){const e=t.split(".");if(e.length!==3)throw new Sc("Invalid JWT structure");for(let n=0;n<e.length;n++)if(!JD.test(e[n]))throw new Sc("JWT not in base64url format");return{header:JSON.parse(k0(e[0])),payload:JSON.parse(k0(e[1])),signature:o5(e[2]),raw:{header:e[0],payload:e[1]}}}async function p5(t){return await new Promise(e=>{setTimeout(()=>e(null),t)})}function m5(t,e){return new Promise((n,i)=>{(async()=>{for(let s=0;s<1/0;s++)try{const a=await t(s);if(!e(s,null,a)){n(a);return}}catch(a){if(!e(s,a)){i(a);return}}})()})}function g5(t){return("0"+t.toString(16)).substr(-2)}function v5(){const e=new Uint32Array(56);if(typeof crypto>"u"){const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",n=r.length;let i="";for(let s=0;s<56;s++)i+=r.charAt(Math.floor(Math.random()*n));return i}return crypto.getRandomValues(e),Array.from(e,g5).join("")}async function x5(t){const r=new TextEncoder().encode(t),n=await crypto.subtle.digest("SHA-256",r),i=new Uint8Array(n);return Array.from(i).map(s=>String.fromCharCode(s)).join("")}async function y5(t){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),t;const r=await x5(t);return btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function fi(t,e,r=!1){const n=v5();let i=n;r&&(i+="/PASSWORD_RECOVERY"),await vi(t,`${e}-code-verifier`,i);const s=await y5(n);return[s,n===s?"plain":"s256"]}const w5=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function _5(t){const e=t.headers.get(bc);if(!e||!e.match(w5))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}function E5(t){if(!t)throw new Error("Missing exp claim");const e=Math.floor(Date.now()/1e3);if(t<=e)throw new Error("JWT has expired")}function b5(t){switch(t){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const T5=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function hi(t){if(!T5.test(t))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function Pl(){const t={};return new Proxy(t,{get:(e,r)=>{if(r==="__isUserNotAvailableProxy")return!0;if(typeof r=="symbol"){const n=r.toString();if(n==="Symbol(Symbol.toPrimitive)"||n==="Symbol(Symbol.toStringTag)"||n==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${r}" property of the session object is not supported. Please use getUser() instead.`)},set:(e,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(e,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function O0(t){return JSON.parse(JSON.stringify(t))}var S5=globalThis&&globalThis.__rest||function(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(t);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]]);return r};const kn=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),A5=[502,503,504];async function R0(t){var e;if(!d5(t))throw new Tc(kn(t),0);if(A5.includes(t.status))throw new Tc(kn(t),t.status);let r;try{r=await t.json()}catch(s){throw new Dv(kn(s),s)}let n;const i=_5(t);if(i&&i.getTime()>=Nv["2024-01-01"].timestamp&&typeof r=="object"&&r&&typeof r.code=="string"?n=r.code:typeof r=="object"&&r&&typeof r.error_code=="string"&&(n=r.error_code),n){if(n==="weak_password")throw new A0(kn(r),t.status,((e=r.weak_password)===null||e===void 0?void 0:e.reasons)||[]);if(n==="session_not_found")throw new Xr}else if(typeof r=="object"&&r&&typeof r.weak_password=="object"&&r.weak_password&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.reasons.reduce((s,a)=>s&&typeof a=="string",!0))throw new A0(kn(r),t.status,r.weak_password.reasons);throw new ZD(kn(r),t.status||500,n)}const C5=(t,e,r,n)=>{const i={method:t,headers:(e==null?void 0:e.headers)||{}};return t==="GET"?i:(i.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e==null?void 0:e.headers),i.body=JSON.stringify(n),Object.assign(Object.assign({},i),r))};async function Ee(t,e,r,n){var i;const s=Object.assign({},n==null?void 0:n.headers);s[bc]||(s[bc]=Nv["2024-01-01"].name),n!=null&&n.jwt&&(s.Authorization=`Bearer ${n.jwt}`);const a=(i=n==null?void 0:n.query)!==null&&i!==void 0?i:{};n!=null&&n.redirectTo&&(a.redirect_to=n.redirectTo);const o=Object.keys(a).length?"?"+new URLSearchParams(a).toString():"",l=await I5(t,e,r+o,{headers:s,noResolveJson:n==null?void 0:n.noResolveJson},{},n==null?void 0:n.body);return n!=null&&n.xform?n==null?void 0:n.xform(l):{data:Object.assign({},l),error:null}}async function I5(t,e,r,n,i,s){const a=C5(e,n,i,s);let o;try{o=await t(r,Object.assign({},a))}catch(l){throw console.error(l),new Tc(kn(l),0)}if(o.ok||await R0(o),n!=null&&n.noResolveJson)return o;try{return await o.json()}catch(l){await R0(l)}}function Er(t){var e;let r=null;P5(t)&&(r=Object.assign({},t),t.expires_at||(r.expires_at=u5(t.expires_in)));const n=(e=t.user)!==null&&e!==void 0?e:t;return{data:{session:r,user:n},error:null}}function P0(t){const e=Er(t);return!e.error&&t.weak_password&&typeof t.weak_password=="object"&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.message&&typeof t.weak_password.message=="string"&&t.weak_password.reasons.reduce((r,n)=>r&&typeof n=="string",!0)&&(e.data.weak_password=t.weak_password),e}function rn(t){var e;return{data:{user:(e=t.user)!==null&&e!==void 0?e:t},error:null}}function k5(t){return{data:t,error:null}}function O5(t){const{action_link:e,email_otp:r,hashed_token:n,redirect_to:i,verification_type:s}=t,a=S5(t,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),o={action_link:e,email_otp:r,hashed_token:n,redirect_to:i,verification_type:s},l=Object.assign({},a);return{data:{properties:o,user:l},error:null}}function R5(t){return t}function P5(t){return t.access_token&&t.refresh_token&&t.expires_in}const Fl=["global","local","others"];var F5=globalThis&&globalThis.__rest||function(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(t);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]]);return r};class N5{constructor({url:e="",headers:r={},fetch:n}){this.url=e,this.headers=r,this.fetch=jv(n),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(e,r=Fl[0]){if(Fl.indexOf(r)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${Fl.join(", ")}`);try{return await Ee(this.fetch,"POST",`${this.url}/logout?scope=${r}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(n){if(me(n))return{data:null,error:n};throw n}}async inviteUserByEmail(e,r={}){try{return await Ee(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:r.data},headers:this.headers,redirectTo:r.redirectTo,xform:rn})}catch(n){if(me(n))return{data:{user:null},error:n};throw n}}async generateLink(e){try{const{options:r}=e,n=F5(e,["options"]),i=Object.assign(Object.assign({},n),r);return"newEmail"in n&&(i.new_email=n==null?void 0:n.newEmail,delete i.newEmail),await Ee(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:i,headers:this.headers,xform:O5,redirectTo:r==null?void 0:r.redirectTo})}catch(r){if(me(r))return{data:{properties:null,user:null},error:r};throw r}}async createUser(e){try{return await Ee(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:rn})}catch(r){if(me(r))return{data:{user:null},error:r};throw r}}async listUsers(e){var r,n,i,s,a,o,l;try{const c={nextPage:null,lastPage:0,total:0},u=await Ee(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(r=e==null?void 0:e.page)===null||r===void 0?void 0:r.toString())!==null&&n!==void 0?n:"",per_page:(s=(i=e==null?void 0:e.perPage)===null||i===void 0?void 0:i.toString())!==null&&s!==void 0?s:""},xform:R5});if(u.error)throw u.error;const f=await u.json(),d=(a=u.headers.get("x-total-count"))!==null&&a!==void 0?a:0,h=(l=(o=u.headers.get("link"))===null||o===void 0?void 0:o.split(","))!==null&&l!==void 0?l:[];return h.length>0&&(h.forEach(m=>{const p=parseInt(m.split(";")[0].split("=")[1].substring(0,1)),g=JSON.parse(m.split(";")[1].split("=")[1]);c[`${g}Page`]=p}),c.total=parseInt(d)),{data:Object.assign(Object.assign({},f),c),error:null}}catch(c){if(me(c))return{data:{users:[]},error:c};throw c}}async getUserById(e){hi(e);try{return await Ee(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:rn})}catch(r){if(me(r))return{data:{user:null},error:r};throw r}}async updateUserById(e,r){hi(e);try{return await Ee(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:r,headers:this.headers,xform:rn})}catch(n){if(me(n))return{data:{user:null},error:n};throw n}}async deleteUser(e,r=!1){hi(e);try{return await Ee(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:r},xform:rn})}catch(n){if(me(n))return{data:{user:null},error:n};throw n}}async _listFactors(e){hi(e.userId);try{const{data:r,error:n}=await Ee(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:i=>({data:{factors:i},error:null})});return{data:r,error:n}}catch(r){if(me(r))return{data:null,error:r};throw r}}async _deleteFactor(e){hi(e.userId),hi(e.id);try{return{data:await Ee(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(r){if(me(r))return{data:null,error:r};throw r}}}function F0(t={}){return{getItem:e=>t[e]||null,setItem:(e,r)=>{t[e]=r},removeItem:e=>{delete t[e]}}}function D5(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const di={debug:!!(globalThis&&Mv()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class $v extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class L5 extends $v{}async function M5(t,e,r){di.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",t,e);const n=new globalThis.AbortController;return e>0&&setTimeout(()=>{n.abort(),di.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",t)},e),await Promise.resolve().then(()=>globalThis.navigator.locks.request(t,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:n.signal},async i=>{if(i){di.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",t,i.name);try{return await r()}finally{di.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",t,i.name)}}else{if(e===0)throw di.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",t),new L5(`Acquiring an exclusive Navigator LockManager lock "${t}" immediately failed`);if(di.debug)try{const s=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(s,null,"  "))}catch(s){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",s)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await r()}}))}D5();const j5={url:KD,storageKey:XD,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:YD,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function N0(t,e,r){return await r()}const pi={};class Ps{constructor(e){var r,n;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=Ps.nextInstanceID,Ps.nextInstanceID+=1,this.instanceID>0&&Xt()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const i=Object.assign(Object.assign({},j5),e);if(this.logDebugMessages=!!i.debug,typeof i.debug=="function"&&(this.logger=i.debug),this.persistSession=i.persistSession,this.storageKey=i.storageKey,this.autoRefreshToken=i.autoRefreshToken,this.admin=new N5({url:i.url,headers:i.headers,fetch:i.fetch}),this.url=i.url,this.headers=i.headers,this.fetch=jv(i.fetch),this.lock=i.lock||N0,this.detectSessionInUrl=i.detectSessionInUrl,this.flowType=i.flowType,this.hasCustomAuthorizationHeader=i.hasCustomAuthorizationHeader,i.lock?this.lock=i.lock:Xt()&&(!((r=globalThis==null?void 0:globalThis.navigator)===null||r===void 0)&&r.locks)?this.lock=M5:this.lock=N0,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?(i.storage?this.storage=i.storage:Mv()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=F0(this.memoryStorage)),i.userStorage&&(this.userStorage=i.userStorage)):(this.memoryStorage={},this.storage=F0(this.memoryStorage)),Xt()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(s){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",s)}(n=this.broadcastChannel)===null||n===void 0||n.addEventListener("message",async s=>{this._debug("received broadcast notification from other tab or client",s),await this._notifyAllSubscribers(s.data.event,s.data.session,!1)})}this.initialize()}get jwks(){var e,r;return(r=(e=pi[this.storageKey])===null||e===void 0?void 0:e.jwks)!==null&&r!==void 0?r:{keys:[]}}set jwks(e){pi[this.storageKey]=Object.assign(Object.assign({},pi[this.storageKey]),{jwks:e})}get jwks_cached_at(){var e,r;return(r=(e=pi[this.storageKey])===null||e===void 0?void 0:e.cachedAt)!==null&&r!==void 0?r:Number.MIN_SAFE_INTEGER}set jwks_cached_at(e){pi[this.storageKey]=Object.assign(Object.assign({},pi[this.storageKey]),{cachedAt:e})}_debug(...e){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${Fv}) ${new Date().toISOString()}`,...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var e;try{const r=h5(window.location.href);let n="none";if(this._isImplicitGrantCallback(r)?n="implicit":await this._isPKCECallback(r)&&(n="pkce"),Xt()&&this.detectSessionInUrl&&n!=="none"){const{data:i,error:s}=await this._getSessionFromURL(r,n);if(s){if(this._debug("#_initialize()","error detecting session from URL",s),r5(s)){const l=(e=s.details)===null||e===void 0?void 0:e.code;if(l==="identity_already_exists"||l==="identity_not_found"||l==="single_identity_not_deletable")return{error:s}}return await this._removeSession(),{error:s}}const{session:a,redirectType:o}=i;return this._debug("#_initialize()","detected session in URL",a,"redirect type",o),await this._saveSession(a),setTimeout(async()=>{o==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",a):await this._notifyAllSubscribers("SIGNED_IN",a)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(r){return me(r)?{error:r}:{error:new Dv("Unexpected error during initialization",r)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var r,n,i;try{const s=await Ee(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(n=(r=e==null?void 0:e.options)===null||r===void 0?void 0:r.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:(i=e==null?void 0:e.options)===null||i===void 0?void 0:i.captchaToken}},xform:Er}),{data:a,error:o}=s;if(o||!a)return{data:{user:null,session:null},error:o};const l=a.session,c=a.user;return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",l)),{data:{user:c,session:l},error:null}}catch(s){if(me(s))return{data:{user:null,session:null},error:s};throw s}}async signUp(e){var r,n,i;try{let s;if("email"in e){const{email:u,password:f,options:d}=e;let h=null,m=null;this.flowType==="pkce"&&([h,m]=await fi(this.storage,this.storageKey)),s=await Ee(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:d==null?void 0:d.emailRedirectTo,body:{email:u,password:f,data:(r=d==null?void 0:d.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:d==null?void 0:d.captchaToken},code_challenge:h,code_challenge_method:m},xform:Er})}else if("phone"in e){const{phone:u,password:f,options:d}=e;s=await Ee(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:u,password:f,data:(n=d==null?void 0:d.data)!==null&&n!==void 0?n:{},channel:(i=d==null?void 0:d.channel)!==null&&i!==void 0?i:"sms",gotrue_meta_security:{captcha_token:d==null?void 0:d.captchaToken}},xform:Er})}else throw new _a("You must provide either an email or phone number and a password");const{data:a,error:o}=s;if(o||!a)return{data:{user:null,session:null},error:o};const l=a.session,c=a.user;return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",l)),{data:{user:c,session:l},error:null}}catch(s){if(me(s))return{data:{user:null,session:null},error:s};throw s}}async signInWithPassword(e){try{let r;if("email"in e){const{email:s,password:a,options:o}=e;r=await Ee(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:s,password:a,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:P0})}else if("phone"in e){const{phone:s,password:a,options:o}=e;r=await Ee(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:s,password:a,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:P0})}else throw new _a("You must provide either an email or phone number and a password");const{data:n,error:i}=r;return i?{data:{user:null,session:null},error:i}:!n||!n.session||!n.user?{data:{user:null,session:null},error:new wa}:(n.session&&(await this._saveSession(n.session),await this._notifyAllSubscribers("SIGNED_IN",n.session)),{data:Object.assign({user:n.user,session:n.session},n.weak_password?{weakPassword:n.weak_password}:null),error:i})}catch(r){if(me(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithOAuth(e){var r,n,i,s;return await this._handleProviderSignIn(e.provider,{redirectTo:(r=e.options)===null||r===void 0?void 0:r.redirectTo,scopes:(n=e.options)===null||n===void 0?void 0:n.scopes,queryParams:(i=e.options)===null||i===void 0?void 0:i.queryParams,skipBrowserRedirect:(s=e.options)===null||s===void 0?void 0:s.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async signInWithWeb3(e){const{chain:r}=e;if(r==="solana")return await this.signInWithSolana(e);throw new Error(`@supabase/auth-js: Unsupported chain "${r}"`)}async signInWithSolana(e){var r,n,i,s,a,o,l,c,u,f,d,h;let m,p;if("message"in e)m=e.message,p=e.signature;else{const{chain:g,wallet:w,statement:b,options:_}=e;let k;if(Xt())if(typeof w=="object")k=w;else{const M=window;if("solana"in M&&typeof M.solana=="object"&&("signIn"in M.solana&&typeof M.solana.signIn=="function"||"signMessage"in M.solana&&typeof M.solana.signMessage=="function"))k=M.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof w!="object"||!(_!=null&&_.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");k=w}const L=new URL((r=_==null?void 0:_.url)!==null&&r!==void 0?r:window.location.href);if("signIn"in k&&k.signIn){const M=await k.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},_==null?void 0:_.signInWithSolana),{version:"1",domain:L.host,uri:L.href}),b?{statement:b}:null));let I;if(Array.isArray(M)&&M[0]&&typeof M[0]=="object")I=M[0];else if(M&&typeof M=="object"&&"signedMessage"in M&&"signature"in M)I=M;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in I&&"signature"in I&&(typeof I.signedMessage=="string"||I.signedMessage instanceof Uint8Array)&&I.signature instanceof Uint8Array)m=typeof I.signedMessage=="string"?I.signedMessage:new TextDecoder().decode(I.signedMessage),p=I.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in k)||typeof k.signMessage!="function"||!("publicKey"in k)||typeof k!="object"||!k.publicKey||!("toBase58"in k.publicKey)||typeof k.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");m=[`${L.host} wants you to sign in with your Solana account:`,k.publicKey.toBase58(),...b?["",b,""]:[""],"Version: 1",`URI: ${L.href}`,`Issued At: ${(i=(n=_==null?void 0:_.signInWithSolana)===null||n===void 0?void 0:n.issuedAt)!==null&&i!==void 0?i:new Date().toISOString()}`,...!((s=_==null?void 0:_.signInWithSolana)===null||s===void 0)&&s.notBefore?[`Not Before: ${_.signInWithSolana.notBefore}`]:[],...!((a=_==null?void 0:_.signInWithSolana)===null||a===void 0)&&a.expirationTime?[`Expiration Time: ${_.signInWithSolana.expirationTime}`]:[],...!((o=_==null?void 0:_.signInWithSolana)===null||o===void 0)&&o.chainId?[`Chain ID: ${_.signInWithSolana.chainId}`]:[],...!((l=_==null?void 0:_.signInWithSolana)===null||l===void 0)&&l.nonce?[`Nonce: ${_.signInWithSolana.nonce}`]:[],...!((c=_==null?void 0:_.signInWithSolana)===null||c===void 0)&&c.requestId?[`Request ID: ${_.signInWithSolana.requestId}`]:[],...!((f=(u=_==null?void 0:_.signInWithSolana)===null||u===void 0?void 0:u.resources)===null||f===void 0)&&f.length?["Resources",..._.signInWithSolana.resources.map(I=>`- ${I}`)]:[]].join(`
`);const M=await k.signMessage(new TextEncoder().encode(m),"utf8");if(!M||!(M instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");p=M}}try{const{data:g,error:w}=await Ee(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:m,signature:c5(p)},!((d=e.options)===null||d===void 0)&&d.captchaToken?{gotrue_meta_security:{captcha_token:(h=e.options)===null||h===void 0?void 0:h.captchaToken}}:null),xform:Er});if(w)throw w;return!g||!g.session||!g.user?{data:{user:null,session:null},error:new wa}:(g.session&&(await this._saveSession(g.session),await this._notifyAllSubscribers("SIGNED_IN",g.session)),{data:Object.assign({},g),error:w})}catch(g){if(me(g))return{data:{user:null,session:null},error:g};throw g}}async _exchangeCodeForSession(e){const r=await An(this.storage,`${this.storageKey}-code-verifier`),[n,i]=(r??"").split("/");try{const{data:s,error:a}=await Ee(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:n},xform:Er});if(await Kr(this.storage,`${this.storageKey}-code-verifier`),a)throw a;return!s||!s.session||!s.user?{data:{user:null,session:null,redirectType:null},error:new wa}:(s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",s.session)),{data:Object.assign(Object.assign({},s),{redirectType:i??null}),error:a})}catch(s){if(me(s))return{data:{user:null,session:null,redirectType:null},error:s};throw s}}async signInWithIdToken(e){try{const{options:r,provider:n,token:i,access_token:s,nonce:a}=e,o=await Ee(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:n,id_token:i,access_token:s,nonce:a,gotrue_meta_security:{captcha_token:r==null?void 0:r.captchaToken}},xform:Er}),{data:l,error:c}=o;return c?{data:{user:null,session:null},error:c}:!l||!l.session||!l.user?{data:{user:null,session:null},error:new wa}:(l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",l.session)),{data:l,error:c})}catch(r){if(me(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithOtp(e){var r,n,i,s,a;try{if("email"in e){const{email:o,options:l}=e;let c=null,u=null;this.flowType==="pkce"&&([c,u]=await fi(this.storage,this.storageKey));const{error:f}=await Ee(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:o,data:(r=l==null?void 0:l.data)!==null&&r!==void 0?r:{},create_user:(n=l==null?void 0:l.shouldCreateUser)!==null&&n!==void 0?n:!0,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken},code_challenge:c,code_challenge_method:u},redirectTo:l==null?void 0:l.emailRedirectTo});return{data:{user:null,session:null},error:f}}if("phone"in e){const{phone:o,options:l}=e,{data:c,error:u}=await Ee(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:o,data:(i=l==null?void 0:l.data)!==null&&i!==void 0?i:{},create_user:(s=l==null?void 0:l.shouldCreateUser)!==null&&s!==void 0?s:!0,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken},channel:(a=l==null?void 0:l.channel)!==null&&a!==void 0?a:"sms"}});return{data:{user:null,session:null,messageId:c==null?void 0:c.message_id},error:u}}throw new _a("You must provide either an email or phone number.")}catch(o){if(me(o))return{data:{user:null,session:null},error:o};throw o}}async verifyOtp(e){var r,n;try{let i,s;"options"in e&&(i=(r=e.options)===null||r===void 0?void 0:r.redirectTo,s=(n=e.options)===null||n===void 0?void 0:n.captchaToken);const{data:a,error:o}=await Ee(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:s}}),redirectTo:i,xform:Er});if(o)throw o;if(!a)throw new Error("An error occurred on token verification.");const l=a.session,c=a.user;return l!=null&&l.access_token&&(await this._saveSession(l),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",l)),{data:{user:c,session:l},error:null}}catch(i){if(me(i))return{data:{user:null,session:null},error:i};throw i}}async signInWithSSO(e){var r,n,i;try{let s=null,a=null;return this.flowType==="pkce"&&([s,a]=await fi(this.storage,this.storageKey)),await Ee(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(n=(r=e.options)===null||r===void 0?void 0:r.redirectTo)!==null&&n!==void 0?n:void 0}),!((i=e==null?void 0:e.options)===null||i===void 0)&&i.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:s,code_challenge_method:a}),headers:this.headers,xform:k5})}catch(s){if(me(s))return{data:null,error:s};throw s}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:r},error:n}=e;if(n)throw n;if(!r)throw new Xr;const{error:i}=await Ee(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:r.access_token});return{data:{user:null,session:null},error:i}})}catch(e){if(me(e))return{data:{user:null,session:null},error:e};throw e}}async resend(e){try{const r=`${this.url}/resend`;if("email"in e){const{email:n,type:i,options:s}=e,{error:a}=await Ee(this.fetch,"POST",r,{headers:this.headers,body:{email:n,type:i,gotrue_meta_security:{captcha_token:s==null?void 0:s.captchaToken}},redirectTo:s==null?void 0:s.emailRedirectTo});return{data:{user:null,session:null},error:a}}else if("phone"in e){const{phone:n,type:i,options:s}=e,{data:a,error:o}=await Ee(this.fetch,"POST",r,{headers:this.headers,body:{phone:n,type:i,gotrue_meta_security:{captcha_token:s==null?void 0:s.captchaToken}}});return{data:{user:null,session:null,messageId:a==null?void 0:a.message_id},error:o}}throw new _a("You must provide either an email or phone number and a type")}catch(r){if(me(r))return{data:{user:null,session:null},error:r};throw r}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async r=>r))}async _acquireLock(e,r){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const n=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),i=(async()=>(await n,await r()))();return this.pendingInLock.push((async()=>{try{await i}catch{}})()),i}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const n=r();for(this.pendingInLock.push((async()=>{try{await n}catch{}})()),await n;this.pendingInLock.length;){const i=[...this.pendingInLock];await Promise.all(i),this.pendingInLock.splice(0,i.length)}return await n}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const r=await this.__loadSession();return await e(r)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const r=await An(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",r),r!==null&&(this._isValidSession(r)?e=r:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const n=e.expires_at?e.expires_at*1e3-Date.now()<kl:!1;if(this._debug("#__loadSession()",`session has${n?"":" not"} expired`,"expires_at",e.expires_at),!n){if(this.userStorage){const a=await An(this.userStorage,this.storageKey+"-user");a!=null&&a.user?e.user=a.user:e.user=Pl()}if(this.storage.isServer&&e.user){let a=this.suppressGetSessionWarning;e=new Proxy(e,{get:(l,c,u)=>(!a&&c==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),a=!0,this.suppressGetSessionWarning=!0),Reflect.get(l,c,u))})}return{data:{session:e},error:null}}const{session:i,error:s}=await this._callRefreshToken(e.refresh_token);return s?{data:{session:null},error:s}:{data:{session:i},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(e){return e?await this._getUser(e):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(e){try{return e?await Ee(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:rn}):await this._useSession(async r=>{var n,i,s;const{data:a,error:o}=r;if(o)throw o;return!(!((n=a.session)===null||n===void 0)&&n.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new Xr}:await Ee(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(s=(i=a.session)===null||i===void 0?void 0:i.access_token)!==null&&s!==void 0?s:void 0,xform:rn})})}catch(r){if(me(r))return t5(r)&&(await this._removeSession(),await Kr(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:r};throw r}}async updateUser(e,r={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,r))}async _updateUser(e,r={}){try{return await this._useSession(async n=>{const{data:i,error:s}=n;if(s)throw s;if(!i.session)throw new Xr;const a=i.session;let o=null,l=null;this.flowType==="pkce"&&e.email!=null&&([o,l]=await fi(this.storage,this.storageKey));const{data:c,error:u}=await Ee(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:r==null?void 0:r.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:o,code_challenge_method:l}),jwt:a.access_token,xform:rn});if(u)throw u;return a.user=c.user,await this._saveSession(a),await this._notifyAllSubscribers("USER_UPDATED",a),{data:{user:a.user},error:null}})}catch(n){if(me(n))return{data:{user:null},error:n};throw n}}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new Xr;const r=Date.now()/1e3;let n=r,i=!0,s=null;const{payload:a}=Rl(e.access_token);if(a.exp&&(n=a.exp,i=n<=r),i){const{session:o,error:l}=await this._callRefreshToken(e.refresh_token);if(l)return{data:{user:null,session:null},error:l};if(!o)return{data:{user:null,session:null},error:null};s=o}else{const{data:o,error:l}=await this._getUser(e.access_token);if(l)throw l;s={access_token:e.access_token,refresh_token:e.refresh_token,user:o.user,token_type:"bearer",expires_in:n-r,expires_at:n},await this._saveSession(s),await this._notifyAllSubscribers("SIGNED_IN",s)}return{data:{user:s.user,session:s},error:null}}catch(r){if(me(r))return{data:{session:null,user:null},error:r};throw r}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async r=>{var n;if(!e){const{data:a,error:o}=r;if(o)throw o;e=(n=a.session)!==null&&n!==void 0?n:void 0}if(!(e!=null&&e.refresh_token))throw new Xr;const{session:i,error:s}=await this._callRefreshToken(e.refresh_token);return s?{data:{user:null,session:null},error:s}:i?{data:{user:i.user,session:i},error:null}:{data:{user:null,session:null},error:null}})}catch(r){if(me(r))return{data:{user:null,session:null},error:r};throw r}}async _getSessionFromURL(e,r){try{if(!Xt())throw new Ea("No browser detected.");if(e.error||e.error_description||e.error_code)throw new Ea(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(r){case"implicit":if(this.flowType==="pkce")throw new S0("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new Ea("Not a valid implicit grant flow url.");break;default:}if(r==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new S0("No code detected.");const{data:b,error:_}=await this._exchangeCodeForSession(e.code);if(_)throw _;const k=new URL(window.location.href);return k.searchParams.delete("code"),window.history.replaceState(window.history.state,"",k.toString()),{data:{session:b.session,redirectType:null},error:null}}const{provider_token:n,provider_refresh_token:i,access_token:s,refresh_token:a,expires_in:o,expires_at:l,token_type:c}=e;if(!s||!o||!a||!c)throw new Ea("No session defined in URL");const u=Math.round(Date.now()/1e3),f=parseInt(o);let d=u+f;l&&(d=parseInt(l));const h=d-u;h*1e3<=gi&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${h}s, should have been closer to ${f}s`);const m=d-f;u-m>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",m,d,u):u-m<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",m,d,u);const{data:p,error:g}=await this._getUser(s);if(g)throw g;const w={provider_token:n,provider_refresh_token:i,access_token:s,expires_in:f,expires_at:d,refresh_token:a,token_type:c,user:p.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:w,redirectType:e.type},error:null}}catch(n){if(me(n))return{data:{session:null,redirectType:null},error:n};throw n}}_isImplicitGrantCallback(e){return!!(e.access_token||e.error_description)}async _isPKCECallback(e){const r=await An(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&r)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async r=>{var n;const{data:i,error:s}=r;if(s)return{error:s};const a=(n=i.session)===null||n===void 0?void 0:n.access_token;if(a){const{error:o}=await this.admin.signOut(a,e);if(o&&!(e5(o)&&(o.status===404||o.status===401||o.status===403)))return{error:o}}return e!=="others"&&(await this._removeSession(),await Kr(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(e){const r=f5(),n={id:r,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",r),this.stateChangeEmitters.delete(r)}};return this._debug("#onAuthStateChange()","registered callback with id",r),this.stateChangeEmitters.set(r,n),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(r)})))(),{data:{subscription:n}}}async _emitInitialSession(e){return await this._useSession(async r=>{var n,i;try{const{data:{session:s},error:a}=r;if(a)throw a;await((n=this.stateChangeEmitters.get(e))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",s)),this._debug("INITIAL_SESSION","callback id",e,"session",s)}catch(s){await((i=this.stateChangeEmitters.get(e))===null||i===void 0?void 0:i.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",s),console.error(s)}})}async resetPasswordForEmail(e,r={}){let n=null,i=null;this.flowType==="pkce"&&([n,i]=await fi(this.storage,this.storageKey,!0));try{return await Ee(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:n,code_challenge_method:i,gotrue_meta_security:{captcha_token:r.captchaToken}},headers:this.headers,redirectTo:r.redirectTo})}catch(s){if(me(s))return{data:null,error:s};throw s}}async getUserIdentities(){var e;try{const{data:r,error:n}=await this.getUser();if(n)throw n;return{data:{identities:(e=r.user.identities)!==null&&e!==void 0?e:[]},error:null}}catch(r){if(me(r))return{data:null,error:r};throw r}}async linkIdentity(e){var r;try{const{data:n,error:i}=await this._useSession(async s=>{var a,o,l,c,u;const{data:f,error:d}=s;if(d)throw d;const h=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(a=e.options)===null||a===void 0?void 0:a.redirectTo,scopes:(o=e.options)===null||o===void 0?void 0:o.scopes,queryParams:(l=e.options)===null||l===void 0?void 0:l.queryParams,skipBrowserRedirect:!0});return await Ee(this.fetch,"GET",h,{headers:this.headers,jwt:(u=(c=f.session)===null||c===void 0?void 0:c.access_token)!==null&&u!==void 0?u:void 0})});if(i)throw i;return Xt()&&!(!((r=e.options)===null||r===void 0)&&r.skipBrowserRedirect)&&window.location.assign(n==null?void 0:n.url),{data:{provider:e.provider,url:n==null?void 0:n.url},error:null}}catch(n){if(me(n))return{data:{provider:e.provider,url:null},error:n};throw n}}async unlinkIdentity(e){try{return await this._useSession(async r=>{var n,i;const{data:s,error:a}=r;if(a)throw a;return await Ee(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(i=(n=s.session)===null||n===void 0?void 0:n.access_token)!==null&&i!==void 0?i:void 0})})}catch(r){if(me(r))return{data:null,error:r};throw r}}async _refreshAccessToken(e){const r=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(r,"begin");try{const n=Date.now();return await m5(async i=>(i>0&&await p5(200*Math.pow(2,i-1)),this._debug(r,"refreshing attempt",i),await Ee(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:Er})),(i,s)=>{const a=200*Math.pow(2,i);return s&&Ol(s)&&Date.now()+a-n<gi})}catch(n){if(this._debug(r,"error",n),me(n))return{data:{session:null,user:null},error:n};throw n}finally{this._debug(r,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,r){const n=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:r.redirectTo,scopes:r.scopes,queryParams:r.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",r,"url",n),Xt()&&!r.skipBrowserRedirect&&window.location.assign(n),{data:{provider:e,url:n},error:null}}async _recoverAndRefresh(){var e,r;const n="#_recoverAndRefresh()";this._debug(n,"begin");try{const i=await An(this.storage,this.storageKey);if(i&&this.userStorage){let a=await An(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!a&&(a={user:i.user},await vi(this.userStorage,this.storageKey+"-user",a)),i.user=(e=a==null?void 0:a.user)!==null&&e!==void 0?e:Pl()}else if(i&&!i.user&&!i.user){const a=await An(this.storage,this.storageKey+"-user");a&&(a!=null&&a.user)?(i.user=a.user,await Kr(this.storage,this.storageKey+"-user"),await vi(this.storage,this.storageKey,i)):i.user=Pl()}if(this._debug(n,"session from storage",i),!this._isValidSession(i)){this._debug(n,"session is not valid"),i!==null&&await this._removeSession();return}const s=((r=i.expires_at)!==null&&r!==void 0?r:1/0)*1e3-Date.now()<kl;if(this._debug(n,`session has${s?"":" not"} expired with margin of ${kl}s`),s){if(this.autoRefreshToken&&i.refresh_token){const{error:a}=await this._callRefreshToken(i.refresh_token);a&&(console.error(a),Ol(a)||(this._debug(n,"refresh failed with a non-retryable error, removing the session",a),await this._removeSession()))}}else if(i.user&&i.user.__isUserNotAvailableProxy===!0)try{const{data:a,error:o}=await this._getUser(i.access_token);!o&&(a!=null&&a.user)?(i.user=a.user,await this._saveSession(i),await this._notifyAllSubscribers("SIGNED_IN",i)):this._debug(n,"could not get user data, skipping SIGNED_IN notification")}catch(a){console.error("Error getting user data:",a),this._debug(n,"error getting user data, skipping SIGNED_IN notification",a)}else await this._notifyAllSubscribers("SIGNED_IN",i)}catch(i){this._debug(n,"error",i),console.error(i);return}finally{this._debug(n,"end")}}async _callRefreshToken(e){var r,n;if(!e)throw new Xr;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const i=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(i,"begin");try{this.refreshingDeferred=new Go;const{data:s,error:a}=await this._refreshAccessToken(e);if(a)throw a;if(!s.session)throw new Xr;await this._saveSession(s.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",s.session);const o={session:s.session,error:null};return this.refreshingDeferred.resolve(o),o}catch(s){if(this._debug(i,"error",s),me(s)){const a={session:null,error:s};return Ol(s)||await this._removeSession(),(r=this.refreshingDeferred)===null||r===void 0||r.resolve(a),a}throw(n=this.refreshingDeferred)===null||n===void 0||n.reject(s),s}finally{this.refreshingDeferred=null,this._debug(i,"end")}}async _notifyAllSubscribers(e,r,n=!0){const i=`#_notifyAllSubscribers(${e})`;this._debug(i,"begin",r,`broadcast = ${n}`);try{this.broadcastChannel&&n&&this.broadcastChannel.postMessage({event:e,session:r});const s=[],a=Array.from(this.stateChangeEmitters.values()).map(async o=>{try{await o.callback(e,r)}catch(l){s.push(l)}});if(await Promise.all(a),s.length>0){for(let o=0;o<s.length;o+=1)console.error(s[o]);throw s[0]}}finally{this._debug(i,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0;const r=Object.assign({},e),n=r.user&&r.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!n&&r.user&&await vi(this.userStorage,this.storageKey+"-user",{user:r.user});const i=Object.assign({},r);delete i.user;const s=O0(i);await vi(this.storage,this.storageKey,s)}else{const i=O0(r);await vi(this.storage,this.storageKey,i)}}async _removeSession(){this._debug("#_removeSession()"),await Kr(this.storage,this.storageKey),await Kr(this.storage,this.storageKey+"-code-verifier"),await Kr(this.storage,this.storageKey+"-user"),this.userStorage&&await Kr(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&Xt()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(r){console.error("removing visibilitychange callback failed",r)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),gi);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async r=>{const{data:{session:n}}=r;if(!n||!n.refresh_token||!n.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const i=Math.floor((n.expires_at*1e3-e)/gi);this._debug("#_autoRefreshTokenTick()",`access token expires in ${i} ticks, a tick lasts ${gi}ms, refresh threshold is ${Ec} ticks`),i<=Ec&&await this._callRefreshToken(n.refresh_token)})}catch(r){console.error("Auto refresh tick failed with error. This is likely a transient error.",r)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof $v)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!Xt()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const r=`#_onVisibilityChanged(${e})`;this._debug(r,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(r,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,r,n){const i=[`provider=${encodeURIComponent(r)}`];if(n!=null&&n.redirectTo&&i.push(`redirect_to=${encodeURIComponent(n.redirectTo)}`),n!=null&&n.scopes&&i.push(`scopes=${encodeURIComponent(n.scopes)}`),this.flowType==="pkce"){const[s,a]=await fi(this.storage,this.storageKey),o=new URLSearchParams({code_challenge:`${encodeURIComponent(s)}`,code_challenge_method:`${encodeURIComponent(a)}`});i.push(o.toString())}if(n!=null&&n.queryParams){const s=new URLSearchParams(n.queryParams);i.push(s.toString())}return n!=null&&n.skipBrowserRedirect&&i.push(`skip_http_redirect=${n.skipBrowserRedirect}`),`${e}?${i.join("&")}`}async _unenroll(e){try{return await this._useSession(async r=>{var n;const{data:i,error:s}=r;return s?{data:null,error:s}:await Ee(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(n=i==null?void 0:i.session)===null||n===void 0?void 0:n.access_token})})}catch(r){if(me(r))return{data:null,error:r};throw r}}async _enroll(e){try{return await this._useSession(async r=>{var n,i;const{data:s,error:a}=r;if(a)return{data:null,error:a};const o=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:{issuer:e.issuer}),{data:l,error:c}=await Ee(this.fetch,"POST",`${this.url}/factors`,{body:o,headers:this.headers,jwt:(n=s==null?void 0:s.session)===null||n===void 0?void 0:n.access_token});return c?{data:null,error:c}:(e.factorType==="totp"&&(!((i=l==null?void 0:l.totp)===null||i===void 0)&&i.qr_code)&&(l.totp.qr_code=`data:image/svg+xml;utf-8,${l.totp.qr_code}`),{data:l,error:null})})}catch(r){if(me(r))return{data:null,error:r};throw r}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var n;const{data:i,error:s}=r;if(s)return{data:null,error:s};const{data:a,error:o}=await Ee(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:{code:e.code,challenge_id:e.challengeId},headers:this.headers,jwt:(n=i==null?void 0:i.session)===null||n===void 0?void 0:n.access_token});return o?{data:null,error:o}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+a.expires_in},a)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",a),{data:a,error:o})})}catch(r){if(me(r))return{data:null,error:r};throw r}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var n;const{data:i,error:s}=r;return s?{data:null,error:s}:await Ee(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:{channel:e.channel},headers:this.headers,jwt:(n=i==null?void 0:i.session)===null||n===void 0?void 0:n.access_token})})}catch(r){if(me(r))return{data:null,error:r};throw r}})}async _challengeAndVerify(e){const{data:r,error:n}=await this._challenge({factorId:e.factorId});return n?{data:null,error:n}:await this._verify({factorId:e.factorId,challengeId:r.id,code:e.code})}async _listFactors(){const{data:{user:e},error:r}=await this.getUser();if(r)return{data:null,error:r};const n=(e==null?void 0:e.factors)||[],i=n.filter(a=>a.factor_type==="totp"&&a.status==="verified"),s=n.filter(a=>a.factor_type==="phone"&&a.status==="verified");return{data:{all:n,totp:i,phone:s},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async e=>{var r,n;const{data:{session:i},error:s}=e;if(s)return{data:null,error:s};if(!i)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:a}=Rl(i.access_token);let o=null;a.aal&&(o=a.aal);let l=o;((n=(r=i.user.factors)===null||r===void 0?void 0:r.filter(f=>f.status==="verified"))!==null&&n!==void 0?n:[]).length>0&&(l="aal2");const u=a.amr||[];return{data:{currentLevel:o,nextLevel:l,currentAuthenticationMethods:u},error:null}}))}async fetchJwk(e,r={keys:[]}){let n=r.keys.find(o=>o.kid===e);if(n)return n;const i=Date.now();if(n=this.jwks.keys.find(o=>o.kid===e),n&&this.jwks_cached_at+QD>i)return n;const{data:s,error:a}=await Ee(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(a)throw a;return!s.keys||s.keys.length===0||(this.jwks=s,this.jwks_cached_at=i,n=s.keys.find(o=>o.kid===e),!n)?null:n}async getClaims(e,r={}){try{let n=e;if(!n){const{data:h,error:m}=await this.getSession();if(m||!h.session)return{data:null,error:m};n=h.session.access_token}const{header:i,payload:s,signature:a,raw:{header:o,payload:l}}=Rl(n);r!=null&&r.allowExpired||E5(s.exp);const c=!i.alg||i.alg.startsWith("HS")||!i.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(i.kid,r!=null&&r.keys?{keys:r.keys}:r==null?void 0:r.jwks);if(!c){const{error:h}=await this.getUser(n);if(h)throw h;return{data:{claims:s,header:i,signature:a},error:null}}const u=b5(i.alg),f=await crypto.subtle.importKey("jwk",c,u,!0,["verify"]);if(!await crypto.subtle.verify(u,f,a,l5(`${o}.${l}`)))throw new Sc("Invalid JWT signature");return{data:{claims:s,header:i,signature:a},error:null}}catch(n){if(me(n))return{data:null,error:n};throw n}}}Ps.nextInstanceID=0;const $5=Ps;class B5 extends $5{constructor(e){super(e)}}var U5=globalThis&&globalThis.__awaiter||function(t,e,r,n){function i(s){return s instanceof r?s:new r(function(a){a(s)})}return new(r||(r=Promise))(function(s,a){function o(u){try{c(n.next(u))}catch(f){a(f)}}function l(u){try{c(n.throw(u))}catch(f){a(f)}}function c(u){u.done?s(u.value):i(u.value).then(o,l)}c((n=n.apply(t,e||[])).next())})};class H5{constructor(e,r,n){var i,s,a;if(this.supabaseUrl=e,this.supabaseKey=r,!e)throw new Error("supabaseUrl is required.");if(!r)throw new Error("supabaseKey is required.");const o=zD(e),l=new URL(o);this.realtimeUrl=new URL("realtime/v1",l),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",l),this.storageUrl=new URL("storage/v1",l),this.functionsUrl=new URL("functions/v1",l);const c=`sb-${l.hostname.split(".")[0]}-auth-token`,u={db:jD,realtime:BD,auth:Object.assign(Object.assign({},$D),{storageKey:c}),global:MD},f=qD(n??{},u);this.storageKey=(i=f.auth.storageKey)!==null&&i!==void 0?i:"",this.headers=(s=f.global.headers)!==null&&s!==void 0?s:{},f.accessToken?(this.accessToken=f.accessToken,this.auth=new Proxy({},{get:(d,h)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(h)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((a=f.auth)!==null&&a!==void 0?a:{},this.headers,f.global.fetch),this.fetch=VD(r,this._getAccessToken.bind(this),f.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},f.realtime)),this.rest=new aD(new URL("rest/v1",l).href,{headers:this.headers,schema:f.db.schema,fetch:this.fetch}),f.accessToken||this._listenForAuthEvents()}get functions(){return new LN(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}get storage(){return new ND(this.storageUrl.href,this.headers,this.fetch)}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,r={},n={}){return this.rest.rpc(e,r,n)}channel(e,r={config:{}}){return this.realtime.channel(e,r)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var e,r;return U5(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:n}=yield this.auth.getSession();return(r=(e=n.session)===null||e===void 0?void 0:e.access_token)!==null&&r!==void 0?r:null})}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:r,detectSessionInUrl:n,storage:i,storageKey:s,flowType:a,lock:o,debug:l},c,u){const f={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new B5({url:this.authUrl.href,headers:Object.assign(Object.assign({},f),c),storageKey:s,autoRefreshToken:e,persistSession:r,detectSessionInUrl:n,storage:i,flowType:a,lock:o,debug:l,fetch:u,hasCustomAuthorizationHeader:"Authorization"in this.headers})}_initRealtimeClient(e){return new _D(this.realtimeUrl.href,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},e==null?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((r,n)=>{this._handleTokenChanged(r,"CLIENT",n==null?void 0:n.access_token)})}_handleTokenChanged(e,r,n){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==n?this.changedAccessToken=n:e==="SIGNED_OUT"&&(this.realtime.setAuth(),r=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const W5=(t,e,r)=>new H5(t,e,r),V5="https://hityjagsqhwbpofaxksx.supabase.co",G5="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImhpdHlqYWdzcWh3YnBvZmF4a3N4Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTMyNTc1MjQsImV4cCI6MjA2ODgzMzUyNH0.Z4asUyZYGCTB0IfaL5gufNvvKlbADcBD8TY5EPZvi9A",Bv=W5(V5,G5),z5=async(t={})=>{let e=Bv.from("companies").select("*",{count:"exact"});if(t.search){const b=t.search.toLowerCase();e=e.or(`name.ilike.%${b}%,business_id.ilike.%${b}%`)}const{company_name:r,business_id:n,industry:i,city:s,company_type:a,min_revenue:o,max_revenue:l,min_date:c,max_date:u}=t;r&&(e=e.ilike("name",`%${r}%`)),n&&(e=e.eq("business_id",n)),i&&(e=e.eq("industry",i)),s&&(e=e.ilike("city",`%${s}%`)),a&&(e=e.eq("company_type",a)),o&&(e=e.gte("revenue",parseFloat(o))),l&&(e=e.lte("revenue",parseFloat(l))),c&&(e=e.gte("registration_date",c)),u&&(e=e.lte("registration_date",u));const f=t.page||1,d=t.limit||10,h=(f-1)*d,m=h+d-1;e=e.range(h,m);const{data:p,error:g,count:w}=await e;if(g)throw g;return{data:p,count:w||0}},q5=async t=>{const{data:e,error:r}=await Bv.from("companies").select("*").eq("id",t).single();if(r)throw r;return e},Uv=async(t={})=>{try{return await z5(t)}catch(e){return console.error("Error fetching companies:",e),{data:[],count:0}}},K5=async t=>{try{return await q5(t)}catch(e){return console.error(`Error fetching company with ID ${t}:`,e),null}},X5=(t={})=>Y0({queryKey:["companies",t],queryFn:async()=>{const e=await Uv(t);return{data:e.data,count:e.count,total:e.count,page:t.page||1,limit:t.limit||10}},keepPreviousData:!0}),Y5=t=>Y0({queryKey:["company",t],queryFn:()=>K5(t),enabled:!!t});function J5(){const[t,e]=v.useState({search:"",company_name:"",business_id:"",industry:"",location:"",city:"",company_type:"",min_revenue:"",max_revenue:"",min_date:"",max_date:""}),[r,n]=v.useState(1),[i,s]=v.useState(!1),a=10;Di(),zs();const{data:o,isLoading:l,isError:c,error:u,refetch:f}=X5({...t,page:r,limit:a});v.useEffect(()=>{n(1)},[t]);const d=g=>{const{name:w,value:b}=g.target;e(_=>({..._,[w]:b}))},h=g=>{g.preventDefault(),f()},m=()=>{e({search:"",company_name:"",business_id:"",industry:"",location:"",city:"",company_type:"",min_revenue:"",max_revenue:"",min_date:"",max_date:""})},p=async()=>{var g;try{const w=await Uv({...t,limit:1e3});((g=w==null?void 0:w.data)==null?void 0:g.length)>0?(ON(w.data,"companies_export"),Qe.success("Export completed successfully")):Qe.error("No data to export")}catch(w){console.error("Export error:",w),Qe.error("Failed to export data")}};return c?x.jsxs("div",{className:"text-center py-12",children:[x.jsx("h3",{className:"text-lg font-medium text-red-600",children:"Error loading companies"}),x.jsx("p",{className:"mt-2 text-sm text-gray-500",children:u instanceof Error?u.message:"An unknown error occurred"}),x.jsx("button",{onClick:()=>f(),className:"mt-4 inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:"Retry"})]}):x.jsxs("div",{className:"space-y-6",children:[x.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between",children:[x.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Company Directory"}),x.jsx("div",{className:"mt-4 flex space-x-3 md:mt-0",children:x.jsxs("button",{type:"button",onClick:p,className:"inline-flex items-center rounded-md bg-white px-3 py-2 text-sm font-semibold text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 hover:bg-gray-50",children:[x.jsx(B2,{className:"-ml-0.5 mr-1.5 h-5 w-5","aria-hidden":"true"}),"Export to Excel"]})})]}),x.jsxs("div",{className:"rounded-lg bg-white shadow",children:[x.jsx("div",{className:"border-b border-gray-200 px-4 py-5 sm:px-6",children:x.jsxs("form",{onSubmit:h,className:"space-y-4",children:[x.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between",children:[x.jsxs("div",{className:"relative flex-1",children:[x.jsx("div",{className:"pointer-events-none absolute inset-y-0 left-0 flex items-center pl-3",children:x.jsx(X2,{className:"h-5 w-5 text-gray-400","aria-hidden":"true"})}),x.jsx("input",{type:"text",name:"search",value:t.search,onChange:d,className:"block w-full rounded-md border-0 py-1.5 pl-10 pr-3 text-gray-900 ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6",placeholder:"Search companies..."})]}),x.jsxs("button",{type:"button",onClick:()=>s(!i),className:"mt-3 inline-flex items-center rounded-md bg-white px-3 py-2 text-sm font-semibold text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 hover:bg-gray-50 sm:mt-0 sm:ml-3",children:[x.jsx(W2,{className:"-ml-0.5 mr-1.5 h-5 w-5","aria-hidden":"true"}),i?"Hide Filters":"Show Filters"]})]}),i&&x.jsx(BI,{filters:t,onFilterChange:d,onReset:m})]})}),x.jsx("div",{className:"overflow-x-auto",children:x.jsx(jI,{companies:(o==null?void 0:o.data)||[],isLoading:l,error:u||null})}),x.jsxs("div",{className:"flex items-center justify-between border-t border-gray-200 bg-white px-4 py-3 sm:px-6",children:[x.jsxs("div",{className:"flex flex-1 justify-between sm:hidden",children:[x.jsx("button",{onClick:()=>n(g=>Math.max(g-1,1)),disabled:r===1,className:"relative inline-flex items-center rounded-md border border-gray-300 bg-white px-4 py-2 text-sm font-medium text-gray-700 hover:bg-gray-50",children:"Previous"}),x.jsx("button",{onClick:()=>n(g=>g+1),disabled:!o||o.data.length<a,className:"relative ml-3 inline-flex items-center rounded-md border border-gray-300 bg-white px-4 py-2 text-sm font-medium text-gray-700 hover:bg-gray-50",children:"Next"})]}),x.jsxs("div",{className:"hidden sm:flex sm:flex-1 sm:items-center sm:justify-between",children:[x.jsx("div",{children:x.jsxs("p",{className:"text-sm text-gray-700",children:["Showing ",x.jsx("span",{className:"font-medium",children:(r-1)*a+1})," to"," ",x.jsx("span",{className:"font-medium",children:Math.min(r*a,(o==null?void 0:o.total)||0)})," ","of ",x.jsx("span",{className:"font-medium",children:(o==null?void 0:o.count)||0})," results"]})}),x.jsx($I,{currentPage:r,totalItems:(o==null?void 0:o.count)||0,itemsPerPage:a,onPageChange:n})]})]})]})]})}function Q5(){const{id:t}=s1(),e=Di(),{data:r,isLoading:n,isError:i}=Y5(Number(t));if(n)return x.jsx("div",{className:"flex h-64 items-center justify-center",children:x.jsx("div",{className:"h-12 w-12 animate-spin rounded-full border-t-2 border-b-2 border-indigo-500"})});if(i||!r)return x.jsxs("div",{className:"text-center py-12",children:[x.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Company Not Found"}),x.jsx("p",{className:"text-gray-600 mb-6",children:"The company you're looking for doesn't exist or has been removed."}),x.jsxs("button",{onClick:()=>e("/"),className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:[x.jsx(Gf,{className:"h-4 w-4 mr-2"}),"Back to Dashboard"]})]});const s=a=>{if(!a)return"N/A";try{const o=new Date(a);return isNaN(o.getTime())?"N/A":o.toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})}catch{return"N/A"}};return x.jsxs("div",{className:"max-w-4xl mx-auto",children:[x.jsxs("div",{className:"mb-6",children:[x.jsxs("button",{onClick:()=>e("/"),className:"inline-flex items-center text-sm text-gray-500 hover:text-gray-700 mb-4",children:[x.jsx(Gf,{className:"h-4 w-4 mr-1"}),"Back to Dashboard"]}),x.jsx("div",{className:"bg-white shadow rounded-lg p-6",children:x.jsxs("div",{className:"flex items-start justify-between",children:[x.jsxs("div",{children:[x.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:r.name}),x.jsxs("p",{className:"text-lg text-gray-600",children:["Business ID: ",r.business_id]})]}),x.jsx("div",{className:"text-right",children:x.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${r.status==="2"?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"}`,children:r.status==="2"?"Active":"Inactive"})})]})})]}),x.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[x.jsxs("div",{className:"bg-white shadow rounded-lg p-6",children:[x.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Basic Information"}),x.jsxs("div",{className:"space-y-4",children:[x.jsxs("div",{className:"flex items-start",children:[x.jsx(N2,{className:"h-5 w-5 text-gray-400 mt-0.5 mr-3"}),x.jsxs("div",{children:[x.jsx("dt",{className:"text-sm font-medium text-gray-500",children:"Company Type"}),x.jsx("dd",{className:"text-sm text-gray-900",children:r.company_type||"N/A"})]})]}),x.jsxs("div",{className:"flex items-start",children:[x.jsx(Q2,{className:"h-5 w-5 text-gray-400 mt-0.5 mr-3"}),x.jsxs("div",{children:[x.jsx("dt",{className:"text-sm font-medium text-gray-500",children:"Location"}),x.jsx("dd",{className:"text-sm text-gray-900",children:r.city&&r.postal_code?`${r.city}, ${r.postal_code}`:r.city||"N/A"})]})]}),x.jsxs("div",{className:"flex items-start",children:[x.jsx(M2,{className:"h-5 w-5 text-gray-400 mt-0.5 mr-3"}),x.jsxs("div",{children:[x.jsx("dt",{className:"text-sm font-medium text-gray-500",children:"Registration Date"}),x.jsx("dd",{className:"text-sm text-gray-900",children:s(r.registration_date)})]})]}),r.website&&x.jsxs("div",{className:"flex items-start",children:[x.jsx(z2,{className:"h-5 w-5 text-gray-400 mt-0.5 mr-3"}),x.jsxs("div",{children:[x.jsx("dt",{className:"text-sm font-medium text-gray-500",children:"Website"}),x.jsx("dd",{className:"text-sm text-gray-900",children:x.jsx("a",{href:r.website.startsWith("http")?r.website:`https://${r.website}`,target:"_blank",rel:"noopener noreferrer",className:"text-indigo-600 hover:text-indigo-500",children:r.website})})]})]})]})]}),x.jsxs("div",{className:"bg-white shadow rounded-lg p-6",children:[x.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Business Details"}),x.jsxs("div",{className:"space-y-4",children:[x.jsxs("div",{children:[x.jsx("dt",{className:"text-sm font-medium text-gray-500 mb-1",children:"Industry"}),x.jsx("dd",{className:"text-sm text-gray-900 bg-gray-50 p-3 rounded-md",children:r.industry||"Not specified"})]}),r.address&&x.jsxs("div",{children:[x.jsx("dt",{className:"text-sm font-medium text-gray-500 mb-1",children:"Address"}),x.jsxs("dd",{className:"text-sm text-gray-900 bg-gray-50 p-3 rounded-md",children:[r.address,r.postal_code&&`, ${r.postal_code}`,r.city&&`, ${r.city}`]})]})]})]})]}),x.jsxs("div",{className:"mt-6 bg-white shadow rounded-lg p-6",children:[x.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Additional Information"}),x.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[x.jsxs("div",{children:[x.jsx("dt",{className:"font-medium text-gray-500",children:"Created"}),x.jsx("dd",{className:"text-gray-900",children:s(r.created_at)})]}),x.jsxs("div",{children:[x.jsx("dt",{className:"font-medium text-gray-500",children:"Last Updated"}),x.jsx("dd",{className:"text-gray-900",children:s(r.updated_at)})]})]})]})]})}function D0({children:t}){const{isAuthenticated:e,loading:r}=zs(),n=a1();return r?x.jsx("div",{className:"flex h-screen items-center justify-center",children:x.jsx("div",{className:"h-12 w-12 animate-spin rounded-full border-t-2 border-b-2 border-indigo-500"})}):e?t:x.jsx(o1,{to:"/login",state:{from:n},replace:!0})}function Z5(){return x.jsx(xI,{children:x.jsxs("div",{className:"min-h-screen bg-gray-50",children:[x.jsx(wI,{}),x.jsx("main",{className:"container mx-auto px-4 py-8",children:x.jsxs(l1,{children:[x.jsx(ia,{path:"/login",element:x.jsx(LI,{})}),x.jsx(ia,{path:"/register",element:x.jsx(MI,{})}),x.jsx(ia,{path:"/",element:x.jsx(D0,{children:x.jsx(J5,{})})}),x.jsx(ia,{path:"/companies/:id",element:x.jsx(D0,{children:x.jsx(Q5,{})})})]})}),x.jsx(Xx,{position:"top-right"})]})})}const eL=new O1({defaultOptions:{queries:{refetchOnWindowFocus:!1,retry:1,staleTime:5*60*1e3}}});Dl.createRoot(document.getElementById("root")).render(x.jsx(ve.StrictMode,{children:x.jsx(c1,{future:{v7_startTransition:!0,v7_relativeSplatPath:!0},children:x.jsx(z1,{client:eL,children:x.jsx(Z5,{})})})}));
